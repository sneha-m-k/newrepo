
/* /web_editor/static/lib/cropperjs/cropper.js defined in bundle 'web_editor.assets_wysiwyg' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):(global=global||self,global.Cropper=factory());}(this,function(){'use strict';function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj;};}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}
return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2;}}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
var IS_BROWSER=typeof window!=='undefined'&&typeof window.document!=='undefined';var WINDOW=IS_BROWSER?window:{};var IS_TOUCH_DEVICE=IS_BROWSER?'ontouchstart'in WINDOW.document.documentElement:false;var HAS_POINTER_EVENT=IS_BROWSER?'PointerEvent'in WINDOW:false;var NAMESPACE='cropper';var ACTION_ALL='all';var ACTION_CROP='crop';var ACTION_MOVE='move';var ACTION_ZOOM='zoom';var ACTION_EAST='e';var ACTION_WEST='w';var ACTION_SOUTH='s';var ACTION_NORTH='n';var ACTION_NORTH_EAST='ne';var ACTION_NORTH_WEST='nw';var ACTION_SOUTH_EAST='se';var ACTION_SOUTH_WEST='sw';var CLASS_CROP="".concat(NAMESPACE,"-crop");var CLASS_DISABLED="".concat(NAMESPACE,"-disabled");var CLASS_HIDDEN="".concat(NAMESPACE,"-hidden");var CLASS_HIDE="".concat(NAMESPACE,"-hide");var CLASS_INVISIBLE="".concat(NAMESPACE,"-invisible");var CLASS_MODAL="".concat(NAMESPACE,"-modal");var CLASS_MOVE="".concat(NAMESPACE,"-move");var DATA_ACTION="".concat(NAMESPACE,"Action");var DATA_PREVIEW="".concat(NAMESPACE,"Preview");var DRAG_MODE_CROP='crop';var DRAG_MODE_MOVE='move';var DRAG_MODE_NONE='none';var EVENT_CROP='crop';var EVENT_CROP_END='cropend';var EVENT_CROP_MOVE='cropmove';var EVENT_CROP_START='cropstart';var EVENT_DBLCLICK='dblclick';var EVENT_TOUCH_START=IS_TOUCH_DEVICE?'touchstart':'mousedown';var EVENT_TOUCH_MOVE=IS_TOUCH_DEVICE?'touchmove':'mousemove';var EVENT_TOUCH_END=IS_TOUCH_DEVICE?'touchend touchcancel':'mouseup';var EVENT_POINTER_DOWN=HAS_POINTER_EVENT?'pointerdown':EVENT_TOUCH_START;var EVENT_POINTER_MOVE=HAS_POINTER_EVENT?'pointermove':EVENT_TOUCH_MOVE;var EVENT_POINTER_UP=HAS_POINTER_EVENT?'pointerup pointercancel':EVENT_TOUCH_END;var EVENT_READY='ready';var EVENT_RESIZE='resize';var EVENT_WHEEL='wheel';var EVENT_ZOOM='zoom';var MIME_TYPE_JPEG='image/jpeg';var REGEXP_ACTIONS=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/;var REGEXP_DATA_URL=/^data:/;var REGEXP_DATA_URL_JPEG=/^data:image\/jpeg;base64,/;var REGEXP_TAG_NAME=/^img|canvas$/i;var MIN_CONTAINER_WIDTH=200;var MIN_CONTAINER_HEIGHT=100;var DEFAULTS={viewMode:0,dragMode:DRAG_MODE_CROP,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:'',responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:0.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:0.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};var TEMPLATE='<div class="cropper-container" touch-action="none">'+'<div class="cropper-wrap-box">'+'<div class="cropper-canvas"></div>'+'</div>'+'<div class="cropper-drag-box"></div>'+'<div class="cropper-crop-box">'+'<span class="cropper-view-box"></span>'+'<span class="cropper-dashed dashed-h"></span>'+'<span class="cropper-dashed dashed-v"></span>'+'<span class="cropper-center"></span>'+'<span class="cropper-face"></span>'+'<span class="cropper-line line-e" data-cropper-action="e"></span>'+'<span class="cropper-line line-n" data-cropper-action="n"></span>'+'<span class="cropper-line line-w" data-cropper-action="w"></span>'+'<span class="cropper-line line-s" data-cropper-action="s"></span>'+'<span class="cropper-point point-e" data-cropper-action="e"></span>'+'<span class="cropper-point point-n" data-cropper-action="n"></span>'+'<span class="cropper-point point-w" data-cropper-action="w"></span>'+'<span class="cropper-point point-s" data-cropper-action="s"></span>'+'<span class="cropper-point point-ne" data-cropper-action="ne"></span>'+'<span class="cropper-point point-nw" data-cropper-action="nw"></span>'+'<span class="cropper-point point-sw" data-cropper-action="sw"></span>'+'<span class="cropper-point point-se" data-cropper-action="se"></span>'+'</div>'+'</div>';var isNaN=Number.isNaN||WINDOW.isNaN;function isNumber(value){return typeof value==='number'&&!isNaN(value);}
var isPositiveNumber=function isPositiveNumber(value){return value>0&&value<Infinity;};function isUndefined(value){return typeof value==='undefined';}
function isObject(value){return _typeof(value)==='object'&&value!==null;}
var hasOwnProperty=Object.prototype.hasOwnProperty;function isPlainObject(value){if(!isObject(value)){return false;}
try{var _constructor=value.constructor;var prototype=_constructor.prototype;return _constructor&&prototype&&hasOwnProperty.call(prototype,'isPrototypeOf');}catch(error){return false;}}
function isFunction(value){return typeof value==='function';}
var slice=Array.prototype.slice;function toArray(value){return Array.from?Array.from(value):slice.call(value);}
function forEach(data,callback){if(data&&isFunction(callback)){if(Array.isArray(data)||isNumber(data.length)){toArray(data).forEach(function(value,key){callback.call(data,value,key,data);});}else if(isObject(data)){Object.keys(data).forEach(function(key){callback.call(data,data[key],key,data);});}}
return data;}
var assign=Object.assign||function assign(target){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
if(isObject(target)&&args.length>0){args.forEach(function(arg){if(isObject(arg)){Object.keys(arg).forEach(function(key){target[key]=arg[key];});}});}
return target;};var REGEXP_DECIMALS=/\.\d*(?:0|9){12}\d*$/;function normalizeDecimalNumber(value){var times=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100000000000;return REGEXP_DECIMALS.test(value)?Math.round(value*times)/times:value;}
var REGEXP_SUFFIX=/^width|height|left|top|marginLeft|marginTop$/;function setStyle(element,styles){var style=element.style;forEach(styles,function(value,property){if(REGEXP_SUFFIX.test(property)&&isNumber(value)){value="".concat(value,"px");}
style[property]=value;});}
function hasClass(element,value){return element.classList?element.classList.contains(value):element.className.indexOf(value)>-1;}
function addClass(element,value){if(!value){return;}
if(isNumber(element.length)){forEach(element,function(elem){addClass(elem,value);});return;}
if(element.classList){element.classList.add(value);return;}
var className=element.className.trim();if(!className){element.className=value;}else if(className.indexOf(value)<0){element.className="".concat(className," ").concat(value);}}
function removeClass(element,value){if(!value){return;}
if(isNumber(element.length)){forEach(element,function(elem){removeClass(elem,value);});return;}
if(element.classList){element.classList.remove(value);return;}
if(element.className.indexOf(value)>=0){element.className=element.className.replace(value,'');}}
function toggleClass(element,value,added){if(!value){return;}
if(isNumber(element.length)){forEach(element,function(elem){toggleClass(elem,value,added);});return;}
if(added){addClass(element,value);}else{removeClass(element,value);}}
var REGEXP_CAMEL_CASE=/([a-z\d])([A-Z])/g;function toParamCase(value){return value.replace(REGEXP_CAMEL_CASE,'$1-$2').toLowerCase();}
function getData(element,name){if(isObject(element[name])){return element[name];}
if(element.dataset){return element.dataset[name];}
return element.getAttribute("data-".concat(toParamCase(name)));}
function setData(element,name,data){if(isObject(data)){element[name]=data;}else if(element.dataset){element.dataset[name]=data;}else{element.setAttribute("data-".concat(toParamCase(name)),data);}}
function removeData(element,name){if(isObject(element[name])){try{delete element[name];}catch(error){element[name]=undefined;}}else if(element.dataset){try{delete element.dataset[name];}catch(error){element.dataset[name]=undefined;}}else{element.removeAttribute("data-".concat(toParamCase(name)));}}
var REGEXP_SPACES=/\s\s*/;var onceSupported=function(){var supported=false;if(IS_BROWSER){var once=false;var listener=function listener(){};var options=Object.defineProperty({},'once',{get:function get(){supported=true;return once;},set:function set(value){once=value;}});WINDOW.addEventListener('test',listener,options);WINDOW.removeEventListener('test',listener,options);}
return supported;}();function removeListener(element,type,listener){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var handler=listener;type.trim().split(REGEXP_SPACES).forEach(function(event){if(!onceSupported){var listeners=element.listeners;if(listeners&&listeners[event]&&listeners[event][listener]){handler=listeners[event][listener];delete listeners[event][listener];if(Object.keys(listeners[event]).length===0){delete listeners[event];}
if(Object.keys(listeners).length===0){delete element.listeners;}}}
element.removeEventListener(event,handler,options);});}
function addListener(element,type,listener){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var _handler=listener;type.trim().split(REGEXP_SPACES).forEach(function(event){if(options.once&&!onceSupported){var _element$listeners=element.listeners,listeners=_element$listeners===void 0?{}:_element$listeners;_handler=function handler(){delete listeners[event][listener];element.removeEventListener(event,_handler,options);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}
listener.apply(element,args);};if(!listeners[event]){listeners[event]={};}
if(listeners[event][listener]){element.removeEventListener(event,listeners[event][listener],options);}
listeners[event][listener]=_handler;element.listeners=listeners;}
element.addEventListener(event,_handler,options);});}
function dispatchEvent(element,type,data){var event;if(isFunction(Event)&&isFunction(CustomEvent)){event=new CustomEvent(type,{detail:data,bubbles:true,cancelable:true});}else{event=document.createEvent('CustomEvent');event.initCustomEvent(type,true,true,data);}
return element.dispatchEvent(event);}
function getOffset(element){var box=element.getBoundingClientRect();return{left:box.left+(window.pageXOffset-document.documentElement.clientLeft),top:box.top+(window.pageYOffset-document.documentElement.clientTop)};}
var location=WINDOW.location;var REGEXP_ORIGINS=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function isCrossOriginURL(url){var parts=url.match(REGEXP_ORIGINS);return parts!==null&&(parts[1]!==location.protocol||parts[2]!==location.hostname||parts[3]!==location.port);}
function addTimestamp(url){var timestamp="timestamp=".concat(new Date().getTime());return url+(url.indexOf('?')===-1?'?':'&')+timestamp;}
function getTransforms(_ref){var rotate=_ref.rotate,scaleX=_ref.scaleX,scaleY=_ref.scaleY,translateX=_ref.translateX,translateY=_ref.translateY;var values=[];if(isNumber(translateX)&&translateX!==0){values.push("translateX(".concat(translateX,"px)"));}
if(isNumber(translateY)&&translateY!==0){values.push("translateY(".concat(translateY,"px)"));}
if(isNumber(rotate)&&rotate!==0){values.push("rotate(".concat(rotate,"deg)"));}
if(isNumber(scaleX)&&scaleX!==1){values.push("scaleX(".concat(scaleX,")"));}
if(isNumber(scaleY)&&scaleY!==1){values.push("scaleY(".concat(scaleY,")"));}
var transform=values.length?values.join(' '):'none';return{WebkitTransform:transform,msTransform:transform,transform:transform};}
function getMaxZoomRatio(pointers){var pointers2=assign({},pointers);var ratios=[];forEach(pointers,function(pointer,pointerId){delete pointers2[pointerId];forEach(pointers2,function(pointer2){var x1=Math.abs(pointer.startX-pointer2.startX);var y1=Math.abs(pointer.startY-pointer2.startY);var x2=Math.abs(pointer.endX-pointer2.endX);var y2=Math.abs(pointer.endY-pointer2.endY);var z1=Math.sqrt(x1*x1+y1*y1);var z2=Math.sqrt(x2*x2+y2*y2);var ratio=(z2-z1)/z1;ratios.push(ratio);});});ratios.sort(function(a,b){return Math.abs(a)<Math.abs(b);});return ratios[0];}
function getPointer(_ref2,endOnly){var pageX=_ref2.pageX,pageY=_ref2.pageY;var end={endX:pageX,endY:pageY};return endOnly?end:assign({startX:pageX,startY:pageY},end);}
function getPointersCenter(pointers){var pageX=0;var pageY=0;var count=0;forEach(pointers,function(_ref3){var startX=_ref3.startX,startY=_ref3.startY;pageX+=startX;pageY+=startY;count+=1;});pageX/=count;pageY/=count;return{pageX:pageX,pageY:pageY};}
function getAdjustedSizes(_ref4)
{var aspectRatio=_ref4.aspectRatio,height=_ref4.height,width=_ref4.width;var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'contain';var isValidWidth=isPositiveNumber(width);var isValidHeight=isPositiveNumber(height);if(isValidWidth&&isValidHeight){var adjustedWidth=height*aspectRatio;if(type==='contain'&&adjustedWidth>width||type==='cover'&&adjustedWidth<width){height=width/aspectRatio;}else{width=height*aspectRatio;}}else if(isValidWidth){height=width/aspectRatio;}else if(isValidHeight){width=height*aspectRatio;}
return{width:width,height:height};}
function getRotatedSizes(_ref5){var width=_ref5.width,height=_ref5.height,degree=_ref5.degree;degree=Math.abs(degree)%180;if(degree===90){return{width:height,height:width};}
var arc=degree%90*Math.PI/180;var sinArc=Math.sin(arc);var cosArc=Math.cos(arc);var newWidth=width*cosArc+height*sinArc;var newHeight=width*sinArc+height*cosArc;return degree>90?{width:newHeight,height:newWidth}:{width:newWidth,height:newHeight};}
function getSourceCanvas(image,_ref6,_ref7,_ref8){var imageAspectRatio=_ref6.aspectRatio,imageNaturalWidth=_ref6.naturalWidth,imageNaturalHeight=_ref6.naturalHeight,_ref6$rotate=_ref6.rotate,rotate=_ref6$rotate===void 0?0:_ref6$rotate,_ref6$scaleX=_ref6.scaleX,scaleX=_ref6$scaleX===void 0?1:_ref6$scaleX,_ref6$scaleY=_ref6.scaleY,scaleY=_ref6$scaleY===void 0?1:_ref6$scaleY;var aspectRatio=_ref7.aspectRatio,naturalWidth=_ref7.naturalWidth,naturalHeight=_ref7.naturalHeight;var _ref8$fillColor=_ref8.fillColor,fillColor=_ref8$fillColor===void 0?'transparent':_ref8$fillColor,_ref8$imageSmoothingE=_ref8.imageSmoothingEnabled,imageSmoothingEnabled=_ref8$imageSmoothingE===void 0?true:_ref8$imageSmoothingE,_ref8$imageSmoothingQ=_ref8.imageSmoothingQuality,imageSmoothingQuality=_ref8$imageSmoothingQ===void 0?'low':_ref8$imageSmoothingQ,_ref8$maxWidth=_ref8.maxWidth,maxWidth=_ref8$maxWidth===void 0?Infinity:_ref8$maxWidth,_ref8$maxHeight=_ref8.maxHeight,maxHeight=_ref8$maxHeight===void 0?Infinity:_ref8$maxHeight,_ref8$minWidth=_ref8.minWidth,minWidth=_ref8$minWidth===void 0?0:_ref8$minWidth,_ref8$minHeight=_ref8.minHeight,minHeight=_ref8$minHeight===void 0?0:_ref8$minHeight;var canvas=document.createElement('canvas');var context=canvas.getContext('2d');var maxSizes=getAdjustedSizes({aspectRatio:aspectRatio,width:maxWidth,height:maxHeight});var minSizes=getAdjustedSizes({aspectRatio:aspectRatio,width:minWidth,height:minHeight},'cover');var width=Math.min(maxSizes.width,Math.max(minSizes.width,naturalWidth));var height=Math.min(maxSizes.height,Math.max(minSizes.height,naturalHeight));var destMaxSizes=getAdjustedSizes({aspectRatio:imageAspectRatio,width:maxWidth,height:maxHeight});var destMinSizes=getAdjustedSizes({aspectRatio:imageAspectRatio,width:minWidth,height:minHeight},'cover');var destWidth=Math.min(destMaxSizes.width,Math.max(destMinSizes.width,imageNaturalWidth));var destHeight=Math.min(destMaxSizes.height,Math.max(destMinSizes.height,imageNaturalHeight));var params=[-destWidth/2,-destHeight/2,destWidth,destHeight];canvas.width=normalizeDecimalNumber(width);canvas.height=normalizeDecimalNumber(height);context.fillStyle=fillColor;context.fillRect(0,0,width,height);context.save();context.translate(width/2,height/2);context.rotate(rotate*Math.PI/180);context.scale(scaleX,scaleY);context.imageSmoothingEnabled=imageSmoothingEnabled;context.imageSmoothingQuality=imageSmoothingQuality;context.drawImage.apply(context,[image].concat(_toConsumableArray(params.map(function(param){return Math.floor(normalizeDecimalNumber(param));}))));context.restore();return canvas;}
var fromCharCode=String.fromCharCode;function getStringFromCharCode(dataView,start,length){var str='';length+=start;for(var i=start;i<length;i+=1){str+=fromCharCode(dataView.getUint8(i));}
return str;}
var REGEXP_DATA_URL_HEAD=/^data:.*,/;function dataURLToArrayBuffer(dataURL){var base64=dataURL.replace(REGEXP_DATA_URL_HEAD,'');var binary=atob(base64);var arrayBuffer=new ArrayBuffer(binary.length);var uint8=new Uint8Array(arrayBuffer);forEach(uint8,function(value,i){uint8[i]=binary.charCodeAt(i);});return arrayBuffer;}
function arrayBufferToDataURL(arrayBuffer,mimeType){var chunks=[];var chunkSize=8192;var uint8=new Uint8Array(arrayBuffer);while(uint8.length>0){chunks.push(fromCharCode.apply(null,toArray(uint8.subarray(0,chunkSize))));uint8=uint8.subarray(chunkSize);}
return"data:".concat(mimeType,";base64,").concat(btoa(chunks.join('')));}
function resetAndGetOrientation(arrayBuffer){var dataView=new DataView(arrayBuffer);var orientation;try{var littleEndian;var app1Start;var ifdStart;if(dataView.getUint8(0)===0xFF&&dataView.getUint8(1)===0xD8){var length=dataView.byteLength;var offset=2;while(offset+1<length){if(dataView.getUint8(offset)===0xFF&&dataView.getUint8(offset+1)===0xE1){app1Start=offset;break;}
offset+=1;}}
if(app1Start){var exifIDCode=app1Start+4;var tiffOffset=app1Start+10;if(getStringFromCharCode(dataView,exifIDCode,4)==='Exif'){var endianness=dataView.getUint16(tiffOffset);littleEndian=endianness===0x4949;if(littleEndian||endianness===0x4D4D){if(dataView.getUint16(tiffOffset+2,littleEndian)===0x002A){var firstIFDOffset=dataView.getUint32(tiffOffset+4,littleEndian);if(firstIFDOffset>=0x00000008){ifdStart=tiffOffset+firstIFDOffset;}}}}}
if(ifdStart){var _length=dataView.getUint16(ifdStart,littleEndian);var _offset;var i;for(i=0;i<_length;i+=1){_offset=ifdStart+i*12+2;if(dataView.getUint16(_offset,littleEndian)===0x0112){_offset+=8;orientation=dataView.getUint16(_offset,littleEndian);dataView.setUint16(_offset,1,littleEndian);break;}}}}catch(error){orientation=1;}
return orientation;}
function parseOrientation(orientation){var rotate=0;var scaleX=1;var scaleY=1;switch(orientation){case 2:scaleX=-1;break;case 3:rotate=-180;break;case 4:scaleY=-1;break;case 5:rotate=90;scaleY=-1;break;case 6:rotate=90;break;case 7:rotate=90;scaleX=-1;break;case 8:rotate=-90;break;default:}
return{rotate:rotate,scaleX:scaleX,scaleY:scaleY};}
var render={render:function render(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.cropped){this.renderCropBox();}},initContainer:function initContainer(){var element=this.element,options=this.options,container=this.container,cropper=this.cropper;addClass(cropper,CLASS_HIDDEN);removeClass(element,CLASS_HIDDEN);var containerData={width:Math.max(container.offsetWidth,Number(options.minContainerWidth)||200),height:Math.max(container.offsetHeight,Number(options.minContainerHeight)||100)};this.containerData=containerData;setStyle(cropper,{width:containerData.width,height:containerData.height});addClass(element,CLASS_HIDDEN);removeClass(cropper,CLASS_HIDDEN);},initCanvas:function initCanvas(){var containerData=this.containerData,imageData=this.imageData;var viewMode=this.options.viewMode;var rotated=Math.abs(imageData.rotate)%180===90;var naturalWidth=rotated?imageData.naturalHeight:imageData.naturalWidth;var naturalHeight=rotated?imageData.naturalWidth:imageData.naturalHeight;var aspectRatio=naturalWidth/naturalHeight;var canvasWidth=containerData.width;var canvasHeight=containerData.height;if(containerData.height*aspectRatio>containerData.width){if(viewMode===3){canvasWidth=containerData.height*aspectRatio;}else{canvasHeight=containerData.width/aspectRatio;}}else if(viewMode===3){canvasHeight=containerData.width/aspectRatio;}else{canvasWidth=containerData.height*aspectRatio;}
var canvasData={aspectRatio:aspectRatio,naturalWidth:naturalWidth,naturalHeight:naturalHeight,width:canvasWidth,height:canvasHeight};canvasData.left=(containerData.width-canvasWidth)/2;canvasData.top=(containerData.height-canvasHeight)/2;canvasData.oldLeft=canvasData.left;canvasData.oldTop=canvasData.top;this.canvasData=canvasData;this.limited=viewMode===1||viewMode===2;this.limitCanvas(true,true);this.initialImageData=assign({},imageData);this.initialCanvasData=assign({},canvasData);},limitCanvas:function limitCanvas(sizeLimited,positionLimited){var options=this.options,containerData=this.containerData,canvasData=this.canvasData,cropBoxData=this.cropBoxData;var viewMode=options.viewMode;var aspectRatio=canvasData.aspectRatio;var cropped=this.cropped&&cropBoxData;if(sizeLimited){var minCanvasWidth=Number(options.minCanvasWidth)||0;var minCanvasHeight=Number(options.minCanvasHeight)||0;if(viewMode>1){minCanvasWidth=Math.max(minCanvasWidth,containerData.width);minCanvasHeight=Math.max(minCanvasHeight,containerData.height);if(viewMode===3){if(minCanvasHeight*aspectRatio>minCanvasWidth){minCanvasWidth=minCanvasHeight*aspectRatio;}else{minCanvasHeight=minCanvasWidth/aspectRatio;}}}else if(viewMode>0){if(minCanvasWidth){minCanvasWidth=Math.max(minCanvasWidth,cropped?cropBoxData.width:0);}else if(minCanvasHeight){minCanvasHeight=Math.max(minCanvasHeight,cropped?cropBoxData.height:0);}else if(cropped){minCanvasWidth=cropBoxData.width;minCanvasHeight=cropBoxData.height;if(minCanvasHeight*aspectRatio>minCanvasWidth){minCanvasWidth=minCanvasHeight*aspectRatio;}else{minCanvasHeight=minCanvasWidth/aspectRatio;}}}
var _getAdjustedSizes=getAdjustedSizes({aspectRatio:aspectRatio,width:minCanvasWidth,height:minCanvasHeight});minCanvasWidth=_getAdjustedSizes.width;minCanvasHeight=_getAdjustedSizes.height;canvasData.minWidth=minCanvasWidth;canvasData.minHeight=minCanvasHeight;canvasData.maxWidth=Infinity;canvasData.maxHeight=Infinity;}
if(positionLimited){if(viewMode>(cropped?0:1)){var newCanvasLeft=containerData.width-canvasData.width;var newCanvasTop=containerData.height-canvasData.height;canvasData.minLeft=Math.min(0,newCanvasLeft);canvasData.minTop=Math.min(0,newCanvasTop);canvasData.maxLeft=Math.max(0,newCanvasLeft);canvasData.maxTop=Math.max(0,newCanvasTop);if(cropped&&this.limited){canvasData.minLeft=Math.min(cropBoxData.left,cropBoxData.left+(cropBoxData.width-canvasData.width));canvasData.minTop=Math.min(cropBoxData.top,cropBoxData.top+(cropBoxData.height-canvasData.height));canvasData.maxLeft=cropBoxData.left;canvasData.maxTop=cropBoxData.top;if(viewMode===2){if(canvasData.width>=containerData.width){canvasData.minLeft=Math.min(0,newCanvasLeft);canvasData.maxLeft=Math.max(0,newCanvasLeft);}
if(canvasData.height>=containerData.height){canvasData.minTop=Math.min(0,newCanvasTop);canvasData.maxTop=Math.max(0,newCanvasTop);}}}}else{canvasData.minLeft=-canvasData.width;canvasData.minTop=-canvasData.height;canvasData.maxLeft=containerData.width;canvasData.maxTop=containerData.height;}}},renderCanvas:function renderCanvas(changed,transformed){var canvasData=this.canvasData,imageData=this.imageData;if(transformed){var _getRotatedSizes=getRotatedSizes({width:imageData.naturalWidth*Math.abs(imageData.scaleX||1),height:imageData.naturalHeight*Math.abs(imageData.scaleY||1),degree:imageData.rotate||0}),naturalWidth=_getRotatedSizes.width,naturalHeight=_getRotatedSizes.height;var width=canvasData.width*(naturalWidth/canvasData.naturalWidth);var height=canvasData.height*(naturalHeight/canvasData.naturalHeight);canvasData.left-=(width-canvasData.width)/2;canvasData.top-=(height-canvasData.height)/2;canvasData.width=width;canvasData.height=height;canvasData.aspectRatio=naturalWidth/naturalHeight;canvasData.naturalWidth=naturalWidth;canvasData.naturalHeight=naturalHeight;this.limitCanvas(true,false);}
if(canvasData.width>canvasData.maxWidth||canvasData.width<canvasData.minWidth){canvasData.left=canvasData.oldLeft;}
if(canvasData.height>canvasData.maxHeight||canvasData.height<canvasData.minHeight){canvasData.top=canvasData.oldTop;}
canvasData.width=Math.min(Math.max(canvasData.width,canvasData.minWidth),canvasData.maxWidth);canvasData.height=Math.min(Math.max(canvasData.height,canvasData.minHeight),canvasData.maxHeight);this.limitCanvas(false,true);canvasData.left=Math.min(Math.max(canvasData.left,canvasData.minLeft),canvasData.maxLeft);canvasData.top=Math.min(Math.max(canvasData.top,canvasData.minTop),canvasData.maxTop);canvasData.oldLeft=canvasData.left;canvasData.oldTop=canvasData.top;setStyle(this.canvas,assign({width:canvasData.width,height:canvasData.height},getTransforms({translateX:canvasData.left,translateY:canvasData.top})));this.renderImage(changed);if(this.cropped&&this.limited){this.limitCropBox(true,true);}},renderImage:function renderImage(changed){var canvasData=this.canvasData,imageData=this.imageData;var width=imageData.naturalWidth*(canvasData.width/canvasData.naturalWidth);var height=imageData.naturalHeight*(canvasData.height/canvasData.naturalHeight);assign(imageData,{width:width,height:height,left:(canvasData.width-width)/2,top:(canvasData.height-height)/2});setStyle(this.image,assign({width:imageData.width,height:imageData.height},getTransforms(assign({translateX:imageData.left,translateY:imageData.top},imageData))));if(changed){this.output();}},initCropBox:function initCropBox(){var options=this.options,canvasData=this.canvasData;var aspectRatio=options.aspectRatio||options.initialAspectRatio;var autoCropArea=Number(options.autoCropArea)||0.8;var cropBoxData={width:canvasData.width,height:canvasData.height};if(aspectRatio){if(canvasData.height*aspectRatio>canvasData.width){cropBoxData.height=cropBoxData.width/aspectRatio;}else{cropBoxData.width=cropBoxData.height*aspectRatio;}}
this.cropBoxData=cropBoxData;this.limitCropBox(true,true);cropBoxData.width=Math.min(Math.max(cropBoxData.width,cropBoxData.minWidth),cropBoxData.maxWidth);cropBoxData.height=Math.min(Math.max(cropBoxData.height,cropBoxData.minHeight),cropBoxData.maxHeight);cropBoxData.width=Math.max(cropBoxData.minWidth,cropBoxData.width*autoCropArea);cropBoxData.height=Math.max(cropBoxData.minHeight,cropBoxData.height*autoCropArea);cropBoxData.left=canvasData.left+(canvasData.width-cropBoxData.width)/2;cropBoxData.top=canvasData.top+(canvasData.height-cropBoxData.height)/2;cropBoxData.oldLeft=cropBoxData.left;cropBoxData.oldTop=cropBoxData.top;this.initialCropBoxData=assign({},cropBoxData);},limitCropBox:function limitCropBox(sizeLimited,positionLimited){var options=this.options,containerData=this.containerData,canvasData=this.canvasData,cropBoxData=this.cropBoxData,limited=this.limited;var aspectRatio=options.aspectRatio;if(sizeLimited){var minCropBoxWidth=Number(options.minCropBoxWidth)||0;var minCropBoxHeight=Number(options.minCropBoxHeight)||0;var maxCropBoxWidth=limited?Math.min(containerData.width,canvasData.width,canvasData.width+canvasData.left,containerData.width-canvasData.left):containerData.width;var maxCropBoxHeight=limited?Math.min(containerData.height,canvasData.height,canvasData.height+canvasData.top,containerData.height-canvasData.top):containerData.height;minCropBoxWidth=Math.min(minCropBoxWidth,containerData.width);minCropBoxHeight=Math.min(minCropBoxHeight,containerData.height);if(aspectRatio){if(minCropBoxWidth&&minCropBoxHeight){if(minCropBoxHeight*aspectRatio>minCropBoxWidth){minCropBoxHeight=minCropBoxWidth/aspectRatio;}else{minCropBoxWidth=minCropBoxHeight*aspectRatio;}}else if(minCropBoxWidth){minCropBoxHeight=minCropBoxWidth/aspectRatio;}else if(minCropBoxHeight){minCropBoxWidth=minCropBoxHeight*aspectRatio;}
if(maxCropBoxHeight*aspectRatio>maxCropBoxWidth){maxCropBoxHeight=maxCropBoxWidth/aspectRatio;}else{maxCropBoxWidth=maxCropBoxHeight*aspectRatio;}}
cropBoxData.minWidth=Math.min(minCropBoxWidth,maxCropBoxWidth);cropBoxData.minHeight=Math.min(minCropBoxHeight,maxCropBoxHeight);cropBoxData.maxWidth=maxCropBoxWidth;cropBoxData.maxHeight=maxCropBoxHeight;}
if(positionLimited){if(limited){cropBoxData.minLeft=Math.max(0,canvasData.left);cropBoxData.minTop=Math.max(0,canvasData.top);cropBoxData.maxLeft=Math.min(containerData.width,canvasData.left+canvasData.width)-cropBoxData.width;cropBoxData.maxTop=Math.min(containerData.height,canvasData.top+canvasData.height)-cropBoxData.height;}else{cropBoxData.minLeft=0;cropBoxData.minTop=0;cropBoxData.maxLeft=containerData.width-cropBoxData.width;cropBoxData.maxTop=containerData.height-cropBoxData.height;}}},renderCropBox:function renderCropBox(){var options=this.options,containerData=this.containerData,cropBoxData=this.cropBoxData;if(cropBoxData.width>cropBoxData.maxWidth||cropBoxData.width<cropBoxData.minWidth){cropBoxData.left=cropBoxData.oldLeft;}
if(cropBoxData.height>cropBoxData.maxHeight||cropBoxData.height<cropBoxData.minHeight){cropBoxData.top=cropBoxData.oldTop;}
cropBoxData.width=Math.min(Math.max(cropBoxData.width,cropBoxData.minWidth),cropBoxData.maxWidth);cropBoxData.height=Math.min(Math.max(cropBoxData.height,cropBoxData.minHeight),cropBoxData.maxHeight);this.limitCropBox(false,true);cropBoxData.left=Math.min(Math.max(cropBoxData.left,cropBoxData.minLeft),cropBoxData.maxLeft);cropBoxData.top=Math.min(Math.max(cropBoxData.top,cropBoxData.minTop),cropBoxData.maxTop);cropBoxData.oldLeft=cropBoxData.left;cropBoxData.oldTop=cropBoxData.top;if(options.movable&&options.cropBoxMovable){setData(this.face,DATA_ACTION,cropBoxData.width>=containerData.width&&cropBoxData.height>=containerData.height?ACTION_MOVE:ACTION_ALL);}
setStyle(this.cropBox,assign({width:cropBoxData.width,height:cropBoxData.height},getTransforms({translateX:cropBoxData.left,translateY:cropBoxData.top})));if(this.cropped&&this.limited){this.limitCanvas(true,true);}
if(!this.disabled){this.output();}},output:function output(){this.preview();dispatchEvent(this.element,EVENT_CROP,this.getData());}};var preview={initPreview:function initPreview(){var element=this.element,crossOrigin=this.crossOrigin;var preview=this.options.preview;var url=crossOrigin?this.crossOriginUrl:this.url;var alt=element.alt||'The image to preview';var image=document.createElement('img');if(crossOrigin){image.crossOrigin=crossOrigin;}
image.src=url;image.alt=alt;this.viewBox.appendChild(image);this.viewBoxImage=image;if(!preview){return;}
var previews=preview;if(typeof preview==='string'){previews=element.ownerDocument.querySelectorAll(preview);}else if(preview.querySelector){previews=[preview];}
this.previews=previews;forEach(previews,function(el){var img=document.createElement('img');setData(el,DATA_PREVIEW,{width:el.offsetWidth,height:el.offsetHeight,html:el.innerHTML});if(crossOrigin){img.crossOrigin=crossOrigin;}
img.src=url;img.alt=alt;img.style.cssText='display:block;'+'width:100%;'+'height:auto;'+'min-width:0!important;'+'min-height:0!important;'+'max-width:none!important;'+'max-height:none!important;'+'image-orientation:0deg!important;"';el.innerHTML='';el.appendChild(img);});},resetPreview:function resetPreview(){forEach(this.previews,function(element){var data=getData(element,DATA_PREVIEW);setStyle(element,{width:data.width,height:data.height});element.innerHTML=data.html;removeData(element,DATA_PREVIEW);});},preview:function preview(){var imageData=this.imageData,canvasData=this.canvasData,cropBoxData=this.cropBoxData;var cropBoxWidth=cropBoxData.width,cropBoxHeight=cropBoxData.height;var width=imageData.width,height=imageData.height;var left=cropBoxData.left-canvasData.left-imageData.left;var top=cropBoxData.top-canvasData.top-imageData.top;if(!this.cropped||this.disabled){return;}
setStyle(this.viewBoxImage,assign({width:width,height:height},getTransforms(assign({translateX:-left,translateY:-top},imageData))));forEach(this.previews,function(element){var data=getData(element,DATA_PREVIEW);var originalWidth=data.width;var originalHeight=data.height;var newWidth=originalWidth;var newHeight=originalHeight;var ratio=1;if(cropBoxWidth){ratio=originalWidth/cropBoxWidth;newHeight=cropBoxHeight*ratio;}
if(cropBoxHeight&&newHeight>originalHeight){ratio=originalHeight/cropBoxHeight;newWidth=cropBoxWidth*ratio;newHeight=originalHeight;}
setStyle(element,{width:newWidth,height:newHeight});setStyle(element.getElementsByTagName('img')[0],assign({width:width*ratio,height:height*ratio},getTransforms(assign({translateX:-left*ratio,translateY:-top*ratio},imageData))));});}};var events={bind:function bind(){var element=this.element,options=this.options,cropper=this.cropper;if(isFunction(options.cropstart)){addListener(element,EVENT_CROP_START,options.cropstart);}
if(isFunction(options.cropmove)){addListener(element,EVENT_CROP_MOVE,options.cropmove);}
if(isFunction(options.cropend)){addListener(element,EVENT_CROP_END,options.cropend);}
if(isFunction(options.crop)){addListener(element,EVENT_CROP,options.crop);}
if(isFunction(options.zoom)){addListener(element,EVENT_ZOOM,options.zoom);}
addListener(cropper,EVENT_POINTER_DOWN,this.onCropStart=this.cropStart.bind(this));if(options.zoomable&&options.zoomOnWheel){addListener(cropper,EVENT_WHEEL,this.onWheel=this.wheel.bind(this),{passive:false,capture:true});}
if(options.toggleDragModeOnDblclick){addListener(cropper,EVENT_DBLCLICK,this.onDblclick=this.dblclick.bind(this));}
addListener(element.ownerDocument,EVENT_POINTER_MOVE,this.onCropMove=this.cropMove.bind(this));addListener(element.ownerDocument,EVENT_POINTER_UP,this.onCropEnd=this.cropEnd.bind(this));if(options.responsive){addListener(window,EVENT_RESIZE,this.onResize=this.resize.bind(this));}},unbind:function unbind(){var element=this.element,options=this.options,cropper=this.cropper;if(isFunction(options.cropstart)){removeListener(element,EVENT_CROP_START,options.cropstart);}
if(isFunction(options.cropmove)){removeListener(element,EVENT_CROP_MOVE,options.cropmove);}
if(isFunction(options.cropend)){removeListener(element,EVENT_CROP_END,options.cropend);}
if(isFunction(options.crop)){removeListener(element,EVENT_CROP,options.crop);}
if(isFunction(options.zoom)){removeListener(element,EVENT_ZOOM,options.zoom);}
removeListener(cropper,EVENT_POINTER_DOWN,this.onCropStart);if(options.zoomable&&options.zoomOnWheel){removeListener(cropper,EVENT_WHEEL,this.onWheel,{passive:false,capture:true});}
if(options.toggleDragModeOnDblclick){removeListener(cropper,EVENT_DBLCLICK,this.onDblclick);}
removeListener(element.ownerDocument,EVENT_POINTER_MOVE,this.onCropMove);removeListener(element.ownerDocument,EVENT_POINTER_UP,this.onCropEnd);if(options.responsive){removeListener(window,EVENT_RESIZE,this.onResize);}}};var handlers={resize:function resize(){var options=this.options,container=this.container,containerData=this.containerData;var minContainerWidth=Number(options.minContainerWidth)||MIN_CONTAINER_WIDTH;var minContainerHeight=Number(options.minContainerHeight)||MIN_CONTAINER_HEIGHT;if(this.disabled||containerData.width<=minContainerWidth||containerData.height<=minContainerHeight){return;}
var ratio=container.offsetWidth/containerData.width;if(ratio!==1||container.offsetHeight!==containerData.height){var canvasData;var cropBoxData;if(options.restore){canvasData=this.getCanvasData();cropBoxData=this.getCropBoxData();}
this.render();if(options.restore){this.setCanvasData(forEach(canvasData,function(n,i){canvasData[i]=n*ratio;}));this.setCropBoxData(forEach(cropBoxData,function(n,i){cropBoxData[i]=n*ratio;}));}}},dblclick:function dblclick(){if(this.disabled||this.options.dragMode===DRAG_MODE_NONE){return;}
this.setDragMode(hasClass(this.dragBox,CLASS_CROP)?DRAG_MODE_MOVE:DRAG_MODE_CROP);},wheel:function wheel(event){var _this=this;var ratio=Number(this.options.wheelZoomRatio)||0.1;var delta=1;if(this.disabled){return;}
event.preventDefault();if(this.wheeling){return;}
this.wheeling=true;setTimeout(function(){_this.wheeling=false;},50);if(event.deltaY){delta=event.deltaY>0?1:-1;}else if(event.wheelDelta){delta=-event.wheelDelta/120;}else if(event.detail){delta=event.detail>0?1:-1;}
this.zoom(-delta*ratio,event);},cropStart:function cropStart(event){var buttons=event.buttons,button=event.button;if(this.disabled||isNumber(buttons)&&buttons!==1||isNumber(button)&&button!==0||event.ctrlKey){return;}
var options=this.options,pointers=this.pointers;var action;if(event.changedTouches){forEach(event.changedTouches,function(touch){pointers[touch.identifier]=getPointer(touch);});}else{pointers[event.pointerId||0]=getPointer(event);}
if(Object.keys(pointers).length>1&&options.zoomable&&options.zoomOnTouch){action=ACTION_ZOOM;}else{action=getData(event.target,DATA_ACTION);}
if(!REGEXP_ACTIONS.test(action)){return;}
if(dispatchEvent(this.element,EVENT_CROP_START,{originalEvent:event,action:action})===false){return;}
event.preventDefault();this.action=action;this.cropping=false;if(action===ACTION_CROP){this.cropping=true;addClass(this.dragBox,CLASS_MODAL);}},cropMove:function cropMove(event){var action=this.action;if(this.disabled||!action){return;}
var pointers=this.pointers;event.preventDefault();if(dispatchEvent(this.element,EVENT_CROP_MOVE,{originalEvent:event,action:action})===false){return;}
if(event.changedTouches){forEach(event.changedTouches,function(touch){assign(pointers[touch.identifier]||{},getPointer(touch,true));});}else{assign(pointers[event.pointerId||0]||{},getPointer(event,true));}
this.change(event);},cropEnd:function cropEnd(event){if(this.disabled){return;}
var action=this.action,pointers=this.pointers;if(event.changedTouches){forEach(event.changedTouches,function(touch){delete pointers[touch.identifier];});}else{delete pointers[event.pointerId||0];}
if(!action){return;}
event.preventDefault();if(!Object.keys(pointers).length){this.action='';}
if(this.cropping){this.cropping=false;toggleClass(this.dragBox,CLASS_MODAL,this.cropped&&this.options.modal);}
dispatchEvent(this.element,EVENT_CROP_END,{originalEvent:event,action:action});}};var change={change:function change(event){var options=this.options,canvasData=this.canvasData,containerData=this.containerData,cropBoxData=this.cropBoxData,pointers=this.pointers;var action=this.action;var aspectRatio=options.aspectRatio;var left=cropBoxData.left,top=cropBoxData.top,width=cropBoxData.width,height=cropBoxData.height;var right=left+width;var bottom=top+height;var minLeft=0;var minTop=0;var maxWidth=containerData.width;var maxHeight=containerData.height;var renderable=true;var offset;if(!aspectRatio&&event.shiftKey){aspectRatio=width&&height?width/height:1;}
if(this.limited){minLeft=cropBoxData.minLeft;minTop=cropBoxData.minTop;maxWidth=minLeft+Math.min(containerData.width,canvasData.width,canvasData.left+canvasData.width);maxHeight=minTop+Math.min(containerData.height,canvasData.height,canvasData.top+canvasData.height);}
var pointer=pointers[Object.keys(pointers)[0]];var range={x:pointer.endX-pointer.startX,y:pointer.endY-pointer.startY};var check=function check(side){switch(side){case ACTION_EAST:if(right+range.x>maxWidth){range.x=maxWidth-right;}
break;case ACTION_WEST:if(left+range.x<minLeft){range.x=minLeft-left;}
break;case ACTION_NORTH:if(top+range.y<minTop){range.y=minTop-top;}
break;case ACTION_SOUTH:if(bottom+range.y>maxHeight){range.y=maxHeight-bottom;}
break;default:}};switch(action){case ACTION_ALL:left+=range.x;top+=range.y;break;case ACTION_EAST:if(range.x>=0&&(right>=maxWidth||aspectRatio&&(top<=minTop||bottom>=maxHeight))){renderable=false;break;}
check(ACTION_EAST);width+=range.x;if(width<0){action=ACTION_WEST;width=-width;left-=width;}
if(aspectRatio){height=width/aspectRatio;top+=(cropBoxData.height-height)/2;}
break;case ACTION_NORTH:if(range.y<=0&&(top<=minTop||aspectRatio&&(left<=minLeft||right>=maxWidth))){renderable=false;break;}
check(ACTION_NORTH);height-=range.y;top+=range.y;if(height<0){action=ACTION_SOUTH;height=-height;top-=height;}
if(aspectRatio){width=height*aspectRatio;left+=(cropBoxData.width-width)/2;}
break;case ACTION_WEST:if(range.x<=0&&(left<=minLeft||aspectRatio&&(top<=minTop||bottom>=maxHeight))){renderable=false;break;}
check(ACTION_WEST);width-=range.x;left+=range.x;if(width<0){action=ACTION_EAST;width=-width;left-=width;}
if(aspectRatio){height=width/aspectRatio;top+=(cropBoxData.height-height)/2;}
break;case ACTION_SOUTH:if(range.y>=0&&(bottom>=maxHeight||aspectRatio&&(left<=minLeft||right>=maxWidth))){renderable=false;break;}
check(ACTION_SOUTH);height+=range.y;if(height<0){action=ACTION_NORTH;height=-height;top-=height;}
if(aspectRatio){width=height*aspectRatio;left+=(cropBoxData.width-width)/2;}
break;case ACTION_NORTH_EAST:if(aspectRatio){if(range.y<=0&&(top<=minTop||right>=maxWidth)){renderable=false;break;}
check(ACTION_NORTH);height-=range.y;top+=range.y;width=height*aspectRatio;}else{check(ACTION_NORTH);check(ACTION_EAST);if(range.x>=0){if(right<maxWidth){width+=range.x;}else if(range.y<=0&&top<=minTop){renderable=false;}}else{width+=range.x;}
if(range.y<=0){if(top>minTop){height-=range.y;top+=range.y;}}else{height-=range.y;top+=range.y;}}
if(width<0&&height<0){action=ACTION_SOUTH_WEST;height=-height;width=-width;top-=height;left-=width;}else if(width<0){action=ACTION_NORTH_WEST;width=-width;left-=width;}else if(height<0){action=ACTION_SOUTH_EAST;height=-height;top-=height;}
break;case ACTION_NORTH_WEST:if(aspectRatio){if(range.y<=0&&(top<=minTop||left<=minLeft)){renderable=false;break;}
check(ACTION_NORTH);height-=range.y;top+=range.y;width=height*aspectRatio;left+=cropBoxData.width-width;}else{check(ACTION_NORTH);check(ACTION_WEST);if(range.x<=0){if(left>minLeft){width-=range.x;left+=range.x;}else if(range.y<=0&&top<=minTop){renderable=false;}}else{width-=range.x;left+=range.x;}
if(range.y<=0){if(top>minTop){height-=range.y;top+=range.y;}}else{height-=range.y;top+=range.y;}}
if(width<0&&height<0){action=ACTION_SOUTH_EAST;height=-height;width=-width;top-=height;left-=width;}else if(width<0){action=ACTION_NORTH_EAST;width=-width;left-=width;}else if(height<0){action=ACTION_SOUTH_WEST;height=-height;top-=height;}
break;case ACTION_SOUTH_WEST:if(aspectRatio){if(range.x<=0&&(left<=minLeft||bottom>=maxHeight)){renderable=false;break;}
check(ACTION_WEST);width-=range.x;left+=range.x;height=width/aspectRatio;}else{check(ACTION_SOUTH);check(ACTION_WEST);if(range.x<=0){if(left>minLeft){width-=range.x;left+=range.x;}else if(range.y>=0&&bottom>=maxHeight){renderable=false;}}else{width-=range.x;left+=range.x;}
if(range.y>=0){if(bottom<maxHeight){height+=range.y;}}else{height+=range.y;}}
if(width<0&&height<0){action=ACTION_NORTH_EAST;height=-height;width=-width;top-=height;left-=width;}else if(width<0){action=ACTION_SOUTH_EAST;width=-width;left-=width;}else if(height<0){action=ACTION_NORTH_WEST;height=-height;top-=height;}
break;case ACTION_SOUTH_EAST:if(aspectRatio){if(range.x>=0&&(right>=maxWidth||bottom>=maxHeight)){renderable=false;break;}
check(ACTION_EAST);width+=range.x;height=width/aspectRatio;}else{check(ACTION_SOUTH);check(ACTION_EAST);if(range.x>=0){if(right<maxWidth){width+=range.x;}else if(range.y>=0&&bottom>=maxHeight){renderable=false;}}else{width+=range.x;}
if(range.y>=0){if(bottom<maxHeight){height+=range.y;}}else{height+=range.y;}}
if(width<0&&height<0){action=ACTION_NORTH_WEST;height=-height;width=-width;top-=height;left-=width;}else if(width<0){action=ACTION_SOUTH_WEST;width=-width;left-=width;}else if(height<0){action=ACTION_NORTH_EAST;height=-height;top-=height;}
break;case ACTION_MOVE:this.move(range.x,range.y);renderable=false;break;case ACTION_ZOOM:this.zoom(getMaxZoomRatio(pointers),event);renderable=false;break;case ACTION_CROP:if(!range.x||!range.y){renderable=false;break;}
offset=getOffset(this.cropper);left=pointer.startX-offset.left;top=pointer.startY-offset.top;width=cropBoxData.minWidth;height=cropBoxData.minHeight;if(range.x>0){action=range.y>0?ACTION_SOUTH_EAST:ACTION_NORTH_EAST;}else if(range.x<0){left-=width;action=range.y>0?ACTION_SOUTH_WEST:ACTION_NORTH_WEST;}
if(range.y<0){top-=height;}
if(!this.cropped){removeClass(this.cropBox,CLASS_HIDDEN);this.cropped=true;if(this.limited){this.limitCropBox(true,true);}}
break;default:}
if(renderable){cropBoxData.width=width;cropBoxData.height=height;cropBoxData.left=left;cropBoxData.top=top;this.action=action;this.renderCropBox();}
forEach(pointers,function(p){p.startX=p.endX;p.startY=p.endY;});}};var methods={crop:function crop(){if(this.ready&&!this.cropped&&!this.disabled){this.cropped=true;this.limitCropBox(true,true);if(this.options.modal){addClass(this.dragBox,CLASS_MODAL);}
removeClass(this.cropBox,CLASS_HIDDEN);this.setCropBoxData(this.initialCropBoxData);}
return this;},reset:function reset(){if(this.ready&&!this.disabled){this.imageData=assign({},this.initialImageData);this.canvasData=assign({},this.initialCanvasData);this.cropBoxData=assign({},this.initialCropBoxData);this.renderCanvas();if(this.cropped){this.renderCropBox();}}
return this;},clear:function clear(){if(this.cropped&&!this.disabled){assign(this.cropBoxData,{left:0,top:0,width:0,height:0});this.cropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();removeClass(this.dragBox,CLASS_MODAL);addClass(this.cropBox,CLASS_HIDDEN);}
return this;},replace:function replace(url){var hasSameSize=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!this.disabled&&url){if(this.isImg){this.element.src=url;}
if(hasSameSize){this.url=url;this.image.src=url;if(this.ready){this.viewBoxImage.src=url;forEach(this.previews,function(element){element.getElementsByTagName('img')[0].src=url;});}}else{if(this.isImg){this.replaced=true;}
this.options.data=null;this.uncreate();this.load(url);}}
return this;},enable:function enable(){if(this.ready&&this.disabled){this.disabled=false;removeClass(this.cropper,CLASS_DISABLED);}
return this;},disable:function disable(){if(this.ready&&!this.disabled){this.disabled=true;addClass(this.cropper,CLASS_DISABLED);}
return this;},destroy:function destroy(){var element=this.element;if(!element[NAMESPACE]){return this;}
element[NAMESPACE]=undefined;if(this.isImg&&this.replaced){element.src=this.originalUrl;}
this.uncreate();return this;},move:function move(offsetX){var offsetY=arguments.length>1&&arguments[1]!==undefined?arguments[1]:offsetX;var _this$canvasData=this.canvasData,left=_this$canvasData.left,top=_this$canvasData.top;return this.moveTo(isUndefined(offsetX)?offsetX:left+Number(offsetX),isUndefined(offsetY)?offsetY:top+Number(offsetY));},moveTo:function moveTo(x){var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:x;var canvasData=this.canvasData;var changed=false;x=Number(x);y=Number(y);if(this.ready&&!this.disabled&&this.options.movable){if(isNumber(x)){canvasData.left=x;changed=true;}
if(isNumber(y)){canvasData.top=y;changed=true;}
if(changed){this.renderCanvas(true);}}
return this;},zoom:function zoom(ratio,_originalEvent){var canvasData=this.canvasData;ratio=Number(ratio);if(ratio<0){ratio=1/(1-ratio);}else{ratio=1+ratio;}
return this.zoomTo(canvasData.width*ratio/canvasData.naturalWidth,null,_originalEvent);},zoomTo:function zoomTo(ratio,pivot,_originalEvent){var options=this.options,canvasData=this.canvasData;var width=canvasData.width,height=canvasData.height,naturalWidth=canvasData.naturalWidth,naturalHeight=canvasData.naturalHeight;ratio=Number(ratio);if(ratio>=0&&this.ready&&!this.disabled&&options.zoomable){var newWidth=naturalWidth*ratio;var newHeight=naturalHeight*ratio;if(dispatchEvent(this.element,EVENT_ZOOM,{ratio:ratio,oldRatio:width/naturalWidth,originalEvent:_originalEvent})===false){return this;}
if(_originalEvent){var pointers=this.pointers;var offset=getOffset(this.cropper);var center=pointers&&Object.keys(pointers).length?getPointersCenter(pointers):{pageX:_originalEvent.pageX,pageY:_originalEvent.pageY};canvasData.left-=(newWidth-width)*((center.pageX-offset.left-canvasData.left)/width);canvasData.top-=(newHeight-height)*((center.pageY-offset.top-canvasData.top)/height);}else if(isPlainObject(pivot)&&isNumber(pivot.x)&&isNumber(pivot.y)){canvasData.left-=(newWidth-width)*((pivot.x-canvasData.left)/width);canvasData.top-=(newHeight-height)*((pivot.y-canvasData.top)/height);}else{canvasData.left-=(newWidth-width)/2;canvasData.top-=(newHeight-height)/2;}
canvasData.width=newWidth;canvasData.height=newHeight;this.renderCanvas(true);}
return this;},rotate:function rotate(degree){return this.rotateTo((this.imageData.rotate||0)+Number(degree));},rotateTo:function rotateTo(degree){degree=Number(degree);if(isNumber(degree)&&this.ready&&!this.disabled&&this.options.rotatable){this.imageData.rotate=degree%360;this.renderCanvas(true,true);}
return this;},scaleX:function scaleX(_scaleX){var scaleY=this.imageData.scaleY;return this.scale(_scaleX,isNumber(scaleY)?scaleY:1);},scaleY:function scaleY(_scaleY){var scaleX=this.imageData.scaleX;return this.scale(isNumber(scaleX)?scaleX:1,_scaleY);},scale:function scale(scaleX){var scaleY=arguments.length>1&&arguments[1]!==undefined?arguments[1]:scaleX;var imageData=this.imageData;var transformed=false;scaleX=Number(scaleX);scaleY=Number(scaleY);if(this.ready&&!this.disabled&&this.options.scalable){if(isNumber(scaleX)){imageData.scaleX=scaleX;transformed=true;}
if(isNumber(scaleY)){imageData.scaleY=scaleY;transformed=true;}
if(transformed){this.renderCanvas(true,true);}}
return this;},getData:function getData(){var rounded=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var options=this.options,imageData=this.imageData,canvasData=this.canvasData,cropBoxData=this.cropBoxData;var data;if(this.ready&&this.cropped){data={x:cropBoxData.left-canvasData.left,y:cropBoxData.top-canvasData.top,width:cropBoxData.width,height:cropBoxData.height};var ratio=imageData.width/imageData.naturalWidth;forEach(data,function(n,i){data[i]=n/ratio;});if(rounded){var bottom=Math.round(data.y+data.height);var right=Math.round(data.x+data.width);data.x=Math.round(data.x);data.y=Math.round(data.y);data.width=right-data.x;data.height=bottom-data.y;}}else{data={x:0,y:0,width:0,height:0};}
if(options.rotatable){data.rotate=imageData.rotate||0;}
if(options.scalable){data.scaleX=imageData.scaleX||1;data.scaleY=imageData.scaleY||1;}
return data;},setData:function setData(data){var options=this.options,imageData=this.imageData,canvasData=this.canvasData;var cropBoxData={};if(this.ready&&!this.disabled&&isPlainObject(data)){var transformed=false;if(options.rotatable){if(isNumber(data.rotate)&&data.rotate!==imageData.rotate){imageData.rotate=data.rotate;transformed=true;}}
if(options.scalable){if(isNumber(data.scaleX)&&data.scaleX!==imageData.scaleX){imageData.scaleX=data.scaleX;transformed=true;}
if(isNumber(data.scaleY)&&data.scaleY!==imageData.scaleY){imageData.scaleY=data.scaleY;transformed=true;}}
if(transformed){this.renderCanvas(true,true);}
var ratio=imageData.width/imageData.naturalWidth;if(isNumber(data.x)){cropBoxData.left=data.x*ratio+canvasData.left;}
if(isNumber(data.y)){cropBoxData.top=data.y*ratio+canvasData.top;}
if(isNumber(data.width)){cropBoxData.width=data.width*ratio;}
if(isNumber(data.height)){cropBoxData.height=data.height*ratio;}
this.setCropBoxData(cropBoxData);}
return this;},getContainerData:function getContainerData(){return this.ready?assign({},this.containerData):{};},getImageData:function getImageData(){return this.sized?assign({},this.imageData):{};},getCanvasData:function getCanvasData(){var canvasData=this.canvasData;var data={};if(this.ready){forEach(['left','top','width','height','naturalWidth','naturalHeight'],function(n){data[n]=canvasData[n];});}
return data;},setCanvasData:function setCanvasData(data){var canvasData=this.canvasData;var aspectRatio=canvasData.aspectRatio;if(this.ready&&!this.disabled&&isPlainObject(data)){if(isNumber(data.left)){canvasData.left=data.left;}
if(isNumber(data.top)){canvasData.top=data.top;}
if(isNumber(data.width)){canvasData.width=data.width;canvasData.height=data.width/aspectRatio;}else if(isNumber(data.height)){canvasData.height=data.height;canvasData.width=data.height*aspectRatio;}
this.renderCanvas(true);}
return this;},getCropBoxData:function getCropBoxData(){var cropBoxData=this.cropBoxData;var data;if(this.ready&&this.cropped){data={left:cropBoxData.left,top:cropBoxData.top,width:cropBoxData.width,height:cropBoxData.height};}
return data||{};},setCropBoxData:function setCropBoxData(data){var cropBoxData=this.cropBoxData;var aspectRatio=this.options.aspectRatio;var widthChanged;var heightChanged;if(this.ready&&this.cropped&&!this.disabled&&isPlainObject(data)){if(isNumber(data.left)){cropBoxData.left=data.left;}
if(isNumber(data.top)){cropBoxData.top=data.top;}
if(isNumber(data.width)&&data.width!==cropBoxData.width){widthChanged=true;cropBoxData.width=data.width;}
if(isNumber(data.height)&&data.height!==cropBoxData.height){heightChanged=true;cropBoxData.height=data.height;}
if(aspectRatio){if(widthChanged){cropBoxData.height=cropBoxData.width/aspectRatio;}else if(heightChanged){cropBoxData.width=cropBoxData.height*aspectRatio;}}
this.renderCropBox();}
return this;},getCroppedCanvas:function getCroppedCanvas(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement){return null;}
var canvasData=this.canvasData;var source=getSourceCanvas(this.image,this.imageData,canvasData,options);if(!this.cropped){return source;}
var _this$getData=this.getData(),initialX=_this$getData.x,initialY=_this$getData.y,initialWidth=_this$getData.width,initialHeight=_this$getData.height;var ratio=source.width/Math.floor(canvasData.naturalWidth);if(ratio!==1){initialX*=ratio;initialY*=ratio;initialWidth*=ratio;initialHeight*=ratio;}
var aspectRatio=initialWidth/initialHeight;var maxSizes=getAdjustedSizes({aspectRatio:aspectRatio,width:options.maxWidth||Infinity,height:options.maxHeight||Infinity});var minSizes=getAdjustedSizes({aspectRatio:aspectRatio,width:options.minWidth||0,height:options.minHeight||0},'cover');var _getAdjustedSizes=getAdjustedSizes({aspectRatio:aspectRatio,width:options.width||(ratio!==1?source.width:initialWidth),height:options.height||(ratio!==1?source.height:initialHeight)}),width=_getAdjustedSizes.width,height=_getAdjustedSizes.height;width=Math.min(maxSizes.width,Math.max(minSizes.width,width));height=Math.min(maxSizes.height,Math.max(minSizes.height,height));var canvas=document.createElement('canvas');var context=canvas.getContext('2d');canvas.width=normalizeDecimalNumber(width);canvas.height=normalizeDecimalNumber(height);context.fillStyle=options.fillColor||'transparent';context.fillRect(0,0,width,height);var _options$imageSmoothi=options.imageSmoothingEnabled,imageSmoothingEnabled=_options$imageSmoothi===void 0?true:_options$imageSmoothi,imageSmoothingQuality=options.imageSmoothingQuality;context.imageSmoothingEnabled=imageSmoothingEnabled;if(imageSmoothingQuality){context.imageSmoothingQuality=imageSmoothingQuality;}
var sourceWidth=source.width;var sourceHeight=source.height;var srcX=initialX;var srcY=initialY;var srcWidth;var srcHeight;var dstX;var dstY;var dstWidth;var dstHeight;if(srcX<=-initialWidth||srcX>sourceWidth){srcX=0;srcWidth=0;dstX=0;dstWidth=0;}else if(srcX<=0){dstX=-srcX;srcX=0;srcWidth=Math.min(sourceWidth,initialWidth+srcX);dstWidth=srcWidth;}else if(srcX<=sourceWidth){dstX=0;srcWidth=Math.min(initialWidth,sourceWidth-srcX);dstWidth=srcWidth;}
if(srcWidth<=0||srcY<=-initialHeight||srcY>sourceHeight){srcY=0;srcHeight=0;dstY=0;dstHeight=0;}else if(srcY<=0){dstY=-srcY;srcY=0;srcHeight=Math.min(sourceHeight,initialHeight+srcY);dstHeight=srcHeight;}else if(srcY<=sourceHeight){dstY=0;srcHeight=Math.min(initialHeight,sourceHeight-srcY);dstHeight=srcHeight;}
var params=[srcX,srcY,srcWidth,srcHeight];if(dstWidth>0&&dstHeight>0){var scale=width/initialWidth;params.push(dstX*scale,dstY*scale,dstWidth*scale,dstHeight*scale);}
context.drawImage.apply(context,[source].concat(_toConsumableArray(params.map(function(param){return Math.floor(normalizeDecimalNumber(param));}))));return canvas;},setAspectRatio:function setAspectRatio(aspectRatio){var options=this.options;if(!this.disabled&&!isUndefined(aspectRatio)){options.aspectRatio=Math.max(0,aspectRatio)||NaN;if(this.ready){this.initCropBox();if(this.cropped){this.renderCropBox();}}}
return this;},setDragMode:function setDragMode(mode){var options=this.options,dragBox=this.dragBox,face=this.face;if(this.ready&&!this.disabled){var croppable=mode===DRAG_MODE_CROP;var movable=options.movable&&mode===DRAG_MODE_MOVE;mode=croppable||movable?mode:DRAG_MODE_NONE;options.dragMode=mode;setData(dragBox,DATA_ACTION,mode);toggleClass(dragBox,CLASS_CROP,croppable);toggleClass(dragBox,CLASS_MOVE,movable);if(!options.cropBoxMovable){setData(face,DATA_ACTION,mode);toggleClass(face,CLASS_CROP,croppable);toggleClass(face,CLASS_MOVE,movable);}}
return this;}};var AnotherCropper=WINDOW.Cropper;var Cropper=function(){function Cropper(element){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Cropper);if(!element||!REGEXP_TAG_NAME.test(element.tagName)){throw new Error('The first argument is required and must be an <img> or <canvas> element.');}
this.element=element;this.options=assign({},DEFAULTS,isPlainObject(options)&&options);this.cropped=false;this.disabled=false;this.pointers={};this.ready=false;this.reloading=false;this.replaced=false;this.sized=false;this.sizing=false;this.init();}
_createClass(Cropper,[{key:"init",value:function init(){var element=this.element;var tagName=element.tagName.toLowerCase();var url;if(element[NAMESPACE]){return;}
element[NAMESPACE]=this;if(tagName==='img'){this.isImg=true;url=element.getAttribute('src')||'';this.originalUrl=url;if(!url){return;}
url=element.src;}else if(tagName==='canvas'&&window.HTMLCanvasElement){url=element.toDataURL();}
this.load(url);}},{key:"load",value:function load(url){var _this=this;if(!url){return;}
this.url=url;this.imageData={};var element=this.element,options=this.options;if(!options.rotatable&&!options.scalable){options.checkOrientation=false;}
if(!options.checkOrientation||!window.ArrayBuffer){this.clone();return;}
if(REGEXP_DATA_URL.test(url)){if(REGEXP_DATA_URL_JPEG.test(url)){this.read(dataURLToArrayBuffer(url));}else{this.clone();}
return;}
var xhr=new XMLHttpRequest();var clone=this.clone.bind(this);this.reloading=true;this.xhr=xhr;xhr.onabort=clone;xhr.onerror=clone;xhr.ontimeout=clone;xhr.onprogress=function(){if(xhr.getResponseHeader('content-type')!==MIME_TYPE_JPEG){xhr.abort();}};xhr.onload=function(){_this.read(xhr.response);};xhr.onloadend=function(){_this.reloading=false;_this.xhr=null;};if(options.checkCrossOrigin&&isCrossOriginURL(url)&&element.crossOrigin){url=addTimestamp(url);}
xhr.open('GET',url);xhr.responseType='arraybuffer';xhr.withCredentials=element.crossOrigin==='use-credentials';xhr.send();}},{key:"read",value:function read(arrayBuffer){var options=this.options,imageData=this.imageData;var orientation=resetAndGetOrientation(arrayBuffer);var rotate=0;var scaleX=1;var scaleY=1;if(orientation>1){this.url=arrayBufferToDataURL(arrayBuffer,MIME_TYPE_JPEG);var _parseOrientation=parseOrientation(orientation);rotate=_parseOrientation.rotate;scaleX=_parseOrientation.scaleX;scaleY=_parseOrientation.scaleY;}
if(options.rotatable){imageData.rotate=rotate;}
if(options.scalable){imageData.scaleX=scaleX;imageData.scaleY=scaleY;}
this.clone();}},{key:"clone",value:function clone(){var element=this.element,url=this.url;var crossOrigin=element.crossOrigin;var crossOriginUrl=url;if(this.options.checkCrossOrigin&&isCrossOriginURL(url)){if(!crossOrigin){crossOrigin='anonymous';}
crossOriginUrl=addTimestamp(url);}
this.crossOrigin=crossOrigin;this.crossOriginUrl=crossOriginUrl;var image=document.createElement('img');if(crossOrigin){image.crossOrigin=crossOrigin;}
image.src=crossOriginUrl||url;image.alt=element.alt||'The image to crop';this.image=image;image.onload=this.start.bind(this);image.onerror=this.stop.bind(this);addClass(image,CLASS_HIDE);element.parentNode.insertBefore(image,element.nextSibling);}},{key:"start",value:function start(){var _this2=this;var image=this.image;image.onload=null;image.onerror=null;this.sizing=true;var isIOSWebKit=WINDOW.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(WINDOW.navigator.userAgent);var done=function done(naturalWidth,naturalHeight){assign(_this2.imageData,{naturalWidth:naturalWidth,naturalHeight:naturalHeight,aspectRatio:naturalWidth/naturalHeight});_this2.sizing=false;_this2.sized=true;_this2.build();};if(image.naturalWidth&&!isIOSWebKit){done(image.naturalWidth,image.naturalHeight);return;}
var sizingImage=document.createElement('img');var body=document.body||document.documentElement;this.sizingImage=sizingImage;sizingImage.onload=function(){done(sizingImage.width,sizingImage.height);if(!isIOSWebKit){body.removeChild(sizingImage);}};sizingImage.src=image.src;if(!isIOSWebKit){sizingImage.style.cssText='left:0;'+'max-height:none!important;'+'max-width:none!important;'+'min-height:0!important;'+'min-width:0!important;'+'opacity:0;'+'position:absolute;'+'top:0;'+'z-index:-1;';body.appendChild(sizingImage);}}},{key:"stop",value:function stop(){var image=this.image;image.onload=null;image.onerror=null;image.parentNode.removeChild(image);this.image=null;}},{key:"build",value:function build(){if(!this.sized||this.ready){return;}
var element=this.element,options=this.options,image=this.image;var container=element.parentNode;var template=document.createElement('div');template.innerHTML=TEMPLATE;var cropper=template.querySelector(".".concat(NAMESPACE,"-container"));var canvas=cropper.querySelector(".".concat(NAMESPACE,"-canvas"));var dragBox=cropper.querySelector(".".concat(NAMESPACE,"-drag-box"));var cropBox=cropper.querySelector(".".concat(NAMESPACE,"-crop-box"));var face=cropBox.querySelector(".".concat(NAMESPACE,"-face"));this.container=container;this.cropper=cropper;this.canvas=canvas;this.dragBox=dragBox;this.cropBox=cropBox;this.viewBox=cropper.querySelector(".".concat(NAMESPACE,"-view-box"));this.face=face;canvas.appendChild(image);addClass(element,CLASS_HIDDEN);container.insertBefore(cropper,element.nextSibling);if(!this.isImg){removeClass(image,CLASS_HIDE);}
this.initPreview();this.bind();options.initialAspectRatio=Math.max(0,options.initialAspectRatio)||NaN;options.aspectRatio=Math.max(0,options.aspectRatio)||NaN;options.viewMode=Math.max(0,Math.min(3,Math.round(options.viewMode)))||0;addClass(cropBox,CLASS_HIDDEN);if(!options.guides){addClass(cropBox.getElementsByClassName("".concat(NAMESPACE,"-dashed")),CLASS_HIDDEN);}
if(!options.center){addClass(cropBox.getElementsByClassName("".concat(NAMESPACE,"-center")),CLASS_HIDDEN);}
if(options.background){addClass(cropper,"".concat(NAMESPACE,"-bg"));}
if(!options.highlight){addClass(face,CLASS_INVISIBLE);}
if(options.cropBoxMovable){addClass(face,CLASS_MOVE);setData(face,DATA_ACTION,ACTION_ALL);}
if(!options.cropBoxResizable){addClass(cropBox.getElementsByClassName("".concat(NAMESPACE,"-line")),CLASS_HIDDEN);addClass(cropBox.getElementsByClassName("".concat(NAMESPACE,"-point")),CLASS_HIDDEN);}
this.render();this.ready=true;this.setDragMode(options.dragMode);if(options.autoCrop){this.crop();}
this.setData(options.data);if(isFunction(options.ready)){addListener(element,EVENT_READY,options.ready,{once:true});}
dispatchEvent(element,EVENT_READY);}},{key:"unbuild",value:function unbuild(){if(!this.ready){return;}
this.ready=false;this.unbind();this.resetPreview();this.cropper.parentNode.removeChild(this.cropper);removeClass(this.element,CLASS_HIDDEN);}},{key:"uncreate",value:function uncreate(){if(this.ready){this.unbuild();this.ready=false;this.cropped=false;}else if(this.sizing){this.sizingImage.onload=null;this.sizing=false;this.sized=false;}else if(this.reloading){this.xhr.onabort=null;this.xhr.abort();}else if(this.image){this.stop();}}}],[{key:"noConflict",value:function noConflict(){window.Cropper=AnotherCropper;return Cropper;}},{key:"setDefaults",value:function setDefaults(options){assign(DEFAULTS,isPlainObject(options)&&options);}}]);return Cropper;}();assign(Cropper.prototype,render,preview,events,handlers,change,methods);return Cropper;}));;

/* /web_editor/static/lib/jquery-cropper/jquery-cropper.js defined in bundle 'web_editor.assets_wysiwyg' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(require('jquery'),require('cropperjs')):typeof define==='function'&&define.amd?define(['jquery','cropperjs'],factory):(factory(global.jQuery,global.Cropper));}(this,(function($,Cropper){'use strict';$=$&&$.hasOwnProperty('default')?$['default']:$;Cropper=Cropper&&Cropper.hasOwnProperty('default')?Cropper['default']:Cropper;if($.fn){var AnotherCropper=$.fn.cropper;var NAMESPACE='cropper';$.fn.cropper=function jQueryCropper(option){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
var result=void 0;this.each(function(i,element){var $element=$(element);var isDestroy=option==='destroy';var cropper=$element.data(NAMESPACE);if(!cropper){if(isDestroy){return;}
var options=$.extend({},$element.data(),$.isPlainObject(option)&&option);cropper=new Cropper(element,options);$element.data(NAMESPACE,cropper);}
if(typeof option==='string'){var fn=cropper[option];if($.isFunction(fn)){result=fn.apply(cropper,args);if(result===cropper){result=undefined;}
if(isDestroy){$element.removeData(NAMESPACE);}}}});return result!==undefined?result:this;};$.fn.cropper.Constructor=Cropper;$.fn.cropper.setDefaults=Cropper.setDefaults;$.fn.cropper.noConflict=function noConflict(){$.fn.cropper=AnotherCropper;return this;};}})));;

/* /web_editor/static/lib/jQuery.transfo.js defined in bundle 'web_editor.assets_wysiwyg' */
(function($){'use strict';var rad=Math.PI/180;var methods={init:function(settings){return this.each(function(){var $this=$(this),transfo=$this.data('transfo');if(!transfo){_init($this,settings);}else{_overwriteOptions($this,transfo,settings);_targetCss($this,transfo);}});},destroy:function(){return this.each(function(){var $this=$(this);if($this.data('transfo')){_destroy($this);}});},reset:function(){return this.each(function(){var $this=$(this);if($this.data('transfo')){_reset($this);}});},toggle:function(){return this.each(function(){var $this=$(this);var transfo=$this.data('transfo');if(transfo){transfo.settings.hide=!transfo.settings.hide;_showHide($this,transfo);}});},hide:function(){return this.each(function(){var $this=$(this);var transfo=$this.data('transfo');if(transfo){transfo.settings.hide=true;_showHide($this,transfo);}});},show:function(){return this.each(function(){var $this=$(this);var transfo=$this.data('transfo');if(transfo){transfo.settings.hide=false;_showHide($this,transfo);}});},settings:function(){if(this.length>1){this.map(function(){var $this=$(this);return $this.data('transfo')&&$this.data('transfo').settings;});}
return this.data('transfo')&&$this.data('transfo').settings;},center:function(){if(this.length>1){this.map(function(){var $this=$(this);return $this.data('transfo')&&$this.data('transfo').$center.offset();});}
return this.data('transfo')&&this.data('transfo').$center.offset();}};$.fn.transfo=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.transfo');}
return false;};function _init($this,settings){var transfo={};$this.data('transfo',transfo);transfo.settings=settings;var css="box-sizing: border-box; position: absolute; background-color: #fff; border: 1px solid #ccc; width: 8px; height: 8px; margin-left: -4px; margin-top: -4px;";transfo.$markup=$(''
+'<div class="transfo-container">'
+'<div class="transfo-controls">'
+'<div style="cursor: crosshair; position: absolute; margin: -30px; top: 0; right: 0; padding: 1px 0 0 1px;" class="transfo-rotator">'
+'<span class="fa-stack fa-lg">'
+'<i class="fa fa-circle fa-stack-2x"></i>'
+'<i class="fa fa-repeat fa-stack-1x fa-inverse"></i>'
+'</span>'
+'</div>'
+'<div style="'+css+'top: 0%; left: 0%; cursor: nw-resize;" class="transfo-scaler-tl"></div>'
+'<div style="'+css+'top: 0%; left: 100%; cursor: ne-resize;" class="transfo-scaler-tr"></div>'
+'<div style="'+css+'top: 100%; left: 100%; cursor: se-resize;" class="transfo-scaler-br"></div>'
+'<div style="'+css+'top: 100%; left: 0%; cursor: sw-resize;" class="transfo-scaler-bl"></div>'
+'<div style="'+css+'top: 0%; left: 50%; cursor: n-resize;" class="transfo-scaler-tc"></div>'
+'<div style="'+css+'top: 100%; left: 50%; cursor: s-resize;" class="transfo-scaler-bc"></div>'
+'<div style="'+css+'top: 50%; left: 0%; cursor: w-resize;" class="transfo-scaler-ml"></div>'
+'<div style="'+css+'top: 50%; left: 100%; cursor: e-resize;" class="transfo-scaler-mr"></div>'
+'<div style="'+css+'border: 0; width: 0px; height: 0px; top: 50%; left: 50%;" class="transfo-scaler-mc"></div>'
+'</div>'
+'</div>');transfo.$center=transfo.$markup.find(".transfo-scaler-mc");_setOptions($this,transfo);_overwriteOptions($this,transfo,settings);$("body").append(transfo.$markup);setTimeout(function(){_targetCss($this,transfo);},0);_bind($this,transfo);_targetCss($this,transfo);_stop_animation($this[0]);}
function _overwriteOptions($this,transfo,settings){transfo.settings=$.extend(transfo.settings,settings||{});}
function _stop_animation(target){target.style.webkitAnimationPlayState="paused";target.style.animationPlayState="paused";target.style.webkitTransition="none";target.style.transition="none";}
function _setOptions($this,transfo){var style=$this.attr("style")||"";var transform=style.match(/transform\s*:([^;]+)/)?style.match(/transform\s*:([^;]+)/)[1]:"";transfo.settings={};transfo.settings.angle=transform.indexOf('rotate')!=-1?parseFloat(transform.match(/rotate\(([^)]+)deg\)/)[1]):0;transfo.settings.scalex=transform.indexOf('scaleX')!=-1?parseFloat(transform.match(/scaleX\(([^)]+)\)/)[1]):1;transfo.settings.scaley=transform.indexOf('scaleY')!=-1?parseFloat(transform.match(/scaleY\(([^)]+)\)/)[1]):1;transfo.settings.style=style.replace(/[^;]*transform[^;]+/g,'').replace(/;+/g,';');$this.attr("style",transfo.settings.style);_stop_animation($this[0]);transfo.settings.pos=$this.offset();transfo.settings.height=$this.innerHeight();transfo.settings.width=$this.innerWidth();var translatex=transform.match(/translateX\(([0-9.-]+)(%|px)\)/);var translatey=transform.match(/translateY\(([0-9.-]+)(%|px)\)/);transfo.settings.translate="%";if(translatex&&translatex[2]==="%"){transfo.settings.translatexp=parseFloat(translatex[1]);transfo.settings.translatex=transfo.settings.translatexp/100*transfo.settings.width;}else{transfo.settings.translatex=translatex?parseFloat(translatex[1]):0;}
if(translatey&&translatey[2]==="%"){transfo.settings.translateyp=parseFloat(translatey[1]);transfo.settings.translatey=transfo.settings.translateyp/100*transfo.settings.height;}else{transfo.settings.translatey=translatey?parseFloat(translatey[1]):0;}
transfo.settings.css=window.getComputedStyle($this[0],null);transfo.settings.rotationStep=5;transfo.settings.hide=false;transfo.settings.callback=function(){};}
function _bind($this,transfo){function mousedown(event){_mouseDown($this,this,transfo,event);$(document).on("mousemove",mousemove).on("mouseup",mouseup);}
function mousemove(event){_mouseMove($this,this,transfo,event);}
function mouseup(event){_mouseUp($this,this,transfo,event);$(document).off("mousemove",mousemove).off("mouseup",mouseup);}
transfo.$markup.off().on("mousedown",mousedown);transfo.$markup.find(".transfo-controls >:not(.transfo-scaler-mc)").off().on("mousedown",mousedown);}
function _mouseDown($this,div,transfo,event){event.preventDefault();if(transfo.active||event.which!==1)return;var type="position",$e=$(div);if($e.hasClass("transfo-rotator"))type="rotator";else if($e.hasClass("transfo-scaler-tl"))type="tl";else if($e.hasClass("transfo-scaler-tr"))type="tr";else if($e.hasClass("transfo-scaler-br"))type="br";else if($e.hasClass("transfo-scaler-bl"))type="bl";else if($e.hasClass("transfo-scaler-tc"))type="tc";else if($e.hasClass("transfo-scaler-bc"))type="bc";else if($e.hasClass("transfo-scaler-ml"))type="ml";else if($e.hasClass("transfo-scaler-mr"))type="mr";transfo.active={"type":type,"scalex":transfo.settings.scalex,"scaley":transfo.settings.scaley,"pageX":event.pageX,"pageY":event.pageY,"center":transfo.$center.offset(),};}
function _mouseUp($this,div,transfo,event){transfo.active=null;}
function _mouseMove($this,div,transfo,event){event.preventDefault();if(!transfo.active)return;var settings=transfo.settings;var center=transfo.active.center;var cdx=center.left-event.pageX;var cdy=center.top-event.pageY;if(transfo.active.type=="rotator"){var ang,dang=Math.atan((settings.width*settings.scalex)/(settings.height*settings.scaley))/rad;if(cdy)ang=Math.atan(-cdx/cdy)/rad;else ang=0;if(event.pageY>=center.top&&event.pageX>=center.left)ang+=180;else if(event.pageY>=center.top&&event.pageX<center.left)ang+=180;else if(event.pageY<center.top&&event.pageX<center.left)ang+=360;ang-=dang;if(settings.scaley<0&&settings.scalex<0)ang+=180;if(!event.ctrlKey){settings.angle=Math.round(ang/transfo.settings.rotationStep)*transfo.settings.rotationStep;}else{settings.angle=ang;}
_targetCss($this,transfo);var new_center=transfo.$center.offset();var x=center.left-new_center.left;var y=center.top-new_center.top;var angle=ang*rad;settings.translatex+=x*Math.cos(angle)-y*Math.sin(-angle);settings.translatey+=-x*Math.sin(angle)+y*Math.cos(-angle);}
else if(transfo.active.type=="position"){var angle=settings.angle*rad;var x=event.pageX-transfo.active.pageX;var y=event.pageY-transfo.active.pageY;transfo.active.pageX=event.pageX;transfo.active.pageY=event.pageY;var dx=x*Math.cos(angle)-y*Math.sin(-angle);var dy=-x*Math.sin(angle)+y*Math.cos(-angle);settings.translatex+=dx;settings.translatey+=dy;}
else if(transfo.active.type.length===2){var angle=settings.angle*rad;var dx=cdx*Math.cos(angle)-cdy*Math.sin(-angle);var dy=-cdx*Math.sin(angle)+cdy*Math.cos(-angle);if(transfo.active.type.indexOf("t")!=-1){settings.scaley=dy/(settings.height/2);}
if(transfo.active.type.indexOf("b")!=-1){settings.scaley=-dy/(settings.height/2);}
if(transfo.active.type.indexOf("l")!=-1){settings.scalex=dx/(settings.width/2);}
if(transfo.active.type.indexOf("r")!=-1){settings.scalex=-dx/(settings.width/2);}
if(settings.scaley>0&&settings.scaley<0.05)settings.scaley=0.05;if(settings.scalex>0&&settings.scalex<0.05)settings.scalex=0.05;if(settings.scaley<0&&settings.scaley>-0.05)settings.scaley=-0.05;if(settings.scalex<0&&settings.scalex>-0.05)settings.scalex=-0.05;if(event.shiftKey&&(transfo.active.type==="tl"||transfo.active.type==="bl"||transfo.active.type==="tr"||transfo.active.type==="br")){settings.scaley=settings.scalex;}}
settings.angle=Math.round(settings.angle);settings.translatex=Math.round(settings.translatex);settings.translatey=Math.round(settings.translatey);settings.scalex=Math.round(settings.scalex*100)/100;settings.scaley=Math.round(settings.scaley*100)/100;_targetCss($this,transfo);_stop_animation($this[0]);return false;}
function _setCss($this,css,settings){var transform="";var trans=false;if(settings.angle!==0){trans=true;transform+=" rotate("+settings.angle+"deg) ";}
if(settings.translatex){trans=true;transform+=" translateX("+(settings.translate==="%"?settings.translatexp+"%":settings.translatex+"px")+") ";}
if(settings.translatey){trans=true;transform+=" translateY("+(settings.translate==="%"?settings.translateyp+"%":settings.translatey+"px")+") ";}
if(settings.scalex!=1){trans=true;transform+=" scaleX("+settings.scalex+") ";}
if(settings.scaley!=1){trans=true;transform+=" scaleY("+settings.scaley+") ";}
if(trans){css+=";"
css+="-webkit-transform:"+transform+";"
+"-moz-transform:"+transform+";"
+"-ms-transform:"+transform+";"
+"-o-transform:"+transform+";"
+"transform:"+transform+";";}
css=css.replace(/(\s*;)+/g,';').replace(/^\s*;|;\s*$/g,'');$this.attr("style",css);}
function _targetCss($this,transfo){var settings=transfo.settings;var width=parseFloat(settings.css.width);var height=parseFloat(settings.css.height);settings.translatexp=Math.round(settings.translatex/width*1000)/10;settings.translateyp=Math.round(settings.translatey/height*1000)/10;_setCss($this,settings.style,settings);transfo.$markup.css({"position":"absolute","width":width+"px","height":height+"px","top":settings.pos.top+"px","left":settings.pos.left+"px"});var $controls=transfo.$markup.find('.transfo-controls');_setCss($controls,"width:"+width+"px;"+"height:"+height+"px;"+"cursor: move;",settings);$controls.children().css("transform","scaleX("+(1/settings.scalex)+") scaleY("+(1/settings.scaley)+")");_showHide($this,transfo);transfo.settings.callback.call($this[0],$this);}
function _showHide($this,transfo){transfo.$markup.css("z-index",transfo.settings.hide?-1:1000);if(transfo.settings.hide){transfo.$markup.find(".transfo-controls > *").hide();transfo.$markup.find(".transfo-scaler-mc").show();}else{transfo.$markup.find(".transfo-controls > *").show();}}
function _destroy($this){$this.data('transfo').$markup.remove();$this.removeData('transfo');}
function _reset($this){var transfo=$this.data('transfo');_destroy($this);$this.transfo(transfo.settings);}})(jQuery);;

/* /web/static/lib/nearest/jquery.nearest.js defined in bundle 'web_editor.assets_wysiwyg' */
;(function($,undefined){var rPerc=/^([\d.]+)%$/;function nearest(selector,options,thisObj){selector||(selector='div');var $container=$(options.container),containerOffset=$container.offset()||{left:0,top:0},containerDims=[containerOffset.left+$container.width(),containerOffset.top+$container.height()],percProps={x:0,y:1,w:0,h:1},prop,match;for(prop in percProps)if(percProps.hasOwnProperty(prop)){match=rPerc.exec(options[prop]);if(match){options[prop]=containerDims[percProps[prop]]*match[1]/100;}}
var $all=$(selector),cache=[],furthest=!!options.furthest,checkX=!!options.checkHoriz,checkY=!!options.checkVert,compDist=furthest?0:Infinity,point1x=parseFloat(options.x)||0,point1y=parseFloat(options.y)||0,point2x=parseFloat(point1x+options.w)||point1x,point2y=parseFloat(point1y+options.h)||point1y,tolerance=options.tolerance||0,hasEach2=!!$.fn.each2,min=Math.min,max=Math.max;if(!options.includeSelf&&thisObj){$all=$all.not(thisObj);}
if(tolerance<0){tolerance=0;}
$all[hasEach2?'each2':'each'](function(i,elem){var $this=hasEach2?elem:$(this),off=$this.offset(),x=off.left,y=off.top,w=$this.outerWidth(),h=$this.outerHeight(),x2=x+w,y2=y+h,maxX1=max(x,point1x),minX2=min(x2,point2x),maxY1=max(y,point1y),minY2=min(y2,point2y),intersectX=minX2>=maxX1,intersectY=minY2>=maxY1,distX,distY,distT,isValid;if((checkX&&checkY)||(!checkX&&!checkY&&intersectX&&intersectY)||(checkX&&intersectY)||(checkY&&intersectX)){distX=intersectX?0:maxX1-minX2;distY=intersectY?0:maxY1-minY2;distT=intersectX||intersectY?max(distX,distY):Math.sqrt(distX*distX+distY*distY);isValid=furthest?distT>=compDist-tolerance:distT<=compDist+tolerance;if(isValid){compDist=furthest?max(compDist,distT):min(compDist,distT);cache.push({node:this,dist:distT});}}});var len=cache.length,filtered=[],compMin,compMax,i,item;if(len){if(furthest){compMin=compDist-tolerance;compMax=compDist;}else{compMin=compDist;compMax=compDist+tolerance;}
for(i=0;i<len;i++){item=cache[i];if(item.dist>=compMin&&item.dist<=compMax){filtered.push(item.node);}}}
return filtered;}
$.each(['nearest','furthest','touching'],function(i,name){var defaults={x:0,y:0,w:0,h:0,tolerance:1,container:document,furthest:name=='furthest',includeSelf:false,checkHoriz:name!='touching',checkVert:name!='touching'};$[name]=function(point,selector,options){if(!point||point.x===undefined||point.y===undefined){return $([]);}
var opts=$.extend({},defaults,point,options||{});return $(nearest(selector,opts));};$.fn[name]=function(selector,options){var opts;if(selector&&$.isPlainObject(selector)){opts=$.extend({},defaults,selector,options||{});return this.pushStack(nearest(this,opts));}
var offset=this.offset(),dimensions={x:offset.left,y:offset.top,w:this.outerWidth(),h:this.outerHeight()};opts=$.extend({},defaults,dimensions,options||{});return this.pushStack(nearest(selector,opts,this));};});})(jQuery);;

/* /web_editor/static/lib/webgl-image-filter/webgl-image-filter.js defined in bundle 'web_editor.assets_wysiwyg' */
(function(window){var WebGLProgram=function(gl,vertexSource,fragmentSource){var _collect=function(source,prefix,collection){var r=new RegExp('\\b'+prefix+' \\w+ (\\w+)','ig');source.replace(r,function(match,name){collection[name]=0;return match;});};var _compile=function(gl,source,type){var shader=gl.createShader(type);gl.shaderSource(shader,source);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){console.log(gl.getShaderInfoLog(shader));return null;}
return shader;};this.uniform={};this.attribute={};var _vsh=_compile(gl,vertexSource,gl.VERTEX_SHADER);var _fsh=_compile(gl,fragmentSource,gl.FRAGMENT_SHADER);this.id=gl.createProgram();gl.attachShader(this.id,_vsh);gl.attachShader(this.id,_fsh);gl.linkProgram(this.id);if(!gl.getProgramParameter(this.id,gl.LINK_STATUS)){console.log(gl.getProgramInfoLog(this.id));}
gl.useProgram(this.id);_collect(vertexSource,'attribute',this.attribute);for(var a in this.attribute){this.attribute[a]=gl.getAttribLocation(this.id,a);}
_collect(vertexSource,'uniform',this.uniform);_collect(fragmentSource,'uniform',this.uniform);for(var u in this.uniform){this.uniform[u]=gl.getUniformLocation(this.id,u);}};const identityMatrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,];const weightedAvg=(a,b,w)=>a*w+b*(1-w);var WebGLImageFilter=window.WebGLImageFilter=function(params){if(!params)
params={};var
gl=null,_drawCount=0,_sourceTexture=null,_lastInChain=false,_currentFramebufferIndex=-1,_tempFramebuffers=[null,null],_filterChain=[],_width=-1,_height=-1,_vertexBuffer=null,_currentProgram=null,_canvas=params.canvas||document.createElement('canvas');var _shaderProgramCache={};var gl=_canvas.getContext("webgl")||_canvas.getContext("experimental-webgl");if(!gl){throw"Couldn't get WebGL context";}
this.addFilter=function(name){var args=Array.prototype.slice.call(arguments,1);var filter=_filter[name];_filterChain.push({func:filter,args:args});};this.reset=function(){_filterChain=[];};this.apply=function(image){_resize(image.width,image.height);_drawCount=0;if(!_sourceTexture)
_sourceTexture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,_sourceTexture);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,image);if(_filterChain.length==0){var program=_compileShader(SHADER.FRAGMENT_IDENTITY);_draw();return _canvas;}
for(var i=0;i<_filterChain.length;i++){_lastInChain=(i==_filterChain.length-1);var f=_filterChain[i];f.func.apply(this,f.args||[]);}
return _canvas;};var _resize=function(width,height){if(width==_width&&height==_height){return;}
_canvas.width=_width=width;_canvas.height=_height=height;if(!_vertexBuffer){var vertices=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,-1,1,0,0,1,-1,1,1,1,1,1,0]);_vertexBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,_vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);}
gl.viewport(0,0,_width,_height);_tempFramebuffers=[null,null];};var _getTempFramebuffer=function(index){_tempFramebuffers[index]=_tempFramebuffers[index]||_createFramebufferTexture(_width,_height);return _tempFramebuffers[index];};var _createFramebufferTexture=function(width,height){var fbo=gl.createFramebuffer();gl.bindFramebuffer(gl.FRAMEBUFFER,fbo);var renderbuffer=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,renderbuffer);var texture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,texture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,texture,0);gl.bindTexture(gl.TEXTURE_2D,null);gl.bindFramebuffer(gl.FRAMEBUFFER,null);return{fbo:fbo,texture:texture};};var _draw=function(flags){var source=null,target=null,flipY=false;if(_drawCount==0){source=_sourceTexture;}
else{source=_getTempFramebuffer(_currentFramebufferIndex).texture;}
_drawCount++;if(_lastInChain&&!(flags&DRAW.INTERMEDIATE)){target=null;flipY=_drawCount%2==0;}
else{_currentFramebufferIndex=(_currentFramebufferIndex+1)%2;target=_getTempFramebuffer(_currentFramebufferIndex).fbo;}
gl.bindTexture(gl.TEXTURE_2D,source);gl.bindFramebuffer(gl.FRAMEBUFFER,target);gl.uniform1f(_currentProgram.uniform.flipY,(flipY?-1:1));gl.drawArrays(gl.TRIANGLES,0,6);};var _compileShader=function(fragmentSource){if(_shaderProgramCache[fragmentSource]){_currentProgram=_shaderProgramCache[fragmentSource];gl.useProgram(_currentProgram.id);return _currentProgram;}
_currentProgram=new WebGLProgram(gl,SHADER.VERTEX_IDENTITY,fragmentSource);var floatSize=Float32Array.BYTES_PER_ELEMENT;var vertSize=4*floatSize;gl.enableVertexAttribArray(_currentProgram.attribute.pos);gl.vertexAttribPointer(_currentProgram.attribute.pos,2,gl.FLOAT,false,vertSize,0*floatSize);gl.enableVertexAttribArray(_currentProgram.attribute.uv);gl.vertexAttribPointer(_currentProgram.attribute.uv,2,gl.FLOAT,false,vertSize,2*floatSize);_shaderProgramCache[fragmentSource]=_currentProgram;return _currentProgram;};var DRAW={INTERMEDIATE:1};var SHADER={};SHADER.VERTEX_IDENTITY=['precision highp float;','attribute vec2 pos;','attribute vec2 uv;','varying vec2 vUv;','uniform float flipY;','void main(void) {','vUv = uv;','gl_Position = vec4(pos.x, pos.y*flipY, 0.0, 1.);','}'].join('\n');SHADER.FRAGMENT_IDENTITY=['precision highp float;','varying vec2 vUv;','uniform sampler2D texture;','void main(void) {','gl_FragColor = texture2D(texture, vUv);','}',].join('\n');var _filter={};_filter.colorMatrix=function(matrix,amount=1){matrix=matrix.map((coef,index)=>weightedAvg(coef,identityMatrix[index],amount));var m=new Float32Array(matrix);m[4]/=255;m[9]/=255;m[14]/=255;m[19]/=255;var shader=(1==m[18]&&0==m[3]&&0==m[8]&&0==m[13]&&0==m[15]&&0==m[16]&&0==m[17]&&0==m[19])?_filter.colorMatrix.SHADER.WITHOUT_ALPHA:_filter.colorMatrix.SHADER.WITH_ALPHA;var program=_compileShader(shader);gl.uniform1fv(program.uniform.m,m);_draw();};_filter.colorMatrix.SHADER={};_filter.colorMatrix.SHADER.WITH_ALPHA=['precision highp float;','varying vec2 vUv;','uniform sampler2D texture;','uniform float m[20];','void main(void) {','vec4 c = texture2D(texture, vUv);','gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[3] * c.a + m[4];','gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[8] * c.a + m[9];','gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[13] * c.a + m[14];','gl_FragColor.a = m[15] * c.r + m[16] * c.g + m[17] * c.b + m[18] * c.a + m[19];','}',].join('\n');_filter.colorMatrix.SHADER.WITHOUT_ALPHA=['precision highp float;','varying vec2 vUv;','uniform sampler2D texture;','uniform float m[20];','void main(void) {','vec4 c = texture2D(texture, vUv);','gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[4];','gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[9];','gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[14];','gl_FragColor.a = c.a;','}',].join('\n');_filter.brightness=function(brightness){var b=(brightness||0)+1;_filter.colorMatrix([b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0]);};_filter.saturation=function(amount){var x=(amount||0)*2/3+1;var y=((x-1)*-0.5);_filter.colorMatrix([x,y,y,0,0,y,x,y,0,0,y,y,x,0,0,0,0,0,1,0]);};_filter.desaturate=function(){_filter.saturation(-1);};_filter.contrast=function(amount){var v=(amount||0)+1;var o=-128*(v-1);_filter.colorMatrix([v,0,0,0,o,0,v,0,0,o,0,0,v,0,o,0,0,0,1,0]);};_filter.negative=function(){_filter.contrast(-2);};_filter.hue=function(rotation){rotation=(rotation||0)/180*Math.PI;var cos=Math.cos(rotation),sin=Math.sin(rotation),lumR=0.213,lumG=0.715,lumB=0.072;_filter.colorMatrix([lumR+cos*(1-lumR)+sin*(-lumR),lumG+cos*(-lumG)+sin*(-lumG),lumB+cos*(-lumB)+sin*(1-lumB),0,0,lumR+cos*(-lumR)+sin*(0.143),lumG+cos*(1-lumG)+sin*(0.140),lumB+cos*(-lumB)+sin*(-0.283),0,0,lumR+cos*(-lumR)+sin*(-(1-lumR)),lumG+cos*(-lumG)+sin*(lumG),lumB+cos*(1-lumB)+sin*(lumB),0,0,0,0,0,1,0]);};_filter.desaturateLuminance=function(amount){_filter.colorMatrix([0.2764723,0.9297080,0.0938197,0,-37.1,0.2764723,0.9297080,0.0938197,0,-37.1,0.2764723,0.9297080,0.0938197,0,-37.1,0,0,0,1,0],amount);};_filter.sepia=function(amount){_filter.colorMatrix([0.393,0.7689999,0.18899999,0,0,0.349,0.6859999,0.16799999,0,0,0.272,0.5339999,0.13099999,0,0,0,0,0,1,0],amount);};_filter.brownie=function(amount){_filter.colorMatrix([0.5997023498159715,0.34553243048391263,-0.2708298674538042,0,47.43192855600873,-0.037703249837783157,0.8609577587992641,0.15059552388459913,0,-36.96841498319127,0.24113635128153335,-0.07441037908422492,0.44972182064877153,0,-7.562075277591283,0,0,0,1,0],amount);};_filter.vintagePinhole=function(amount){_filter.colorMatrix([0.6279345635605994,0.3202183420819367,-0.03965408211312453,0,9.651285835294123,0.02578397704808868,0.6441188644374771,0.03259127616149294,0,7.462829176470591,0.0466055556782719,-0.0851232987247891,0.5241648018700465,0,5.159190588235296,0,0,0,1,0],amount);};_filter.kodachrome=function(amount){_filter.colorMatrix([1.1285582396593525,-0.3967382283601348,-0.03992559172921793,0,63.72958762196502,-0.16404339962244616,1.0835251566291304,-0.05498805115633132,0,24.732407896706203,-0.16786010706155763,-0.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],amount);};_filter.technicolor=function(amount){_filter.colorMatrix([1.9125277891456083,-0.8545344976951645,-0.09155508482755585,0,11.793603434377337,-0.3087833385928097,1.7658908555458428,-0.10601743074722245,0,-70.35205161461398,-0.231103377548616,-0.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],amount);};_filter.polaroid=function(amount){_filter.colorMatrix([1.438,-0.062,-0.062,0,0,-0.122,1.378,-0.122,0,0,-0.016,-0.016,1.483,0,0,0,0,0,1,0],amount);};_filter.shiftToBGR=function(amount){_filter.colorMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],amount);};_filter.convolution=function(matrix){var m=new Float32Array(matrix);var pixelSizeX=1/_width;var pixelSizeY=1/_height;var program=_compileShader(_filter.convolution.SHADER);gl.uniform1fv(program.uniform.m,m);gl.uniform2f(program.uniform.px,pixelSizeX,pixelSizeY);_draw();};_filter.convolution.SHADER=['precision highp float;','varying vec2 vUv;','uniform sampler2D texture;','uniform vec2 px;','uniform float m[9];','void main(void) {','vec4 c11 = texture2D(texture, vUv - px);','vec4 c12 = texture2D(texture, vec2(vUv.x, vUv.y - px.y));','vec4 c13 = texture2D(texture, vec2(vUv.x + px.x, vUv.y - px.y));','vec4 c21 = texture2D(texture, vec2(vUv.x - px.x, vUv.y) );','vec4 c22 = texture2D(texture, vUv);','vec4 c23 = texture2D(texture, vec2(vUv.x + px.x, vUv.y) );','vec4 c31 = texture2D(texture, vec2(vUv.x - px.x, vUv.y + px.y) );','vec4 c32 = texture2D(texture, vec2(vUv.x, vUv.y + px.y) );','vec4 c33 = texture2D(texture, vUv + px );','gl_FragColor = ','c11 * m[0] + c12 * m[1] + c22 * m[2] +','c21 * m[3] + c22 * m[4] + c23 * m[5] +','c31 * m[6] + c32 * m[7] + c33 * m[8];','gl_FragColor.a = c22.a;','}',].join('\n');_filter.detectEdges=function(){_filter.convolution.call(this,[0,1,0,1,-4,1,0,1,0]);};_filter.sobelX=function(){_filter.convolution.call(this,[-1,0,1,-2,0,2,-1,0,1]);};_filter.sobelY=function(){_filter.convolution.call(this,[-1,-2,-1,0,0,0,1,2,1]);};_filter.sharpen=function(amount){var a=amount||1;_filter.convolution.call(this,[0,-1*a,0,-1*a,1+4*a,-1*a,0,-1*a,0]);};_filter.emboss=function(size){var s=size||1;_filter.convolution.call(this,[-2*s,-1*s,0,-1*s,1,1*s,0,1*s,2*s]);};_filter.blur=function(size){var blurSizeX=(size/7)/_width;var blurSizeY=(size/7)/_height;var program=_compileShader(_filter.blur.SHADER);gl.uniform2f(program.uniform.px,0,blurSizeY);_draw(DRAW.INTERMEDIATE);gl.uniform2f(program.uniform.px,blurSizeX,0);_draw();};_filter.blur.SHADER=['precision highp float;','varying vec2 vUv;','uniform sampler2D texture;','uniform vec2 px;','void main(void) {','gl_FragColor = vec4(0.0);','gl_FragColor += texture2D(texture, vUv + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;','gl_FragColor += texture2D(texture, vUv + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;','gl_FragColor += texture2D(texture, vUv + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;','gl_FragColor += texture2D(texture, vUv + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;','gl_FragColor += texture2D(texture, vUv + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;','gl_FragColor += texture2D(texture, vUv + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;','gl_FragColor += texture2D(texture, vUv + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;','gl_FragColor += texture2D(texture, vUv                             )*0.159576912161;','gl_FragColor += texture2D(texture, vUv + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;','gl_FragColor += texture2D(texture, vUv + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;','gl_FragColor += texture2D(texture, vUv + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;','gl_FragColor += texture2D(texture, vUv + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;','gl_FragColor += texture2D(texture, vUv + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;','gl_FragColor += texture2D(texture, vUv + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;','gl_FragColor += texture2D(texture, vUv + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;','}',].join('\n');_filter.pixelate=function(size){var blurSizeX=(size)/_width;var blurSizeY=(size)/_height;var program=_compileShader(_filter.pixelate.SHADER);gl.uniform2f(program.uniform.size,blurSizeX,blurSizeY);_draw();};_filter.pixelate.SHADER=['precision highp float;','varying vec2 vUv;','uniform vec2 size;','uniform sampler2D texture;','vec2 pixelate(vec2 coord, vec2 size) {','return floor( coord / size ) * size;','}','void main(void) {','gl_FragColor = vec4(0.0);','vec2 coord = pixelate(vUv, size);','gl_FragColor += texture2D(texture, coord);','}',].join('\n');};})(window);;

/* /web_editor/static/src/js/wysiwyg/fonts.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.fonts',function(require){'use strict';return{cacheCssSelectors:{},getCssSelectors:function(filter){if(this.cacheCssSelectors[filter]){return this.cacheCssSelectors[filter];}
this.cacheCssSelectors[filter]=[];var sheets=document.styleSheets;for(var i=0;i<sheets.length;i++){var rules;try{rules=sheets[i].rules||sheets[i].cssRules;}catch(e){console.warn("Can't read the css rules of: "+sheets[i].href,e);continue;}
if(!rules){continue;}
for(var r=0;r<rules.length;r++){var selectorText=rules[r].selectorText;if(!selectorText){continue;}
var selectors=selectorText.split(/\s*,\s*/);var data=null;for(var s=0;s<selectors.length;s++){var match=selectors[s].trim().match(filter);if(!match){continue;}
if(!data){data={selector:match[0],css:rules[r].cssText.replace(/(^.*\{\s*)|(\s*\}\s*$)/g,''),names:[match[1]]};}else{data.selector+=(', '+match[0]);data.names.push(match[1]);}}
if(data){this.cacheCssSelectors[filter].push(data);}}}
return this.cacheCssSelectors[filter];},fontIcons:[{base:'fa',parser:/\.(fa-(?:\w|-)+)::?before/i}],computeFonts:_.once(function(){var self=this;_.each(this.fontIcons,function(data){data.cssData=self.getCssSelectors(data.parser);data.alias=_.flatten(_.map(data.cssData,_.property('names')));});}),};});;

/* /web_editor/static/src/js/base.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.base',function(require){'use strict';var ajax=require('web.ajax');var session=require('web.session');var domReady=new Promise(function(resolve){$(resolve);});return{cacheCssSelectors:{},getCssSelectors:function(filter){if(this.cacheCssSelectors[filter]){return this.cacheCssSelectors[filter];}
this.cacheCssSelectors[filter]=[];var sheets=document.styleSheets;for(var i=0;i<sheets.length;i++){var rules;try{rules=sheets[i].rules||sheets[i].cssRules;}catch(e){console.warn("Can't read the css rules of: "+sheets[i].href,e);continue;}
if(!rules){continue;}
for(var r=0;r<rules.length;r++){var selectorText=rules[r].selectorText;if(!selectorText){continue;}
var selectors=selectorText.split(/\s*,\s*/);var data=null;for(var s=0;s<selectors.length;s++){var match=selectors[s].trim().match(filter);if(!match){continue;}
if(!data){data={selector:match[0],css:rules[r].cssText.replace(/(^.*\{\s*)|(\s*\}\s*$)/g,''),names:[match[1]]};}else{data.selector+=(', '+match[0]);data.names.push(match[1]);}}
if(data){this.cacheCssSelectors[filter].push(data);}}}
return this.cacheCssSelectors[filter];},fontIcons:[{base:'fa',parser:/\.(fa-(?:\w|-)+)::?before/i}],computeFonts:_.once(function(){var self=this;_.each(this.fontIcons,function(data){data.cssData=self.getCssSelectors(data.parser);data.alias=_.flatten(_.map(data.cssData,_.property('names')));});}),ready:function(){return Promise.all([domReady,session.is_bound,ajax.loadXML()]);},};});odoo.define('web_editor.context',function(require){'use strict';function getContext(context){var html=document.documentElement;return _.extend({lang:(html.getAttribute('lang')||'en_US').replace('-','_'),'website_id':html.getAttribute('data-website-id')|0,},context||{});}
function getExtraContext(context){var html=document.documentElement;return _.extend(getContext(),{editable:!!(html.dataset.editable||$('[data-oe-model]').length),translatable:!!html.dataset.translatable,edit_translations:!!html.dataset.edit_translations,},context||{});}
return{get:getContext,getExtra:getExtraContext,};});odoo.define('web_editor.ready',function(require){'use strict';var base=require('web_editor.base');return base.ready();});;

/* /web_editor/static/src/js/editor/editor.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.editor',function(require){'use strict';var Dialog=require('web.Dialog');var Widget=require('web.Widget');var core=require('web.core');var rte=require('web_editor.rte');var snippetsEditor=require('web_editor.snippet.editor');var summernoteCustomColors=require('web_editor.rte.summernote_custom_colors');var _t=core._t;var EditorMenuBar=Widget.extend({template:'web_editor.editorbar',xmlDependencies:['/web_editor/static/src/xml/editor.xml'],events:{'click button[data-action=save]':'_onSaveClick','click button[data-action=cancel]':'_onCancelClick',},custom_events:{request_editable:'_onRequestEditable',request_history_undo_record:'_onHistoryUndoRecordRequest',request_save:'_onSaveRequest',},init:function(parent,options){var self=this;var res=this._super.apply(this,arguments);var Editor=options.Editor||rte.Class;this.rte=new Editor(this,{getConfig:function($editable){var param=self._getDefaultConfig($editable);if(options.generateOptions){param=options.generateOptions(param);}
return param;},saveElement:options.saveElement,});this.rte.on('rte:start',this,function(){self.trigger('rte:start');});var $editable=this.rte.editable();window.__EditorMenuBar_$editable=$editable;if(options.snippets){this.snippetsMenu=new snippetsEditor.Class(this,Object.assign({$el:$editable,selectorEditableArea:'.o_editable',},options));}
return res;},start:function(){var self=this;var defs=[this._super.apply(this,arguments)];core.bus.on('editor_save_request',this,this.save);core.bus.on('editor_discard_request',this,this.cancel);$('.dropdown-toggle').dropdown();$(document).on('keyup',function(event){if((event.keyCode===8||event.keyCode===46)){var $target=$(event.target).closest('.o_editable');if(!$target.is(':has(*:not(p):not(br))')&&!$target.text().match(/\S/)){$target.empty();}}});$(document).on('click','.note-editable',function(ev){ev.preventDefault();});$(document).on('submit','.note-editable form .btn',function(ev){ev.preventDefault();});$(document).on('hide.bs.dropdown','.dropdown',function(ev){if(ev.originalEvent&&$(ev.target).has(ev.originalEvent.target).length&&$(ev.originalEvent.target).is('[contenteditable]')){ev.preventDefault();}});this.rte.start();var flag=false;window.onbeforeunload=function(event){if(rte.history.getEditableHasUndo().length&&!flag){flag=true;_.defer(function(){flag=false;});return _t('This document is not saved!');}};if(self.snippetsMenu){defs.push(this.snippetsMenu.insertAfter(this.$el));}
this.rte.editable().find('*').off('mousedown mouseup click');return Promise.all(defs).then(function(){self.trigger_up('edit_mode');});},destroy:function(){this._super.apply(this,arguments);core.bus.off('editor_save_request',this,this._onSaveRequest);core.bus.off('editor_discard_request',this,this._onDiscardRequest);},cancel:function(reload){var self=this;return new Promise(function(resolve,reject){if(!rte.history.getEditableHasUndo().length){resolve();}else{var confirm=Dialog.confirm(this,_t("If you discard the current edits, all unsaved changes will be lost. You can cancel to return to edit mode."),{confirm_callback:resolve,});confirm.on('closed',self,reject);}}).then(function(){if(reload!==false){window.onbeforeunload=null;return self._reload();}});},save:async function(reload){var defs=[];this.trigger_up('ready_to_save',{defs:defs});await Promise.all(defs);if(this.snippetsMenu){await this.snippetsMenu.cleanForSave();}
await this.getParent().saveModifiedImages(this.rte.editable());await this.rte.save();if(reload!==false){return this._reload();}},_getDefaultConfig:function($editable){return{'airMode':true,'focus':false,'airPopover':[['style',['style']],['font',['bold','italic','underline','clear']],['fontsize',['fontsize']],['color',['color']],['para',['ul','ol','paragraph']],['table',['table']],['insert',['link','picture']],['history',['undo','redo']],],'styleWithSpan':false,'inlinemedia':['p'],'lang':'odoo','onChange':function(html,$editable){$editable.trigger('content_changed');},'colors':summernoteCustomColors,};},_reload:function(){window.location.hash='scrollTop='+window.document.body.scrollTop;if(window.location.search.indexOf('enable_editor')>=0){window.location.href=window.location.href.replace(/&?enable_editor(=[^&]*)?/g,'');}else{window.location.reload(true);}
return new Promise(function(){});},_onCancelClick:function(){this.cancel();},_onHistoryUndoRecordRequest:function(ev){this.rte.historyRecordUndo(ev.data.$target,ev.data.event);},_onSaveClick:function(){this.save();},_onDiscardRequest:function(ev){this.cancel(ev.data.reload).then(ev.data.onSuccess,ev.data.onFailure);},_onSaveRequest:function(ev){ev.stopPropagation();this.save(ev.data.reload).then(ev.data.onSuccess,ev.data.onFailure);},_onRequestEditable:function(ev){ev.data.callback(this.rte.editable());},});return{Class:EditorMenuBar,};});;

/* /web_editor/static/src/js/editor/rte.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.rte',function(require){'use strict';var fonts=require('wysiwyg.fonts');var concurrency=require('web.concurrency');var core=require('web.core');var Widget=require('web.Widget');var weContext=require('web_editor.context');var summernote=require('web_editor.summernote');var summernoteCustomColors=require('web_editor.rte.summernote_custom_colors');var _t=core._t;var dom=summernote.core.dom;var range=summernote.core.range;var History=function History($editable){var aUndo=[];var pos=0;var toSnap;this.makeSnap=function(event,rng){rng=rng||range.create();var elEditable=$(rng&&rng.sc).closest('.o_editable')[0];if(!elEditable){return false;}
return{event:event,editable:elEditable,contents:elEditable.innerHTML,bookmark:rng&&rng.bookmark(elEditable),scrollTop:$(elEditable).scrollTop()};};this.applySnap=function(oSnap){var $editable=$(oSnap.editable);if(document.documentMode){$editable.removeAttr('contentEditable').removeProp('contentEditable');}
$editable.trigger('content_will_be_destroyed');var $tempDiv=$('<div/>',{html:oSnap.contents});_.each($tempDiv.find('.o_temp_auto_element'),function(el){var $el=$(el);var originalContent=$el.attr('data-temp-auto-element-original-content');if(originalContent){$el.after(originalContent);}
$el.remove();});$editable.html($tempDiv.html()).scrollTop(oSnap.scrollTop);$editable.trigger('content_was_recreated');$('.oe_overlay').remove();$('.note-control-selection').hide();$editable.trigger('content_changed');try{var r=oSnap.editable.innerHTML===''?range.create(oSnap.editable,0):range.createFromBookmark(oSnap.editable,oSnap.bookmark);r.select();}catch(e){console.error(e);return;}
$(document).trigger('click');$('.o_editable *').filter(function(){var $el=$(this);if($el.data('snippet-editor')){$el.removeData();}});_.defer(function(){var target=dom.isBR(r.sc)?r.sc.parentNode:dom.node(r.sc);if(!target){return;}
$editable.trigger('applySnap');var evt=document.createEvent('MouseEvents');evt.initMouseEvent('click',true,true,window,0,0,0,0,0,false,false,false,false,0,target);target.dispatchEvent(evt);$editable.trigger('keyup');});};this.undo=function(){if(!pos){return;}
var _toSnap=toSnap;if(_toSnap){this.saveSnap();}
if(!aUndo[pos]&&(!aUndo[pos]||aUndo[pos].event!=='undo')){var temp=this.makeSnap('undo');if(temp&&(!pos||temp.contents!==aUndo[pos-1].contents)){aUndo[pos]=temp;}else{pos--;}}else if(_toSnap){pos--;}
this.applySnap(aUndo[Math.max(--pos,0)]);while(pos&&(aUndo[pos].event==='blur'||(aUndo[pos+1].editable===aUndo[pos].editable&&aUndo[pos+1].contents===aUndo[pos].contents))){this.applySnap(aUndo[--pos]);}};this.hasUndo=function(){return(toSnap&&(toSnap.event!=='blur'&&toSnap.event!=='activate'&&toSnap.event!=='undo'))||!!_.find(aUndo.slice(0,pos+1),function(undo){return undo.event!=='blur'&&undo.event!=='activate'&&undo.event!=='undo';});};this.getEditableHasUndo=function(){var editable=[];if((toSnap&&(toSnap.event!=='blur'&&toSnap.event!=='activate'&&toSnap.event!=='undo'))){editable.push(toSnap.editable);}
_.each(aUndo.slice(0,pos+1),function(undo){if(undo.event!=='blur'&&undo.event!=='activate'&&undo.event!=='undo'){editable.push(undo.editable);}});return _.uniq(editable);};this.redo=function(){if(!aUndo[pos+1]){return;}
this.applySnap(aUndo[++pos]);while(aUndo[pos+1]&&aUndo[pos].event==='active'){this.applySnap(aUndo[pos++]);}};this.hasRedo=function(){return aUndo.length>pos+1;};this.recordUndo=function($editable,event,internal_history){var self=this;if(!$editable){var rng=range.create();if(!rng)return;$editable=$(rng.sc).closest('.o_editable');}
if(aUndo[pos]&&(event==='applySnap'||event==='activate')){return;}
if(!internal_history){if(!event||!toSnap||!aUndo[pos-1]||toSnap.event==='activate'){setTimeout(function(){$editable.trigger('content_changed');},0);}}
if(aUndo[pos]){pos=Math.min(pos,aUndo.length);aUndo.splice(pos,aUndo.length);}
if(toSnap&&(toSnap.split||!event||toSnap.event!==event||toSnap.editable!==$editable[0])){this.saveSnap();}
if(pos&&aUndo[pos-1].editable!==$editable[0]){var snap=this.makeSnap('blur',range.create(aUndo[pos-1].editable,0));pos++;aUndo.push(snap);}
if(range.create()){toSnap=self.makeSnap(event);}else{toSnap=false;}};this.splitNext=function(){if(toSnap){toSnap.split=true;}};this.saveSnap=function(){if(toSnap){if(!aUndo[pos]){pos++;}
aUndo.push(toSnap);delete toSnap.split;toSnap=null;}};};var history=new History();$.extend($.expr[':'],{o_editable:function(node,i,m){while(node){if(node.className&&_.isString(node.className)){if(node.className.indexOf('o_not_editable')!==-1){return false;}
if(node.className.indexOf('o_editable')!==-1){return true;}}
node=node.parentNode;}
return false;},});$.fn.extend({focusIn:function(){if(this.length){range.create(dom.firstChild(this[0]),0).select();}
return this;},focusInEnd:function(){if(this.length){var last=dom.lastChild(this[0]);range.create(last,dom.nodeLength(last)).select();}
return this;},selectContent:function(){if(this.length){var next=dom.lastChild(this[0]);range.create(dom.firstChild(this[0]),0,next,next.textContent.length).select();}
return this;},});var RTEWidget=Widget.extend({init:function(parent,params){var self=this;this._super.apply(this,arguments);this.init_bootstrap_carousel=$.fn.carousel;this.edit_bootstrap_carousel=function(){var res=self.init_bootstrap_carousel.apply(this,arguments);$(this).off('keydown.bs.carousel');return res;};this._getConfig=params&&params.getConfig||this._getDefaultConfig;this._saveElement=params&&params.saveElement||this._saveElement;fonts.computeFonts();},start:function(){var self=this;this.saving_mutex=new concurrency.Mutex();$.fn.carousel=this.edit_bootstrap_carousel;$(document).on('click.rte keyup.rte',function(){var current_range={};try{current_range=range.create()||{};}catch(e){}
var $popover=$(current_range.sc).closest('[contenteditable]');var popover_history=($popover.data()||{}).NoteHistory;if(!popover_history||popover_history===history)return;var editor=$popover.parent('.note-editor');$('button[data-event="undo"]',editor).attr('disabled',!popover_history.hasUndo());$('button[data-event="redo"]',editor).attr('disabled',!popover_history.hasRedo());});$(document).on('mousedown.rte activate.rte',this,this._onMousedown.bind(this));$(document).on('mouseup.rte',this,this._onMouseup.bind(this));$('.o_not_editable').attr('contentEditable',false);var $editable=this.editable();$editable.on('content_will_be_destroyed',function(ev){self.trigger_up('content_will_be_destroyed',{$target:$(ev.currentTarget),});});$editable.on('content_was_recreated',function(ev){self.trigger_up('content_was_recreated',{$target:$(ev.currentTarget),});});$editable.addClass('o_editable').data('rte',this).each(function(){var $node=$(this);var computedStyles=window.getComputedStyle(this)||window.parent.getComputedStyle(this);if(computedStyles.display==='inline'&&$node.data('oe-type')!=='image'){$node.addClass('o_is_inline_editable');}});$(document).on('content_changed',function(ev){self.trigger_up('rte_change',{target:ev.target});if(!ev.__isDirtyHandled){ev.__isDirtyHandled=true;var el=ev.target;var dirty=el.closest('.o_editable')||el;dirty.classList.add('o_dirty');}});$('#wrapwrap, .o_editable').on('click.rte','*',this,this._onClick.bind(this));$('body').addClass('editor_enable');$(document.body).tooltip({selector:'[data-oe-readonly]',container:'body',trigger:'hover',delay:{'show':1000,'hide':100},placement:'bottom',title:_t("Readonly field")}).on('click',function(){$(this).tooltip('hide');});$(document).trigger('mousedown');this.trigger('rte:start');return this._super.apply(this,arguments);},destroy:function(){this.cancel();this._super.apply(this,arguments);},cancel:function(){if(this.$last){this.$last.destroy();this.$last=null;}
$.fn.carousel=this.init_bootstrap_carousel;$(document).off('.rte');$('#wrapwrap, .o_editable').off('.rte');$('.o_not_editable').removeAttr('contentEditable');$(document).off('click.rte keyup.rte mousedown.rte activate.rte mouseup.rte');$(document).off('content_changed').removeClass('o_is_inline_editable').removeData('rte');$(document).tooltip('dispose');$('body').removeClass('editor_enable');this.trigger('rte:stop');},editable:function(){return $('#wrapwrap [data-oe-model]').not('.o_not_editable').filter(function(){return!$(this).closest('.o_not_editable').length;}).not('link, script').not('[data-oe-readonly]').not('img[data-oe-field="arch"], br[data-oe-field="arch"], input[data-oe-field="arch"]').not('.oe_snippet_editor').add('.o_editable');},historyRecordUndo:function($target,event,internal_history){const initialActiveElement=document.activeElement;const initialSelectionStart=initialActiveElement&&initialActiveElement.selectionStart;const initialSelectionEnd=initialActiveElement&&initialActiveElement.selectionEnd;$target=$($target);var rng=range.create();var $editable=$(rng&&rng.sc).closest('.o_editable');if(!rng||!$editable.length){$editable=$target.closest('.o_editable');rng=range.create($target.closest('*')[0],0);}else{rng=$editable.data('range')||rng;}
try{rng.select();}catch(e){console.log('error',e);}
history.recordUndo($editable,event,internal_history);if(initialActiveElement&&initialActiveElement!==document.activeElement){initialActiveElement.focus();if(initialActiveElement.matches('input[type=range]')){return;}
try{initialActiveElement.selectionStart=initialSelectionStart;initialActiveElement.selectionEnd=initialSelectionEnd;}catch(e){console.log('error',e);}}},save:function(context){var self=this;$('.o_editable').destroy().removeClass('o_editable o_is_inline_editable o_editable_date_field_linked o_editable_date_field_format_changed');var $dirty=$('.o_dirty');$dirty.removeAttr('contentEditable').removeClass('o_dirty oe_carlos_danger o_is_inline_editable');var defs=_.map($dirty,function(el){var $el=$(el);$el.find('[class]').filter(function(){if(!this.getAttribute('class').match(/\S/)){this.removeAttribute('class');}});return self.saving_mutex.exec(function(){return self._saveElement($el,context||weContext.get()).then(function(){$el.removeClass('o_dirty');}).guardedCatch(function(response){var id=_.uniqueId('carlos_danger_');$el.addClass('o_dirty oe_carlos_danger '+id);$('.o_editable.'+id).removeClass(id).popover({trigger:'hover',content:response.message.data.message||'',placement:'auto top',}).popover('show');});});});return Promise.all(defs).then(function(){window.onbeforeunload=null;}).guardedCatch(function(failed){self.cancel();self.start();});},_enableEditableArea:function($editable){if($editable.data('oe-type')==="datetime"||$editable.data('oe-type')==="date"){var selector='[data-oe-id="'+$editable.data('oe-id')+'"]';selector+='[data-oe-field="'+$editable.data('oe-field')+'"]';selector+='[data-oe-model="'+$editable.data('oe-model')+'"]';var $linkedFieldNodes=this.editable().find(selector).addBack(selector);$linkedFieldNodes.not($editable).addClass('o_editable_date_field_linked');if(!$editable.hasClass('o_editable_date_field_format_changed')){$linkedFieldNodes.html($editable.data('oe-original-with-format'));$linkedFieldNodes.addClass('o_editable_date_field_format_changed');}}
if($editable.data('oe-type')==="monetary"){$editable.attr('contenteditable',false);$editable.find('.oe_currency_value').attr('contenteditable',true);}
if($editable.is('[data-oe-model]')&&!$editable.is('[data-oe-model="ir.ui.view"]')&&!$editable.is('[data-oe-type="html"]')){$editable.data('layoutInfo').popover().find('.btn-group:not(.note-history)').remove();}},_getDefaultConfig:function($editable){return{'airMode':true,'focus':false,'airPopover':[['style',['style']],['font',['bold','italic','underline','clear']],['fontsize',['fontsize']],['color',['color']],['para',['ul','ol','paragraph']],['table',['table']],['insert',['link','picture']],['history',['undo','redo']],],'styleWithSpan':false,'inlinemedia':['p'],'lang':'odoo','onChange':function(html,$editable){$editable.trigger('content_changed');},'colors':summernoteCustomColors,};},_getEscapedElement:function($el){var escaped_el=$el.clone();var to_escape=escaped_el.find('*').addBack();to_escape=to_escape.not(to_escape.filter('object,iframe,script,style,[data-oe-model][data-oe-model!="ir.ui.view"]').find('*').addBack());to_escape.contents().each(function(){if(this.nodeType===3){this.nodeValue=$('<div />').text(this.nodeValue).html();}});return escaped_el;},_saveElement:function($el,context,withLang){var viewID=$el.data('oe-id');if(!viewID){return Promise.resolve();}
return this._rpc({model:'ir.ui.view',method:'save',args:[viewID,this._getEscapedElement($el).prop('outerHTML'),$el.data('oe-xpath')||null,],context:context,},withLang?undefined:{noContextKeys:'lang',});},_onClick:function(e){e.preventDefault();},_onMousedown:function(ev){var $target=$(ev.target);var $editable=$target.closest('.o_editable');var isLink=$target.is('a');if(this&&this.$last&&this.$last.length&&this.$last[0]!==$target[0]){$('.o_editable_date_field_linked').removeClass('o_editable_date_field_linked');}
if(!$editable.length||(!isLink&&$.summernote.core.dom.isContentEditableFalse($target))){return;}
_.defer(function(){$editable.find('[_moz_abspos]').removeAttr('_moz_abspos');});if(isLink){let hasContentEditable=$target.attr('contenteditable');$target.attr('contenteditable',true);_.defer(function(){$editable.not($target).attr('contenteditable',false);$target.focus();});$(document).on('mousedown.reactivate_contenteditable',function(e){if($target.is(e.target))return;if(!hasContentEditable){$target.removeAttr('contenteditable');}
$editable.attr('contenteditable',true);$(document).off('mousedown.reactivate_contenteditable');});}
if(this&&this.$last&&(!$editable.length||this.$last[0]!==$editable[0])){var $destroy=this.$last;history.splitNext();var lastTimerId=_.delay(function(){var id=$destroy.data('note-id');$destroy.destroy().removeData('note-id').removeAttr('data-note-id');$('#note-popover-'+id+', #note-handle-'+id+', #note-dialog-'+id+'').remove();},150);this.$last=null;if($destroy.hasClass('modal-body')){clearTimeout(lastTimerId);}}
if($editable.length&&(!this.$last||this.$last[0]!==$editable[0])){$editable.summernote(this._getConfig($editable));$editable.data('NoteHistory',history);this.$last=$editable;try{document.execCommand('enableObjectResizing',false,false);document.execCommand('enableInlineTableEditing',false,false);document.execCommand('2D-position',false,false);}catch(e){}
document.body.addEventListener('resizestart',function(evt){evt.preventDefault();return false;});document.body.addEventListener('movestart',function(evt){evt.preventDefault();return false;});document.body.addEventListener('dragstart',function(evt){evt.preventDefault();return false;});if(!range.create()){$editable.focusIn();}
if(dom.isImg($target[0])){$target.trigger('mousedown');}
this._enableEditableArea($editable);}},_onMouseup:function(ev){var $target=$(ev.target);var $editable=$target.closest('.o_editable');if(!$editable.length){return;}
var self=this;_.defer(function(){self.historyRecordUndo($target,'activate',true);});if(ev.originalEvent&&ev.originalEvent.detail===3){range.create(ev.target,0,ev.target,ev.target.childNodes.length).select();}},});return{Class:RTEWidget,history:history,};});odoo.define('web_editor.rte.summernote_custom_colors',function(require){'use strict';return[['#000000','#424242','#636363','#9C9C94','#CEC6CE','#EFEFEF','#F7F7F7','#FFFFFF'],['#FF0000','#FF9C00','#FFFF00','#00FF00','#00FFFF','#0000FF','#9C00FF','#FF00FF'],['#F7C6CE','#FFE7CE','#FFEFC6','#D6EFD6','#CEDEE7','#CEE7F7','#D6D6E7','#E7D6DE'],['#E79C9C','#FFC69C','#FFE79C','#B5D6A5','#A5C6CE','#9CC6EF','#B5A5D6','#D6A5BD'],['#E76363','#F7AD6B','#FFD663','#94BD7B','#73A5AD','#6BADDE','#8C7BC6','#C67BA5'],['#CE0000','#E79439','#EFC631','#6BA54A','#4A7B8C','#3984C6','#634AA5','#A54A7B'],['#9C0000','#B56308','#BD9400','#397B21','#104A5A','#085294','#311873','#731842'],['#630000','#7B3900','#846300','#295218','#083139','#003163','#21104A','#4A1031']];});;

/* /web_editor/static/src/js/editor/rte.summernote.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.rte.summernote',function(require){'use strict';var Class=require('web.Class');const concurrency=require('web.concurrency');var core=require('web.core');const topBus=window.top.odoo.__DEBUG__.services['web.core'].bus;const{ColorpickerWidget}=require('web.Colorpicker');var ColorPaletteWidget=require('web_editor.ColorPalette').ColorPaletteWidget;var mixins=require('web.mixins');var fonts=require('wysiwyg.fonts');var rte=require('web_editor.rte');var ServicesMixin=require('web.ServicesMixin');var weWidgets=require('wysiwyg.widgets');var _t=core._t;var dom=$.summernote.core.dom;var range=$.summernote.core.range;var eventHandler=$.summernote.eventHandler;var renderer=$.summernote.renderer;var tplButton=renderer.getTemplate().button;var tplIconButton=renderer.getTemplate().iconButton;var tplDropdown=renderer.getTemplate().dropdown;const processAndApplyColor=function(target,eventName,color,preview){if(!color){color='inherit';}else if(!ColorpickerWidget.isCSSColor(color)){color=(eventName==="foreColor"?'text-':'bg-')+color;}
var layoutInfo=dom.makeLayoutInfo(target);$.summernote.pluginEvents[eventName](undefined,eventHandler.modules.editor,layoutInfo,color,preview);};renderer.createPalette=function($container,options){const $dropdownContent=$container.find(".colorPalette");const parent=odoo.__DEBUG__.services['root.widget'];_.each($dropdownContent,elem=>{const eventName=elem.dataset.eventName;let colorpicker=null;const mutex=new concurrency.MutexedDropPrevious();const $dropdown=$(elem).closest('.btn-group, .dropdown');let manualOpening=false;$dropdown.on('hide.bs.dropdown',ev=>{return!(ev.clickEvent&&ev.clickEvent.originalEvent&&ev.clickEvent.originalEvent.__isColorpickerClick);});$dropdown.on('show.bs.dropdown',()=>{if(manualOpening){return true;}
mutex.exec(()=>{const oldColorpicker=colorpicker;const hookEl=oldColorpicker?oldColorpicker.el:elem;const r=range.create();const targetNode=r.sc;const targetElement=targetNode.nodeType===Node.ELEMENT_NODE?targetNode:targetNode.parentNode;colorpicker=new ColorPaletteWidget(parent,{excluded:['transparent_grayscale'],$editable:rte.Class.prototype.editable(),selectedColor:$(targetElement).css(eventName==="foreColor"?'color':'backgroundColor'),});colorpicker.on('custom_color_picked color_picked',null,ev=>{processAndApplyColor(ev.data.target,eventName,ev.data.color);});colorpicker.on('color_hover color_leave',null,ev=>{processAndApplyColor(ev.data.target,eventName,ev.data.color,true);});colorpicker.on('enter_key_color_colorpicker',null,()=>{$dropdown.children('.dropdown-toggle').dropdown('hide');});return colorpicker.replace(hookEl).then(()=>{if(oldColorpicker){oldColorpicker.destroy();}
manualOpening=true;$dropdown.children('.dropdown-toggle').dropdown('show');manualOpening=false;});});return false;});});};var fn_tplPopovers=renderer.tplPopovers;renderer.tplPopovers=function(lang,options){var $popover=$(fn_tplPopovers.call(this,lang,options));var $imagePopover=$popover.find('.note-image-popover');var $linkPopover=$popover.find('.note-link-popover');var $airPopover=$popover.find('.note-air-popover');$(tplIconButton('fa fa-align-center',{title:_t('Center'),event:'floatMe',value:'center'})).insertAfter($imagePopover.find('[data-event="floatMe"][data-value="left"]'));$imagePopover.find('button[data-event="removeMedia"]').parent().remove();$imagePopover.find('button[data-event="floatMe"][data-value="none"]').remove();var $padding=$('<div class="btn-group"/>');$padding.insertBefore($imagePopover.find('.btn-group:first'));var dropdown_content=['<li><a class="dropdown-item" data-event="padding" href="#" data-value="">'+_t('None')+'</a></li>','<li><a class="dropdown-item" data-event="padding" href="#" data-value="small">'+_t('Small')+'</a></li>','<li><a class="dropdown-item" data-event="padding" href="#" data-value="medium">'+_t('Medium')+'</a></li>','<li><a class="dropdown-item" data-event="padding" href="#" data-value="large">'+_t('Large')+'</a></li>','<li><a class="dropdown-item" data-event="padding" href="#" data-value="xl">'+_t('Xl')+'</a></li>',];$(tplIconButton('fa fa-plus-square-o',{title:_t('Padding'),dropdown:tplDropdown(dropdown_content)})).appendTo($padding);$imagePopover.find('[data-event="imageShape"]:not([data-value])').remove();var $button=$(tplIconButton('fa fa-sun-o',{title:_t('Shadow'),event:'imageShape',value:'shadow'})).insertAfter($imagePopover.find('[data-event="imageShape"][data-value="rounded-circle"]'));var $spin=$('<div class="btn-group d-none only_fa"/>').insertAfter($button.parent());$(tplIconButton('fa fa-refresh',{title:_t('Spin'),event:'imageShape',value:'fa-spin'})).appendTo($spin);var $resizefa=$('<div class="btn-group d-none only_fa"/>').insertAfter($imagePopover.find('.btn-group:has([data-event="resize"])'));for(var size=1;size<=5;size++){$(tplButton('<span class="note-fontsize-10">'+size+'x</span>',{title:size+"x",event:'resizefa',value:size+''})).appendTo($resizefa);}
var $colorfa=$airPopover.find('.note-color').clone();$colorfa.find(".dropdown-menu").css('min-width','172px');$resizefa.after($colorfa);var $imageprop=$('<div class="btn-group"/>');$imageprop.appendTo($imagePopover.find('.popover-body'));$(tplIconButton('fa fa-file-image-o',{title:_t('Edit'),event:'showImageDialog'})).appendTo($imageprop);$(tplIconButton('fa fa-trash-o',{title:_t('Remove'),event:'delete'})).appendTo($imageprop);$(tplIconButton('fa fa-crop',{title:_t('Crop Image'),event:'cropImage',})).insertAfter($imagePopover.find('[data-event="imageShape"][data-value="img-thumbnail"]'));$imagePopover.find('.popover-body').append($airPopover.find(".note-history").clone());$imagePopover.find('[data-event="showImageDialog"]').before($airPopover.find('[data-event="showLinkDialog"]').clone());var $alt=$('<div class="btn-group"/>');$alt.appendTo($imagePopover.find('.popover-body'));$alt.append('<button class="btn btn-secondary" data-event="alt"><strong>'+_t('Description')+': </strong><span class="o_image_alt"/></button>');$linkPopover.find('.popover-body').append($airPopover.find(".note-history").clone());$linkPopover.find('button[data-event="showLinkDialog"] i').attr("class","fa fa-link");$linkPopover.find('button[data-event="unlink"]').before($airPopover.find('button[data-event="showImageDialog"]').clone());$airPopover.find('.note-style .dropdown-toggle').on('mousedown',function(){var $format=$airPopover.find('[data-event="formatBlock"]');var node=range.create().sc;var formats=$format.map(function(){return $(this).data("value");}).get();while(node&&(!node.tagName||(!node.tagName||formats.indexOf(node.tagName.toLowerCase())===-1))){node=node.parentNode;}
$format.removeClass('active');$format.filter('[data-value="'+(node?node.tagName.toLowerCase():"p")+'"]').addClass("active");});setTimeout(function(){$airPopover.add($linkPopover).add($imagePopover).find("button").tooltip('dispose').tooltip({container:'body',trigger:'hover',placement:'bottom'}).on('click',function(){$(this).tooltip('hide');});});return $popover;};var fn_boutton_update=eventHandler.modules.popover.button.update;eventHandler.modules.popover.button.update=function($container,oStyle){var previous=$(".note-control-selection").data('target');if(previous){var $previous=$(previous);$previous.css({"-webkit-animation-play-state":"","animation-play-state":"","-webkit-transition":"","transition":"","-webkit-animation":"","animation":""});$previous.find('.o_we_selected_image').addBack('.o_we_selected_image').removeClass('o_we_selected_image');}
fn_boutton_update.call(this,$container,oStyle);$container.find('.note-color').removeClass('d-none');if(oStyle.image){$container.find('[data-event]').removeClass("active");$container.find('a[data-event="padding"][data-value="small"]').toggleClass("active",$(oStyle.image).hasClass("padding-small"));$container.find('a[data-event="padding"][data-value="medium"]').toggleClass("active",$(oStyle.image).hasClass("padding-medium"));$container.find('a[data-event="padding"][data-value="large"]').toggleClass("active",$(oStyle.image).hasClass("padding-large"));$container.find('a[data-event="padding"][data-value="xl"]').toggleClass("active",$(oStyle.image).hasClass("padding-xl"));$container.find('a[data-event="padding"][data-value=""]').toggleClass("active",!$container.find('li a.active[data-event="padding"]').length);$(oStyle.image).addClass('o_we_selected_image');if(dom.isImgFont(oStyle.image)){$container.find('.note-fore-color-preview > button > .caret').css('border-bottom-color',$(oStyle.image).css('color'));$container.find('.note-back-color-preview > button > .caret').css('border-bottom-color',$(oStyle.image).css('background-color'));$container.find('.btn-group:not(.only_fa):has(button[data-event="resize"],button[data-value="img-thumbnail"])').addClass('d-none');$container.find('.only_fa').removeClass('d-none');$container.find('button[data-event="resizefa"][data-value="2"]').toggleClass("active",$(oStyle.image).hasClass("fa-2x"));$container.find('button[data-event="resizefa"][data-value="3"]').toggleClass("active",$(oStyle.image).hasClass("fa-3x"));$container.find('button[data-event="resizefa"][data-value="4"]').toggleClass("active",$(oStyle.image).hasClass("fa-4x"));$container.find('button[data-event="resizefa"][data-value="5"]').toggleClass("active",$(oStyle.image).hasClass("fa-5x"));$container.find('button[data-event="resizefa"][data-value="1"]').toggleClass("active",!$container.find('.active[data-event="resizefa"]').length);$container.find('button[data-event="imageShape"][data-value="fa-spin"]').toggleClass("active",$(oStyle.image).hasClass("fa-spin"));$container.find('button[data-event="imageShape"][data-value="shadow"]').toggleClass("active",$(oStyle.image).hasClass("shadow"));$container.find('.btn-group:has(button[data-event="imageShape"])').removeClass("d-none");}else{$container.find('.d-none:not(.only_fa, .note-recent-color)').removeClass('d-none');$container.find('.only_fa').addClass('d-none');var width=($(oStyle.image).attr('style')||'').match(/(^|;|\s)width:\s*([0-9]+%)/);if(width){width=width[2];}
$container.find('button[data-event="resize"][data-value="auto"]').toggleClass("active",width!=="100%"&&width!=="50%"&&width!=="25%");$container.find('button[data-event="resize"][data-value="1"]').toggleClass("active",width==="100%");$container.find('button[data-event="resize"][data-value="0.5"]').toggleClass("active",width==="50%");$container.find('button[data-event="resize"][data-value="0.25"]').toggleClass("active",width==="25%");$container.find('button[data-event="imageShape"][data-value="shadow"]').toggleClass("active",$(oStyle.image).hasClass("shadow"));if(!$(oStyle.image).is("img")){$container.find('.btn-group:has(button[data-event="imageShape"])').addClass('d-none');}
$container.find('.note-color').addClass('d-none');}
$container.find('button[data-event="floatMe"][data-value="left"]').toggleClass("active",$(oStyle.image).hasClass("float-left"));$container.find('button[data-event="floatMe"][data-value="center"]').toggleClass("active",$(oStyle.image).hasClass("d-block mx-auto"));$container.find('button[data-event="floatMe"][data-value="right"]').toggleClass("active",$(oStyle.image).hasClass("float-right"));$(oStyle.image).trigger('attributes_change');}else{$container.find('.note-fore-color-preview > button > .caret').css('border-bottom-color',oStyle.color);$container.find('.note-back-color-preview > button > .caret').css('border-bottom-color',oStyle['background-color']);}};var fn_toolbar_boutton_update=eventHandler.modules.toolbar.button.update;eventHandler.modules.toolbar.button.update=function($container,oStyle){fn_toolbar_boutton_update.call(this,$container,oStyle);$container.find('button[data-event="insertUnorderedList"]').toggleClass("active",$(oStyle.ancestors).is('ul:not(.o_checklist)'));$container.find('button[data-event="insertOrderedList"]').toggleClass("active",$(oStyle.ancestors).is('ol'));$container.find('button[data-event="insertCheckList"]').toggleClass("active",$(oStyle.ancestors).is('ul.o_checklist'));};var fn_popover_update=eventHandler.modules.popover.update;eventHandler.modules.popover.update=function($popover,oStyle,isAirMode){var $imagePopover=$popover.find('.note-image-popover');var $linkPopover=$popover.find('.note-link-popover');var $airPopover=$popover.find('.note-air-popover');fn_popover_update.call(this,$popover,oStyle,isAirMode);if(oStyle.image){if(oStyle.image.parentNode.className.match(/(^|\s)media_iframe_video(\s|$)/i)){oStyle.image=oStyle.image.parentNode;}
var alt=$(oStyle.image).attr("alt");$imagePopover.find('.o_image_alt').text((alt||"").replace(/&quot;/g,'"')).parent().toggle(oStyle.image.tagName==="IMG");$imagePopover.show();var target_node=oStyle.image;if(!oStyle.image.className.match(/(^|\s)media_iframe_video(\s|$)/i)){target_node=dom.firstChild(target_node);}
range.createFromNode(target_node).select();eventHandler.modules.editor.saveRange(dom.makeLayoutInfo(target_node).editable());}else{$(".note-control-selection").hide();}
if(oStyle.image||(oStyle.range&&(!oStyle.range.isCollapsed()||(oStyle.range.sc.tagName&&!dom.isAnchor(oStyle.range.sc))))||(oStyle.image&&!$(oStyle.image).closest('a').length)){$linkPopover.hide();oStyle.anchor=false;}
if(oStyle.image||oStyle.anchor||(oStyle.range&&!$(oStyle.range.sc).closest('.note-editable').length)){$airPopover.hide();}else{$airPopover.show();}
const $externalHistoryButtons=$('.o_we_external_history_buttons');if($externalHistoryButtons.length){const $noteHistory=$('.note-history');$noteHistory.addClass('d-none');$externalHistoryButtons.find(':first-child').prop('disabled',$noteHistory.find('[data-event=undo]').prop('disabled'));$externalHistoryButtons.find(':last-child').prop('disabled',$noteHistory.find('[data-event=redo]').prop('disabled'));}
$popover.trigger('summernote_popover_update_call');};var fn_handle_update=eventHandler.modules.handle.update;eventHandler.modules.handle.update=function($handle,oStyle,isAirMode){fn_handle_update.call(this,$handle,oStyle,isAirMode);if(oStyle.image){$handle.find('.note-control-selection').hide();}};function getImgTarget($editable){var $handle=$editable?dom.makeLayoutInfo($editable).handle():undefined;return $(".note-control-selection",$handle).data('target');}
eventHandler.modules.editor.padding=function($editable,sValue){var $target=$(getImgTarget($editable));var paddings="small medium large xl".split(/\s+/);$editable.data('NoteHistory').recordUndo();if(sValue.length){paddings.splice(paddings.indexOf(sValue),1);$target.toggleClass('padding-'+sValue);}
$target.removeClass("padding-"+paddings.join(" padding-"));};eventHandler.modules.editor.resize=function($editable,sValue){var $target=$(getImgTarget($editable));$editable.data('NoteHistory').recordUndo();var width=($target.attr('style')||'').match(/(^|;|\s)width:\s*([0-9]+)%/);if(width){width=width[2]/100;}
$target.css('width',(width!==sValue&&sValue!=="auto")?(sValue*100)+'%':'');};eventHandler.modules.editor.resizefa=function($editable,sValue){var $target=$(getImgTarget($editable));$editable.data('NoteHistory').recordUndo();$target.attr('class',$target.attr('class').replace(/\s*fa-[0-9]+x/g,''));if(+sValue>1){$target.addClass('fa-'+sValue+'x');}};eventHandler.modules.editor.floatMe=function($editable,sValue){var $target=$(getImgTarget($editable));$editable.data('NoteHistory').recordUndo();switch(sValue){case'center':$target.toggleClass('d-block mx-auto').removeClass('float-right float-left');break;case'left':$target.toggleClass('float-left').removeClass('float-right d-block mx-auto');break;case'right':$target.toggleClass('float-right').removeClass('float-left d-block mx-auto');break;}};eventHandler.modules.editor.imageShape=function($editable,sValue){var $target=$(getImgTarget($editable));$editable.data('NoteHistory').recordUndo();$target.toggleClass(sValue);};eventHandler.modules.linkDialog.showLinkDialog=function($editable,$dialog,linkInfo){$editable.data('range').select();$editable.data('NoteHistory').recordUndo();var commonAncestor=linkInfo.range.commonAncestor();if(commonAncestor&&commonAncestor.closest){var link=commonAncestor.closest('a');linkInfo.className=link&&link.className;}
var def=new $.Deferred();topBus.trigger('link_dialog_demand',{$editable:$editable,linkInfo:linkInfo,onSave:function(linkInfo){linkInfo.range.select();$editable.data('range',linkInfo.range);def.resolve(linkInfo);$editable.trigger('keyup');$('.note-popover .note-link-popover').show();},onCancel:def.reject.bind(def),});return def;};eventHandler.modules.imageDialog.showImageDialog=function($editable){var r=$editable.data('range');if(r.sc.tagName&&r.sc.childNodes.length){r.sc=r.sc.childNodes[r.so];}
var media=$(r.sc).parents().addBack().filter(function(i,el){return dom.isImg(el);})[0];var options=$editable.closest('.o_editable, .note-editor').data('options');topBus.trigger('media_dialog_demand',{$editable:$editable,media:media,options:{onUpload:$editable.data('callbacks').onUpload,noVideos:options&&options.noVideos,},onSave:function(media){if(media&&!document.body.contains(media)){r.insertNode(media);};},});return new $.Deferred().reject();};$.summernote.pluginEvents.alt=function(event,editor,layoutInfo,sorted){var $editable=layoutInfo.editable();var $selection=layoutInfo.handle().find('.note-control-selection');topBus.trigger('alt_dialog_demand',{$editable:$editable,media:$selection.data('target'),});};$.summernote.pluginEvents.cropImage=function(event,editor,layoutInfo,sorted){var $editable=layoutInfo.editable();var $selection=layoutInfo.handle().find('.note-control-selection');topBus.trigger('crop_image_demand',{$editable:$editable,media:$selection.data('target'),});};var fn_is_void=dom.isVoid||function(){};dom.isVoid=function(node){return fn_is_void(node)||dom.isImgFont(node)||(node&&node.className&&node.className.match(/(^|\s)media_iframe_video(\s|$)/i));};var fn_is_img=dom.isImg||function(){};dom.isImg=function(node){return fn_is_img(node)||dom.isImgFont(node)||(node&&(node.nodeName==="IMG"||(node.className&&node.className.match(/(^|\s)(media_iframe_video|o_image)(\s|$)/i))));};var fn_is_forbidden_node=dom.isForbiddenNode||function(){};dom.isForbiddenNode=function(node){if(node.tagName==="BR"){return false;}
return fn_is_forbidden_node(node)||$(node).is(".media_iframe_video");};var fn_is_img_font=dom.isImgFont||function(){};dom.isImgFont=function(node){if(fn_is_img_font(node))return true;var nodeName=node&&node.nodeName.toUpperCase();var className=(node&&node.className||"");if(node&&(nodeName==="SPAN"||nodeName==="I")&&className.length){var classNames=className.split(/\s+/);for(var k=0;k<fonts.fontIcons.length;k++){if(_.intersection(fonts.fontIcons[k].alias,classNames).length){return true;}}}
return false;};var fn_is_font=dom.isFont;dom.isFont=function(node){return fn_is_font(node)||dom.isImgFont(node);};var fn_visible=$.summernote.pluginEvents.visible;$.summernote.pluginEvents.visible=function(event,editor,layoutInfo){var res=fn_visible.apply(this,arguments);var rng=range.create();if(!rng)return res;var $node=$(dom.node(rng.sc));if(($node.is('[data-oe-type="html"]')||$node.is('[data-oe-field="arch"]'))&&$node.hasClass("o_editable")&&!$node[0].children.length&&"h1 h2 h3 h4 h5 h6 p b bold i u code sup strong small pre th td span label".toUpperCase().indexOf($node[0].nodeName)===-1){var p=$('<p><br/></p>')[0];$node.append(p);range.createFromNode(p.firstChild).select();}
return res;};function prettify_html(html){html=html.trim();var result='',level=0,get_space=function(level){var i=level,space='';while(i--)space+='  ';return space;},reg=/^<\/?(a|span|font|u|em|i|strong|b)(\s|>)/i,inline_level=Infinity,tokens=_.compact(_.flatten(_.map(html.split(/</),function(value){value=value.replace(/\s+/g,' ').split(/>/);value[0]=/\S/.test(value[0])?'<'+value[0]+'>':'';return value;})));for(var i=0,l=tokens.length;i<l;i++){var token=tokens[i];var inline_tag=reg.test(token);var inline=inline_tag||inline_level<=level;if(token[0]==='<'&&token[1]==='/'){if(inline_tag&&inline_level===level){inline_level=Infinity;}
level--;}
if(!inline&&!/\S/.test(token)){continue;}
if(!inline||(token[1]!=='/'&&inline_level>level)){result+=get_space(level);}
if(token[0]==='<'&&token[1]!=='/'){level++;if(inline_tag&&inline_level>level){inline_level=level;}}
if(token.match(/^<(img|hr|br)/)){level--;}
if(!inline){token=token.trim();}
result+=token.replace(/\s+/,' ');if(inline_level>level){result+='\n';}}
return result;}
$.summernote.pluginEvents.codeview=function(event,editor,layoutInfo,enable){if(!layoutInfo){return;}
if(layoutInfo.toolbar){var is_activated=$.summernote.eventHandler.modules.codeview.isActivated(layoutInfo);if(is_activated===enable){return;}
return eventHandler.modules.codeview.toggle(layoutInfo);}else{var $editor=layoutInfo.editor();var $textarea=$editor.prev('textarea');if($textarea.is('textarea')===enable){return;}
if(!$textarea.length){var html=prettify_html($editor.prop("innerHTML"));$editor.parent().css({'position':'absolute','top':0,'bottom':0,'left':0,'right':0});$textarea=$('<textarea/>').css({'margin':'0 -4px','padding':'0 4px','border':0,'top':'51px','left':'620px','width':'100%','font-family':'sans-serif','font-size':'13px','height':'98%','white-space':'pre','word-wrap':'normal'}).val(html).data('init',html);$editor.before($textarea);$editor.hide();}else{$editor.prop('innerHTML',$textarea.val().replace(/\s*\n\s*/g,'')).trigger('content_changed');$textarea.remove();$editor.show();}}};var last_div;var last_div_change;var last_editable;var initial_data={};function reRangeSelectKey(event){initial_data.range=null;if(event.shiftKey&&event.keyCode>=37&&event.keyCode<=40&&!$(event.target).is("input, textarea, select")){var r=range.create();if(r){var rng=r.reRange(event.keyCode<=38);if(r!==rng){rng.select();}}}}
function reRangeSelect(event,dx,dy){var r=range.create();if(!r||r.isCollapsed())return;var data=r.reRange(dy<0||(dy===0&&dx<0));if(data.sc!==r.sc||data.so!==r.so||data.ec!==r.ec||data.eo!==r.eo){setTimeout(function(){data.select();$(data.sc.parentNode).closest('.note-popover');},0);}
$(data.sc).closest('.o_editable').data('range',r);return r;}
function summernote_mouseup(event){if($(event.target).closest("#web_editor-top-navbar, .note-popover").length){return;}
if(initial_data.event){var dx=event.clientX-(event.shiftKey&&initial_data.rect?initial_data.rect.left:initial_data.event.clientX);var dy=event.clientY-(event.shiftKey&&initial_data.rect?initial_data.rect.top:initial_data.event.clientY);if(10<Math.pow(dx,2)+Math.pow(dy,2)){reRangeSelect(event,dx,dy);}}
if(!$(event.target).closest(".o_editable").length){return;}
if(!initial_data.range||!event.shiftKey){setTimeout(function(){initial_data.range=range.create();},0);}}
var remember_selection;function summernote_mousedown(event){rte.history.splitNext();var $editable=$(event.target).closest(".o_editable, .note-editor");var r;if(document.documentMode){summernote_ie_fix(event,function(node){return node.tagName==="DIV"||node.tagName==="IMG"||(node.dataset&&node.dataset.oeModel);});}else if(last_div&&event.target!==last_div){if(last_div.tagName==="A"){summernote_ie_fix(event,function(node){return node.dataset&&node.dataset.oeModel;});}else if($editable.length){if(summernote_ie_fix(event,function(node){return node.tagName==="A";})){r=range.create();r.select();}}}
try{r=range.create();}catch(e){return;}
var editables=$(".o_editable[contenteditable], .note-editable[contenteditable]");var r_editable=editables.has((r||{}).sc).addBack(editables.filter((r||{}).sc));if(!r_editable.closest('.note-editor').is($editable)&&!r_editable.filter('.o_editable').is(editables)){var saved_editable=editables.has((remember_selection||{}).sc);if($editable.length&&!saved_editable.closest('.o_editable, .note-editor').is($editable)){remember_selection=range.create(dom.firstChild($editable[0]),0);}else if(!saved_editable.length){remember_selection=undefined;}
if(remember_selection){try{remember_selection.select();}catch(e){console.warn(e);}}}else if(r_editable.length){remember_selection=r;}
initial_data.event=event;if(event.shiftKey&&$editable.length){if(initial_data.range){initial_data.range.select();}
var rect=r&&r.getClientRects();initial_data.rect=rect&&rect.length?rect[0]:{top:0,left:0};}}
function summernote_ie_fix(event,pred){var editable;var div;var node=event.target;while(node.parentNode){if(!div&&pred(node)){div=node;}
if(last_div!==node&&(node.getAttribute('contentEditable')==='false'||node.className&&(node.className.indexOf('o_not_editable')!==-1))){break;}
if(node.className&&node.className.indexOf('o_editable')!==-1){if(!div){div=node;}
editable=node;break;}
node=node.parentNode;}
if(!editable){$(last_div_change).removeAttr("contentEditable").removeProp("contentEditable");$(last_editable).attr("contentEditable","true").prop("contentEditable","true");last_div_change=null;last_editable=null;return;}
if(div===last_div){return;}
last_div=div;$(last_div_change).removeAttr("contentEditable").removeProp("contentEditable");if(last_editable!==editable){if($(editable).is("[contentEditable='true']")){$(editable).removeAttr("contentEditable").removeProp("contentEditable");last_editable=editable;}else{last_editable=null;}}
if(!$(div).attr("contentEditable")&&!$(div).is("[data-oe-type='many2one'], [data-oe-type='contact']")){$(div).attr("contentEditable","true").prop("contentEditable","true");last_div_change=div;}else{last_div_change=null;}
return editable!==div?div:null;}
var fn_attach=eventHandler.attach;eventHandler.attach=function(oLayoutInfo,options){fn_attach.call(this,oLayoutInfo,options);oLayoutInfo.editor().on('dragstart','img',function(e){e.preventDefault();});$(document).on('mousedown',summernote_mousedown).on('mouseup',summernote_mouseup);oLayoutInfo.editor().off('click').on('click',function(e){e.preventDefault();});create_dblclick_feature("img, .media_iframe_video, i.fa, span.fa, a.o_image",function(){eventHandler.modules.imageDialog.show(oLayoutInfo);});create_dblclick_feature("a[href], a.btn, button.btn",function(){eventHandler.modules.linkDialog.show(oLayoutInfo);});oLayoutInfo.editable().on('mousedown',function(e){if(dom.isImg(e.target)&&dom.isContentEditable(e.target)){range.createFromNode(e.target).select();}});$(document).on("keyup",reRangeSelectKey);var clone_data=false;if(options.model){oLayoutInfo.editable().data({'oe-model':options.model,'oe-id':options.id});}
if(options.getMediaDomain){oLayoutInfo.editable().data('oe-media-domain',options.getMediaDomain);}
var $node=oLayoutInfo.editor();if($node.data('oe-model')||$node.data('oe-translation-id')){$node.on('content_changed',function(){var $nodes=$('[data-oe-model], [data-oe-translation-id]').filter(function(){return this!==$node[0];});if($node.data('oe-model')){$nodes=$nodes.filter('[data-oe-model="'+$node.data('oe-model')+'"]').filter('[data-oe-id="'+$node.data('oe-id')+'"]').filter('[data-oe-field="'+$node.data('oe-field')+'"]');}
if($node.data('oe-translation-id'))$nodes=$nodes.filter('[data-oe-translation-id="'+$node.data('oe-translation-id')+'"]');if($node.data('oe-type'))$nodes=$nodes.filter('[data-oe-type="'+$node.data('oe-type')+'"]');if($node.data('oe-expression'))$nodes=$nodes.filter('[data-oe-expression="'+$node.data('oe-expression')+'"]');if($node.data('oe-xpath'))$nodes=$nodes.filter('[data-oe-xpath="'+$node.data('oe-xpath')+'"]');if($node.data('oe-contact-options'))$nodes=$nodes.filter('[data-oe-contact-options="'+$node.data('oe-contact-options')+'"]');var nodes=$node.get();if($node.data('oe-type')==="many2one"){$nodes=$nodes.add($('[data-oe-model]').filter(function(){return this!==$node[0]&&nodes.indexOf(this)===-1;}).filter('[data-oe-many2one-model="'+$node.data('oe-many2one-model')+'"]').filter('[data-oe-many2one-id="'+$node.data('oe-many2one-id')+'"]').filter('[data-oe-type="many2one"]'));$nodes=$nodes.add($('[data-oe-model]').filter(function(){return this!==$node[0]&&nodes.indexOf(this)===-1;}).filter('[data-oe-model="'+$node.data('oe-many2one-model')+'"]').filter('[data-oe-id="'+$node.data('oe-many2one-id')+'"]').filter('[data-oe-field="name"]'));}
if(!clone_data){clone_data=true;$nodes.html(this.innerHTML);clone_data=false;}});}
var custom_toolbar=oLayoutInfo.toolbar?oLayoutInfo.toolbar():undefined;var $toolbar=$(oLayoutInfo.popover()).add(custom_toolbar);$('button[data-event="undo"], button[data-event="redo"]',$toolbar).attr('disabled',true);$(oLayoutInfo.editor()).add(oLayoutInfo.handle()).add(oLayoutInfo.popover()).add(custom_toolbar).on('click content_changed',function(){$('button[data-event="undo"]',$toolbar).attr('disabled',!oLayoutInfo.editable().data('NoteHistory').hasUndo());$('button[data-event="redo"]',$toolbar).attr('disabled',!oLayoutInfo.editable().data('NoteHistory').hasRedo());});function create_dblclick_feature(selector,callback){var show_tooltip=true;oLayoutInfo.editor().on("dblclick",selector,function(e){var $target=$(e.target);if(!dom.isContentEditable($target)){return;}
show_tooltip=false;callback();e.stopImmediatePropagation();});oLayoutInfo.editor().on("click",selector,function(e){var $target=$(e.target);if(!dom.isContentEditable($target)){return;}
show_tooltip=true;setTimeout(function(){if(!show_tooltip||$target.attr('title')!==undefined){return;}
$target.tooltip({title:_t('Double-click to edit'),trigger:'manuel',container:'body'}).tooltip('show');setTimeout(function(){$target.tooltip('dispose');},800);},400);});}};var fn_detach=eventHandler.detach;eventHandler.detach=function(oLayoutInfo,options){fn_detach.call(this,oLayoutInfo,options);oLayoutInfo.editable().off('mousedown');oLayoutInfo.editor().off("dragstart");oLayoutInfo.editor().off('click');$(document).off('mousedown',summernote_mousedown);$(document).off('mouseup',summernote_mouseup);oLayoutInfo.editor().off("dblclick");$(document).off("keyup",reRangeSelectKey);};$.summernote.lang.odoo={font:{bold:_t('Bold'),italic:_t('Italic'),underline:_t('Underline'),strikethrough:_t('Strikethrough'),subscript:_t('Subscript'),superscript:_t('Superscript'),clear:_t('Remove Font Style'),height:_t('Line Height'),name:_t('Font Family'),size:_t('Font Size')},image:{image:_t('File / Image'),insert:_t('Insert Image'),resizeFull:_t('Resize Full'),resizeHalf:_t('Resize Half'),resizeQuarter:_t('Resize Quarter'),floatLeft:_t('Float Left'),floatRight:_t('Float Right'),floatNone:_t('Float None'),dragImageHere:_t('Drag an image here'),selectFromFiles:_t('Select from files'),url:_t('Image URL'),remove:_t('Remove Image')},link:{link:_t('Link'),insert:_t('Insert Link'),unlink:_t('Unlink'),edit:_t('Edit'),textToDisplay:_t('Text to display'),url:_t('To what URL should this link go?'),openInNewWindow:_t('Open in new window')},video:{video:_t('Video'),videoLink:_t('Video Link'),insert:_t('Insert Video'),url:_t('Video URL?'),providers:_t('(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)')},table:{table:_t('Table')},hr:{insert:_t('Insert Horizontal Rule')},style:{style:_t('Style'),normal:_t('Normal'),blockquote:_t('Quote'),pre:_t('Code'),small:_t('Small'),h1:_t('Header 1'),h2:_t('Header 2'),h3:_t('Header 3'),h4:_t('Header 4'),h5:_t('Header 5'),h6:_t('Header 6')},lists:{unordered:_t('Unordered list'),ordered:_t('Ordered list')},options:{help:_t('Help'),fullscreen:_t('Full Screen'),codeview:_t('Code View')},paragraph:{paragraph:_t('Paragraph'),outdent:_t('Outdent'),indent:_t('Indent'),left:_t('Align left'),center:_t('Align center'),right:_t('Align right'),justify:_t('Justify full')},color:{custom:_t('Custom Color'),background:_t('Background Color'),foreground:_t('Font Color'),transparent:_t('Transparent'),setTransparent:_t('None'),},shortcut:{shortcuts:_t('Keyboard shortcuts'),close:_t('Close'),textFormatting:_t('Text formatting'),action:_t('Action'),paragraphFormatting:_t('Paragraph formatting'),documentStyle:_t('Document Style')},history:{undo:_t('Undo'),redo:_t('Redo')}};var SummernoteManager=Class.extend(mixins.EventDispatcherMixin,ServicesMixin,{init:function(parent){mixins.EventDispatcherMixin.init.call(this);this.setParent(parent);topBus.on('alt_dialog_demand',this,this._onAltDialogDemand);topBus.on('crop_image_demand',this,this._onCropImageDemand);topBus.on('link_dialog_demand',this,this._onLinkDialogDemand);topBus.on('media_dialog_demand',this,this._onMediaDialogDemand);},destroy:function(){mixins.EventDispatcherMixin.destroy.call(this);topBus.off('alt_dialog_demand',this,this._onAltDialogDemand);topBus.off('crop_image_demand',this,this._onCropImageDemand);topBus.off('link_dialog_demand',this,this._onLinkDialogDemand);topBus.off('media_dialog_demand',this,this._onMediaDialogDemand);},saveModifiedImages:function($editable){const defs=_.map($editable,async editableEl=>{const{oeModel:resModel,oeId:resId}=editableEl.dataset;const proms=[...editableEl.querySelectorAll('.o_modified_image_to_save')].map(async el=>{const isBackground=!el.matches('img');el.classList.remove('o_modified_image_to_save');const newAttachmentSrc=await this._rpc({route:`/web_editor/modify_image/${el.dataset.originalId}`,params:{res_model:resModel,res_id:parseInt(resId),data:(isBackground?el.dataset.bgSrc:el.getAttribute('src')).split(',')[1],},});if(isBackground){$(el).css('background-image',`url('${newAttachmentSrc}')`);delete el.dataset.bgSrc;}else{el.setAttribute('src',newAttachmentSrc);}});return Promise.all(proms);});return Promise.all(defs);},_onAltDialogDemand:function(data){if(data.__alreadyDone){return;}
data.__alreadyDone=true;var altDialog=new weWidgets.AltDialog(this,data.options||{},data.media);if(data.onSave){altDialog.on('save',this,data.onSave);}
if(data.onCancel){altDialog.on('cancel',this,data.onCancel);}
altDialog.open();},_onCropImageDemand:function(data){if(data.__alreadyDone){return;}
data.__alreadyDone=true;new weWidgets.ImageCropWidget(this,data.media).appendTo(data.$editable);},_onLinkDialogDemand:function(data){if(data.__alreadyDone){return;}
data.__alreadyDone=true;var linkDialog=new weWidgets.LinkDialog(this,data.options||{},data.$editable,data.linkInfo);if(data.onSave){linkDialog.on('save',this,data.onSave);}
if(data.onCancel){linkDialog.on('cancel',this,data.onCancel);}
linkDialog.open();},_onMediaDialogDemand:function(data){if(data.__alreadyDone){return;}
data.__alreadyDone=true;var mediaDialog=new weWidgets.MediaDialog(this,_.extend({res_model:data.$editable.data('oe-model'),res_id:data.$editable.data('oe-id'),domain:data.$editable.data('oe-media-domain'),},data.options),data.media);if(data.onSave){mediaDialog.on('save',this,data.onSave);}
if(data.onCancel){mediaDialog.on('cancel',this,data.onCancel);}
mediaDialog.open();},});return SummernoteManager;});;

/* /web_editor/static/src/js/editor/image_processing.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.image_processing',function(require){'use strict';const cropperDataFields=['x','y','width','height','rotate','scaleX','scaleY'];const modifierFields=['filter','quality','mimetype','glFilter','originalId','originalSrc','resizeWidth','aspectRatio',];const _applyAll=(result,filter,filters)=>{filters.forEach(f=>{if(f[0]==='blend'){const cv=f[1];const ctx=result.getContext('2d');ctx.globalCompositeOperation=f[2];ctx.globalAlpha=f[3];ctx.drawImage(cv,0,0);ctx.globalCompositeOperation='source-over';ctx.globalAlpha=1.0;}else{filter.addFilter(...f);}});};let applyAll;const glFilters={blur:filter=>filter.addFilter('blur',10),'1977':(filter,cv)=>{const ctx=cv.getContext('2d');ctx.fillStyle='rgb(243, 106, 188)';ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'screen',.3],['brightness',.1],['contrast',.1],['saturation',.3],]);},aden:(filter,cv)=>{const ctx=cv.getContext('2d');ctx.fillStyle='rgb(66, 10, 14)';ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'darken',.2],['brightness',.2],['contrast',-.1],['saturation',-.15],['hue',20],]);},brannan:(filter,cv)=>{const ctx=cv.getContext('2d');ctx.fillStyle='rgb(161, 44, 191)';ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'lighten',.31],['sepia',.5],['contrast',.4],]);},earlybird:(filter,cv)=>{const ctx=cv.getContext('2d');const gradient=ctx.createRadialGradient(cv.width/2,cv.height/2,0,cv.width/2,cv.height/2,Math.hypot(cv.width,cv.height)/2);gradient.addColorStop(.2,'#D0BA8E');gradient.addColorStop(1,'#1D0210');ctx.fillStyle=gradient;ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'overlay',.2],['sepia',.2],['contrast',-.1],]);},inkwell:(filter,cv)=>{applyAll(filter,[['sepia',.3],['brightness',.1],['contrast',-.1],['desaturateLuminance'],]);},maven:(filter,cv)=>{applyAll(filter,[['sepia',.25],['brightness',-.05],['contrast',-.05],['saturation',.5],]);},toaster:(filter,cv)=>{const ctx=cv.getContext('2d');const gradient=ctx.createRadialGradient(cv.width/2,cv.height/2,0,cv.width/2,cv.height/2,Math.hypot(cv.width,cv.height)/2);gradient.addColorStop(0,'#0F4E80');gradient.addColorStop(1,'#3B003B');ctx.fillStyle=gradient;ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'screen',.5],['brightness',-.1],['contrast',.5],]);},walden:(filter,cv)=>{const ctx=cv.getContext('2d');ctx.fillStyle='#CC4400';ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'screen',.3],['sepia',.3],['brightness',.1],['saturation',.6],['hue',350],]);},valencia:(filter,cv)=>{const ctx=cv.getContext('2d');ctx.fillStyle='#3A0339';ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'exclusion',.5],['sepia',.08],['brightness',.08],['contrast',.08],]);},xpro:(filter,cv)=>{const ctx=cv.getContext('2d');const gradient=ctx.createRadialGradient(cv.width/2,cv.height/2,0,cv.width/2,cv.height/2,Math.hypot(cv.width,cv.height)/2);gradient.addColorStop(.4,'#E0E7E6');gradient.addColorStop(1,'#2B2AA1');ctx.fillStyle=gradient;ctx.fillRect(0,0,cv.width,cv.height);applyAll(filter,[['blend',cv,'color-burn',.7],['sepia',.3],]);},custom:(filter,cv,filterOptions)=>{const options=Object.assign({blend:'normal',filterColor:'',blur:'0',desaturateLuminance:'0',saturation:'0',contrast:'0',brightness:'0',sepia:'0',},JSON.parse(filterOptions||"{}"));const filters=[];if(options.filterColor){const ctx=cv.getContext('2d');ctx.fillStyle=options.filterColor;ctx.fillRect(0,0,cv.width,cv.height);filters.push(['blend',cv,options.blend,1]);}
delete options.blend;delete options.filterColor;filters.push(...Object.entries(options).map(([filter,amount])=>[filter,parseInt(amount)/100]));applyAll(filter,filters);},};async function applyModifications(img){const data=Object.assign({glFilter:'',filter:'#0000',quality:'75',},img.dataset);let{width,height,resizeWidth,quality,filter,mimetype,originalSrc,glFilter,filterOptions,}=data;[width,height,resizeWidth]=[width,height,resizeWidth].map(s=>parseFloat(s));quality=parseInt(quality);const container=document.createElement('div');const original=await loadImage(originalSrc);container.appendChild(original);await activateCropper(original,0,data);const croppedImg=$(original).cropper('getCroppedCanvas',{width,height});$(original).cropper('destroy');const result=document.createElement('canvas');result.width=resizeWidth||croppedImg.width;result.height=croppedImg.height*result.width/croppedImg.width;const ctx=result.getContext('2d');ctx.drawImage(croppedImg,0,0,croppedImg.width,croppedImg.height,0,0,result.width,result.height);if(glFilter){const glf=new window.WebGLImageFilter();const cv=document.createElement('canvas');cv.width=result.width;cv.height=result.height;applyAll=_applyAll.bind(null,result);glFilters[glFilter](glf,cv,filterOptions);const filtered=glf.apply(result);ctx.drawImage(filtered,0,0,filtered.width,filtered.height,0,0,result.width,result.height);}
ctx.fillStyle=filter||'#0000';ctx.fillRect(0,0,result.width,result.height);return result.toDataURL(mimetype,quality/100);}
function loadImage(src,img=new Image()){return new Promise((resolve,reject)=>{img.addEventListener('load',()=>resolve(img),{once:true});img.addEventListener('error',reject,{once:true});img.src=src;});}
const imageCache=new Map();async function activateCropper(image,aspectRatio,dataset){const src=image.getAttribute('src');if(!imageCache.has(src)){const res=await fetch(src);imageCache.set(src,URL.createObjectURL(await res.blob()));}
image.src=imageCache.get(src);$(image).cropper({viewMode:2,dragMode:'move',autoCropArea:1.0,aspectRatio:aspectRatio,data:_.mapObject(_.pick(dataset,...cropperDataFields),value=>parseFloat(value)),minContainerWidth:1,minContainerHeight:1,});return new Promise(resolve=>image.addEventListener('ready',resolve,{once:true}));}
async function loadImageInfo(img,rpc){if(img.dataset.originalSrc){return;}
const{original}=await rpc({route:'/web_editor/get_image_info',params:{src:img.getAttribute('src').split(/[?#]/)[0]},});if(original&&new URL(original.image_src,window.location.origin).origin===window.location.origin){img.dataset.originalId=original.id;img.dataset.originalSrc=original.image_src;img.dataset.mimetype=original.mimetype;}}
return{applyModifications,cropperDataFields,activateCropper,loadImageInfo,loadImage,removeOnImageChangeAttrs:[...cropperDataFields,...modifierFields,'aspectRatio'],};});;

/* /web_editor/static/src/js/editor/custom_colors.js defined in bundle 'web_editor.assets_wysiwyg' */
;

/* /web_editor/static/src/js/wysiwyg/widgets/media.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.widgets.media',function(require){'use strict';var concurrency=require('web.concurrency');var core=require('web.core');var Dialog=require('web.Dialog');var dom=require('web.dom');var fonts=require('wysiwyg.fonts');var utils=require('web.utils');var Widget=require('web.Widget');var session=require('web.session');const{removeOnImageChangeAttrs}=require('web_editor.image_processing');const{getCSSVariableValue,DEFAULT_PALETTE}=require('web_editor.utils');var QWeb=core.qweb;var _t=core._t;var MediaWidget=Widget.extend({xmlDependencies:['/web_editor/static/src/xml/wysiwyg.xml'],init:function(parent,media,options){this._super.apply(this,arguments);this.media=media;this.$media=$(media);},clear:function(){if(!this.media){return;}
this._clear();},save:function(){},_clear:function(){},});var SearchableMediaWidget=MediaWidget.extend({events:_.extend({},MediaWidget.prototype.events||{},{'input .o_we_search':'_onSearchInput',}),init:function(){this._super.apply(this,arguments);this._onSearchInput=_.debounce(this._onSearchInput,500);},search:function(needle){},_renderThumbnails:function(){},_onSearchInput:function(ev){this.attachments=[];this.search($(ev.currentTarget).val()||'').then(()=>this._renderThumbnails());this.hasSearched=true;},});var FileWidget=SearchableMediaWidget.extend({events:_.extend({},SearchableMediaWidget.prototype.events||{},{'click .o_upload_media_button':'_onUploadButtonClick','change .o_file_input':'_onFileInputChange','click .o_upload_media_url_button':'_onUploadURLButtonClick','input .o_we_url_input':'_onURLInputChange','click .o_existing_attachment_cell':'_onAttachmentClick','click .o_existing_attachment_remove':'_onRemoveClick','click .o_load_more':'_onLoadMoreClick',}),existingAttachmentsTemplate:undefined,IMAGE_MIMETYPES:['image/gif','image/jpe','image/jpeg','image/jpg','image/gif','image/png','image/svg+xml'],NUMBER_OF_ATTACHMENTS_TO_DISPLAY:30,MAX_DB_ATTACHMENTS:5,init:function(parent,media,options){this._super.apply(this,arguments);this._mutex=new concurrency.Mutex();this.numberOfAttachmentsToDisplay=this.NUMBER_OF_ATTACHMENTS_TO_DISPLAY;this.options=_.extend({mediaWidth:media&&media.parentElement&&$(media.parentElement).width(),},options||{});this.attachments=[];this.selectedAttachments=[];this.libraryMedia=[];this.selectedMedia=[];this._onUploadURLButtonClick=dom.makeAsyncHandler(this._onUploadURLButtonClick);},start:function(){var def=this._super.apply(this,arguments);var self=this;this.$urlInput=this.$('.o_we_url_input');this.$form=this.$('form');this.$fileInput=this.$('.o_file_input');this.$uploadButton=this.$('.o_upload_media_button');this.$addUrlButton=this.$('.o_upload_media_url_button');this.$urlSuccess=this.$('.o_we_url_success');this.$urlWarning=this.$('.o_we_url_warning');this.$urlError=this.$('.o_we_url_error');this.$errorText=this.$('.o_we_error_text');var o={url:null,alt:null,};if(this.$media.is('img')){o.url=this.$media.attr('src');}else if(this.$media.is('a.o_image')){o.url=this.$media.attr('href').replace(/[?].*/,'');o.id=+o.url.match(/\/web\/content\/(\d+)/,'')[1];}
return this.search('').then(async()=>{await this._renderThumbnails();if(o.url){self._selectAttachement(_.find(self.attachments,function(attachment){return o.url===attachment.image_src;})||o);}
return def;});},save:function(){return this._mutex.exec(this._save.bind(this));},search:function(needle){this.needle=needle;return this.fetchAttachments(this.NUMBER_OF_ATTACHMENTS_TO_DISPLAY,0);},fetchAttachments:function(number,offset){return this._rpc({model:'ir.attachment',method:'search_read',args:[],kwargs:{domain:this._getAttachmentsDomain(this.needle),fields:['name','mimetype','description','checksum','url','type','res_id','res_model','public','access_token','image_src','image_width','image_height','original_id'],order:[{name:'id',asc:false}],context:this.options.context,limit:number+1,offset:offset,},}).then(attachments=>{this.attachments=this.attachments.slice();Array.prototype.splice.apply(this.attachments,[offset,attachments.length].concat(attachments));});},hasContent(){return this.attachments.length;},_clear:function(){if(this.$media.is('img')){return;}
var allImgClasses=/(^|\s+)((img(\s|$)|img-(?!circle|rounded|thumbnail))[^\s]*)/g;var allImgClassModifiers=/(^|\s+)(rounded-circle|shadow|rounded|img-thumbnail|mx-auto)([^\s]*)/g;this.media.className=this.media.className&&this.media.className.replace('o_we_custom_image','').replace(allImgClasses,' ').replace(allImgClassModifiers,' ');},_getAttachmentsDomain:function(needle){var domain=this.options.attachmentIDs&&this.options.attachmentIDs.length?['|',['id','in',this.options.attachmentIDs]]:[];var attachedDocumentDomain=['&',['res_model','=',this.options.res_model],['res_id','=',this.options.res_id|0]];if(!this.options.res_id){attachedDocumentDomain.unshift('&');attachedDocumentDomain.push(['create_uid','=',this.options.user_id]);}
if(this.options.data_res_model){var relatedDomain=['&',['res_model','=',this.options.data_res_model],['res_id','=',this.options.data_res_id|0]];if(!this.options.data_res_id){relatedDomain.unshift('&');relatedDomain.push(['create_uid','=',session.uid]);}
domain=domain.concat(['|'],attachedDocumentDomain,relatedDomain);}else{domain=domain.concat(attachedDocumentDomain);}
domain=['|',['public','=',true]].concat(domain);domain=domain.concat(this.options.mimetypeDomain);if(needle&&needle.length){domain.push(['name','ilike',needle]);}
domain.push('!',['name','=like','%.crop']);domain.push('|',['type','=','binary'],'!',['url','=like','/%/static/%']);return domain;},_highlightSelected:function(){var self=this;this.$('.o_existing_attachment_cell.o_we_attachment_selected').removeClass("o_we_attachment_selected");_.each(this.selectedAttachments,function(attachment){self.$('.o_existing_attachment_cell[data-id='+attachment.id+']').addClass("o_we_attachment_selected").css('display','');});},_handleNewAttachment:function(attachment){this.attachments=this.attachments.filter(att=>att.id!==attachment.id);this.attachments.unshift(attachment);this._renderThumbnails();this._selectAttachement(attachment);},_loadMoreImages:function(forceSearch){return this.fetchAttachments(10,this.numberOfAttachmentsToDisplay).then(()=>{this.numberOfAttachmentsToDisplay+=10;if(!forceSearch){this._renderThumbnails();return Promise.resolve();}else{return this.search(this.$('.o_we_search').val()||'');}});},_renderExisting:function(attachments){return QWeb.render(this.existingAttachmentsTemplate,{attachments:attachments,widget:this,});},_renderThumbnails:function(){var attachments=this.attachments.slice(0,this.numberOfAttachmentsToDisplay);this.$('.o_we_existing_attachments').replaceWith(this._renderExisting(attachments));this._highlightSelected();this.$('.o_we_load_more').toggleClass('d-none',!this.hasContent());var noLoadMoreButton=this.NUMBER_OF_ATTACHMENTS_TO_DISPLAY>=this.attachments.length;var noMoreImgToLoad=this.numberOfAttachmentsToDisplay>=this.attachments.length;this.$('.o_load_done_msg').toggleClass('d-none',noLoadMoreButton||!noMoreImgToLoad);this.$('.o_load_more').toggleClass('d-none',noMoreImgToLoad);},_save:async function(){const toSave=Object.fromEntries(this.selectedMedia.map(media=>[media.id,{query:media.query||'',is_dynamic_svg:!!media.isDynamicSVG,}]));let mediaAttachments=[];if(Object.keys(toSave).length!==0){mediaAttachments=await this._rpc({route:'/web_editor/save_library_media',params:{media:toSave,},});}
const selected=this.selectedAttachments.concat(mediaAttachments).map(attachment=>{if(attachment.image_src&&attachment.image_src.startsWith('/web_editor/shape/')){const colorCustomizedURL=new URL(attachment.image_src,window.location.origin);colorCustomizedURL.searchParams.set('c1',getCSSVariableValue('o-color-1'));attachment.image_src=colorCustomizedURL.pathname+colorCustomizedURL.search;}
return attachment;});if(this.options.multiImages){return selected;}
const img=selected[0];if(!img||!img.id){return this.media;}
if(!img.public&&!img.access_token){await this._rpc({model:'ir.attachment',method:'generate_access_token',args:[[img.id]]}).then(function(access_token){img.access_token=access_token[0];});}
if(img.image_src){var src=img.image_src;if(!img.public&&img.access_token){src+=_.str.sprintf('?access_token=%s',img.access_token);}
if(!this.$media.is('img')){this.$media=$('<img/>',{class:'img-fluid o_we_custom_image'});this.media=this.$media[0];}
this.$media.attr('src',src);}else{if(!this.$media.is('a')){$('.note-control-selection').hide();this.$media=$('<a/>');this.media=this.$media[0];}
var href='/web/content/'+img.id+'?';if(!img.public&&img.access_token){href+=_.str.sprintf('access_token=%s&',img.access_token);}
href+='unique='+img.checksum+'&download=true';this.$media.attr('href',href);this.$media.addClass('o_image').attr('title',img.name).attr('data-mimetype',img.mimetype);}
this.$media.attr('alt',img.alt||img.description||'');var style=this.style;if(style){this.$media.css(style);}
removeOnImageChangeAttrs.forEach(attr=>{delete this.media.dataset[attr];});this.media.classList.remove('o_modified_image_to_save');this.$media.trigger('image_changed');return this.media;},_selectAttachement:function(attachment,save,{type='attachment'}={}){const possibleProps={'attachment':'selectedAttachments','media':'selectedMedia'};const prop=possibleProps[type];if(this.options.multiImages){const index=this[prop].indexOf(attachment);if(index!==-1){if(!save){this[prop].splice(index,1);}}else{this[prop].push(attachment);}}else{Object.values(possibleProps).forEach(prop=>{this[prop]=[];});this[prop]=[attachment];}
this._highlightSelected();if(save){this.trigger_up('save_request');}},_updateAddUrlUi:function(emptyValue,isURL,isImage){this.$addUrlButton.toggleClass('btn-secondary',emptyValue).toggleClass('btn-primary',!emptyValue).prop('disabled',!isURL);this.$urlSuccess.toggleClass('d-none',!isURL);this.$urlError.toggleClass('d-none',emptyValue||isURL);},_onAttachmentClick:function(ev){const attachment=ev.currentTarget;const{id:attachmentID,mediaId}=attachment.dataset;if(attachmentID){const attachment=this.attachments.find(attachment=>attachment.id===parseInt(attachmentID));this._selectAttachement(attachment,!this.options.multiImages);}else if(mediaId){const media=this.libraryMedia.find(media=>media.id===parseInt(mediaId));this._selectAttachement(media,!this.options.multiImages,{type:'media'});}},_onFileInputChange:function(){return this._mutex.exec(this._addData.bind(this));},_addData:function(){var self=this;var uploadMutex=new concurrency.Mutex();var files=_.sortBy(this.$fileInput[0].files,'size');_.each(files,function(file){uploadMutex.exec(function(){return utils.getDataURLFromFile(file).then(function(result){return self._rpc({route:'/web_editor/attachment/add_data',params:{'name':file.name,'data':result.split(',')[1],'res_id':self.options.res_id,'res_model':self.options.res_model,'width':0,'quality':0,},}).then(function(attachment){self._handleNewAttachment(attachment);});});});});return uploadMutex.getUnlockedDef().then(function(){if(!self.options.multiImages&&!self.noSave){self.trigger_up('save_request');}
self.noSave=false;});},_onRemoveClick:function(ev){var self=this;ev.stopPropagation();Dialog.confirm(this,_t("Are you sure you want to delete this file ?"),{confirm_callback:function(){var $a=$(ev.currentTarget).closest('.o_existing_attachment_cell');var id=parseInt($a.data('id'),10);var attachment=_.findWhere(self.attachments,{id:id});return self._rpc({route:'/web_editor/attachment/remove',params:{ids:[id],},}).then(function(prevented){if(_.isEmpty(prevented)){self.attachments=_.without(self.attachments,attachment);self.attachments.filter(at=>at.original_id[0]===attachment.id).forEach(at=>delete at.original_id);if(!self.attachments.length){self._renderThumbnails();}else{$a.closest('.o_existing_attachment_cell').remove();}
return;}
self.$errorText.replaceWith(QWeb.render('wysiwyg.widgets.image.existing.error',{views:prevented[id],widget:self,}));});}});},_onURLInputChange:function(){var inputValue=this.$urlInput.val();var emptyValue=(inputValue==='');var isURL=/^.+\..+$/.test(inputValue);var isImage=_.any(['.gif','.jpeg','.jpe','.jpg','.png'],function(format){return inputValue.endsWith(format);});this._updateAddUrlUi(emptyValue,isURL,isImage);},_onUploadButtonClick:function(){this.$fileInput.click();},_onUploadURLButtonClick:function(){if(this.$urlInput.is('.o_we_horizontal_collapse')){this.$urlInput.removeClass('o_we_horizontal_collapse');this.$addUrlButton.attr('disabled','disabled');return;}
return this._mutex.exec(this._addUrl.bind(this));},_addUrl:function(){var self=this;return this._rpc({route:'/web_editor/attachment/add_url',params:{'url':this.$urlInput.val(),'res_id':this.options.res_id,'res_model':this.options.res_model,},}).then(function(attachment){self.$urlInput.val('');self._onURLInputChange();self._handleNewAttachment(attachment);if(!self.options.multiImages){self.trigger_up('save_request');}});},_onLoadMoreClick:function(){this._loadMoreImages();},_onSearchInput:function(){this.attachments=[];this.numberOfAttachmentsToDisplay=this.NUMBER_OF_ATTACHMENTS_TO_DISPLAY;this._super.apply(this,arguments);},});var ImageWidget=FileWidget.extend({template:'wysiwyg.widgets.image',existingAttachmentsTemplate:'wysiwyg.widgets.image.existing.attachments',events:Object.assign({},FileWidget.prototype.events,{'change input.o_we_show_optimized':'_onShowOptimizedChange','change .o_we_search_select':'_onSearchSelect',}),MIN_ROW_HEIGHT:128,init:function(parent,media,options){this.searchService='all';options=_.extend({accept:'image/*',mimetypeDomain:[['mimetype','in',this.IMAGE_MIMETYPES]],},options||{});this._onAttachmentImageLoad=this._onAttachmentImageLoad.bind(this);this._super(parent,media,options);},start:async function(){await this._super(...arguments);this.el.addEventListener('load',this._onAttachmentImageLoad,true);},destroy:function(){this.el.removeEventListener('load',this._onAttachmentImageLoad,true);return this._super(...arguments);},async fetchAttachments(number,offset){if(this.needle&&this.searchService!=='database'){number=this.MAX_DB_ATTACHMENTS;offset=0;}
const result=await this._super(number,offset);const primaryColor=getCSSVariableValue('o-color-1');this.attachments.forEach(attachment=>{if(attachment.image_src.startsWith('/')){const newURL=new URL(attachment.image_src,window.location.origin);if(attachment.image_src.startsWith('/web_editor/shape/')){newURL.searchParams.set('c1',primaryColor);}else{newURL.searchParams.set('height',2*this.MIN_ROW_HEIGHT);}
attachment.thumbnail_src=newURL.pathname+newURL.search;}});if(this.needle){try{const response=await this._rpc({route:'/web_editor/media_library_search',params:{'query':this.needle,'offset':this.libraryMedia.length,},});const newMedia=response.media;this.nbMediaResults=response.results;this.libraryMedia.push(...newMedia);}catch(e){console.error(`Couldn't reach API endpoint.`);}}
return result;},hasContent(){if(this.searchService==='all'){return this._super(...arguments)||this.libraryMedia.length;}else if(this.searchService==='media-library'){return!!this.libraryMedia.length;}
return this._super(...arguments);},_updateAddUrlUi:function(emptyValue,isURL,isImage){this._super.apply(this,arguments);this.$addUrlButton.text((isURL&&!isImage)?_t("Add as document"):_t("Add image"));const warning=isURL&&!isImage;this.$urlWarning.toggleClass('d-none',!warning);if(warning){this.$urlSuccess.addClass('d-none');}},_renderThumbnails:function(){const alreadyLoaded=this.$('.o_existing_attachment_cell[data-loaded="true"]');this._super(...arguments);this.$('.o_existing_attachment_cell').addClass('d-none');alreadyLoaded.each((index,el)=>{const toReplace=this.$(`.o_existing_attachment_cell[data-id="${el.dataset.id}"], .o_existing_attachment_cell[data-media-id="${el.dataset.mediaId}"]`);if(toReplace.length){toReplace.replaceWith(el);}});this._toggleOptimized(this.$('input.o_we_show_optimized')[0].checked);const placeholderWidth=3/2*this.MIN_ROW_HEIGHT;this.$('.o_we_attachment_placeholder').css({flexGrow:placeholderWidth,flexBasis:placeholderWidth,});if(this.needle&&['media-library','all'].includes(this.searchService)){const noMoreImgToLoad=this.libraryMedia.length===this.nbMediaResults;const noLoadMoreButton=noMoreImgToLoad&&this.libraryMedia.length<=15;this.$('.o_load_done_msg').toggleClass('d-none',noLoadMoreButton||!noMoreImgToLoad);this.$('.o_load_more').toggleClass('d-none',noMoreImgToLoad);}},_renderExisting:function(attachments){if(this.needle&&this.searchService!=='database'){attachments=attachments.slice(0,this.MAX_DB_ATTACHMENTS);}
return QWeb.render(this.existingAttachmentsTemplate,{attachments:attachments,libraryMedia:this.libraryMedia,widget:this,});},_toggleOptimized:function(value){this.$('.o_we_attachment_optimized').each((i,cell)=>cell.style.setProperty('display',value?null:'none','important'));},_highlightSelected:function(){this._super(...arguments);this.selectedMedia.forEach(media=>{this.$(`.o_existing_attachment_cell[data-media-id=${media.id}]`).addClass("o_we_attachment_selected");});},_onAttachmentImageLoad:async function(ev){const img=ev.target;const cell=img.closest('.o_existing_attachment_cell');if(!cell){return;}
if(cell.dataset.mediaId&&!img.src.startsWith('blob')){const mediaUrl=img.src;try{const response=await fetch(mediaUrl);if(response.headers.get('content-type')==='image/svg+xml'){const svg=await response.text();const colorRegex=new RegExp(DEFAULT_PALETTE['1'],'gi');if(colorRegex.test(svg)){const fileName=mediaUrl.split('/').pop();const file=new File([svg.replace(colorRegex,getCSSVariableValue('o-color-1'))],fileName,{type:"image/svg+xml",});img.src=URL.createObjectURL(file);const media=this.libraryMedia.find(media=>media.id===parseInt(cell.dataset.mediaId));if(media){media.isDynamicSVG=true;}
return;}}}catch(e){console.error('CORS is misconfigured on the API server, image will be treated as non-dynamic.');}}
let aspectRatio=img.naturalWidth/img.naturalHeight;if(img.naturalHeight===0){img.width=1000;img.style.position='fixed';img.style.opacity='0';const originalParent=img.parentElement;document.body.appendChild(img);aspectRatio=img.width/img.height;originalParent.appendChild(img);img.removeAttribute('width');img.style.removeProperty('position');img.style.removeProperty('opacity');}
const width=aspectRatio*this.MIN_ROW_HEIGHT;cell.style.flexGrow=width;cell.style.flexBasis=`${width}px`;cell.classList.remove('d-none');cell.classList.add('d-flex');cell.dataset.loaded='true';},_onShowOptimizedChange:function(ev){this._toggleOptimized(ev.target.checked);},_onSearchSelect:function(ev){const{value}=ev.target;this.searchService=value;this.$('.o_we_search').trigger('input');},_onSearchInput:function(ev){this.libraryMedia=[];this._super(...arguments);},});var DocumentWidget=FileWidget.extend({template:'wysiwyg.widgets.document',existingAttachmentsTemplate:'wysiwyg.widgets.document.existing.attachments',init:function(parent,media,options){options=_.extend({accept:'*/*',mimetypeDomain:[['mimetype','not in',this.IMAGE_MIMETYPES]],},options||{});this._super(parent,media,options);},_updateAddUrlUi:function(emptyValue,isURL,isImage){this._super.apply(this,arguments);this.$addUrlButton.text((isURL&&isImage)?_t("Add as image"):_t("Add document"));const warning=isURL&&isImage;this.$urlWarning.toggleClass('d-none',!warning);if(warning){this.$urlSuccess.addClass('d-none');}},_getAttachmentsDomain:function(needle){var domain=this._super.apply(this,arguments);return domain.concat('!',utils.assetsDomain());},});var IconWidget=SearchableMediaWidget.extend({template:'wysiwyg.widgets.font-icons',events:_.extend({},SearchableMediaWidget.prototype.events||{},{'click .font-icons-icon':'_onIconClick',}),init:function(parent,media){this._super.apply(this,arguments);fonts.computeFonts();this.iconsParser=fonts.fontIcons;this.alias=_.flatten(_.map(this.iconsParser,function(data){return data.alias;}));},start:function(){this.$icons=this.$('.font-icons-icon');var classes=(this.media&&this.media.className||'').split(/\s+/);for(var i=0;i<classes.length;i++){var cls=classes[i];if(_.contains(this.alias,cls)){this.selectedIcon=cls;this._highlightSelectedIcon();}}
this.nonIconClasses=_.without(classes,'media_iframe_video',this.selectedIcon);return this._super.apply(this,arguments);},save:function(){var style=this.$media.attr('style')||'';var iconFont=this._getFont(this.selectedIcon)||{base:'fa',font:''};var finalClasses=_.uniq(this.nonIconClasses.concat([iconFont.base,iconFont.font]));if(!this.$media.is('span, i')){var $span=$('<span/>');$span.data(this.$media.data());this.$media=$span;this.media=this.$media[0];style=style.replace(/\s*width:[^;]+/,'');}
this.$media.attr({class:_.compact(finalClasses).join(' '),style:style||null,});return Promise.resolve(this.media);},search:function(needle){var iconsParser=this.iconsParser;if(needle&&needle.length){iconsParser=[];_.filter(this.iconsParser,function(data){var cssData=_.filter(data.cssData,function(cssData){return _.find(cssData.names,function(alias){return alias.indexOf(needle)>=0;});});if(cssData.length){iconsParser.push({base:data.base,cssData:cssData,});}});}
this.$('div.font-icons-icons').html(QWeb.render('wysiwyg.widgets.font-icons.icons',{iconsParser:iconsParser,widget:this}));return Promise.resolve();},_clear:function(){var allFaClasses=/(^|\s)(fa(\s|$)|fa-[^\s]*)/g;this.media.className=this.media.className&&this.media.className.replace(allFaClasses,' ');},_getFont:function(classNames){if(!(classNames instanceof Array)){classNames=(classNames||"").split(/\s+/);}
var fontIcon,cssData;for(var k=0;k<this.iconsParser.length;k++){fontIcon=this.iconsParser[k];for(var s=0;s<fontIcon.cssData.length;s++){cssData=fontIcon.cssData[s];if(_.intersection(classNames,cssData.names).length){return{base:fontIcon.base,parser:fontIcon.parser,font:cssData.names[0],};}}}
return null;},_highlightSelectedIcon:function(){var self=this;this.$icons.removeClass('o_we_attachment_selected');this.$icons.filter(function(i,el){return _.contains($(el).data('alias').split(','),self.selectedIcon);}).addClass('o_we_attachment_selected');},_onIconClick:function(ev){ev.preventDefault();ev.stopPropagation();this.selectedIcon=$(ev.currentTarget).data('id');this._highlightSelectedIcon();this.trigger_up('save_request');},});var VideoWidget=MediaWidget.extend({template:'wysiwyg.widgets.video',events:_.extend({},MediaWidget.prototype.events||{},{'change .o_video_dialog_options input':'_onUpdateVideoOption','input textarea#o_video_text':'_onVideoCodeInput','change textarea#o_video_text':'_onVideoCodeChange',}),init:function(parent,media,options){this._super.apply(this,arguments);this.isForBgVideo=!!options.isForBgVideo;this._onVideoCodeInput=_.debounce(this._onVideoCodeInput,1000);},start:function(){this.$content=this.$('.o_video_dialog_iframe');if(this.media){var $media=$(this.media);var src=$media.data('oe-expression')||$media.data('src')||($media.is('iframe')?$media.attr('src'):'')||'';this.$('textarea#o_video_text').val(src);this.$('input#o_video_autoplay').prop('checked',src.indexOf('autoplay=1')>=0);this.$('input#o_video_hide_controls').prop('checked',src.indexOf('controls=0')>=0);this.$('input#o_video_loop').prop('checked',src.indexOf('loop=1')>=0);this.$('input#o_video_hide_fullscreen').prop('checked',src.indexOf('fs=0')>=0);this.$('input#o_video_hide_yt_logo').prop('checked',src.indexOf('modestbranding=1')>=0);this.$('input#o_video_hide_dm_logo').prop('checked',src.indexOf('ui-logo=0')>=0);this.$('input#o_video_hide_dm_share').prop('checked',src.indexOf('sharing-enable=0')>=0);this._updateVideo();}
return this._super.apply(this,arguments);},save:function(){this._updateVideo();if(this.isForBgVideo){return Promise.resolve({bgVideoSrc:this.$content.attr('src')});}
if(this.$('.o_video_dialog_iframe').is('iframe')){this.$media=$('<div class="media_iframe_video" data-oe-expression="'+this.$content.attr('src')+'">'+'<div class="css_editable_mode_display">&nbsp;</div>'+'<div class="media_iframe_video_size" contenteditable="false">&nbsp;</div>'+'<iframe src="'+this.$content.attr('src')+'" frameborder="0" contenteditable="false" allowfullscreen="allowfullscreen"></iframe>'+'</div>');this.media=this.$media[0];}
return Promise.resolve(this.media);},_clear:function(){if(this.media.dataset.src){try{delete this.media.dataset.src;}catch(e){this.media.dataset.src=undefined;}}
var allVideoClasses=/(^|\s)media_iframe_video(\s|$)/g;var isVideo=this.media.className&&this.media.className.match(allVideoClasses);if(isVideo){this.media.className=this.media.className.replace(allVideoClasses,' ');this.media.innerHTML='';}},_createVideoNode:function(url,options){options=options||{};const videoData=this._getVideoURLData(url,options);if(videoData.error){return{errorCode:0};}
if(!videoData.type){return{errorCode:1};}
const $video=$('<iframe>').width(1280).height(720).attr('frameborder',0).attr('src',videoData.embedURL).addClass('o_video_dialog_iframe');return{$video:$video,type:videoData.type};},_updateVideo:function(){this.$content.empty();this.$('#o_video_form_group').removeClass('o_has_error o_has_success').find('.form-control, .custom-select').removeClass('is-invalid is-valid');this.$('.o_video_dialog_options div').addClass('d-none');var $textarea=this.$('textarea#o_video_text');var code=$textarea.val().trim();if(!code){return;}
var embedMatch=code.match(/(src|href)=["']?([^"']+)?/);if(embedMatch&&embedMatch[2].length>0&&embedMatch[2].indexOf('instagram')){embedMatch[1]=embedMatch[2];}
var url=embedMatch?embedMatch[1]:code;var query=this._createVideoNode(url,{'autoplay':this.isForBgVideo||this.$('input#o_video_autoplay').is(':checked'),'hide_controls':this.isForBgVideo||this.$('input#o_video_hide_controls').is(':checked'),'loop':this.isForBgVideo||this.$('input#o_video_loop').is(':checked'),'hide_fullscreen':this.isForBgVideo||this.$('input#o_video_hide_fullscreen').is(':checked'),'hide_yt_logo':this.isForBgVideo||this.$('input#o_video_hide_yt_logo').is(':checked'),'hide_dm_logo':this.isForBgVideo||this.$('input#o_video_hide_dm_logo').is(':checked'),'hide_dm_share':this.isForBgVideo||this.$('input#o_video_hide_dm_share').is(':checked'),});var $optBox=this.$('.o_video_dialog_options');this.$el.find('.o_video_dialog_preview_text, .media_iframe_video_size').add($optBox).toggleClass('d-none',!query.$video);this.$el.find('#o_video_form_group').toggleClass('o_has_error',!query.$video).find('.form-control, .custom-select').toggleClass('is-invalid',!query.$video).end().toggleClass('o_has_success',!!query.$video).find('.form-control, .custom-select').toggleClass('is-valid',!!query.$video);$optBox.find('div.o_'+query.type+'_option').removeClass('d-none');$optBox.toggleClass('d-none',this.isForBgVideo||$optBox.find('div:not(.d-none)').length===0);if(query.type==='youtube'){this.$('input#o_video_hide_fullscreen, input#o_video_hide_yt_logo').closest('div').toggleClass('d-none',this.$('input#o_video_hide_controls').is(':checked'));}
var $content=query.$video;if(!$content){switch(query.errorCode){case 0:$content=$('<div/>',{class:'alert alert-danger o_video_dialog_iframe mb-2 mt-2',text:_t("The provided url is not valid"),});break;case 1:$content=$('<div/>',{class:'alert alert-warning o_video_dialog_iframe mb-2 mt-2',text:_t("The provided url does not reference any supported video"),});break;}}
this.$content.replaceWith($content);this.$content=$content;},_onUpdateVideoOption:function(){this._updateVideo();},_onVideoCodeChange:function(){this._updateVideo();},_onVideoCodeInput:function(){this._updateVideo();},_getVideoURLData:function(url,options){if(!url.match(/^(http:\/\/|https:\/\/|\/\/)[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/i)){return{error:true,message:'The provided url is invalid',};}
const regexes={youtube:/^(?:(?:https?:)?\/\/)?(?:www\.)?(?:youtu\.be\/|youtube(-nocookie)?\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((?:\w|-){11})(?:\S+)?$/,instagram:/(.*)instagram.com\/p\/(.[a-zA-Z0-9]*)/,vine:/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,vimeo:/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,dailymotion:/.+dailymotion.com\/(video|hub|embed)\/([^_?]+)[^#]*(#video=([^_&]+))?/,youku:/(.*).youku\.com\/(v_show\/id_|embed\/)(.+)/,};const matches=_.mapObject(regexes,regex=>url.match(regex));const autoplay=options.autoplay?'?autoplay=1&mute=1':'?autoplay=0';const controls=options.hide_controls?'&controls=0':'';const loop=options.loop?'&loop=1':'';let embedURL;let type;if(matches.youtube&&matches.youtube[2].length===11){const fullscreen=options.hide_fullscreen?'&fs=0':'';const ytLoop=loop?loop+`&playlist=${matches.youtube[2]}`:'';const logo=options.hide_yt_logo?'&modestbranding=1':'';embedURL=`//www.youtube${matches.youtube[1] || ''}.com/embed/${matches.youtube[2]}${autoplay}&rel=0${ytLoop}${controls}${fullscreen}${logo}`;type='youtube';}else if(matches.instagram&&matches.instagram[2].length){embedURL=`//www.instagram.com/p/${matches.instagram[2]}/embed/`;type='instagram';}else if(matches.vine&&matches.vine[0].length){embedURL=`${matches.vine[0]}/embed/simple`;type='vine';}else if(matches.vimeo&&matches.vimeo[3].length){const vimeoAutoplay=autoplay.replace('mute','muted');embedURL=`//player.vimeo.com/video/${matches.vimeo[3]}${vimeoAutoplay}${loop}`;type='vimeo';}else if(matches.dailymotion&&matches.dailymotion[2].length){const videoId=matches.dailymotion[2].replace('video/','');const logo=options.hide_dm_logo?'&ui-logo=0':'';const share=options.hide_dm_share?'&sharing-enable=0':'';embedURL=`//www.dailymotion.com/embed/video/${videoId}${autoplay}${controls}${logo}${share}`;type='dailymotion';}else if(matches.youku&&matches.youku[3].length){const videoId=matches.youku[3].indexOf('.html?')>=0?matches.youku[3].substring(0,matches.youku[3].indexOf('.html?')):matches.youku[3];embedURL=`//player.youku.com/embed/${videoId}`;type='youku';}
return{type:type,embedURL:embedURL};},});return{MediaWidget:MediaWidget,SearchableMediaWidget:SearchableMediaWidget,FileWidget:FileWidget,ImageWidget:ImageWidget,DocumentWidget:DocumentWidget,IconWidget:IconWidget,VideoWidget:VideoWidget,};});;

/* /web_editor/static/src/js/wysiwyg/widgets/dialog.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.widgets.Dialog',function(require){'use strict';var config=require('web.config');var core=require('web.core');var Dialog=require('web.Dialog');var _t=core._t;var SummernoteDialog=Dialog.extend({init:function(parent,options){this.options=options||{};if(config.device.isMobile){options.fullscreen=true;}
this._super(parent,_.extend({},{buttons:[{text:this.options.save_text||_t("Save"),classes:'btn-primary',click:this.save,},{text:_t("Discard"),close:true,}]},this.options));this.destroyAction='cancel';var self=this;this.opened(function(){self.$('input:visible:first').focus();self.$el.closest('.modal').addClass('o_web_editor_dialog');self.$el.closest('.modal').on('hidden.bs.modal',self.options.onClose);});this.on('closed',this,function(){self._toggleFullScreen();this.trigger(this.destroyAction,this.final_data||null);});},_toggleFullScreen:function(){if(config.device.isMobile&&!this.hasFullScreen){$('#iframe_target[isMobile="true"] #web_editor-top-edit .o_fullscreen').click();}},save:function(){this.destroyAction="save";this.close();},open:function(){this.hasFullScreen=$(window.top.document.body).hasClass('o_field_widgetTextHtml_fullscreen');this._toggleFullScreen();return this._super.apply(this,arguments);},});return SummernoteDialog;});;

/* /web_editor/static/src/js/wysiwyg/widgets/alt_dialog.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.widgets.AltDialog',function(require){'use strict';var core=require('web.core');var Dialog=require('wysiwyg.widgets.Dialog');var _t=core._t;var AltDialog=Dialog.extend({template:'wysiwyg.widgets.alt',xmlDependencies:Dialog.prototype.xmlDependencies.concat(['/web_editor/static/src/xml/wysiwyg.xml']),init:function(parent,options,media){options=options||{};this._super(parent,_.extend({},{title:_t("Change media description and tooltip")},options));this.trigger_up('getRecordInfo',{recordInfo:options,callback:function(recordInfo){_.defaults(options,recordInfo);},});this.media=media;var allEscQuots=/&quot;/g;this.alt=($(this.media).attr('alt')||"").replace(allEscQuots,'"');var title=$(this.media).attr('title')||$(this.media).data('original-title')||"";this.tag_title=(title).replace(allEscQuots,'"');},save:function(){var alt=this.$('#alt').val();var title=this.$('#title').val();var allNonEscQuots=/"/g;$(this.media).attr('alt',alt?alt.replace(allNonEscQuots,"&quot;"):null).attr('title',title?title.replace(allNonEscQuots,"&quot;"):null);$(this.media).trigger('content_changed');this.final_data=this.media;return this._super.apply(this,arguments);},});return AltDialog;});;

/* /web_editor/static/src/js/wysiwyg/widgets/color_palette.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.ColorPalette',function(require){'use strict';const ajax=require('web.ajax');const core=require('web.core');const session=require('web.session');const{ColorpickerWidget}=require('web.Colorpicker');const Widget=require('web.Widget');const summernoteCustomColors=require('web_editor.rte.summernote_custom_colors');const weUtils=require('web_editor.utils');const qweb=core.qweb;const ColorPaletteWidget=Widget.extend({template:'web_editor.snippet.option.colorpicker',events:{'click .o_we_color_btn':'_onColorButtonClick','mouseenter .o_we_color_btn':'_onColorButtonEnter','mouseleave .o_we_color_btn':'_onColorButtonLeave','click .o_we_colorpicker_switch_pane_btn':'_onSwitchPaneButtonClick',},custom_events:{'colorpicker_select':'_onColorPickerSelect','colorpicker_preview':'_onColorPickerPreview',},init:function(parent,options){this._super.apply(this,arguments);this.summernoteCustomColorsArray=[].concat(...summernoteCustomColors);this.style=window.getComputedStyle(document.documentElement);this.options=_.extend({selectedColor:false,resetButton:true,excluded:[],excludeSectionOf:null,$editable:$(),withCombinations:false,},options||{});this.selectedColor='';this.resetButton=this.options.resetButton;this.withCombinations=this.options.withCombinations;this.trigger_up('request_editable',{callback:val=>this.options.$editable=val});},willStart:async function(){await this._super(...arguments);await ColorPaletteWidget.loadDependencies(this);},start:async function(){const res=this._super.apply(this,arguments);const $colorSection=this.$('.o_colorpicker_sections[data-color-tab="theme-colors"]');const $clpicker=qweb.has_template('web_editor.colorpicker')?$(qweb.render('web_editor.colorpicker')):$(`<colorpicker><div class="o_colorpicker_section" data-name="common"></div></colorpicker>`);$clpicker.find('button').addClass('o_we_color_btn');$clpicker.appendTo($colorSection);_.each(this.options.excluded,exc=>{this.$('[data-name="'+exc+'"]').addClass('d-none');});if(this.options.excludeSectionOf){this.$('[data-name]:has([data-color="'+this.options.excludeSectionOf+'"])').addClass('d-none');}
this.el.querySelectorAll('.o_colorpicker_section').forEach(elem=>{$(elem).prepend('<div>'+(elem.dataset.display||'')+'</div>');});if(!this.options.excluded.includes('common')){const $commonColorSection=this.$('[data-name="common"]');summernoteCustomColors.forEach((colorRow,i)=>{if(i===0){return;}
const $div=$('<div/>',{class:'clearfix'}).appendTo($commonColorSection);colorRow.forEach(color=>{$div.append(this._createColorButton(color,['o_common_color']));});});}
const compatibilityColorNames=['primary','secondary','alpha','beta','gamma','delta','epsilon','success','info','warning','danger'];this.colorNames=[...compatibilityColorNames];this.colorToColorNames={};this.el.querySelectorAll('button[data-color]').forEach(elem=>{const colorName=elem.dataset.color;const $color=$(elem);const isCCName=weUtils.isColorCombinationName(colorName);if(isCCName){$color.find('.o_we_cc_preview_wrapper').addClass(`o_cc o_cc${colorName}`);}else{$color.addClass(`bg-${colorName}`);}
this.colorNames.push(colorName);if(!isCCName&&!elem.classList.contains('d-none')){const color=weUtils.getCSSVariableValue(colorName,this.style);this.colorToColorNames[color]=colorName;}});if(this.options.selectedColor){let selectedColor=this.options.selectedColor;if(compatibilityColorNames.includes(selectedColor)){selectedColor=weUtils.getCSSVariableValue(selectedColor,this.style)||selectedColor;}
selectedColor=ColorpickerWidget.normalizeCSSColor(selectedColor);if(selectedColor!=='rgba(0, 0, 0, 0)'){this.selectedColor=this.colorToColorNames[selectedColor]||selectedColor;}}
this._buildCustomColors();this._markSelectedColor();let defaultColor=this.selectedColor;if(defaultColor&&!ColorpickerWidget.isCSSColor(defaultColor)){defaultColor=weUtils.getCSSVariableValue(defaultColor,this.style);}
this.colorPicker=new ColorpickerWidget(this,{defaultColor:defaultColor,});await this.colorPicker.prependTo($colorSection);return res;},getColorNames:function(){return this.colorNames;},_buildCustomColors:function(){if(this.options.excluded.includes('custom')){return;}
this.el.querySelectorAll('.o_custom_color').forEach(el=>el.remove());const existingColors=new Set(this.summernoteCustomColorsArray.concat(Object.keys(this.colorToColorNames)));this.trigger_up('get_custom_colors',{onSuccess:(colors)=>{colors.forEach(color=>{this._addCustomColor(existingColors,color);});},});weUtils.getCSSVariableValue('custom-colors',this.style).split(' ').forEach(v=>{const color=weUtils.getCSSVariableValue(v.substring(1,v.length-1),this.style);if(ColorpickerWidget.isCSSColor(color)){this._addCustomColor(existingColors,color);}});_.each(this.options.$editable.find('[style*="color"]'),el=>{for(const colorProp of['color','backgroundColor']){this._addCustomColor(existingColors,el.style[colorProp]);}});if(this.selectedColor){this._addCustomColor(existingColors,this.selectedColor);}},_addCustomColor:function(existingColors,color){if(!color){return;}
if(!ColorpickerWidget.isCSSColor(color)){color=weUtils.getCSSVariableValue(color,this.style);}
const normColor=ColorpickerWidget.normalizeCSSColor(color);if(!existingColors.has(normColor)){this._addCustomColorButton(normColor);existingColors.add(normColor);}},_addCustomColorButton:function(color,classes=[]){classes.push('o_custom_color');const $themeSection=this.$('.o_colorpicker_section[data-name="theme"]');const $button=this._createColorButton(color,classes);return $button.appendTo($themeSection);},_createColorButton:function(color,classes){return $('<button/>',{class:'o_we_color_btn '+classes.join(' '),style:'background-color:'+color+';',});},_getButtonInfo:function(buttonEl){const bgColor=buttonEl.style.backgroundColor;return{color:bgColor?ColorpickerWidget.normalizeCSSColor(bgColor):buttonEl.dataset.color||'',target:buttonEl,};},_selectColor:function(colorInfo,eventName){this.selectedColor=colorInfo.color=this.colorToColorNames[colorInfo.color]||colorInfo.color;this.trigger_up(eventName,colorInfo);this._buildCustomColors();this._markSelectedColor();},_markSelectedColor:function(){this.el.querySelectorAll('button.selected').forEach(el=>el.classList.remove('selected'));const selectedButton=this.el.querySelector(`button[data-color="${this.selectedColor}"], button[style*="background-color:${this.selectedColor};"]`);if(selectedButton){selectedButton.classList.add('selected');}},_onColorButtonClick:function(ev){const buttonEl=ev.currentTarget;const colorInfo=this._getButtonInfo(buttonEl);this._selectColor(colorInfo,'color_picked');},_onColorButtonEnter:function(ev){ev.stopPropagation();this.trigger_up('color_hover',this._getButtonInfo(ev.currentTarget));},_onColorButtonLeave:function(ev){ev.stopPropagation();this.trigger_up('color_leave',{color:this.selectedColor,target:ev.target,});},_onColorPickerPreview:function(ev){this.trigger_up('color_hover',{color:ev.data.cssColor,target:this.colorPicker.el,});},_onColorPickerSelect:function(ev){this._selectColor({color:ev.data.cssColor,target:this.colorPicker.el,},'custom_color_picked');},_onSwitchPaneButtonClick(ev){ev.stopPropagation();this.el.querySelectorAll('.o_we_colorpicker_switch_pane_btn').forEach(el=>{el.classList.remove('active');});ev.currentTarget.classList.add('active');this.el.querySelectorAll('.o_colorpicker_sections').forEach(el=>{el.classList.toggle('d-none',el.dataset.colorTab!==ev.currentTarget.dataset.target);});},});let colorpickerTemplateProm;ColorPaletteWidget.loadDependencies=async function(rpcCapableObj){const proms=[ajax.loadXML('/web_editor/static/src/xml/snippets.xml',qweb)];if(!session.is_website_user){if(!colorpickerTemplateProm&&!qweb.has_template('web_editor.colorpicker')){colorpickerTemplateProm=rpcCapableObj._rpc({model:'ir.ui.view',method:'read_template',args:['web_editor.colorpicker'],}).then(template=>{return qweb.add_template('<templates>'+template+'</templates>');});}
proms.push(colorpickerTemplateProm);}
return Promise.all(proms);};return{ColorPaletteWidget:ColorPaletteWidget,};});;

/* /web_editor/static/src/js/wysiwyg/widgets/image_crop_widget.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.widgets.ImageCropWidget',function(require){'use strict';const core=require('web.core');const Widget=require('web.Widget');const{applyModifications,cropperDataFields,activateCropper,loadImage,loadImageInfo}=require('web_editor.image_processing');const _t=core._t;const ImageCropWidget=Widget.extend({template:['wysiwyg.widgets.crop'],xmlDependencies:['/web_editor/static/src/xml/wysiwyg.xml'],events:{'click.crop_options [data-action]':'_onCropOptionClick','zoom':'_onCropZoom',},init(parent,media){this._super(...arguments);this.media=media;this.$media=$(media);this.document=media.ownerDocument;this.aspectRatios={"0/0":{label:_t("Free"),value:0},"16/9":{label:"16:9",value:16/9},"4/3":{label:"4:3",value:4/3},"1/1":{label:"1:1",value:1},"2/3":{label:"2:3",value:2/3},};const src=this.media.getAttribute('src');const data=Object.assign({},media.dataset);this.initialSrc=src;this.aspectRatio=data.aspectRatio||"0/0";this.mimetype=data.mimetype||src.endsWith('.png')?'image/png':'image/jpeg';},async willStart(){await this._super.apply(this,arguments);await loadImageInfo(this.media,this._rpc.bind(this));if(this.media.dataset.originalSrc){this.originalSrc=this.media.dataset.originalSrc;this.originalId=this.media.dataset.originalId;return;}
this.uncroppable=true;},async start(){if(this.uncroppable){this.displayNotification({type:'warning',title:_t("This image is an external image"),message:_t("This type of image is not supported for cropping.<br/>If you want to crop it, please first download it from the original source and upload it in Odoo."),});return this.destroy();}
const _super=this._super.bind(this);const $cropperWrapper=this.$('.o_we_cropper_wrapper');await loadImage(this.originalSrc,this.media);this.$cropperImage=this.$('.o_we_cropper_img');const cropperImage=this.$cropperImage[0];[cropperImage.style.width,cropperImage.style.height]=[this.$media.width()+'px',this.$media.height()+'px'];const offset=this.$media.offset();offset.left+=parseInt(this.$media.css('padding-left'));offset.top+=parseInt(this.$media.css('padding-right'));$cropperWrapper.offset(offset);await loadImage(this.originalSrc,cropperImage);await activateCropper(cropperImage,this.aspectRatios[this.aspectRatio].value,this.media.dataset);core.bus.trigger('deactivate_snippet');this._onDocumentMousedown=this._onDocumentMousedown.bind(this);this.document.addEventListener('mousedown',this._onDocumentMousedown,{capture:true});return _super(...arguments);},destroy(){if(this.$cropperImage){this.$cropperImage.cropper('destroy');this.document.removeEventListener('mousedown',this._onDocumentMousedown,{capture:true});}
this.media.setAttribute('src',this.initialSrc);return this._super(...arguments);},async _save(){this.media.classList.add('o_modified_image_to_save');[...cropperDataFields,'aspectRatio'].forEach(attr=>{delete this.media.dataset[attr];const value=this._getAttributeValue(attr);if(value){this.media.dataset[attr]=value;}});delete this.media.dataset.resizeWidth;this.initialSrc=await applyModifications(this.media);this.$media.trigger('image_cropped');this.destroy();},_getAttributeValue(attr){if(cropperDataFields.includes(attr)){return this.$cropperImage.cropper('getData')[attr];}
return this[attr];},_resetCropBox(){this.$cropperImage.cropper('clear');this.$cropperImage.cropper('crop');},_onCropOptionClick(ev){const{action,value,scaleDirection}=ev.currentTarget.dataset;switch(action){case'ratio':this.$cropperImage.cropper('reset');this.aspectRatio=value;this.$cropperImage.cropper('setAspectRatio',this.aspectRatios[this.aspectRatio].value);break;case'zoom':case'reset':this.$cropperImage.cropper(action,value);break;case'rotate':this.$cropperImage.cropper(action,value);this._resetCropBox();break;case'flip':{const amount=this.$cropperImage.cropper('getData')[scaleDirection]*-1;return this.$cropperImage.cropper(scaleDirection,amount);}
case'apply':return this._save();case'discard':return this.destroy();}},_onDocumentMousedown(ev){if(document.body.contains(ev.target)&&this.$(ev.target).length===0){return this.destroy();}},async _onCropZoom(){await new Promise(res=>setTimeout(res,0));this._resetCropBox();},});return ImageCropWidget;});;

/* /web_editor/static/src/js/wysiwyg/widgets/link_dialog.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.widgets.LinkDialog',function(require){'use strict';var core=require('web.core');var Dialog=require('wysiwyg.widgets.Dialog');var dom=$.summernote.core.dom;var range=$.summernote.core.range;var _t=core._t;var LinkDialog=Dialog.extend({template:'wysiwyg.widgets.link',xmlDependencies:(Dialog.prototype.xmlDependencies||[]).concat(['/web_editor/static/src/xml/wysiwyg.xml']),events:_.extend({},Dialog.prototype.events||{},{'input':'_onAnyChange','change [name="link_style_color"]':'_onTypeChange','change':'_onAnyChange','input input[name="url"]':'_onURLInput',}),init:function(parent,options,editable,linkInfo){this.options=options||{};this._super(parent,_.extend({title:_t("Link to"),},this.options));this.trigger_up('getRecordInfo',{recordInfo:this.options,callback:recordInfo=>{_.defaults(this.options,recordInfo);},});this.colorsData=[{type:'',label:_t("Link"),btnPreview:'link'},{type:'primary',label:_t("Primary"),btnPreview:'primary'},{type:'secondary',label:_t("Secondary"),btnPreview:'secondary'},];this.editable=editable;this.data=linkInfo||{};this.data.className="";this.data.iniClassName="";var r=this.data.range;this.needLabel=!r||(r.sc===r.ec&&r.so===r.eo);if(this.data.range){const $link=$(this.data.range.sc).filter("a");this.data.iniClassName=$link.attr("class")||"";this.colorCombinationClass=false;let $node=$link;while($node.length&&!$node.is('body')){const className=$node.attr('class')||'';const m=className.match(/\b(o_cc\d+)\b/g);if(m){this.colorCombinationClass=m[0];break;}
$node=$node.parent();}
this.data.className=this.data.iniClassName.replace(/(^|\s+)btn(-[a-z0-9_-]*)?/gi,' ');var is_link=this.data.range.isOnAnchor();var sc=r.sc;var so=r.so;var ec=r.ec;var eo=r.eo;var nodes;if(!is_link){if(sc.tagName){sc=dom.firstChild(so?sc.childNodes[so]:sc);so=0;}else if(so!==sc.textContent.length){if(sc===ec){ec=sc=sc.splitText(so);eo-=so;}else{sc=sc.splitText(so);}
so=0;}
if(ec.tagName){ec=dom.lastChild(eo?ec.childNodes[eo-1]:ec);eo=ec.textContent.length;}else if(eo!==ec.textContent.length){ec.splitText(eo);}
nodes=dom.listBetween(sc,ec);if(dom.isVoid(sc)||dom.isImg(sc)){so=dom.listPrev(sc).length-1;sc=sc.parentNode;}
if(dom.isBR(ec)){eo=dom.listPrev(ec).length-1;ec=ec.parentNode;}else if(dom.isVoid(ec)||dom.isImg(sc)){eo=dom.listPrev(ec).length;ec=ec.parentNode;}
this.data.range=range.create(sc,so,ec,eo);$(editable).data("range",this.data.range);this.data.range.select();}else{nodes=dom.ancestor(sc,dom.isAnchor).childNodes;}
if(dom.isImg(sc)&&nodes.indexOf(sc)===-1){nodes.push(sc);}
if(nodes.length>1||dom.ancestor(nodes[0],dom.isImg)){var text="";this.data.images=[];for(var i=0;i<nodes.length;i++){if(dom.ancestor(nodes[i],dom.isImg)){this.data.images.push(dom.ancestor(nodes[i],dom.isImg));text+='[IMG]';}else if(!is_link&&nodes[i].nodeType===1){}else if(!is_link&&i===0){text+=nodes[i].textContent.slice(so,Infinity);}else if(!is_link&&i===nodes.length-1){text+=nodes[i].textContent.slice(0,eo);}else{text+=nodes[i].textContent;}}
this.data.text=text;}}
this.data.text=this.data.text.replace(/[ \t\r\n]+/g,' ');var allBtnClassSuffixes=/(^|\s+)btn(-[a-z0-9_-]*)?/gi;var allBtnShapes=/\s*(rounded-circle|flat)\s*/gi;this.data.className=this.data.iniClassName.replace(allBtnClassSuffixes,' ').replace(allBtnShapes,' ');},start:function(){this.buttonOptsCollapseEl=this.el.querySelector('#o_link_dialog_button_opts_collapse');this.$styleInputs=this.$('input.link-style');this.$styleInputs.prop('checked',false).filter('[value=""]').prop('checked',true);if(this.data.iniClassName){_.each(this.$('input[name="link_style_color"], select[name="link_style_size"] > option, select[name="link_style_shape"] > option'),el=>{var $option=$(el);if($option.val()&&this.data.iniClassName.match(new RegExp('(^|btn-| |btn-outline-)'+$option.val()))){if($option.is("input")){$option.prop("checked",true);}else{$option.parent().find('option').removeAttr('selected').removeProp('selected');$option.parent().val($option.val());$option.attr('selected','selected').prop('selected','selected');}}});}
if(this.data.url){var match=/mailto:(.+)/.exec(this.data.url);this.$('input[name="url"]').val(match?match[1]:this.data.url);this._onURLInput();}
this._updateOptionsUI();this._adaptPreview();this.$('input:visible:first').focus();return this._super.apply(this,arguments);},save:function(){var data=this._getData();if(data===null){var $url=this.$('input[name="url"]');$url.closest('.form-group').addClass('o_has_error').find('.form-control, .custom-select').addClass('is-invalid');$url.focus();return Promise.reject();}
this.data.text=data.label;this.data.url=data.url;var allWhitespace=/\s+/gi;var allStartAndEndSpace=/^\s+|\s+$/gi;var allBtnTypes=/(^|[ ])(btn-secondary|btn-success|btn-primary|btn-info|btn-warning|btn-danger)([ ]|$)/gi;this.data.className=data.classes.replace(allWhitespace,' ').replace(allStartAndEndSpace,'');if(data.classes.replace(allBtnTypes,' ')){this.data.style={'background-color':'','color':'',};}
this.data.isNewWindow=data.isNewWindow;this.final_data=this.data;return this._super.apply(this,arguments);},_adaptPreview:function(){var data=this._getData();if(data===null){return;}
const attrs={target:data.isNewWindow?'_blank':'',href:data.url&&data.url.length?data.url:'#',class:`${data.classes.replace(/float-\w+/, '')} o_btn_preview`,};this.$("#link-preview").attr(attrs).html((data.label&&data.label.length)?data.label:data.url);},_getData:function(){var $url=this.$('input[name="url"]');var url=$url.val();var label=this.$('input[name="label"]').val()||url;if(label&&this.data.images){for(var i=0;i<this.data.images.length;i++){label=label.replace('<',"&lt;").replace('>',"&gt;").replace(/\[IMG\]/,this.data.images[i].outerHTML);}}
if($url.prop('required')&&(!url||!$url[0].checkValidity())){return null;}
const type=this.$('input[name="link_style_color"]:checked').val()||'';const size=this.$('select[name="link_style_size"]').val()||'';const shape=this.$('select[name="link_style_shape"]').val()||'';const shapes=shape?shape.split(','):[];const style=['outline','fill'].includes(shapes[0])?`${shapes[0]}-`:'';const shapeClasses=shapes.slice(style?1:0).join(' ');const classes=(this.data.className||'')+
(type?(` btn btn-${style}${type}`):'')+
(shapeClasses?(` ${shapeClasses}`):'')+
(size?(' btn-'+size):'');var isNewWindow=this.$('input[name="is_new_window"]').prop('checked');if(url.indexOf('@')>=0&&url.indexOf('mailto:')<0&&!url.match(/^http[s]?/i)){url=('mailto:'+url);}else if(url.indexOf(location.origin)===0&&this.$('#o_link_dialog_url_strip_domain').prop("checked")){url=url.slice(location.origin.length);}
var allWhitespace=/\s+/gi;var allStartAndEndSpace=/^\s+|\s+$/gi;return{label:label,url:url,classes:classes.replace(allWhitespace,' ').replace(allStartAndEndSpace,''),isNewWindow:isNewWindow,};},_updateOptionsUI:function(){const el=this.el.querySelector('[name="link_style_color"]:checked');$(this.buttonOptsCollapseEl).collapse(el&&el.value?'show':'hide');},_onAnyChange:function(){this._adaptPreview();},_onTypeChange(){this._updateOptionsUI();},_onURLInput:function(){var $linkUrlInput=this.$('#o_link_dialog_url_input');$linkUrlInput.closest('.form-group').removeClass('o_has_error').find('.form-control, .custom-select').removeClass('is-invalid');let value=$linkUrlInput.val();let isLink=value.indexOf('@')<0;this.$('input[name="is_new_window"]').closest('.form-group').toggleClass('d-none',!isLink);this.$('.o_strip_domain').toggleClass('d-none',value.indexOf(window.location.origin)!==0);},});return LinkDialog;});;

/* /web_editor/static/src/js/wysiwyg/widgets/media_dialog.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.widgets.MediaDialog',function(require){'use strict';var core=require('web.core');var MediaModules=require('wysiwyg.widgets.media');var Dialog=require('wysiwyg.widgets.Dialog');var _t=core._t;var MediaDialog=Dialog.extend({template:'wysiwyg.widgets.media',xmlDependencies:Dialog.prototype.xmlDependencies.concat(['/web_editor/static/src/xml/wysiwyg.xml']),events:_.extend({},Dialog.prototype.events,{'click #editor-media-image-tab':'_onClickImageTab','click #editor-media-document-tab':'_onClickDocumentTab','click #editor-media-icon-tab':'_onClickIconTab','click #editor-media-video-tab':'_onClickVideoTab',}),custom_events:_.extend({},Dialog.prototype.custom_events||{},{save_request:'_onSaveRequest',show_parent_dialog_request:'_onShowRequest',hide_parent_dialog_request:'_onHideRequest',}),init:function(parent,options,media){var $media=$(media);media=$media[0];options=_.extend({},options);var onlyImages=options.onlyImages||this.multiImages||(media&&($media.parent().data('oeField')==='image'||$media.parent().data('oeType')==='image'));options.noDocuments=onlyImages||options.noDocuments;options.noIcons=onlyImages||options.noIcons;options.noVideos=onlyImages||options.noVideos;this._super(parent,_.extend({},{title:_t("Select a Media"),save_text:_t("Add"),},options));this.trigger_up('getRecordInfo',{recordInfo:options,type:'media',callback:function(recordInfo){_.defaults(options,recordInfo);},});if(!options.noImages){this.imageWidget=new MediaModules.ImageWidget(this,media,options);}
if(!options.noDocuments){this.documentWidget=new MediaModules.DocumentWidget(this,media,options);}
if(!options.noIcons){this.iconWidget=new MediaModules.IconWidget(this,media,options);}
if(!options.noVideos){this.videoWidget=new MediaModules.VideoWidget(this,media,options);}
if(this.imageWidget&&$media.is('img')){this.activeWidget=this.imageWidget;}else if(this.documentWidget&&$media.is('a.o_image')){this.activeWidget=this.documentWidget;}else if(this.videoWidget&&$media.is('.media_iframe_video, .o_bg_video_iframe')){this.activeWidget=this.videoWidget;}else if(this.iconWidget&&$media.is('span, i')){this.activeWidget=this.iconWidget;}else{this.activeWidget=[this.imageWidget,this.documentWidget,this.videoWidget,this.iconWidget].find(w=>!!w);}},start:function(){var promises=[this._super.apply(this,arguments)];this.$modal.find('.modal-dialog').addClass('o_select_media_dialog');if(this.imageWidget){promises.push(this.imageWidget.appendTo(this.$("#editor-media-image")));}
if(this.documentWidget){promises.push(this.documentWidget.appendTo(this.$("#editor-media-document")));}
if(this.iconWidget){promises.push(this.iconWidget.appendTo(this.$("#editor-media-icon")));}
if(this.videoWidget){promises.push(this.videoWidget.appendTo(this.$("#editor-media-video")));}
this.opened(()=>this.$('input.o_we_search:visible:first').focus());return Promise.all(promises);},isDocumentActive:function(){return this.activeWidget===this.documentWidget;},isIconActive:function(){return this.activeWidget===this.iconWidget;},isImageActive:function(){return this.activeWidget===this.imageWidget;},isVideoActive:function(){return this.activeWidget===this.videoWidget;},save:function(){var self=this;var _super=this._super;var args=arguments;return this.activeWidget.save().then(function(data){self._clearWidgets();self.final_data=data;_super.apply(self,args);$(data).trigger('content_changed');});},_clearWidgets:function(){[this.imageWidget,this.documentWidget,this.iconWidget,this.videoWidget].forEach((widget)=>{if(widget!==this.activeWidget){widget&&widget.clear();}});},_onClickDocumentTab:function(){this.activeWidget=this.documentWidget;},_onClickIconTab:function(){this.activeWidget=this.iconWidget;},_onClickImageTab:function(){this.activeWidget=this.imageWidget;},_onClickVideoTab:function(){this.activeWidget=this.videoWidget;},_onHideRequest:function(ev){this.$modal.addClass('d-none');},_onSaveRequest:function(ev){ev.stopPropagation();this.save();},_onShowRequest:function(ev){this.$modal.removeClass('d-none');},});return MediaDialog;});;

/* /web_editor/static/src/js/wysiwyg/widgets/widgets.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('wysiwyg.widgets',function(require){'use strict';var Dialog=require('wysiwyg.widgets.Dialog');var AltDialog=require('wysiwyg.widgets.AltDialog');var MediaDialog=require('wysiwyg.widgets.MediaDialog');var LinkDialog=require('wysiwyg.widgets.LinkDialog');var ImageCropWidget=require('wysiwyg.widgets.ImageCropWidget');const{ColorpickerDialog}=require('web.Colorpicker');var media=require('wysiwyg.widgets.media');return{Dialog:Dialog,AltDialog:AltDialog,MediaDialog:MediaDialog,LinkDialog:LinkDialog,ImageCropWidget:ImageCropWidget,ColorpickerDialog:ColorpickerDialog,MediaWidget:media.MediaWidget,SearchableMediaWidget:media.SearchableMediaWidget,FileWidget:media.FileWidget,ImageWidget:media.ImageWidget,DocumentWidget:media.DocumentWidget,IconWidget:media.IconWidget,VideoWidget:media.VideoWidget,};});;

/* /web_editor/static/src/js/editor/snippets.editor.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.snippet.editor',function(require){'use strict';var concurrency=require('web.concurrency');var core=require('web.core');var Dialog=require('web.Dialog');var dom=require('web.dom');var Widget=require('web.Widget');var options=require('web_editor.snippets.options');var Wysiwyg=require('web_editor.wysiwyg');const{ColorPaletteWidget}=require('web_editor.ColorPalette');const SmoothScrollOnDrag=require('web/static/src/js/core/smooth_scroll_on_drag.js');const{getCSSVariableValue}=require('web_editor.utils');var _t=core._t;var globalSelector={closest:()=>$(),all:()=>$(),is:()=>false,};var SnippetEditor=Widget.extend({template:'web_editor.snippet_overlay',xmlDependencies:['/web_editor/static/src/xml/snippets.xml'],events:{'click .oe_snippet_remove':'_onRemoveClick','wheel':'_onMouseWheel',},custom_events:{'option_update':'_onOptionUpdate','user_value_widget_request':'_onUserValueWidgetRequest','snippet_option_update':'_onSnippetOptionUpdate','snippet_option_visibility_update':'_onSnippetOptionVisibilityUpdate',},init:function(parent,target,templateOptions,$editable,options){this._super.apply(this,arguments);this.options=options;this.$editable=$editable;this.ownerDocument=this.$editable[0].ownerDocument;this.$body=$(this.ownerDocument.body);this.$target=$(target);this.$target.data('snippet-editor',this);this.templateOptions=templateOptions;this.isTargetParentEditable=false;this.isTargetMovable=false;this.__isStarted=new Promise(resolve=>{this.__isStartedResolveFunc=resolve;});},start:function(){var defs=[this._super.apply(this,arguments)];defs.push(this._initializeOptions());var $customize=this._customize$Elements[this._customize$Elements.length-1];this.isTargetParentEditable=this.$target.parent().is(':o_editable');this.isTargetMovable=this.isTargetParentEditable&&this.isTargetMovable;this.isTargetRemovable=this.isTargetParentEditable&&!this.$target.parent().is('[data-oe-type="image"]');if(this.isTargetMovable){this.dropped=false;const smoothScrollOptions=this.options.getScrollOptions({jQueryDraggableOptions:{cursorAt:{left:10,top:10},handle:'.o_move_handle',helper:()=>{var $clone=this.$el.clone().css({width:'24px',height:'24px',border:0});$clone.appendTo(this.$body).removeClass('d-none');return $clone;},start:this._onDragAndDropStart.bind(this),stop:(...args)=>{setTimeout(()=>{this._onDragAndDropStop(...args);},0);},},});this.draggableComponent=new SmoothScrollOnDrag(this,this.$el,$().getScrollingElement(),smoothScrollOptions);}else{this.$('.o_overlay_move_options').addClass('d-none');$customize.find('.oe_snippet_clone').addClass('d-none');}
if(!this.isTargetRemovable){this.$el.add($customize).find('.oe_snippet_remove').addClass('d-none');}
var _animationsCount=0;var postAnimationCover=_.throttle(()=>this.cover(),100);this.$target.on('transitionstart.snippet_editor, animationstart.snippet_editor',()=>{_animationsCount++;setTimeout(()=>{if(!--_animationsCount){postAnimationCover();}},500);});this.$target.on('transitionend.snippet_editor, animationend.snippet_editor',postAnimationCover);return Promise.all(defs).then(()=>{this.__isStartedResolveFunc(this);});},destroy:function(){this.trigger_up('snippet_editor_destroyed');this._super(...arguments);this.$target.removeData('snippet-editor');this.$target.off('.snippet_editor');},areOptionsShown:function(){const lastIndex=this._customize$Elements.length-1;return!!this._customize$Elements[lastIndex].parent().length;},buildSnippet:async function(){for(var i in this.styles){this.styles[i].onBuilt();}
await this.toggleTargetVisibility(true);},cleanForSave:async function(){if(this.isDestroyed()){return;}
await this.toggleTargetVisibility(!this.$target.hasClass('o_snippet_invisible'));const proms=_.map(this.styles,option=>{return option.cleanForSave();});await Promise.all(proms);},closeWidgets:function(){if(!this.styles||!this.areOptionsShown()){return;}
Object.keys(this.styles).forEach(key=>{this.styles[key].closeWidgets();});},cover:function(){if(!this.isShown()||!this.$target.length){return;}
const $modal=this.$target.find('.modal');const $target=$modal.length?$modal:this.$target;const targetEl=$target[0];const rect=targetEl.getBoundingClientRect();const vpWidth=window.innerWidth||document.documentElement.clientWidth;const vpHeight=window.innerHeight||document.documentElement.clientHeight;const isInViewport=(rect.bottom>-0.1&&rect.right>-0.1&&(vpHeight-rect.top)>-0.1&&(vpWidth-rect.left)>-0.1);const hasSize=(Math.abs(rect.bottom-rect.top)>0.01&&Math.abs(rect.right-rect.left)>0.01);if(!isInViewport||!hasSize||!this.$target.is(`:visible`)){this.toggleOverlayVisibility(false);return;}
const offset=$target.offset();var manipulatorOffset=this.$el.parent().offset();offset.top-=manipulatorOffset.top;offset.left-=manipulatorOffset.left;this.$el.css({width:$target.outerWidth(),left:offset.left,top:offset.top,});this.$('.o_handles').css('height',$target.outerHeight());const editableOffsetTop=this.$editable.offset().top-manipulatorOffset.top;this.$el.toggleClass('o_top_cover',offset.top-editableOffsetTop<25);},getName:function(){if(this.$target.data('name')!==undefined){return this.$target.data('name');}
if(this.$target.is('img')){return _t("Image");}
if(this.$target.parent('.row').length){return _t("Column");}
return _t("Block");},isShown:function(){return this.$el&&this.$el.parent().length&&this.$el.hasClass('oe_active');},isSticky:function(){return this.$el&&this.$el.hasClass('o_we_overlay_sticky');},isTargetVisible:function(){return(this.$target[0].dataset.invisible!=='1');},removeSnippet:async function(){this.toggleOverlay(false);this.toggleOptions(false);await new Promise(resolve=>{this.trigger_up('call_for_each_child_snippet',{$snippet:this.$target,callback:function(editor,$snippet){for(var i in editor.styles){editor.styles[i].onRemove();}
resolve();},});});this.trigger_up('go_to_parent',{$snippet:this.$target});var $parent=this.$target.parent();this.$target.find('*').addBack().tooltip('dispose');this.$target.remove();this.$el.remove();var node=$parent[0];if(node&&node.firstChild){if(!node.firstChild.tagName&&node.firstChild.textContent===' '){node.removeChild(node.firstChild);}}
if($parent.closest(':data("snippet-editor")').length){var editor=$parent.data('snippet-editor');while(!editor){var $nextParent=$parent.parent();if(isEmptyAndRemovable($parent)){$parent.remove();}
$parent=$nextParent;editor=$parent.data('snippet-editor');}
if(isEmptyAndRemovable($parent,editor)){setTimeout(()=>editor.removeSnippet());}}
this.$body.find('.note-control-selection').hide();this.$body.find('.o_table_handler').remove();this.trigger_up('snippet_removed');this.destroy();$parent.trigger('content_changed');function isEmptyAndRemovable($el,editor){editor=editor||$el.data('snippet-editor');return $el.children().length===0&&$el.text().trim()===''&&!$el.hasClass('oe_structure')&&(!editor||editor.isTargetParentEditable);}},toggleOverlay:function(show,previewMode){if(!this.$el){return;}
if(previewMode){this.$el.toggleClass('o_we_overlay_preview',show);}else{this.$el.removeClass('o_we_overlay_preview');this.$el.toggleClass('o_we_overlay_sticky',show);}
this.$el.toggleClass('oe_active',show);this.cover();},toggleOptions:function(show){if(!this.$el){return;}
if(this.areOptionsShown()===show){return;}
this.trigger_up('update_customize_elements',{customize$Elements:show?this._customize$Elements:[],});this._customize$Elements.forEach(($el,i)=>{const editor=$el.data('editor');const styles=_.chain(editor.styles).values().sortBy('__order').value();if(show){styles.forEach(style=>style.onFocus());styles.forEach(style=>style.updateUI());}else{styles.forEach(style=>style.onBlur());}});},toggleTargetVisibility:async function(show){show=this._toggleVisibilityStatus(show);var styles=_.values(this.styles);const proms=_.sortBy(styles,'__order').map(style=>{return show?style.onTargetShow():style.onTargetHide();});await Promise.all(proms);return show;},toggleOverlayVisibility:function(show){if(this.$el&&!this.scrollingTimeout){this.$el.toggleClass('o_overlay_hidden',!show&&this.isShown());}},clone:async function(recordUndo){this.trigger_up('snippet_will_be_cloned',{$target:this.$target});var $clone=this.$target.clone(false);if(recordUndo){this.trigger_up('request_history_undo_record',{$target:this.$target});}
this.$target.after($clone);await new Promise(resolve=>{this.trigger_up('call_for_each_child_snippet',{$snippet:$clone,callback:function(editor,$snippet){for(var i in editor.styles){editor.styles[i].onClone({isCurrent:($snippet.is($clone)),});}
resolve();},});});this.trigger_up('snippet_cloned',{$target:$clone,$origin:this.$target});$clone.trigger('content_changed');},_initializeOptions:function(){this._customize$Elements=[];this.styles={};this.selectorSiblings=[];this.selectorChildren=[];var $element=this.$target.parent();while($element.length){var parentEditor=$element.data('snippet-editor');if(parentEditor){this._customize$Elements=this._customize$Elements.concat(parentEditor._customize$Elements);break;}
$element=$element.parent();}
var $optionsSection=$(core.qweb.render('web_editor.customize_block_options_section',{name:this.getName(),})).data('editor',this);const $optionsSectionBtnGroup=$optionsSection.find('we-top-button-group');$optionsSectionBtnGroup.contents().each((i,node)=>{if(node.nodeType===Node.TEXT_NODE){node.parentNode.removeChild(node);}});$optionsSection.on('mouseenter',this._onOptionsSectionMouseEnter.bind(this));$optionsSection.on('mouseleave',this._onOptionsSectionMouseLeave.bind(this));$optionsSection.on('click','we-title > span',this._onOptionsSectionClick.bind(this));$optionsSection.on('click','.oe_snippet_clone',this._onCloneClick.bind(this));$optionsSection.on('click','.oe_snippet_remove',this._onRemoveClick.bind(this));this._customize$Elements.push($optionsSection);this.$el.data('$optionsSection',$optionsSection);var i=0;var defs=_.map(this.templateOptions,val=>{if(!val.selector.is(this.$target)){return;}
if(val['drop-near']){this.selectorSiblings.push(val['drop-near']);}
if(val['drop-in']){this.selectorChildren.push(val['drop-in']);}
var optionName=val.option;var option=new(options.registry[optionName]||options.Class)(this,val.$el.children(),val.base_target?this.$target.find(val.base_target).eq(0):this.$target,this.$el,_.extend({optionName:optionName,snippetName:this.getName(),},val.data),this.options);var key=optionName||_.uniqueId('option');if(this.styles[key]){key=_.uniqueId(key);}
this.styles[key]=option;option.__order=i++;if(option.forceNoDeleteButton){this.$el.add($optionsSection).find('.oe_snippet_remove').addClass('d-none');}
return option.appendTo(document.createDocumentFragment());});this.isTargetMovable=(this.selectorSiblings.length>0||this.selectorChildren.length>0);this.$el.find('[data-toggle="dropdown"]').dropdown();return Promise.all(defs).then(()=>{const options=_.sortBy(this.styles,'__order');options.forEach(option=>{if(option.isTopOption){$optionsSectionBtnGroup.prepend(option.$el);}else{$optionsSection.append(option.$el);}});$optionsSection.toggleClass('d-none',options.length===0);});},_toggleVisibilityStatus:function(show){if(show===undefined){show=!this.isTargetVisible();}
if(show){delete this.$target[0].dataset.invisible;}else{this.$target[0].dataset.invisible='1';}
return show;},_onCloneClick:function(ev){ev.preventDefault();this.clone(true);},_onDragAndDropStart:function(){var self=this;this.dropped=false;self.size={width:self.$target.width(),height:self.$target.height()};self.$target.after('<div class="oe_drop_clone" style="display: none;"/>');self.$target.detach();self.$el.addClass('d-none');var $selectorSiblings;for(var i=0;i<self.selectorSiblings.length;i++){if(!$selectorSiblings){$selectorSiblings=self.selectorSiblings[i].all();}else{$selectorSiblings=$selectorSiblings.add(self.selectorSiblings[i].all());}}
var $selectorChildren;for(i=0;i<self.selectorChildren.length;i++){if(!$selectorChildren){$selectorChildren=self.selectorChildren[i].all();}else{$selectorChildren=$selectorChildren.add(self.selectorChildren[i].all());}}
this.trigger_up('go_to_parent',{$snippet:this.$target});this.trigger_up('activate_insertion_zones',{$selectorSiblings:$selectorSiblings,$selectorChildren:$selectorChildren,});this.$body.addClass('move-important');this.$editable.find('.oe_drop_zone').droppable({over:function(){self.$editable.find('.oe_drop_zone.hide').removeClass('hide');$(this).addClass('hide').first().after(self.$target);self.dropped=true;},out:function(){$(this).removeClass('hide');self.$target.detach();self.dropped=false;},});},_onDragAndDropStop:function(ev,ui){if(!this.dropped){var $el=$.nearest({x:ui.position.left,y:ui.position.top},'.oe_drop_zone',{container:document.body}).first();if($el.length){$el.after(this.$target);this.dropped=true;}}
this.$editable.find('.oe_drop_zone').droppable('destroy').remove();var prev=this.$target.first()[0].previousSibling;var next=this.$target.last()[0].nextSibling;var $parent=this.$target.parent();var $clone=this.$editable.find('.oe_drop_clone');if(prev===$clone[0]){prev=$clone[0].previousSibling;}else if(next===$clone[0]){next=$clone[0].nextSibling;}
$clone.after(this.$target);var $from=$clone.parent();this.$el.removeClass('d-none');this.$body.removeClass('move-important');$clone.remove();if(this.dropped){this.trigger_up('request_history_undo_record',{$target:this.$target});if(prev){this.$target.insertAfter(prev);}else if(next){this.$target.insertBefore(next);}else{$parent.prepend(this.$target);}
for(var i in this.styles){this.styles[i].onMove();}
this.$target.trigger('content_changed');$from.trigger('content_changed');}
this.trigger_up('drag_and_drop_stop',{$snippet:this.$target,});},_onOptionsSectionMouseEnter:function(ev){if(!this.$target.is(':visible')){return;}
this.trigger_up('activate_snippet',{$snippet:this.$target,previewMode:true,});},_onOptionsSectionMouseLeave:function(ev){this.trigger_up('activate_snippet',{$snippet:false,previewMode:true,});},_onOptionsSectionClick:function(ev){this.trigger_up('activate_snippet',{$snippet:this.$target,previewMode:false,});},_onOptionUpdate:function(ev){var self=this;if(ev.data.optionNames){ev.stopPropagation();_.each(ev.data.optionNames,function(name){notifyForEachMatchedOption(name);});}
if(ev.data.optionName){if(notifyForEachMatchedOption(ev.data.optionName)){ev.stopPropagation();}}
function notifyForEachMatchedOption(name){var regex=new RegExp('^'+name+'\\d+$');var hasOption=false;for(var key in self.styles){if(key===name||regex.test(key)){self.styles[key].notify(ev.data.name,ev.data.data);hasOption=true;}}
return hasOption;}},_onRemoveClick:function(ev){ev.preventDefault();ev.stopPropagation();this.trigger_up('request_history_undo_record',{$target:this.$target});this.removeSnippet();},_onSnippetOptionUpdate:async function(ev){const proms1=Object.keys(this.styles).map(key=>{return this.styles[key].updateUI({noVisibility:true,});});await Promise.all(proms1);const proms2=Object.keys(this.styles).map(key=>{return this.styles[key].updateUIVisibility();});await Promise.all(proms2);ev.data.onSuccess();},_onSnippetOptionVisibilityUpdate:function(ev){ev.data.show=this._toggleVisibilityStatus(ev.data.show);},_onUserValueWidgetRequest:function(ev){ev.stopPropagation();for(const key of Object.keys(this.styles)){const widget=this.styles[key].findWidget(ev.data.name);if(widget){ev.data.onSuccess(widget);return;}}},_onMouseWheel:function(ev){ev.stopPropagation();this.$el.css('pointer-events','none');clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(()=>{this.$el.css('pointer-events','');},250);},});var SnippetsMenu=Widget.extend({id:'oe_snippets',cacheSnippetTemplate:{},events:{'click .o_install_btn':'_onInstallBtnClick','click .o_we_add_snippet_btn':'_onBlocksTabClick','click .o_we_invisible_entry':'_onInvisibleEntryClick','click #snippet_custom .o_delete_btn':'_onDeleteBtnClick','mousedown':'_onMouseDown','input .o_snippet_search_filter_input':'_onSnippetSearchInput','click .o_snippet_search_filter_reset':'_onSnippetSearchResetClick','summernote_popover_update_call .o_we_snippet_text_tools':'_onSummernoteToolsUpdate',},custom_events:{'activate_insertion_zones':'_onActivateInsertionZones','activate_snippet':'_onActivateSnippet','call_for_each_child_snippet':'_onCallForEachChildSnippet','clone_snippet':'_onCloneSnippet','cover_update':'_onOverlaysCoverUpdate','deactivate_snippet':'_onDeactivateSnippet','drag_and_drop_stop':'_onDragAndDropStop','get_snippet_versions':'_onGetSnippetVersions','go_to_parent':'_onGoToParent','remove_snippet':'_onRemoveSnippet','snippet_edition_request':'_onSnippetEditionRequest','snippet_editor_destroyed':'_onSnippetEditorDestroyed','snippet_removed':'_onSnippetRemoved','snippet_cloned':'_onSnippetCloned','snippet_option_visibility_update':'_onSnippetOptionVisibilityUpdate','snippet_thumbnail_url_request':'_onSnippetThumbnailURLRequest','reload_snippet_dropzones':'_disableUndroppableSnippets','request_save':'_onSaveRequest','update_customize_elements':'_onUpdateCustomizeElements','hide_overlay':'_onHideOverlay','block_preview_overlays':'_onBlockPreviewOverlays','unblock_preview_overlays':'_onUnblockPreviewOverlays','user_value_widget_opening':'_onUserValueWidgetOpening','user_value_widget_closing':'_onUserValueWidgetClosing','reload_snippet_template':'_onReloadSnippetTemplate',},tabs:{BLOCKS:'blocks',OPTIONS:'options',},init:function(parent,options){this._super.apply(this,arguments);options=options||{};this.trigger_up('getRecordInfo',{recordInfo:options,callback:function(recordInfo){_.defaults(options,recordInfo);},});this.options=options;if(!this.options.snippets){this.options.snippets='web_editor.snippets';}
this.snippetEditors=[];this._enabledEditorHierarchy=[];this._mutex=new concurrency.Mutex();this.setSelectorEditableArea(options.$el,options.selectorEditableArea);this._notActivableElementsSelector=['#web_editor-top-edit','.o_we_website_top_actions','#oe_snippets','#oe_manipulators','.o_technical_modal','.oe_drop_zone','.o_notification_manager','.o_we_no_overlay','.ui-autocomplete','.modal .close','.o_we_crop_widget',].join(', ');this.loadingTimers={};this.loadingElements={};},willStart:function(){ColorPaletteWidget.loadDependencies(this);return this._super(...arguments);},async start(){var defs=[this._super.apply(this,arguments)];this.ownerDocument=this.$el[0].ownerDocument;this.$document=$(this.ownerDocument);this.window=this.ownerDocument.defaultView;this.$window=$(this.window);this.customizePanel=document.createElement('div');this.customizePanel.classList.add('o_we_customize_panel','d-none');this.textEditorPanelEl=document.createElement('div');this.textEditorPanelEl.classList.add('o_we_snippet_text_tools','d-none');this.invisibleDOMPanelEl=document.createElement('div');this.invisibleDOMPanelEl.classList.add('o_we_invisible_el_panel');this.invisibleDOMPanelEl.appendChild($('<div/>',{text:_t('Invisible Elements'),class:'o_panel_header',})[0]);this.options.getScrollOptions=this._getScrollOptions.bind(this);defs.push((async()=>{await this._loadSnippetsTemplates();await this._updateInvisibleDOM();})());this.$snippetEditorArea=$('<div/>',{id:'oe_manipulators',}).insertAfter(this.$el);var lastElement;this.$document.on('click.snippets_menu','*',ev=>{var srcElement=ev.target||(ev.originalEvent&&(ev.originalEvent.target||ev.originalEvent.originalTarget))||ev.srcElement;if(!srcElement||lastElement===srcElement){return;}
lastElement=srcElement;_.defer(function(){lastElement=false;});var $target=$(srcElement);if(!$target.closest('we-button, we-toggler, .o_we_color_preview').length){this._closeWidgets();}
if(!$target.closest('body > *').length){return;}
if($target.closest(this._notActivableElementsSelector).length){return;}
this._activateSnippet($target);});core.bus.on('deactivate_snippet',this,this._onDeactivateSnippet);var debouncedCoverUpdate=_.throttle(()=>{this.updateCurrentSnippetEditorOverlay();},50);this.$window.on('resize.snippets_menu',debouncedCoverUpdate);this.$window.on('content_changed.snippets_menu',debouncedCoverUpdate);this.$document.on('keydown.snippets_menu',()=>{this.__overlayKeyWasDown=true;this.snippetEditors.forEach(editor=>{editor.toggleOverlayVisibility(false);});});this.$document.on('mousemove.snippets_menu, mousedown.snippets_menu',_.throttle(()=>{if(!this.__overlayKeyWasDown){return;}
this.__overlayKeyWasDown=false;this.snippetEditors.forEach(editor=>{editor.toggleOverlayVisibility(true);editor.cover();});},250));this.$scrollingElement=$().getScrollingElement();this.$scrollingElement.on('scroll.snippets_menu',_.throttle(()=>{for(const editor of this.snippetEditors){editor.toggleOverlayVisibility(false);}
clearTimeout(this.scrollingTimeout);this.scrollingTimeout=setTimeout(()=>{this._scrollingTimeout=null;for(const editor of this.snippetEditors){editor.toggleOverlayVisibility(true);editor.cover();}},250);},50));this.$document.on('click.snippets_menu','.o_default_snippet_text',function(ev){$(ev.target).closest('.o_default_snippet_text').removeClass('o_default_snippet_text');$(ev.target).selectContent();$(ev.target).removeClass('o_default_snippet_text');});this.$document.on('keyup.snippets_menu',function(){var range=Wysiwyg.getRange(this);$(range&&range.sc).closest('.o_default_snippet_text').removeClass('o_default_snippet_text');});const $autoFocusEls=$('.o_we_snippet_autofocus');this._activateSnippet($autoFocusEls.length?$autoFocusEls.first():false);this.$el.tooltip({selector:'we-title',placement:'bottom',delay:100,title:function(){const el=this;el.style.setProperty('overflow','scroll','important');const tipContent=el.scrollWidth>el.clientWidth?el.innerHTML:'';el.style.removeProperty('overflow');return tipContent;},});return Promise.all(defs).then(()=>{this.$('[data-title]').tooltip({delay:100,title:function(){return this.classList.contains('active')?false:this.dataset.title;},});setTimeout(()=>{this.$window.trigger('resize');this._mutex.exec(()=>this._textToolsSwitchingEnabled=true);},1000);});},destroy:function(){this._super.apply(this,arguments);if(this.$window){this.$snippetEditorArea.remove();this.$window.off('.snippets_menu');this.$document.off('.snippets_menu');this.$scrollingElement.off('.snippets_menu');}
core.bus.off('deactivate_snippet',this,this._onDeactivateSnippet);delete this.cacheSnippetTemplate[this.options.snippets];},cleanForSave:async function(){await this._activateSnippet(false);this.trigger_up('ready_to_clean_for_save');await this._destroyEditors();this.getEditableArea().find('[contentEditable]').removeAttr('contentEditable').removeProp('contentEditable');this.getEditableArea().find('.o_we_selected_image').removeClass('o_we_selected_image');},loadSnippets:function(invalidateCache){if(!invalidateCache&&this.cacheSnippetTemplate[this.options.snippets]){this._defLoadSnippets=this.cacheSnippetTemplate[this.options.snippets];return this._defLoadSnippets;}
this._defLoadSnippets=this._rpc({model:'ir.ui.view',method:'render_public_asset',args:[this.options.snippets,{}],kwargs:{context:this.options.context,},});this.cacheSnippetTemplate[this.options.snippets]=this._defLoadSnippets;return this._defLoadSnippets;},setSelectorEditableArea:function($editor,selectorEditableArea){this.selectorEditableArea=selectorEditableArea;this.$editor=$editor;this.$body=$editor.closest('body');},getEditableArea:function(){return this.$editor.find(this.selectorEditableArea).add(this.$editor.filter(this.selectorEditableArea));},updateCurrentSnippetEditorOverlay:function(){for(const snippetEditor of this.snippetEditors){if(snippetEditor.$target.closest('body').length){snippetEditor.cover();continue;}
this._mutex.exec(()=>snippetEditor.destroy());}},_activateInsertionZones:function($selectorSiblings,$selectorChildren){var self=this;function isFullWidth($elem){return $elem.parent().width()===$elem.outerWidth(true);}
if($selectorChildren){$selectorChildren.each(function(){var $zone=$(this);var style;var vertical;var node;var css=self.window.getComputedStyle(this);var parentCss=self.window.getComputedStyle($zone.parent()[0]);var float=css.float||css.cssFloat;var parentDisplay=parentCss.display;var parentFlex=parentCss.flexDirection;style={};vertical=false;node=$zone[0].lastChild;var test=!!(node&&((!node.tagName&&node.textContent.match(/\S/))||node.tagName==='BR'));if(test){vertical=true;style['float']='none';style['height']=parseInt(self.window.getComputedStyle($zone[0]).lineHeight)+'px';style['display']='inline-block';}else if(float==='left'||float==='right'||(parentDisplay==='flex'&&parentFlex==='row')){style['float']=float;if(!isFullWidth($zone)&&!$zone.hasClass('oe_structure')){vertical=true;style['height']=Math.max($zone.outerHeight(),30)+'px';}}
self._insertDropzone($('<we-hook/>').appendTo($zone),vertical,style);style={};vertical=false;node=$zone[0].firstChild;test=!!(node&&((!node.tagName&&node.textContent.match(/\S/))||node.tagName==='BR'));if(test){vertical=true;style['float']='none';style['height']=parseInt(self.window.getComputedStyle($zone[0]).lineHeight)+'px';style['display']='inline-block';}else if(float==='left'||float==='right'||(parentDisplay==='flex'&&parentFlex==='row')){style['float']=float;if(!isFullWidth($zone)&&!$zone.hasClass('oe_structure')){vertical=true;style['height']=Math.max($zone.outerHeight(),30)+'px';}}
self._insertDropzone($('<we-hook/>').prependTo($zone),vertical,style);});$selectorSiblings=$(_.uniq(($selectorSiblings||$()).add($selectorChildren.children()).get()));}
if($selectorSiblings){$selectorSiblings.filter(':not(.oe_drop_zone):not(.oe_drop_clone)').each(function(){var $zone=$(this);var style;var vertical;var css=self.window.getComputedStyle(this);var parentCss=self.window.getComputedStyle($zone.parent()[0]);var float=css.float||css.cssFloat;var parentDisplay=parentCss.display;var parentFlex=parentCss.flexDirection;if($zone.prev('.oe_drop_zone:visible').length===0){style={};vertical=false;if(float==='left'||float==='right'||(parentDisplay==='flex'&&parentFlex==='row')){style['float']=float;if(!isFullWidth($zone)){vertical=true;style['height']=Math.max($zone.outerHeight(),30)+'px';}}
self._insertDropzone($('<we-hook/>').insertBefore($zone),vertical,style);}
if($zone.next('.oe_drop_zone:visible').length===0){style={};vertical=false;if(float==='left'||float==='right'||(parentDisplay==='flex'&&parentFlex==='row')){style['float']=float;if(!isFullWidth($zone)){vertical=true;style['height']=Math.max($zone.outerHeight(),30)+'px';}}
self._insertDropzone($('<we-hook/>').insertAfter($zone),vertical,style);}});}
var count;var $zones;do{count=0;$zones=this.getEditableArea().find('.oe_drop_zone > .oe_drop_zone').remove();count+=$zones.length;$zones.remove();}while(count>0);$zones=this.getEditableArea().find('.oe_drop_zone:not(.oe_vertical)');$zones.each(function(){var zone=$(this);var prev=zone.prev();var next=zone.next();if(prev.is('.oe_drop_zone')||next.is('.oe_drop_zone')){zone.remove();return;}
var floatPrev=prev.css('float')||'none';var floatNext=next.css('float')||'none';var dispPrev=prev.css('display')||null;var dispNext=next.css('display')||null;if((floatPrev==='left'||floatPrev==='right')&&(floatNext==='left'||floatNext==='right')){zone.remove();}else if(dispPrev!==null&&dispNext!==null&&dispPrev.indexOf('inline')>=0&&dispNext.indexOf('inline')>=0){zone.remove();}});},_updateInvisibleDOM:function(){return this._execWithLoadingEffect(()=>{this.invisibleDOMMap=new Map();const $invisibleDOMPanelEl=$(this.invisibleDOMPanelEl);$invisibleDOMPanelEl.find('.o_we_invisible_entry').remove();const $invisibleSnippets=globalSelector.all().find('.o_snippet_invisible').addBack('.o_snippet_invisible');$invisibleDOMPanelEl.toggleClass('d-none',!$invisibleSnippets.length);const proms=_.map($invisibleSnippets,async el=>{const editor=await this._createSnippetEditor($(el));const $invisEntry=$('<div/>',{class:'o_we_invisible_entry d-flex align-items-center justify-content-between',text:editor.getName(),}).append($('<i/>',{class:`fa ${editor.isTargetVisible() ? 'fa-eye' : 'fa-eye-slash'} ml-2`}));$invisibleDOMPanelEl.append($invisEntry);this.invisibleDOMMap.set($invisEntry[0],el);});return Promise.all(proms);},false);},_activateSnippet:async function($snippet,previewMode,ifInactiveOptions){if(this._blockPreviewOverlays&&previewMode){return;}
if($snippet&&!$snippet.is(':visible')){return;}
const exec=previewMode?action=>this._mutex.exec(action):action=>this._execWithLoadingEffect(action,false);return exec(()=>{return new Promise(resolve=>{if($snippet&&$snippet.length){$snippet=globalSelector.closest($snippet);if($snippet.length){return this._createSnippetEditor($snippet).then(resolve);}}
resolve(null);}).then(editorToEnable=>{if(ifInactiveOptions&&this._enabledEditorHierarchy.includes(editorToEnable)){return editorToEnable;}
const editorToEnableHierarchy=[];let current=editorToEnable;while(current&&current.$target){editorToEnableHierarchy.push(current);current=current.getParent();}
for(let i=this.snippetEditors.length;i--;){const editor=this.snippetEditors[i];editor.toggleOverlay(false,previewMode);if(!previewMode&&!editorToEnableHierarchy.includes(editor)){editor.toggleOptions(false);}}
if(!editorToEnable){editorToEnable=this.snippetEditors.find(editor=>editor.isSticky());previewMode=false;}
if(editorToEnable){editorToEnable.toggleOverlay(true,previewMode);editorToEnable.toggleOptions(true);}
this._enabledEditorHierarchy=editorToEnableHierarchy;return editorToEnable;});});},_loadSnippetsTemplates:async function(invalidateCache){return this._execWithLoadingEffect(async()=>{await this._destroyEditors();const html=await this.loadSnippets(invalidateCache);await this._computeSnippetTemplates(html);},false);},_destroyEditors:async function(){const proms=_.map(this.snippetEditors,async function(snippetEditor){await snippetEditor.cleanForSave();snippetEditor.destroy();});await Promise.all(proms);this.snippetEditors.splice(0);},_callForEachChildSnippet:function($snippet,callback){var self=this;var defs=_.map($snippet.add(globalSelector.all($snippet)),function(el){var $snippet=$(el);return self._createSnippetEditor($snippet).then(function(editor){if(editor){return callback.call(self,editor,$snippet);}});});return Promise.all(defs);},_closeWidgets:function(){this.snippetEditors.forEach(editor=>editor.closeWidgets());},_computeSelectorFunctions:function(selector,exclude,target,noCheck,isChildren){var self=this;exclude+=`${exclude && ', '}.o_snippet_not_selectable`;let filterFunc=function(){return!$(this).is(exclude);};if(target){const oldFilter=filterFunc;filterFunc=function(){return oldFilter.apply(this)&&$(this).find(target).length!==0;};}
var functions={is:function($from){return $from.is(selector)&&$from.filter(filterFunc).length!==0;},};if(noCheck){functions.closest=function($from,parentNode){return $from.closest(selector,parentNode).filter(filterFunc);};functions.all=function($from){return($from?dom.cssFind($from,selector):$(selector)).filter(filterFunc);};}else{functions.closest=function($from,parentNode){var parents=self.getEditableArea().get();return $from.closest(selector,parentNode).filter(function(){var node=this;while(node.parentNode){if(parents.indexOf(node)!==-1){return true;}
node=node.parentNode;}
return false;}).filter(filterFunc);};functions.all=isChildren?function($from){return dom.cssFind($from||self.getEditableArea(),selector).filter(filterFunc);}:function($from){$from=$from||self.getEditableArea();return $from.filter(selector).add(dom.cssFind($from,selector)).filter(filterFunc);};}
return functions;},_computeSnippetTemplates:function(html){var self=this;var $html=$(html);var $scroll=$html.siblings('#o_scroll');const $headerNavFix=$html.find('[data-js="HeaderNavbar"][data-selector="#wrapwrap > header > nav"]');if($headerNavFix.length){$headerNavFix[0].dataset.selector='#wrapwrap > header nav.navbar';}
this.templateOptions=[];var selectors=[];var $styles=$html.find('[data-selector]');$styles.each(function(){var $style=$(this);var selector=$style.data('selector');var exclude=$style.data('exclude')||'';var target=$style.data('target');var noCheck=$style.data('no-check');var optionID=$style.data('js')||$style.data('option-name');var option={'option':optionID,'base_selector':selector,'base_exclude':exclude,'base_target':target,'selector':self._computeSelectorFunctions(selector,exclude,target,noCheck),'$el':$style,'drop-near':$style.data('drop-near')&&self._computeSelectorFunctions($style.data('drop-near'),'',false,noCheck,true),'drop-in':$style.data('drop-in')&&self._computeSelectorFunctions($style.data('drop-in'),'',false,noCheck),'data':_.extend({string:$style.attr('string')},$style.data()),};self.templateOptions.push(option);selectors.push(option.selector);});$styles.addClass('d-none');globalSelector.closest=function($from){var $temp;var $target;for(var i=0,len=selectors.length;i<len;i++){$temp=selectors[i].closest($from,$target&&$target[0]);if($temp.length){$target=$temp;}}
return $target||$();};globalSelector.all=function($from){var $target=$();for(var i=0,len=selectors.length;i<len;i++){$target=$target.add(selectors[i].all($from));}
return $target;};globalSelector.is=function($from){for(var i=0,len=selectors.length;i<len;i++){if(selectors[i].is($from)){return true;}}
return false;};this.$snippets=$scroll.find('.o_panel_body').children().addClass('oe_snippet').each((i,el)=>{const $snippet=$(el);const name=el.getAttribute('name');const $sbody=$snippet.children().addClass('oe_snippet_body');const isCustomSnippet=!!el.closest('#snippet_custom');let snippetClasses=$sbody.attr('class').match(/s_[^ ]+/g);if(snippetClasses&&snippetClasses.length){snippetClasses='.'+snippetClasses.join('.');}
const $els=$(snippetClasses).not('[data-name]').add($sbody);$els.attr('data-name',name).data('name',name);const $thumbnail=$(`
                    <div class="oe_snippet_thumbnail">
                        <div class="oe_snippet_thumbnail_img" style="background-image: url(${el.dataset.oeThumbnail});"/>
                        <span class="oe_snippet_thumbnail_title">${name}</span>
                    </div>
                `);$snippet.prepend($thumbnail);const moduleID=$snippet.data('moduleId');if(moduleID){el.classList.add('o_snippet_install');$thumbnail.append($('<button/>',{class:'btn btn-primary o_install_btn w-100',type:'button',text:_t("Install"),}));}
if(isCustomSnippet){const btnEl=document.createElement('we-button');btnEl.dataset.snippetId=$snippet.data('oeSnippetId');btnEl.classList.add('o_delete_btn','fa','fa-trash','btn','o_we_hover_danger');btnEl.title=_.str.sprintf(_t("Delete %s"),name);$snippet.append(btnEl);}}).not('[data-module-id]');if(!this.$snippets.length){this.$el.detach();}
this._registerDefaultTexts();$html.find('.o_not_editable').attr('contentEditable',false);this.$el.html($html);this.$el.append(this.customizePanel);this.$el.append(this.textEditorPanelEl);this.$el.append(this.invisibleDOMPanelEl);this._makeSnippetDraggable(this.$snippets);this._disableUndroppableSnippets();this.$el.addClass('o_loaded');$('body.editor_enable').addClass('editor_has_snippets');this.trigger_up('snippets_loaded',self.$el);},_createSnippetEditor:function($snippet){var self=this;var snippetEditor=$snippet.data('snippet-editor');if(snippetEditor){return snippetEditor.__isStarted;}
var def;var $parent=globalSelector.closest($snippet.parent());if($parent.length){def=this._createSnippetEditor($parent);}
return Promise.resolve(def).then(function(parentEditor){snippetEditor=$snippet.data('snippet-editor');if(snippetEditor){return snippetEditor.__isStarted;}
let editableArea=self.getEditableArea();snippetEditor=new SnippetEditor(parentEditor||self,$snippet,self.templateOptions,$snippet.closest('[data-oe-type="html"], .oe_structure').add(editableArea),self.options);self.snippetEditors.push(snippetEditor);return snippetEditor.appendTo(self.$snippetEditorArea);}).then(function(){return snippetEditor;});},_disableUndroppableSnippets:function(){var self=this;var cache={};this.$snippets.each(function(){var $snippet=$(this);var $snippetBody=$snippet.find('.oe_snippet_body');var check=false;_.each(self.templateOptions,function(option,k){if(check||!($snippetBody.is(option.base_selector)&&!$snippetBody.is(option.base_exclude))){return;}
cache[k]=cache[k]||{'drop-near':option['drop-near']?option['drop-near'].all().length:0,'drop-in':option['drop-in']?option['drop-in'].all().length:0};check=(cache[k]['drop-near']||cache[k]['drop-in']);});$snippet.toggleClass('o_disabled',!check);$snippet.attr('title',check?'':_t("No location to drop in"));const $icon=$snippet.find('.o_snippet_undroppable').remove();if(check){$icon.remove();}else if(!$icon.length){const imgEl=document.createElement('img');imgEl.classList.add('o_snippet_undroppable');imgEl.src='/web_editor/static/src/img/snippet_disabled.svg';$snippet.append(imgEl);}});},_filterSnippets(search){const searchInputEl=this.el.querySelector('.o_snippet_search_filter_input');const searchInputReset=this.el.querySelector('.o_snippet_search_filter_reset');if(search!==undefined){searchInputEl.value=search;}else{search=searchInputEl.value;}
search=search.toLowerCase();searchInputReset.classList.toggle('d-none',!search);const strMatches=str=>!search||str.toLowerCase().includes(search);for(const panelEl of this.el.querySelectorAll('.o_panel')){let hasVisibleSnippet=false;const panelTitle=panelEl.querySelector('.o_panel_header').textContent;const isPanelTitleMatch=strMatches(panelTitle);for(const snippetEl of panelEl.querySelectorAll('.oe_snippet')){const matches=(isPanelTitleMatch||strMatches(snippetEl.getAttribute('name'))||strMatches(snippetEl.dataset.oeKeywords||''));if(matches){hasVisibleSnippet=true;}
snippetEl.classList.toggle('d-none',!matches);}
panelEl.classList.toggle('d-none',!hasVisibleSnippet);}},_getScrollOptions(options={}){return Object.assign({},options,{scrollBoundaries:Object.assign({right:false,},options.scrollBoundaries),jQueryDraggableOptions:Object.assign({appendTo:this.$body,cursor:'move',greedy:true,scroll:false,},options.jQueryDraggableOptions),});},_insertDropzone:function($hook,vertical,style){var $dropzone=$('<div/>',{'class':'oe_drop_zone oe_insert'+(vertical?' oe_vertical':''),});if(style){$dropzone.css(style);}
$hook.replaceWith($dropzone);return $dropzone;},_makeSnippetDraggable:function($snippets){var self=this;var $toInsert,dropped,$snippet;let dragAndDropResolve;const smoothScrollOptions=this._getScrollOptions({jQueryDraggableOptions:{distance:0,handle:'.oe_snippet_thumbnail:not(.o_we_already_dragging)',helper:function(){const dragSnip=this.cloneNode(true);dragSnip.querySelectorAll('.o_delete_btn').forEach(el=>el.remove());return dragSnip;},start:function(){self.$el.find('.oe_snippet_thumbnail').addClass('o_we_already_dragging');dropped=false;$snippet=$(this);var $baseBody=$snippet.find('.oe_snippet_body');var $selectorSiblings=$();var $selectorChildren=$();var temp=self.templateOptions;for(var k in temp){if($baseBody.is(temp[k].base_selector)&&!$baseBody.is(temp[k].base_exclude)){if(temp[k]['drop-near']){$selectorSiblings=$selectorSiblings.add(temp[k]['drop-near'].all());}
if(temp[k]['drop-in']){$selectorChildren=$selectorChildren.add(temp[k]['drop-in'].all());}}}
$toInsert=$baseBody.clone();[...$toInsert.find('img[src^="/web_editor/shape/"]')].forEach(dynamicSvg=>{const colorCustomizedURL=new URL(dynamicSvg.getAttribute('src'),window.location.origin);colorCustomizedURL.searchParams.set('c1',getCSSVariableValue('o-color-1'));dynamicSvg.src=colorCustomizedURL.pathname+colorCustomizedURL.search;});if(!$selectorSiblings.length&&!$selectorChildren.length){console.warn($snippet.find('.oe_snippet_thumbnail_title').text()+" have not insert action: data-drop-near or data-drop-in");return;}
self._activateSnippet(false);self._activateInsertionZones($selectorSiblings,$selectorChildren);self.getEditableArea().find('.oe_drop_zone').droppable({over:function(){if(!dropped){dropped=true;$(this).first().after($toInsert).addClass('d-none');$toInsert.removeClass('oe_snippet_body');}},out:function(){var prev=$toInsert.prev();if(this===prev[0]){dropped=false;$toInsert.detach();$(this).removeClass('d-none');$toInsert.addClass('oe_snippet_body');}},});const prom=new Promise(resolve=>dragAndDropResolve=()=>resolve());self._mutex.exec(()=>prom);},stop:async function(ev,ui){$toInsert.removeClass('oe_snippet_body');if(!dropped&&ui.position.top>3&&ui.position.left+ui.helper.outerHeight()<self.el.getBoundingClientRect().left){var $el=$.nearest({x:ui.position.left,y:ui.position.top},'.oe_drop_zone',{container:document.body}).first();if($el.length){$el.after($toInsert);dropped=true;}}
self.getEditableArea().find('.oe_drop_zone').droppable('destroy').remove();if(dropped){var prev=$toInsert.first()[0].previousSibling;var next=$toInsert.last()[0].nextSibling;if(prev){$toInsert.detach();self.trigger_up('request_history_undo_record',{$target:$(prev)});$toInsert.insertAfter(prev);}else if(next){$toInsert.detach();self.trigger_up('request_history_undo_record',{$target:$(next)});$toInsert.insertBefore(next);}else{var $parent=$toInsert.parent();$toInsert.detach();self.trigger_up('request_history_undo_record',{$target:$parent});$parent.prepend($toInsert);}
var $target=$toInsert;await self._scrollToSnippet($target);_.defer(async function(){self.trigger_up('snippet_dropped',{$target:$target});self._disableUndroppableSnippets();dragAndDropResolve();await self._callForEachChildSnippet($target,function(editor,$snippet){return editor.buildSnippet();});$target.trigger('content_changed');await self._updateInvisibleDOM();self.$el.find('.oe_snippet_thumbnail').removeClass('o_we_already_dragging');});}else{$toInsert.remove();dragAndDropResolve();self.$el.find('.oe_snippet_thumbnail').removeClass('o_we_already_dragging');}},},});this.draggableComponent=new SmoothScrollOnDrag(this,$snippets,$().getScrollingElement(),smoothScrollOptions);},_registerDefaultTexts:function($in){if($in===undefined){$in=this.$snippets.find('.oe_snippet_body');}
$in.find('*').addBack().contents().filter(function(){return this.nodeType===3&&this.textContent.match(/\S/);}).parent().addClass('o_default_snippet_text');},_updateLeftPanelContent:function({content,tab}){clearTimeout(this._textToolsSwitchingTimeout);this._closeWidgets();tab=tab||this.tabs.BLOCKS;if(content){while(this.customizePanel.firstChild){this.customizePanel.removeChild(this.customizePanel.firstChild);}
$(this.customizePanel).append(content);}
this.$('.o_snippet_search_filter').toggleClass('d-none',tab!==this.tabs.BLOCKS);this.$('#o_scroll').toggleClass('d-none',tab!==this.tabs.BLOCKS);this.customizePanel.classList.toggle('d-none',tab===this.tabs.BLOCKS);this.textEditorPanelEl.classList.toggle('d-none',tab!==this.tabs.OPTIONS);this.$('.o_we_add_snippet_btn').toggleClass('active',tab===this.tabs.BLOCKS);this.$('.o_we_customize_snippet_btn').toggleClass('active',tab===this.tabs.OPTIONS).prop('disabled',tab!==this.tabs.OPTIONS);},async _scrollToSnippet($el){return dom.scrollTo($el[0],{extraOffset:50});},_createLoadingElement(){const loaderContainer=document.createElement('div');const loader=document.createElement('i');const loaderContainerClassList=['o_we_ui_loading','d-flex','justify-content-center','align-items-center',];const loaderClassList=['fa','fa-circle-o-notch','fa-spin','fa-4x',];loaderContainer.classList.add(...loaderContainerClassList);loader.classList.add(...loaderClassList);loaderContainer.appendChild(loader);return loaderContainer;},async _execWithLoadingEffect(action,contentLoading=true,delay=500){const mutexExecResult=this._mutex.exec(action);if(!this.loadingTimers[contentLoading]){this.loadingTimers[contentLoading]=setTimeout(()=>{this.loadingElements[contentLoading]=this._createLoadingElement();if(contentLoading){this.$snippetEditorArea.append(this.loadingElements[contentLoading]);}else{this.el.appendChild(this.loadingElements[contentLoading]);}},delay);this._mutex.getUnlockedDef().then(()=>{clearTimeout(this.loadingTimers[contentLoading]);this.loadingTimers[contentLoading]=undefined;if(this.loadingElements[contentLoading]){this.loadingElements[contentLoading].remove();this.loadingElements[contentLoading]=null;}});}
return mutexExecResult;},_onActivateInsertionZones:function(ev){this._activateInsertionZones(ev.data.$selectorSiblings,ev.data.$selectorChildren);},_onActivateSnippet:function(ev){this._activateSnippet(ev.data.$snippet,ev.data.previewMode,ev.data.ifInactiveOptions);},_onCallForEachChildSnippet:function(ev){this._callForEachChildSnippet(ev.data.$snippet,ev.data.callback);},_onOverlaysCoverUpdate:function(){this.snippetEditors.forEach(editor=>{editor.cover();});},_onCloneSnippet:async function(ev){ev.stopPropagation();const editor=await this._createSnippetEditor(ev.data.$snippet);await editor.clone();if(ev.data.onSuccess){ev.data.onSuccess();}},_onDeactivateSnippet:function(){this._activateSnippet(false);},_onDragAndDropStop:async function(ev){await this._destroyEditors();await this._activateSnippet(ev.data.$snippet);},_onGoToParent:function(ev){ev.stopPropagation();this._activateSnippet(ev.data.$snippet.parent());},_onHideOverlay:function(){for(const editor of this.snippetEditors){editor.toggleOverlay(false);}},_onInstallBtnClick:function(ev){var self=this;var $snippet=$(ev.currentTarget).closest('[data-module-id]');var moduleID=$snippet.data('moduleId');var name=$snippet.attr('name');new Dialog(this,{title:_.str.sprintf(_t("Install %s"),name),size:'medium',$content:$('<div/>',{text:_.str.sprintf(_t("Do you want to install the %s App?"),name)}).append($('<a/>',{target:'_blank',href:'/web#id='+moduleID+'&view_type=form&model=ir.module.module&action=base.open_module_tree',text:_t("More info about this app."),class:'ml4',})),buttons:[{text:_t("Save and Install"),classes:'btn-primary',click:function(){this.$footer.find('.btn').toggleClass('o_hidden');this._rpc({model:'ir.module.module',method:'button_immediate_install',args:[[moduleID]],}).then(()=>{self.trigger_up('request_save',{reloadEditor:true,_toMutex:true,});}).guardedCatch(reason=>{reason.event.preventDefault();this.close();self.displayNotification({message:_.str.sprintf(_t("Could not install module <strong>%s</strong>"),name),type:'danger',sticky:true,});});},},{text:_t("Install in progress"),icon:'fa-spin fa-spinner fa-pulse mr8',classes:'btn-primary disabled o_hidden',},{text:_t("Cancel"),close:true,}],}).open();},_onInvisibleEntryClick:async function(ev){ev.preventDefault();const $snippet=$(this.invisibleDOMMap.get(ev.currentTarget));const isVisible=await this._execWithLoadingEffect(async()=>{const editor=await this._createSnippetEditor($snippet);return editor.toggleTargetVisibility();},true);$(ev.currentTarget).find('.fa').toggleClass('fa-eye',isVisible).toggleClass('fa-eye-slash',!isVisible);return this._activateSnippet(isVisible?$snippet:false);},_onBlocksTabClick:function(ev){this._activateSnippet(false).then(()=>{this._updateLeftPanelContent({content:[],tab:this.tabs.BLOCKS,});});},_onDeleteBtnClick:function(ev){const $snippet=$(ev.target).closest('.oe_snippet');new Dialog(this,{size:'medium',title:_t('Confirmation'),$content:$('<div><p>'+_t(`Are you sure you want to delete the snippet: ${$snippet.attr('name')} ?`)+'</p></div>'),buttons:[{text:_t("Yes"),close:true,classes:'btn-primary',click:async()=>{await this._rpc({model:'ir.ui.view',method:'delete_snippet',kwargs:{'view_id':parseInt(ev.currentTarget.dataset.snippetId),'template_key':this.options.snippets,},});await this._loadSnippetsTemplates(true);},},{text:_t("No"),close:true,}],}).open();},_onMouseDown:function(){const $blockedArea=$('#wrapwrap');$blockedArea.addClass('o_we_no_pointer_events');const reenable=()=>$blockedArea.removeClass('o_we_no_pointer_events');const enableTimeoutID=setTimeout(()=>reenable(),5000);$(document).one('mouseup',()=>{clearTimeout(enableTimeoutID);reenable();});},_onGetSnippetVersions:function(ev){const snippet=this.el.querySelector(`.oe_snippet > [data-snippet="${ev.data.snippetName}"]`);ev.data.onSuccess(snippet&&{vcss:snippet.dataset.vcss,vjs:snippet.dataset.vjs,vxml:snippet.dataset.vxml,});},_onReloadSnippetTemplate:async function(ev){await this._activateSnippet(false);await this._loadSnippetsTemplates(true);},_onBlockPreviewOverlays:function(ev){this._blockPreviewOverlays=true;},_onUnblockPreviewOverlays:function(ev){this._blockPreviewOverlays=false;},_onRemoveSnippet:async function(ev){ev.stopPropagation();const editor=await this._createSnippetEditor(ev.data.$snippet);await editor.removeSnippet();if(ev.data.onSuccess){ev.data.onSuccess();}},_onSaveRequest:function(ev){const data=ev.data;if(ev.target===this&&!data._toMutex){return;}
delete data._toMutex;ev.stopPropagation();this._execWithLoadingEffect(()=>{if(data.reloadEditor){data.reload=false;const oldOnSuccess=data.onSuccess;data.onSuccess=async function(){if(oldOnSuccess){await oldOnSuccess.call(this,...arguments);}
window.location.href=window.location.origin+window.location.pathname+'?enable_editor=1';};}
this.trigger_up('request_save',data);},true);},_onSnippetEditionRequest:function(ev){this._execWithLoadingEffect(ev.data.exec,true);},_onSnippetEditorDestroyed(ev){ev.stopPropagation();const index=this.snippetEditors.indexOf(ev.target);this.snippetEditors.splice(index,1);},_onSnippetCloned:function(ev){this._updateInvisibleDOM();},_onSnippetRemoved:function(){this._disableUndroppableSnippets();this._updateInvisibleDOM();},_onSnippetOptionVisibilityUpdate:async function(ev){if(!ev.data.show){await this._activateSnippet(false);}
await this._updateInvisibleDOM();},_onSnippetThumbnailURLRequest(ev){const $snippet=this.$snippets.has(`[data-snippet="${ev.data.key}"]`);ev.data.onSuccess($snippet.length?$snippet[0].dataset.oeThumbnail:'');},_onSummernoteToolsUpdate(ev){if(!this._textToolsSwitchingEnabled){return;}
const range=$.summernote.core.range.create();if(!range){return;}
if(range.sc===range.ec&&range.sc.nodeType===Node.ELEMENT_NODE&&range.sc.classList.contains('oe_structure')&&range.sc.children.length===0){return;}
this.textEditorPanelEl.classList.add('d-block');const hasVisibleButtons=!!$(this.textEditorPanelEl).find('.btn:visible').length;this.textEditorPanelEl.classList.remove('d-block');if(!hasVisibleButtons){return;}
clearTimeout(this._textToolsSwitchingTimeout);this._textToolsSwitchingTimeout=setTimeout(()=>{this._updateLeftPanelContent({tab:this.tabs.OPTIONS});},250);},_onUpdateCustomizeElements:function(ev){this._updateLeftPanelContent({content:ev.data.customize$Elements,tab:ev.data.customize$Elements.length?this.tabs.OPTIONS:this.tabs.BLOCKS,});},_onUserValueWidgetOpening:function(){this._closeWidgets();this.el.classList.add('o_we_backdrop');},_onUserValueWidgetClosing:function(){this.el.classList.remove('o_we_backdrop');},_onSnippetSearchInput:function(){this._filterSnippets();},_onSnippetSearchResetClick:function(){this._filterSnippets('');},});return{Class:SnippetsMenu,Editor:SnippetEditor,globalSelector:globalSelector,};});;

/* /web_editor/static/src/js/editor/snippets.options.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.snippets.options',function(require){'use strict';var core=require('web.core');const{ColorpickerWidget}=require('web.Colorpicker');const Dialog=require('web.Dialog');const time=require('web.time');var Widget=require('web.Widget');var ColorPaletteWidget=require('web_editor.ColorPalette').ColorPaletteWidget;const weUtils=require('web_editor.utils');const{normalizeColor,getBgImageURL,}=weUtils;var weWidgets=require('wysiwyg.widgets');const{loadImage,loadImageInfo,applyModifications,removeOnImageChangeAttrs,}=require('web_editor.image_processing');var qweb=core.qweb;var _t=core._t;function _addTitleAndAllowedAttributes(el,title,options){let tooltipEl=el;if(title){const titleEl=_buildTitleElement(title);tooltipEl=titleEl;el.appendChild(titleEl);}
if(options&&options.classes){el.classList.add(...options.classes);}
if(options&&options.tooltip){tooltipEl.title=options.tooltip;}
if(options&&options.placeholder){el.setAttribute('placeholder',options.placeholder);}
if(options&&options.dataAttributes){for(const key in options.dataAttributes){el.dataset[key]=options.dataAttributes[key];}}
return el;}
function _buildElement(tagName,title,options){const el=document.createElement(tagName);return _addTitleAndAllowedAttributes(el,title,options);}
function _buildTitleElement(title){const titleEl=document.createElement('we-title');titleEl.textContent=title;return titleEl;}
async function _buildImgElement(src){if(src.split('.').pop()==='svg'){const response=await window.fetch(src);const text=await response.text();const parser=new window.DOMParser();const xmlDoc=parser.parseFromString(text,'text/xml');return xmlDoc.getElementsByTagName('svg')[0];}
const imgEl=document.createElement('img');imgEl.src=src;return imgEl;}
function _buildRowElement(title,options){const groupEl=_buildElement('we-row',title,options);const rowEl=document.createElement('div');groupEl.appendChild(rowEl);if(options&&options.childNodes){options.childNodes.forEach(node=>rowEl.appendChild(node));}
return groupEl;}
function _buildCollapseElement(title,options){const groupEl=_buildElement('we-collapse',title,options);const titleEl=groupEl.querySelector('we-title');const children=options&&options.childNodes||[];if(titleEl){titleEl.remove();children.unshift(titleEl);}
let i=0;for(i=0;i<children.length;i++){groupEl.appendChild(children[i]);if(children[i].nodeType===Node.ELEMENT_NODE){break;}}
const togglerEl=document.createElement('we-toggler');togglerEl.classList.add('o_we_collapse_toggler');groupEl.appendChild(togglerEl);const containerEl=document.createElement('div');children.slice(i+1).forEach(node=>containerEl.appendChild(node));groupEl.appendChild(containerEl);return groupEl;}
function createPropertyProxy(obj,propertyName,value){return new Proxy(obj,{get:function(obj,prop){if(prop===propertyName){return value;}
return obj[prop];},set:function(obj,prop,val){if(prop===propertyName){return(value=val);}
return Reflect.set(...arguments);},});}
const NULL_ID='__NULL__';const UserValueWidget=Widget.extend({className:'o_we_user_value_widget',custom_events:{'user_value_update':'_onUserValueNotification',},init:function(parent,title,options,$target){this._super(...arguments);this.title=title;this.options=options;this._userValueWidgets=[];this._value='';this.$target=$target;},async willStart(){await this._super(...arguments);if(this.options.dataAttributes.img){this.imgEl=await _buildImgElement(this.options.dataAttributes.img);}},_makeDescriptive:function(){const $el=this._super(...arguments);const el=$el[0];_addTitleAndAllowedAttributes(el,this.title,this.options);this.containerEl=document.createElement('div');if(this.imgEl){this.containerEl.appendChild(this.imgEl);}
el.appendChild(this.containerEl);return $el;},async start(){await this._super(...arguments);if(this.el.classList.contains('o_we_img_animate')){const buildImgExtensionSwitcher=(from,to)=>{const regex=new RegExp(`${from}$`,'i');return ev=>{const img=ev.currentTarget.getElementsByTagName("img")[0];img.src=img.src.replace(regex,to);};};this.$el.on('mouseenter.img_animate',buildImgExtensionSwitcher('png','gif'));this.$el.on('mouseleave.img_animate',buildImgExtensionSwitcher('gif','png'));}},destroy(){if(this.$el){this.$el.off('.img_animate');}
this._super(...arguments);},close:function(){this.trigger_up('user_value_widget_closing');this.el.classList.remove('o_we_widget_opened');this._userValueWidgets.forEach(widget=>widget.close());},findWidget:function(name){for(const widget of this._userValueWidgets){if(widget.getName()===name){return widget;}
const depWidget=widget.findWidget(name);if(depWidget){return depWidget;}}
return null;},getActiveValue:function(methodName){return this._value;},getDefaultValue:function(methodName){const possibleValues=this._methodsParams.optionsPossibleValues[methodName];return possibleValues&&possibleValues[0]||'';},getDependencies:function(){return this._dependencies;},getMethodsNames:function(){return this._methodsNames;},getMethodsParams:function(methodName){const params=_.extend({},this._methodsParams);if(methodName){params.possibleValues=params.optionsPossibleValues[methodName]||[];params.activeValue=this.getActiveValue(methodName);params.defaultValue=this.getDefaultValue(methodName);}
return params;},getName:function(){return this._methodsParams.name||'';},getValue:function(methodName){const isActive=this.isActive();if(!methodName||!this._methodsNames.includes(methodName)){return isActive?'true':'';}
if(isActive){return this.getActiveValue(methodName);}
return this.getDefaultValue(methodName);},isActive:function(){return this._value&&this._value!==NULL_ID;},isContainer:function(){return false;},isPreviewed:function(){const focusEl=document.activeElement;if(focusEl&&focusEl.tagName==='INPUT'&&(this.el===focusEl||this.el.contains(focusEl))){return true;}
return this.el.classList.contains('o_we_preview');},loadMethodsData:function(validMethodNames,extraParams){this._methodsNames=[];this._methodsParams=_.extend({},extraParams);this._methodsParams.optionsPossibleValues={};this._dependencies=[];this._triggerWidgetsNames=[];this._triggerWidgetsValues=[];for(const key in this.el.dataset){const dataValue=this.el.dataset[key].trim();if(key==='dependencies'){this._dependencies.push(...dataValue.split(/\s*,\s*/g));}else if(key==='trigger'){this._triggerWidgetsNames.push(...dataValue.split(/\s*,\s*/g));}else if(key==='triggerValue'){this._triggerWidgetsValues.push(...dataValue.split(/\s*,\s*/g));}else if(validMethodNames.includes(key)){this._methodsNames.push(key);this._methodsParams.optionsPossibleValues[key]=dataValue.split(/\s*\|\s*/g);}else{this._methodsParams[key]=dataValue;}}
this._userValueWidgets.forEach(widget=>{const inheritedParams=_.extend({},this._methodsParams);inheritedParams.optionsPossibleValues=null;widget.loadMethodsData(validMethodNames,inheritedParams);const subMethodsNames=widget.getMethodsNames();const subMethodsParams=widget.getMethodsParams();for(const methodName of subMethodsNames){if(!this._methodsNames.includes(methodName)){this._methodsNames.push(methodName);this._methodsParams.optionsPossibleValues[methodName]=[];}
for(const subPossibleValue of subMethodsParams.optionsPossibleValues[methodName]){this._methodsParams.optionsPossibleValues[methodName].push(subPossibleValue);}}});for(const methodName of this._methodsNames){const arr=this._methodsParams.optionsPossibleValues[methodName];const uniqArr=arr.filter((v,i,arr)=>i===arr.indexOf(v));this._methodsParams.optionsPossibleValues[methodName]=uniqArr;}},notifyValueChange:function(previewMode,isSimulatedEvent){if(!this._methodsNames.length){return;}
const isPreviewed=this.isPreviewed();if(!previewMode&&!isPreviewed){this.notifyValueChange(true);}
const data={previewMode:previewMode||false,isSimulatedEvent:!!isSimulatedEvent,};if(previewMode===true||previewMode===false){data.prepare=()=>this.el.classList.add('o_we_preview');}else if(previewMode==='reset'){data.prepare=()=>this.el.classList.remove('o_we_preview');}
this.trigger_up('user_value_update',data);},open(){this.trigger_up('user_value_widget_opening');this.el.classList.add('o_we_widget_opened');},registerSubWidget:function(widget){this._userValueWidgets.push(widget);},async setValue(value,methodName){this._value=value;this.el.classList.remove('o_we_preview');},toggleVisibility:function(show){this.el.classList.toggle('d-none',!show);},_handleNotifierEvent:function(ev){if(!ev){return true;}
if(ev._seen){return false;}
ev._seen=true;if(ev.preventDefault){ev.preventDefault();}
return true;},_onUserValueChange:function(ev){if(this._handleNotifierEvent(ev)){this.notifyValueChange(false);}},_onUserValueNotification:function(ev){ev.data.widget=this;if(!ev.data.triggerWidgetsNames){ev.data.triggerWidgetsNames=[];}
ev.data.triggerWidgetsNames.push(...this._triggerWidgetsNames);if(!ev.data.triggerWidgetsValues){ev.data.triggerWidgetsValues=[];}
ev.data.triggerWidgetsValues.push(...this._triggerWidgetsValues);},_onUserValuePreview:function(ev){if(this._handleNotifierEvent(ev)){this.notifyValueChange(true);}},_onUserValueReset:function(ev){if(this._handleNotifierEvent(ev)){this.notifyValueChange('reset');}},});const ButtonUserValueWidget=UserValueWidget.extend({tagName:'we-button',events:{'click':'_onButtonClick','click [role="button"]':'_onInnerButtonClick','mouseenter':'_onUserValuePreview','mouseleave':'_onUserValueReset',},start:function(parent,title,options){if(this.options&&this.options.childNodes){this.options.childNodes.forEach(node=>this.containerEl.appendChild(node));}
return this._super(...arguments);},getActiveValue:function(methodName){const possibleValues=this._methodsParams.optionsPossibleValues[methodName];return possibleValues&&possibleValues[possibleValues.length-1]||'';},isActive:function(){return(this.isPreviewed()!==this.el.classList.contains('active'));},loadMethodsData:function(validMethodNames){this._super.apply(this,arguments);for(const methodName of this._methodsNames){const possibleValues=this._methodsParams.optionsPossibleValues[methodName];if(possibleValues.length<=1){possibleValues.unshift('');}}},async setValue(value,methodName){await this._super(...arguments);let active=!!value;if(methodName){if(!this._methodsNames.includes(methodName)){return;}
active=(this.getActiveValue(methodName)===value);}
this.el.classList.toggle('active',active);},_onButtonClick:function(ev){if(!ev._innerButtonClicked){this._onUserValueChange(ev);}},_onInnerButtonClick:function(ev){ev._innerButtonClicked=true;},});const CheckboxUserValueWidget=ButtonUserValueWidget.extend({className:(ButtonUserValueWidget.prototype.className||'')+' o_we_checkbox_wrapper',start:function(){const checkboxEl=document.createElement('we-checkbox');this.containerEl.appendChild(checkboxEl);return this._super(...arguments);},_onButtonClick(ev){if(!ev.target.closest('we-title, we-checkbox')){return;}
return this._super(...arguments);},});const BaseSelectionUserValueWidget=UserValueWidget.extend({async start(){await this._super(...arguments);this.menuEl=document.createElement('we-selection-items');if(this.options&&this.options.childNodes){this.options.childNodes.forEach(node=>this.menuEl.appendChild(node));}
this.containerEl.appendChild(this.menuEl);},getMethodsParams(methodName){const params=this._super(...arguments);const activeWidget=this._getActiveSubWidget();if(!activeWidget){return params;}
return Object.assign(activeWidget.getMethodsParams(...arguments),params);},getValue(methodName){const activeWidget=this._getActiveSubWidget();if(activeWidget){return activeWidget.getActiveValue(methodName);}
return this._super(...arguments);},isContainer(){return true;},async setValue(value,methodName){const _super=this._super.bind(this);for(const widget of this._userValueWidgets){await widget.setValue(NULL_ID,methodName);}
for(const widget of[...this._userValueWidgets].reverse()){await widget.setValue(value,methodName);if(widget.isActive()){return;}}
await _super(...arguments);},_getActiveSubWidget(){const previewedWidget=this._userValueWidgets.find(widget=>widget.isPreviewed());if(previewedWidget){return previewedWidget;}
return this._userValueWidgets.find(widget=>widget.isActive());},});const SelectUserValueWidget=BaseSelectionUserValueWidget.extend({tagName:'we-select',events:{'click':'_onClick',},async start(){await this._super(...arguments);if(this.options&&this.options.valueEl){this.containerEl.insertBefore(this.options.valueEl,this.menuEl);}
this.menuTogglerEl=document.createElement('we-toggler');this.icon=this.el.dataset.icon||false;if(this.icon){this.el.classList.add('o_we_icon_select');const iconEl=document.createElement('i');iconEl.classList.add('fa','fa-fw',this.icon);this.menuTogglerEl.appendChild(iconEl);}
this.containerEl.insertBefore(this.menuTogglerEl,this.menuEl);const dropdownCaretEl=document.createElement('span');dropdownCaretEl.classList.add('o_we_dropdown_caret');this.containerEl.appendChild(dropdownCaretEl);},close:function(){this._super(...arguments);this.menuTogglerEl.classList.remove('active');},isPreviewed:function(){return this._super(...arguments)||this.menuTogglerEl.classList.contains('active');},open(){this._super(...arguments);this.menuTogglerEl.classList.add('active');},async setValue(){await this._super(...arguments);if(this.icon){return;}
if(this.menuTogglerItemEl){this.menuTogglerItemEl.remove();this.menuTogglerItemEl=null;}
let textContent='';const activeWidget=this._userValueWidgets.find(widget=>!widget.isPreviewed()&&widget.isActive());if(activeWidget){const svgTag=activeWidget.el.querySelector('svg');const value=(activeWidget.el.dataset.selectLabel||(!svgTag&&activeWidget.el.textContent.trim()));const imgSrc=activeWidget.el.dataset.img;if(value){textContent=value;}else if(imgSrc){this.menuTogglerItemEl=document.createElement('img');this.menuTogglerItemEl.src=imgSrc;}else{const fakeImgEl=activeWidget.el.querySelector('.o_we_fake_img_item');if(fakeImgEl){this.menuTogglerItemEl=fakeImgEl.cloneNode(true);}}}else{textContent="/";}
this.menuTogglerEl.textContent=textContent;if(this.menuTogglerItemEl){this.menuTogglerEl.appendChild(this.menuTogglerItemEl);}},_onClick:function(ev){if(ev.target.closest('[role="button"]')){return;}
if(!this.menuTogglerEl.classList.contains('active')){this.open();}else{this.close();}
const activeButton=this._userValueWidgets.find(widget=>widget.isActive());if(activeButton){this.menuEl.scrollTop=activeButton.el.offsetTop-(this.menuEl.offsetHeight/2);}},});const ButtonGroupUserValueWidget=BaseSelectionUserValueWidget.extend({tagName:'we-button-group',});const UnitUserValueWidget=UserValueWidget.extend({start:async function(){const unit=this.el.dataset.unit||'';this.el.dataset.unit=unit;if(this.el.dataset.saveUnit===undefined){this.el.dataset.saveUnit=unit;}
return this._super(...arguments);},getActiveValue:function(methodName){const activeValue=this._super(...arguments);const params=this._methodsParams;if(!params.unit){return activeValue;}
const defaultValue=this.getDefaultValue(methodName,false);return activeValue.split(/\s+/g).map(v=>{const numValue=parseFloat(v);if(isNaN(numValue)){return defaultValue;}else{const value=weUtils.convertNumericToUnit(numValue,params.unit,params.saveUnit,params.cssProperty,this.$target);return`${this._floatToStr(value)}${params.saveUnit}`;}}).join(' ');},getDefaultValue:function(methodName,useInputUnit){const defaultValue=this._super(...arguments);const params=this._methodsParams;if(!params.unit){return defaultValue;}
const unit=useInputUnit?params.unit:params.saveUnit;const numValue=weUtils.convertValueToUnit(defaultValue||'0',unit,params.cssProperty,this.$target);if(isNaN(numValue)){return defaultValue;}
return`${this._floatToStr(numValue)}${unit}`;},isActive:function(){const isSuperActive=this._super(...arguments);const params=this._methodsParams;if(!params.unit){return isSuperActive;}
return isSuperActive&&this._floatToStr(parseFloat(this._value))!=='0';},async setValue(value,methodName){const params=this._methodsParams;if(params.unit){value=value.split(' ').map(v=>{const numValue=weUtils.convertValueToUnit(v,params.unit,params.cssProperty,this.$target);if(isNaN(numValue)){return'';}
return this._floatToStr(numValue);}).join(' ');}
return this._super(value,methodName);},_floatToStr:function(value){return`${parseFloat(value.toFixed(5))}`;},});const InputUserValueWidget=UnitUserValueWidget.extend({tagName:'we-input',events:{'input input':'_onInputInput','blur input':'_onInputBlur','keydown input':'_onInputKeydown',},start:async function(){await this._super(...arguments);const unit=this.el.dataset.unit;this.inputEl=document.createElement('input');this.inputEl.setAttribute('type','text');this.inputEl.setAttribute('autocomplete','chrome-off');this.inputEl.setAttribute('placeholder',this.el.getAttribute('placeholder')||'');this.inputEl.classList.toggle('text-left',!unit);this.inputEl.classList.toggle('text-right',!!unit);this.containerEl.appendChild(this.inputEl);var unitEl=document.createElement('span');unitEl.textContent=unit;this.containerEl.appendChild(unitEl);if(unit.length>3){this.el.classList.add('o_we_large_input');}},async setValue(){await this._super(...arguments);this.inputEl.value=this._value;},_onInputInput:function(ev){this._value=this.inputEl.value;this._onUserValuePreview(ev);},_onInputBlur:function(ev){setTimeout(()=>{if(ev.currentTarget===document.activeElement){return;}
this._onUserValueChange(ev);});},_onInputKeydown:function(ev){switch(ev.which){case $.ui.keyCode.ENTER:{this._onUserValueChange(ev);break;}
case $.ui.keyCode.UP:case $.ui.keyCode.DOWN:{const input=ev.currentTarget;const params=this._methodsParams;if(!params.unit&&!params.step){break;}
let value=parseFloat(input.value||input.placeholder);if(isNaN(value)){value=0.0;}
let step=parseFloat(params.step);if(isNaN(step)){step=1.0;}
value+=(ev.which===$.ui.keyCode.UP?step:-step);input.value=this._floatToStr(value);$(input).trigger('input');break;}}},});const MultiUserValueWidget=UserValueWidget.extend({tagName:'we-multi',start:function(){if(this.options&&this.options.childNodes){this.options.childNodes.forEach(node=>this.containerEl.appendChild(node));}
return this._super(...arguments);},getValue:function(methodName){const value=this._userValueWidgets.map(widget=>{return widget.getValue(methodName);}).join(' ').trim();return value||this._super(...arguments);},isContainer:function(){return true;},async setValue(value,methodName){let values=value.split(/\s*\|\s*/g);if(values.length===1){values=value.split(/\s+/g);}
for(let i=0;i<this._userValueWidgets.length-1;i++){await this._userValueWidgets[i].setValue(values.shift()||'',methodName);}
await this._userValueWidgets[this._userValueWidgets.length-1].setValue(values.join(' '),methodName);},});const ColorpickerUserValueWidget=SelectUserValueWidget.extend({className:(SelectUserValueWidget.prototype.className||'')+' o_we_so_color_palette',custom_events:_.extend({},SelectUserValueWidget.prototype.custom_events,{'custom_color_picked':'_onCustomColorPicked','color_picked':'_onColorPicked','color_hover':'_onColorHovered','color_leave':'_onColorLeft','enter_key_color_colorpicker':'_onEnterKey'}),start:async function(){const _super=this._super.bind(this);const args=arguments;await this._renderColorPalette();this.colorPreviewEl=document.createElement('span');this.colorPreviewEl.classList.add('o_we_color_preview');this.options.childNodes=[this.colorPalette.el];this.options.valueEl=this.colorPreviewEl;return _super(...args);},close:function(){this._super(...arguments);if(this._customColorValue&&this._customColorValue!==this._value){this._value=this._customColorValue;this._customColorValue=false;this._onUserValueChange();}},getMethodsParams:function(){return _.extend(this._super(...arguments),{colorNames:this.colorPalette.getColorNames(),});},getValue:function(methodName){if(typeof this._previewColor==='string'){return this._previewColor;}
if(typeof this._customColorValue==='string'){return this._customColorValue;}
let value=this._super(...arguments);if(value){const useCssColor=this.options.dataAttributes.hasOwnProperty('useCssColor');const cssCompatible=this.options.dataAttributes.hasOwnProperty('cssCompatible');if((useCssColor||cssCompatible)&&!ColorpickerWidget.isCSSColor(value)){if(useCssColor){value=weUtils.getCSSVariableValue(value);}else{value=`var(--${value})`;}}}
return value;},isContainer:function(){return false;},isActive:function(){return!weUtils.areCssValuesEqual(this._value,'rgba(0, 0, 0, 0)');},async setValue(color){await this._super(...arguments);await this._renderColorPalette();const classes=weUtils.computeColorClasses(this.colorPalette.getColorNames());this.colorPreviewEl.classList.remove(...classes);this.colorPreviewEl.style.removeProperty('background-color');if(this._value){if(ColorpickerWidget.isCSSColor(this._value)){this.colorPreviewEl.style.backgroundColor=this._value;}else if(weUtils.isColorCombinationName(this._value)){this.colorPreviewEl.classList.add('o_cc',`o_cc${this._value}`);}else{this.colorPreviewEl.classList.add(`bg-${this._value}`);}}},_renderColorPalette:function(){const options={selectedColor:this._value,};if(this.options.dataAttributes.excluded){options.excluded=this.options.dataAttributes.excluded.replace(/ /g,'').split(',');}
if(this.options.dataAttributes.withCombinations){options.withCombinations=!!this.options.dataAttributes.withCombinations;}
const oldColorPalette=this.colorPalette;this.colorPalette=new ColorPaletteWidget(this,options);if(oldColorPalette){return this.colorPalette.insertAfter(oldColorPalette.el).then(()=>{oldColorPalette.destroy();});}
return this.colorPalette.appendTo(document.createDocumentFragment());},_onCustomColorPicked:function(ev){this._customColorValue=ev.data.color;},_onColorPicked:function(ev){this._previewColor=false;this._customColorValue=false;this._value=ev.data.color;this._onUserValueChange(ev);},_onColorHovered:function(ev){this._previewColor=ev.data.color;this._onUserValuePreview(ev);},_onColorLeft:function(ev){this._previewColor=false;this._onUserValueReset(ev);},_onEnterKey:function(){this.close();},_onClick:function(ev){if(!ev.originalEvent.__isColorpickerClick){this._super(...arguments);}
ev.stopPropagation();},});const MediapickerUserValueWidget=UserValueWidget.extend({tagName:'we-button',events:{'click':'_onEditMedia',},async start(){await this._super(...arguments);const iconEl=document.createElement('i');if(this.options.dataAttributes.buttonStyle){iconEl.classList.add('fa','fa-fw','fa-camera');}else{iconEl.classList.add('fa','fa-fw','fa-refresh','mr-1');this.el.classList.add('o_we_no_toggle');this.containerEl.textContent=_t("Replace media");}
$(this.containerEl).prepend(iconEl);},_openDialog(el,{images=false,videos=false}){el.src=this._value;const $editable=this.$target.closest('.o_editable');const mediaDialog=new weWidgets.MediaDialog(this,{noImages:!images,noVideos:!videos,noIcons:true,noDocuments:true,isForBgVideo:true,'res_model':$editable.data('oe-model'),'res_id':$editable.data('oe-id'),},el).open();return mediaDialog;},async setValue(){await this._super(...arguments);this.el.classList.toggle('active',this.isActive());},_onEditMedia:function(ev){},});const ImagepickerUserValueWidget=MediapickerUserValueWidget.extend({_onEditMedia(ev){const dummyEl=document.createElement('img');const dialog=this._openDialog(dummyEl,{images:true});dialog.on('save',this,data=>{this._value=dummyEl.getAttribute('src');this._onUserValueChange();});},});const VideopickerUserValueWidget=MediapickerUserValueWidget.extend({_onEditMedia(ev){const dummyEl=document.createElement('iframe');const dialog=this._openDialog(dummyEl,{videos:true});dialog.on('save',this,data=>{this._value=data.bgVideoSrc;this._onUserValueChange();});},});const DatetimePickerUserValueWidget=InputUserValueWidget.extend({events:{'blur input':'_onInputBlur','change.datetimepicker':'_onDateTimePickerChange','error.datetimepicker':'_onDateTimePickerError',},init:function(){this._super(...arguments);this._value=moment().unix().toString();this.__libInput=0;},start:async function(){await this._super(...arguments);const datetimePickerId=_.uniqueId('datetimepicker');this.el.classList.add('o_we_large_input');this.inputEl.classList.add('datetimepicker-input','mx-0','text-left');this.inputEl.setAttribute('id',datetimePickerId);this.inputEl.setAttribute('data-target','#'+datetimePickerId);const datepickersOptions={minDate:moment({y:1}),maxDate:moment().add(200,'y'),calendarWeeks:true,defaultDate:moment().format(),icons:{close:'fa fa-check primary',},locale:moment.locale(),format:time.getLangDatetimeFormat(),sideBySide:true,buttons:{showClose:true,showToday:true,},widgetParent:'body',allowInputToggle:true,};this.__libInput++;const $input=$(this.inputEl);$input.datetimepicker(datepickersOptions);this.__libInput--;const libObject=$input.data('datetimepicker');const oldFunc=libObject._getTemplate;libObject._getTemplate=function(){const $template=oldFunc.call(this,...arguments);$template.addClass('o_we_no_overlay o_we_datetimepicker');return $template;};},isPreviewed:function(){return this._super(...arguments)||!!$(this.inputEl).data('datetimepicker').widget;},async setValue(){await this._super(...arguments);let momentObj=moment.unix(this._value);if(!momentObj.isValid()){momentObj=moment();}
this.__libInput++;$(this.inputEl).datetimepicker('date',momentObj);this.__libInput--;},_onDateTimePickerChange:function(ev){if(this.__libInput>0){return;}
if(!ev.date||!ev.date.isValid()){return;}
this._value=ev.date.unix().toString();this._onUserValuePreview(ev);},_onDateTimePickerError:function(ev){ev.stopPropagation();},});const RangeUserValueWidget=UnitUserValueWidget.extend({tagName:'we-range',events:{'change input':'_onInputChange',},async start(){await this._super(...arguments);this.input=document.createElement('input');this.input.type="range";let min=this.el.dataset.min&&parseFloat(this.el.dataset.min)||0;let max=this.el.dataset.max&&parseFloat(this.el.dataset.max)||100;const step=this.el.dataset.step&&parseFloat(this.el.dataset.step)||1;if(min>max){[min,max]=[max,min];this.input.classList.add('o_we_inverted_range');}
this.input.setAttribute('min',min);this.input.setAttribute('max',max);this.input.setAttribute('step',step);this.containerEl.appendChild(this.input);},async setValue(value,methodName){await this._super(...arguments);this.input.value=this._value;},_onInputChange(ev){this._value=ev.target.value;this._onUserValueChange(ev);},});const SelectPagerUserValueWidget=SelectUserValueWidget.extend({className:(SelectUserValueWidget.prototype.className||'')+' o_we_select_pager',events:Object.assign({},SelectUserValueWidget.prototype.events,{'click .o_we_pager_next, .o_we_pager_prev':'_onPageChange',}),async start(){const _super=this._super.bind(this);this.pages=this.options.childNodes.filter(node=>node.matches&&node.matches('we-select-page'));this.numPages=this.pages.length;const prev=document.createElement('i');prev.classList.add('o_we_pager_prev','fa','fa-chevron-left');this.pageNum=document.createElement('span');this.currentPage=0;const next=document.createElement('i');next.classList.add('o_we_pager_next','fa','fa-chevron-right');const pagerControls=document.createElement('div');pagerControls.classList.add('o_we_pager_controls');pagerControls.appendChild(prev);pagerControls.appendChild(this.pageNum);pagerControls.appendChild(next);this.pageName=document.createElement('b');const pagerHeader=document.createElement('div');pagerHeader.classList.add('o_we_pager_header');pagerHeader.appendChild(this.pageName);pagerHeader.appendChild(pagerControls);await _super(...arguments);this.menuEl.classList.add('o_we_has_pager');$(this.menuEl).prepend(pagerHeader);this._updatePage();},_updatePage(){this.pages.forEach((page,i)=>page.classList.toggle('active',i===this.currentPage));this.pageNum.textContent=`${this.currentPage + 1}/${this.numPages}`;const activePage=this.pages.find((page,i)=>i===this.currentPage);this.pageName.textContent=activePage.getAttribute('string');},_onPageChange(ev){ev.preventDefault();ev.stopPropagation();const delta=ev.target.matches('.o_we_pager_next')?1:-1;this.currentPage=(this.currentPage+this.numPages+delta)%this.numPages;this._updatePage();},_onClick(ev){const activeButton=this._getActiveSubWidget();if(activeButton){const currentPage=this.pages.indexOf(activeButton.el.closest('we-select-page'));if(currentPage!==-1){this.currentPage=currentPage;this._updatePage();}}
return this._super(...arguments);},});const userValueWidgetsRegistry={'we-button':ButtonUserValueWidget,'we-checkbox':CheckboxUserValueWidget,'we-select':SelectUserValueWidget,'we-button-group':ButtonGroupUserValueWidget,'we-input':InputUserValueWidget,'we-multi':MultiUserValueWidget,'we-colorpicker':ColorpickerUserValueWidget,'we-datetimepicker':DatetimePickerUserValueWidget,'we-imagepicker':ImagepickerUserValueWidget,'we-videopicker':VideopickerUserValueWidget,'we-range':RangeUserValueWidget,'we-select-pager':SelectPagerUserValueWidget,};const SnippetOptionWidget=Widget.extend({tagName:'we-customizeblock-option',events:{'click .o_we_collapse_toggler':'_onCollapseTogglerClick',},custom_events:{'user_value_update':'_onUserValueUpdate','user_value_widget_critical':'_onUserValueWidgetCritical',},isTopOption:false,forceNoDeleteButton:false,init:function(parent,$uiElements,$target,$overlay,data,options){this._super.apply(this,arguments);this.$originalUIElements=$uiElements;this.$target=$target;this.$overlay=$overlay;this.data=data;this.options=options;this.className='snippet-option-'+this.data.optionName;this.ownerDocument=this.$target[0].ownerDocument;this._userValueWidgets=[];this._actionQueues=new Map();},willStart:async function(){await this._super(...arguments);return this._renderOriginalXML().then(uiFragment=>{this.uiFragment=uiFragment;});},renderElement:function(){this._super(...arguments);this.el.appendChild(this.uiFragment);this.uiFragment=null;},onFocus:function(){},onBuilt:function(){},onBlur:function(){},onClone:function(options){},onMove:function(){},onRemove:function(){},onTargetShow:async function(){},onTargetHide:async function(){},cleanForSave:async function(){},selectClass:function(previewMode,widgetValue,params){for(const classNames of params.possibleValues){if(classNames){this.$target[0].classList.remove(...classNames.trim().split(/\s+/g));}}
if(widgetValue){this.$target[0].classList.add(...widgetValue.trim().split(/\s+/g));}},selectDataAttribute:function(previewMode,widgetValue,params){const value=this._selectAttributeHelper(widgetValue,params);this.$target[0].dataset[params.attributeName]=value;},selectAttribute:function(previewMode,widgetValue,params){const value=this._selectAttributeHelper(widgetValue,params);this.$target[0].setAttribute(params.attributeName,value);},selectStyle:function(previewMode,widgetValue,params){this.$target[0].classList.add('o_we_force_no_transition');const _restoreTransitions=()=>this.$target[0].classList.remove('o_we_force_no_transition');if(params.cssProperty==='background-color'){this.$target.trigger('background-color-event',previewMode);}
const cssProps=weUtils.CSS_SHORTHANDS[params.cssProperty]||[params.cssProperty];for(const cssProp of cssProps){this.$target[0].style.setProperty(cssProp,'');}
if(params.extraClass){this.$target.removeClass(params.extraClass);}
if(params.colorNames&&params.colorPrefix){const classes=weUtils.computeColorClasses(params.colorNames,params.colorPrefix);this.$target[0].classList.remove(...classes);if(weUtils.isColorCombinationName(widgetValue)){this.$target[0].classList.add('o_cc',`o_cc${widgetValue}`,params.extraClass);_restoreTransitions();return;}
if(params.colorNames.includes(widgetValue)){const originalCSSValue=window.getComputedStyle(this.$target[0])[cssProps[0]];const className=params.colorPrefix+widgetValue;this.$target[0].classList.add(className);if(originalCSSValue!==window.getComputedStyle(this.$target[0])[cssProps[0]]){this.$target.addClass(params.extraClass);_restoreTransitions();return;}
this.$target[0].classList.remove(className);}}
const htmlPropValue=weUtils.getCSSVariableValue(widgetValue);if(htmlPropValue){widgetValue=`var(--${widgetValue})`;}
const values=widgetValue.replace(/,\s/g,',').split(/\s+/g);while(values.length<cssProps.length){switch(values.length){case 1:case 2:{values.push(values[0]);break;}
case 3:{values.push(values[1]);break;}
default:{values.push(values[values.length-1]);}}}
const styles=window.getComputedStyle(this.$target[0]);let hasUserValue=false;for(let i=cssProps.length-1;i>0;i--){hasUserValue=applyCSS.call(this,cssProps[i],values.pop(),styles)||hasUserValue;}
hasUserValue=applyCSS.call(this,cssProps[0],values.join(' '),styles)||hasUserValue;function applyCSS(cssProp,cssValue,styles){if(!weUtils.areCssValuesEqual(styles[cssProp],cssValue)){this.$target[0].style.setProperty(cssProp,cssValue,'important');return true;}
return false;}
if(params.extraClass){this.$target.toggleClass(params.extraClass,hasUserValue);}
_restoreTransitions();},$:function(){return this.$target.find.apply(this.$target,arguments);},closeWidgets:function(){this._userValueWidgets.forEach(widget=>widget.close());},findWidget:function(name){for(const widget of this._userValueWidgets){if(widget.getName()===name){return widget;}
const depWidget=widget.findWidget(name);if(depWidget){return depWidget;}}
return null;},notify:function(name,data){if(name==='target'){this.setTarget(data);}},setTarget:function($target){this.$target=$target;},updateUI:async function({noVisibility}={}){const proms=this._userValueWidgets.map(async widget=>{const methodsNames=widget.getMethodsNames();for(const methodName of methodsNames){const params=widget.getMethodsParams(methodName);let obj=this;if(params.applyTo){const $firstSubTarget=this.$(params.applyTo).eq(0);if(!$firstSubTarget.length){continue;}
obj=createPropertyProxy(this,'$target',$firstSubTarget);}
const value=await this._computeWidgetState.call(obj,methodName,params);if(value===undefined){continue;}
const normalizedValue=this._normalizeWidgetValue(value);await widget.setValue(normalizedValue,methodName);}});await Promise.all(proms);if(!noVisibility){await this.updateUIVisibility();}},updateUIVisibility:async function(){const proms=this._userValueWidgets.map(async widget=>{const params=widget.getMethodsParams();let obj=this;if(params.applyTo){const $firstSubTarget=this.$(params.applyTo).eq(0);if(!$firstSubTarget.length){widget.toggleVisibility(false);return;}
obj=createPropertyProxy(this,'$target',$firstSubTarget);}
const allSubWidgets=[widget];let i=0;while(i<allSubWidgets.length){allSubWidgets.push(...allSubWidgets[i]._userValueWidgets);i++;}
const proms=allSubWidgets.map(async widget=>{const show=await this._computeWidgetVisibility.call(obj,widget.getName(),params);if(!show){widget.toggleVisibility(false);return;}
const dependencies=widget.getDependencies();const dependenciesData=[];dependencies.forEach(depName=>{const toBeActive=(depName[0]!=='!');if(!toBeActive){depName=depName.substr(1);}
const widget=this._requestUserValueWidgets(depName)[0];if(widget){dependenciesData.push({widget:widget,toBeActive:toBeActive,});}});const dependenciesOK=!dependenciesData.length||dependenciesData.some(depData=>{return(depData.widget.isActive()===depData.toBeActive);});widget.toggleVisibility(dependenciesOK);});return Promise.all(proms);});const showUI=await this._computeVisibility();this.el.classList.toggle('d-none',!showUI);await Promise.all(proms);for(const el of this.$el.find('we-row')){el.classList.toggle('d-none',!$(el).find('> div > .o_we_user_value_widget').not('.d-none').length);}
for(const el of this.$el.find('we-collapse')){const $el=$(el);el.classList.toggle('d-none',$el.children().first().hasClass('d-none'));const hasNoVisibleElInCollapseMenu=!$el.children().last().children().not('.d-none').length;if(hasNoVisibleElInCollapseMenu){this._toggleCollapseEl(el,false);}
el.querySelector('.o_we_collapse_toggler').classList.toggle('d-none',hasNoVisibleElInCollapseMenu);}},async _checkIfWidgetsUpdateNeedWarning(widgets){const messages=[];for(const widget of widgets){const message=widget.getMethodsParams().warnMessage;if(message){messages.push(message);}}
return messages.join(' ');},async _checkIfWidgetsUpdateNeedReload(widgets){return false;},_computeVisibility:async function(){return true;},_computeWidgetState:async function(methodName,params){switch(methodName){case'selectClass':{let maxNbClasses=0;let activeClassNames='';params.possibleValues.forEach(classNames=>{if(!classNames){return;}
const classes=classNames.split(/\s+/g);if(classes.length>=maxNbClasses&&classes.every(className=>this.$target[0].classList.contains(className))){maxNbClasses=classes.length;activeClassNames=classNames;}});return activeClassNames;}
case'selectAttribute':case'selectDataAttribute':{const attrName=params.attributeName;let attrValue;if(methodName==='selectAttribute'){attrValue=this.$target[0].getAttribute(attrName);}else if(methodName==='selectDataAttribute'){attrValue=this.$target[0].dataset[attrName];}
attrValue=(attrValue||'').trim();if(params.saveUnit&&!params.withUnit){attrValue=attrValue.split(/\s+/g).map(v=>v+params.saveUnit).join(' ');}
return attrValue||params.attributeDefaultValue||'';}
case'selectStyle':{if(params.colorPrefix&&params.colorNames){for(const c of params.colorNames){const className=weUtils.computeColorClasses([c],params.colorPrefix)[0];if(this.$target[0].classList.contains(className)){return c;}}}
this.$target[0].classList.add('o_we_force_no_transition');const _restoreTransitions=()=>this.$target[0].classList.remove('o_we_force_no_transition');const styles=window.getComputedStyle(this.$target[0]);const cssProps=weUtils.CSS_SHORTHANDS[params.cssProperty]||[params.cssProperty];const cssValues=cssProps.map(cssProp=>{let value=styles[cssProp].trim();if(cssProp==='box-shadow'){const inset=value.includes('inset');let values=value.replace(/,\s/g,',').replace('inset','').trim().split(/\s+/g);const color=values.find(s=>!s.match(/^\d/));values=values.join(' ').replace(color,'').trim();value=`${color} ${values}${inset ? ' inset' : ''}`;}
return value;});if(cssValues.length===4&&weUtils.areCssValuesEqual(cssValues[3],cssValues[1],params.cssProperty,this.$target)){cssValues.pop();}
if(cssValues.length===3&&weUtils.areCssValuesEqual(cssValues[2],cssValues[0],params.cssProperty,this.$target)){cssValues.pop();}
if(cssValues.length===2&&weUtils.areCssValuesEqual(cssValues[1],cssValues[0],params.cssProperty,this.$target)){cssValues.pop();}
_restoreTransitions();return cssValues.join(' ');}}},_computeWidgetVisibility:async function(widgetName,params){if(widgetName==='move_up_opt'||widgetName==='move_left_opt'){return!this.$target.is(':first-child');}
if(widgetName==='move_down_opt'||widgetName==='move_right_opt'){return!this.$target.is(':last-child');}
return true;},_extraInfoFromDescriptionElement:function(el){return{title:el.getAttribute('string'),options:{classes:el.classList,dataAttributes:el.dataset,tooltip:el.title,placeholder:el.getAttribute('placeholder'),childNodes:[...el.childNodes],},};},_normalizeWidgetValue:function(value){value=`${value}`.trim();value=ColorpickerWidget.normalizeCSSColor(value);return value;},_registerUserValueWidget:function(widgetName,parent,title,options){const widget=new userValueWidgetsRegistry[widgetName](parent,title,options,this.$target);if(!parent||parent===this){this._userValueWidgets.push(widget);}else{parent.registerSubWidget(widget);}
return widget;},_renderCustomWidgets:function(uiFragment){return Promise.resolve();},_renderCustomXML:function(uiFragment){return Promise.resolve();},_renderOriginalXML:async function($xml){const uiFragment=document.createDocumentFragment();($xml||this.$originalUIElements).clone(true).appendTo(uiFragment);await this._renderCustomXML(uiFragment);for(const[itemName,build]of[['we-row',_buildRowElement],['we-collapse',_buildCollapseElement]]){uiFragment.querySelectorAll(itemName).forEach(el=>{const infos=this._extraInfoFromDescriptionElement(el);const groupEl=build(infos.title,infos.options);el.parentNode.insertBefore(groupEl,el);el.parentNode.removeChild(el);});}
await this._renderXMLWidgets(uiFragment);await this._renderCustomWidgets(uiFragment);if(this.isDestroyed()){return uiFragment;}
const validMethodNames=[];for(const key in this){validMethodNames.push(key);}
this._userValueWidgets.forEach(widget=>{widget.loadMethodsData(validMethodNames);});return uiFragment;},_renderXMLWidgets:function(parentEl,parentWidget){const proms=[...parentEl.children].map(el=>{const widgetName=el.tagName.toLowerCase();if(!userValueWidgetsRegistry.hasOwnProperty(widgetName)){return this._renderXMLWidgets(el,parentWidget);}
const infos=this._extraInfoFromDescriptionElement(el);const widget=this._registerUserValueWidget(widgetName,parentWidget||this,infos.title,infos.options);return widget.insertAfter(el).then(()=>{parentEl.removeChild(el);if(widget.isContainer()){return this._renderXMLWidgets(widget.el,widget);}});});return Promise.all(proms);},_requestUserValueWidgets:function(...widgetNames){const widgets=[];for(const widgetName of widgetNames){let widget=null;this.trigger_up('user_value_widget_request',{name:widgetName,onSuccess:_widget=>widget=_widget,});if(widget){widgets.push(widget);}}
return widgets;},_rerenderXML:async function(callback){this._userValueWidgets.forEach(widget=>widget.destroy());this._userValueWidgets=[];this.$el.empty();let $xml=undefined;if(callback){$xml=await callback.call(this);}
return this._renderOriginalXML($xml).then(uiFragment=>{this.$el.append(uiFragment);return this.updateUI();});},_select:async function(previewMode,widget){let $applyTo=null;for(const methodName of widget.getMethodsNames()){const widgetValue=widget.getValue(methodName);const params=widget.getMethodsParams(methodName);if(params.applyTo){if(!$applyTo){$applyTo=this.$(params.applyTo);}
const proms=_.map($applyTo,subTargetEl=>{const proxy=createPropertyProxy(this,'$target',$(subTargetEl));return this[methodName].call(proxy,previewMode,widgetValue,params);});await Promise.all(proms);}else{await this[methodName](previewMode,widgetValue,params);}}
($applyTo||this.$target).trigger('content_changed');},_selectAttributeHelper(value,params){if(!params.attributeName){throw new Error('Attribute name missing');}
if(params.saveUnit&&!params.withUnit){value=value.split(params.saveUnit).join('');}
if(params.extraClass){this.$target.toggleClass(params.extraClass,params.defaultValue!==value);}
return value;},_toggleCollapseEl(collapseEl,show){collapseEl.classList.toggle('active',show);collapseEl.querySelector('.o_we_collapse_toggler').classList.toggle('active',show);},_onCollapseTogglerClick(ev){const currentCollapseEl=ev.currentTarget.parentNode;this._toggleCollapseEl(currentCollapseEl);for(const collapseEl of currentCollapseEl.querySelectorAll('we-collapse')){this._toggleCollapseEl(collapseEl,false);}},_onUserValueUpdate:async function(ev){ev.stopPropagation();const widget=ev.data.widget;const previewMode=ev.data.previewMode;let requiresReload=false;if(!ev.data.previewMode&&!ev.data.isSimulatedEvent){const linkedWidgets=this._requestUserValueWidgets(...ev.data.triggerWidgetsNames);const widgets=[ev.data.widget].concat(linkedWidgets);const warnMessage=await this._checkIfWidgetsUpdateNeedWarning(widgets);if(warnMessage){const okWarning=await new Promise(resolve=>{Dialog.confirm(this,warnMessage,{confirm_callback:()=>resolve(true),cancel_callback:()=>resolve(false),});});if(!okWarning){return;}}
const reloadMessage=await this._checkIfWidgetsUpdateNeedReload(widgets);requiresReload=!!reloadMessage;if(requiresReload){const save=await new Promise(resolve=>{Dialog.confirm(this,_t("This change needs to reload the page, this will save all your changes and reload the page, are you sure you want to proceed?")+' '
+(typeof reloadMessage==='string'?reloadMessage:''),{confirm_callback:()=>resolve(true),cancel_callback:()=>resolve(false),});});if(!save){return;}}}
if(!this._actionQueues.get(widget)){this._actionQueues.set(widget,[]);}
const currentAction={previewMode};this._actionQueues.get(widget).push(currentAction);const shouldRecordUndo=(!previewMode&&!ev.data.isSimulatedEvent);this.trigger_up('snippet_edition_request',{exec:async()=>{const actionQueue=this._actionQueues.get(widget).filter(({previewMode},i,actions)=>{const prev=actions[i-1];const next=actions[i+1];if(previewMode===true&&next&&next.previewMode){return false;}else if(previewMode==='reset'&&prev&&prev.previewMode){return false;}
return true;});if(!actionQueue.includes(currentAction)){this._actionQueues.set(widget,actionQueue);return;}
this._actionQueues.set(widget,actionQueue.filter(action=>action!==currentAction));if(ev.data.prepare){ev.data.prepare();}
if(previewMode&&(widget.$el.closest('[data-no-preview="true"]').length)){return;}
if(shouldRecordUndo){this.trigger_up('request_history_undo_record',{$target:this.$target});}
await this._select(previewMode,widget);if(previewMode){return;}
await new Promise(resolve=>setTimeout(()=>{this.trigger_up('snippet_option_update',{onSuccess:()=>resolve(),});}));}});if(ev.data.isSimulatedEvent){return;}
const linkedWidgets=this._requestUserValueWidgets(...ev.data.triggerWidgetsNames);if(linkedWidgets.length!==ev.data.triggerWidgetsNames.length){console.warn('Missing widget to trigger');return;}
let i=0;const triggerWidgetsValues=ev.data.triggerWidgetsValues;for(const linkedWidget of linkedWidgets){const widgetValue=triggerWidgetsValues[i];if(widgetValue!==undefined){const normValue=this._normalizeWidgetValue(widgetValue);if(previewMode===true){linkedWidget._previewColor=normValue;}else if(previewMode===false){linkedWidget._previewColor=false;linkedWidget._value=normValue;}else{linkedWidget._previewColor=false;}}
linkedWidget.notifyValueChange(previewMode,true);i++;}
if(requiresReload){this.trigger_up('request_save',{reloadEditor:true,});}},_onUserValueWidgetCritical(){this.trigger_up('remove_snippet',{$snippet:this.$target,});},});const registry={};registry.sizing=SnippetOptionWidget.extend({start:function(){var self=this;var def=this._super.apply(this,arguments);this.$handles=this.$overlay.find('.o_handle');var resizeValues=this._getSize();this.$handles.on('mousedown',function(ev){ev.preventDefault();resizeValues=self._getSize();var $handle=$(ev.currentTarget);var compass=false;var XY=false;if($handle.hasClass('n')){compass='n';XY='Y';}else if($handle.hasClass('s')){compass='s';XY='Y';}else if($handle.hasClass('e')){compass='e';XY='X';}else if($handle.hasClass('w')){compass='w';XY='X';}
var resize=resizeValues[compass];if(!resize){return;}
var current=0;var cssProperty=resize[2];var cssPropertyValue=parseInt(self.$target.css(cssProperty));_.each(resize[0],function(val,key){if(self.$target.hasClass(val)){current=key;}else if(resize[1][key]===cssPropertyValue){current=key;}});var begin=current;var beginClass=self.$target.attr('class');var regClass=new RegExp('\\s*'+resize[0][begin].replace(/[-]*[0-9]+/,'[-]*[0-9]+'),'g');var cursor=$handle.css('cursor')+'-important';var $body=$(this.ownerDocument.body);$body.addClass(cursor);var xy=ev['page'+XY];var bodyMouseMove=function(ev){ev.preventDefault();var dd=ev['page'+XY]-xy+resize[1][begin];var next=current+(current+1===resize[1].length?0:1);var prev=current?(current-1):0;var change=false;if(dd>(2*resize[1][next]+resize[1][current])/3){self.$target.attr('class',(self.$target.attr('class')||'').replace(regClass,''));self.$target.addClass(resize[0][next]);current=next;change=true;}
if(prev!==current&&dd<(2*resize[1][prev]+resize[1][current])/3){self.$target.attr('class',(self.$target.attr('class')||'').replace(regClass,''));self.$target.addClass(resize[0][prev]);current=prev;change=true;}
if(change){self._onResize(compass,beginClass,current);self.trigger_up('cover_update');$handle.addClass('o_active');}};var bodyMouseUp=function(){$body.off('mousemove',bodyMouseMove);$(window).off('mouseup',bodyMouseUp);$body.removeClass(cursor);$handle.removeClass('o_active');var $handlers=self.$overlay.find('.o_handle');$handlers.addClass('o_active').delay(300).queue(function(){$handlers.removeClass('o_active').dequeue();});if(begin===current){return;}
setTimeout(function(){self.trigger_up('request_history_undo_record',{$target:self.$target,event:'resize_'+XY,});},0);};$body.on('mousemove',bodyMouseMove);$(window).on('mouseup',bodyMouseUp);});return def;},onFocus:function(){this._onResize();},onBlur:function(){this.$handles.addClass('readonly');},setTarget:function(){this._super(...arguments);this._onResize();},updateUI:async function(){await this._super(...arguments);const resizeValues=this._getSize();_.each(resizeValues,(value,key)=>{this.$handles.filter('.'+key).toggleClass('readonly',!value);});},_getSize:function(){},_onResize:function(compass,beginClass,current){var self=this;var resizeValues=this._getSize();var $handles=this.$overlay.find('.o_handle');_.each(resizeValues,function(resizeValue,direction){var classes=resizeValue[0];var values=resizeValue[1];var cssProperty=resizeValue[2];var $handle=$handles.filter('.'+direction);var current=0;var cssPropertyValue=parseInt(self.$target.css(cssProperty));_.each(classes,function(className,key){if(self.$target.hasClass(className)){current=key;}else if(values[key]===cssPropertyValue){current=key;}});$handle.toggleClass('o_handle_start',current===0);$handle.toggleClass('o_handle_end',current===classes.length-1);});var ml=this.$target.css('margin-left');this.$overlay.find('.o_handle.w').css({width:ml,left:'-'+ml,});this.$overlay.find('.o_handle.e').css({width:0,});_.each(this.$overlay.find(".o_handle.n, .o_handle.s"),function(handle){var $handle=$(handle);var direction=$handle.hasClass('n')?'top':'bottom';$handle.height(self.$target.css('padding-'+direction));});this.$target.trigger('content_changed');},});registry['sizing_y']=registry.sizing.extend({_getSize:function(){var nClass='pt';var nProp='padding-top';var sClass='pb';var sProp='padding-bottom';if(this.$target.is('hr')){nClass='mt';nProp='margin-top';sClass='mb';sProp='margin-bottom';}
var grid=[];for(var i=0;i<=(256/8);i++){grid.push(i*8);}
grid.splice(1,0,4);this.grid={n:[grid.map(v=>nClass+v),grid,nProp],s:[grid.map(v=>sClass+v),grid,sProp],};return this.grid;},});const ImageHandlerOption=SnippetOptionWidget.extend({async willStart(){const _super=this._super.bind(this);await this._loadImageInfo();const img=this._getImg();await new Promise((resolve,reject)=>{if(img.complete){return resolve();}
img.addEventListener('load',resolve,{once:true});img.addEventListener('error',resolve,{once:true});});return _super(...arguments);},selectWidth(previewMode,widgetValue,params){this._getImg().dataset.resizeWidth=widgetValue;return this._applyOptions();},setQuality(previewMode,widgetValue,params){this._getImg().dataset.quality=widgetValue;return this._applyOptions();},glFilter(previewMode,widgetValue,params){const dataset=this._getImg().dataset;if(widgetValue){dataset.glFilter=widgetValue;}else{delete dataset.glFilter;}
return this._applyOptions();},customFilter(previewMode,widgetValue,params){const img=this._getImg();const{filterOptions}=img.dataset;const{filterProperty}=params;if(filterProperty==='filterColor'){widgetValue=normalizeColor(widgetValue);}
const newOptions=Object.assign(JSON.parse(filterOptions||"{}"),{[filterProperty]:widgetValue});img.dataset.filterOptions=JSON.stringify(newOptions);return this._applyOptions();},_computeVisibility(){const img=this._getImg();if(!['image/jpeg','image/png'].includes(img.dataset.mimetype)){return false;}
const src=img.getAttribute('src');return src&&src!=='/';},_computeWidgetState(methodName,params){const img=this._getImg();switch(methodName){case'selectWidth':return img.naturalWidth;case'setFilter':return img.dataset.filter;case'glFilter':return img.dataset.glFilter||"";case'setQuality':return img.dataset.quality||75;case'customFilter':{const{filterProperty}=params;const options=JSON.parse(img.dataset.filterOptions||"{}");const defaultValue=filterProperty==='blend'?'normal':0;return options[filterProperty]||defaultValue;}}
return this._super(...arguments);},async _renderCustomXML(uiFragment){if(!this.originalSrc){return[...uiFragment.childNodes].forEach(node=>{if(node.matches('.o_we_external_warning')){node.classList.remove('d-none');}else{node.remove();}});}
const img=this._getImg();const $select=$(uiFragment).find('we-select[data-name=width_select_opt]');(await this._computeAvailableWidths()).forEach(([value,label])=>{$select.append(`<we-button data-select-width="${value}">${label}</we-button>`);});const qualityRange=uiFragment.querySelector('we-range');if(img.dataset.mimetype!=='image/jpeg'){qualityRange.remove();}},async _computeAvailableWidths(){const img=this._getImg();const original=await loadImage(this.originalSrc);const maxWidth=img.dataset.width?img.naturalWidth:original.naturalWidth;const optimizedWidth=Math.min(maxWidth,this._computeMaxDisplayWidth());this.optimizedWidth=optimizedWidth;const widths={128:'128px',256:'256px',512:'512px',1024:'1024px',1920:'1920px',};widths[img.naturalWidth]=_.str.sprintf(_t("%spx"),img.naturalWidth);widths[optimizedWidth]=_.str.sprintf(_t("%dpx (Suggested)"),optimizedWidth);widths[maxWidth]=_.str.sprintf(_t("%dpx (Original)"),maxWidth);return Object.entries(widths).filter(([width])=>width<=maxWidth).sort(([v1],[v2])=>v1-v2);},async _applyOptions(){const img=this._getImg();if(!['image/jpeg','image/png'].includes(img.dataset.mimetype)){this.originalId=null;return;}
const dataURL=await applyModifications(img);const weight=dataURL.split(',')[1].length/4*3;const $weight=this.$el.find('.o_we_image_weight');$weight.find('> small').text(_t("New size"));$weight.find('b').text(`${(weight / 1024).toFixed(1)} kb`);$weight.removeClass('d-none');img.classList.add('o_modified_image_to_save');return loadImage(dataURL,img);},async _loadImageInfo(){const img=this._getImg();await loadImageInfo(img,this._rpc.bind(this));if(!img.dataset.originalId){this.originalId=null;this.originalSrc=null;return;}
this.originalId=img.dataset.originalId;this.originalSrc=img.dataset.originalSrc;},async _autoOptimizeImage(){await this._loadImageInfo();await this._rerenderXML();this._getImg().dataset.resizeWidth=this.optimizedWidth;await this._applyOptions();await this.updateUI();},_getImg(){},_computeMaxDisplayWidth(){},});registry.ImageOptimize=ImageHandlerOption.extend({start(){this.$target.on('image_changed.ImageOptimization',this._onImageChanged.bind(this));this.$target.on('image_cropped.ImageOptimization',this._onImageCropped.bind(this));return this._super(...arguments);},destroy(){this.$target.off('.ImageOptimization');return this._super(...arguments);},_computeMaxDisplayWidth(){const displayWidth=this._getImg().clientWidth;if(this.$target.closest('[class*="col-lg"]').length){if(this.$target.closest('.container, .o_container_small').length){return Math.min(1920,Math.max(displayWidth,690));}
return Math.min(1920,Math.max(displayWidth,962));}
return displayWidth;},_getImg(){return this.$target[0];},async _onImageChanged(ev){this.trigger_up('snippet_edition_request',{exec:async()=>{await this._autoOptimizeImage();this.trigger_up('cover_update');}});},async _onImageCropped(ev){await this._rerenderXML();},});registry.BackgroundOptimize=ImageHandlerOption.extend({start(){this.$target.on('background_changed.BackgroundOptimize',this._onBackgroundChanged.bind(this));return this._super(...arguments);},destroy(){this.$target.off('.BackgroundOptimize');return this._super(...arguments);},async cleanForSave(){const img=this._getImg();if(img.matches('.o_modified_image_to_save')){this.$target.addClass('o_modified_image_to_save');Object.entries(img.dataset).forEach(([key,value])=>{this.$target[0].dataset[key]=value;});this.$target[0].dataset.bgSrc=img.getAttribute('src');}},_getImg(){return this.img;},_computeMaxDisplayWidth(){return 1920;},async _applyOptions(){await this._super(...arguments);this.$target.css('background-image',`url('${this._getImg().getAttribute('src')}')`);},async _loadImageInfo(){this.img=new Image();Object.entries(this.$target[0].dataset).forEach(([key,value])=>{this.img.dataset[key]=value;});const src=getBgImageURL(this.$target[0]);this.img.src=src.startsWith('/')?src:'';return await this._super(...arguments);},async _onBackgroundChanged(ev,previewMode){if(!previewMode){this.trigger_up('snippet_edition_request',{exec:async()=>{await this._autoOptimizeImage();}});}},});registry.BackgroundToggler=SnippetOptionWidget.extend({start(){this.$target.on('content_changed.BackgroundToggler',this._onExternalUpdate.bind(this));return this._super(...arguments);},destroy(){this._super(...arguments);this.$target.off('.BackgroundToggler');},toggleBgImage(previewMode,widgetValue,params){if(!widgetValue){const[bgImageWidget]=this._requestUserValueWidgets('bg_image_opt');const bgImageOpt=bgImageWidget.getParent();return bgImageOpt.background(false,'',bgImageWidget.getMethodsParams('background'));}else{this._requestUserValueWidgets('bg_image_opt')[0].el.click();}},toggleBgShape(previewMode,widgetValue,params){const[shapeWidget]=this._requestUserValueWidgets('bg_shape_opt');const shapeOption=shapeWidget.getParent();return shapeOption._toggleShape();},toggleBgFilter(previewMode,widgetValue,params){if(widgetValue){const bgFilterEl=document.createElement('div');bgFilterEl.classList.add('o_we_bg_filter','bg-black-50');const lastBackgroundEl=this._getLastPreFilterLayerElement();if(lastBackgroundEl){$(lastBackgroundEl).after(bgFilterEl);}else{this.$target.prepend(bgFilterEl);}}else{this.$target.find('.o_we_bg_filter').remove();}},_computeWidgetState(methodName,params){switch(methodName){case'toggleBgImage':{const[bgImageWidget]=this._requestUserValueWidgets('bg_image_opt');const bgImageOpt=bgImageWidget.getParent();return!!bgImageOpt._computeWidgetState('background',bgImageWidget.getMethodsParams('background'));}
case'toggleBgFilter':{return this._hasBgFilter();}
case'toggleBgShape':{const[shapeWidget]=this._requestUserValueWidgets('bg_shape_opt');const shapeOption=shapeWidget.getParent();return!!shapeOption._computeWidgetState('shape',shapeWidget.getMethodsParams('shape'));}}
return this._super(...arguments);},_getLastPreFilterLayerElement(){return null;},_hasBgFilter(){return!!this.$target.find('> .o_we_bg_filter').length;},_onExternalUpdate(){if(this._hasBgFilter()&&!this._getLastPreFilterLayerElement()&&!getBgImageURL(this.$target)){const widget=this._requestUserValueWidgets('bg_filter_toggle_opt')[0];widget.$el.click();}},});registry.BackgroundImage=SnippetOptionWidget.extend({start:function(){this.__customImageSrc=getBgImageURL(this.$target[0]);return this._super(...arguments);},background:async function(previewMode,widgetValue,params){if(previewMode===true){this.__customImageSrc=getBgImageURL(this.$target[0]);}else if(previewMode==='reset'){widgetValue=this.__customImageSrc;}else{this.__customImageSrc=widgetValue;}
this._setBackground(widgetValue);if(previewMode!=='reset'){removeOnImageChangeAttrs.forEach(attr=>delete this.$target[0].dataset[attr]);this.$target.trigger('background_changed',[previewMode]);}},async dynamicColor(previewMode,widgetValue,params){const currentSrc=getBgImageURL(this.$target[0]);switch(previewMode){case true:this.previousSrc=currentSrc;break;case'reset':this.$target.css('background-image',`url('${this.previousSrc}')`);return;}
const newURL=new URL(currentSrc,window.location.origin);newURL.searchParams.set('c1',normalizeColor(widgetValue));const src=newURL.pathname+newURL.search;await loadImage(src);this.$target.css('background-image',`url('${src}')`);if(!previewMode){this.previousSrc=src;}},setTarget:function(){const oldBgURL=getBgImageURL(this.$target);this._setBackground('');this._super(...arguments);if(oldBgURL){this._setBackground(oldBgURL);}
this.__customImageSrc=getBgImageURL(this.$target[0]);},_computeWidgetState:function(methodName){switch(methodName){case'background':return getBgImageURL(this.$target[0]);case'dynamicColor':return new URL(getBgImageURL(this.$target[0]),window.location.origin).searchParams.get('c1');}
return this._super(...arguments);},_computeWidgetVisibility(widgetName,params){if(widgetName==='dynamic_color_opt'){const src=new URL(getBgImageURL(this.$target[0]),window.location.origin);return src.origin===window.location.origin&&src.pathname.startsWith('/web_editor/shape/');}
return this._super(...arguments);},_setBackground(backgroundURL){if(backgroundURL){this.$target.css('background-image',`url('${backgroundURL}')`);this.$target.addClass('oe_img_bg');}else{this.$target.css('background-image','');this.$target.removeClass('oe_img_bg');}},});registry.BackgroundShape=SnippetOptionWidget.extend({updateUI(){if(this.rerender){this.rerender=false;return this._rerenderXML();}
return this._super.apply(this,arguments);},shape(previewMode,widgetValue,params){this._handlePreviewState(previewMode,()=>{return{shape:widgetValue,colors:this._getDefaultColors(),flip:[]};});},color(previewMode,widgetValue,params){this._handlePreviewState(previewMode,()=>{const{colorName}=params;const{colors:previousColors}=this._getShapeData();const newColor=normalizeColor(widgetValue)||this._getDefaultColors()[colorName];const newColors=Object.assign(previousColors,{[colorName]:newColor});return{colors:newColors};});},flipX(previewMode,widgetValue,params){this._flipShape(previewMode,'x');},flipY(previewMode,widgetValue,params){this._flipShape(previewMode,'y');},_computeWidgetState(methodName,params){switch(methodName){case'shape':{return this._getShapeData().shape;}
case'color':{const{shape,colors:customColors}=this._getShapeData();const colors=Object.assign(this._getDefaultColors(),customColors);const color=shape&&colors[params.colorName];return color||'';}
case'flipX':{return this.$target.find('> .o_we_shape.o_we_flip_x').length!==0;}
case'flipY':{return this.$target.find('> .o_we_shape.o_we_flip_y').length!==0;}}
return this._super(...arguments);},_renderCustomXML(uiFragment){Object.keys(this._getDefaultColors()).map(colorName=>{uiFragment.querySelector('[data-name="colors"]').prepend($(`<we-colorpicker data-color="true" data-color-name="${colorName}">`)[0]);});uiFragment.querySelectorAll('we-select-pager we-button[data-shape]').forEach(btn=>{const btnContent=document.createElement('div');btnContent.classList.add('o_we_shape_btn_content','position-relative','border-dark');const btnContentInnerDiv=document.createElement('div');btnContentInnerDiv.classList.add('o_we_shape');btnContent.appendChild(btnContentInnerDiv);const{shape}=btn.dataset;const shapeEl=btnContent.querySelector('.o_we_shape');shapeEl.classList.add(`o_${shape.replace(/\//g, '_')}`);btn.append(btnContent);});return uiFragment;},async _computeWidgetVisibility(widgetName,params){if(widgetName==='shape_none_opt'){return false;}
return this._super(...arguments);},_flipShape(previewMode,axis){this._handlePreviewState(previewMode,()=>{const flip=new Set(this._getShapeData().flip);if(flip.has(axis)){flip.delete(axis);}else{flip.add(axis);}
return{flip:[...flip]};});},_handlePreviewState(previewMode,computeShapeData){if(previewMode==='reset'){if(this.prevShape){this.$target[0].dataset.oeShapeData=this.prevShape;}else{delete this.$target[0].dataset.oeShapeData;}}else{if(previewMode===true){this.prevShape=this.$target[0].dataset.oeShapeData;}
const newShapeData=computeShapeData();this._markShape(newShapeData);if(previewMode===false){this.prevShape=this.$target[0].dataset.oeShapeData;if(newShapeData.hasOwnProperty('shape')){this.rerender=true;}}}
const json=this.$target[0].dataset.oeShapeData;const{shape,colors,flip=[]}=json?JSON.parse(json):{};const target=this.$target[0];let shapeContainer=target.querySelector(':scope > .o_we_shape');if(!shape){if(shapeContainer){shapeContainer.remove();}
return;}
if(!shapeContainer){shapeContainer=document.createElement('div');const preShapeLayerElement=this._getLastPreShapeLayerElement();if(preShapeLayerElement){$(preShapeLayerElement).after(shapeContainer);}else{target.prepend(shapeContainer);}
target.style.position='relative';}
shapeContainer.className=`o_we_shape o_${shape.replace(/\//g, '_')}`;flip.forEach(dir=>{shapeContainer.classList.add(`o_we_flip_${dir}`);});$(shapeContainer).css('background-image',colors?`url("${this._getShapeSrc()}")`:'');},_markShape(newData){const defaultColors=this._getDefaultColors();const shapeData=Object.assign(this._getShapeData(),newData);const areColorsDefault=Object.entries(shapeData.colors).every(([colorName,colorValue])=>{return colorValue.toLowerCase()===defaultColors[colorName].toLowerCase();});if(areColorsDefault){delete shapeData.colors;}
if(!shapeData.shape){delete this.$target[0].dataset.oeShapeData;}else{this.$target[0].dataset.oeShapeData=JSON.stringify(shapeData);}},_getLastPreShapeLayerElement(){const $filterEl=this.$target.find('> .o_we_bg_filter');if($filterEl.length){return $filterEl[0];}
return null;},_getShapeSrc(){const{shape,colors}=this._getShapeData();if(!shape){return'';}
const queryString=Object.entries(colors).map(([colorName,colorValue])=>{const encodedCol=encodeURIComponent(colorValue);return`${colorName}=${encodedCol}`;}).join('&');return`/web_editor/shape/${shape}.svg?${queryString}`;},_getShapeData(target=this.$target[0]){const defaultData={shape:'',colors:this._getDefaultColors(),flip:[],};const json=target.dataset.oeShapeData;return json?Object.assign(defaultData,JSON.parse(json)):defaultData;},_getDefaultColors(){const $shapeContainer=this.$target.find('> .o_we_shape').clone().addClass('d-none').appendTo(document.body);const shapeContainer=$shapeContainer[0];$shapeContainer.css('background-image','');const shapeSrc=shapeContainer&&getBgImageURL(shapeContainer);$shapeContainer.remove();if(!shapeSrc){return{};}
const url=new URL(shapeSrc,window.location.origin);return Object.fromEntries(url.searchParams.entries());},_toggleShape(){if(this._getShapeData().shape){return this._handlePreviewState(false,()=>({shape:''}));}else{const target=this.$target[0];const previousSibling=target.previousElementSibling;const[shapeWidget]=this._requestUserValueWidgets('bg_shape_opt');const possibleShapes=shapeWidget.getMethodsParams('shape').possibleValues;let shapeToSelect;if(previousSibling){const previousShape=this._getShapeData(previousSibling).shape;shapeToSelect=possibleShapes.find((shape,i)=>{return possibleShapes[i-1]===previousShape;});}else{shapeToSelect=possibleShapes[1];}
return this._handlePreviewState(false,()=>({shape:shapeToSelect}));}},});registry.BackgroundPosition=SnippetOptionWidget.extend({xmlDependencies:['/web_editor/static/src/xml/editor.xml'],start:function(){this._super.apply(this,arguments);this._initOverlay();$(window).on('resize.bgposition',()=>this._dimensionOverlay());},destroy:function(){this._toggleBgOverlay(false);$(window).off('.bgposition');this._super.apply(this,arguments);},backgroundType:function(previewMode,widgetValue,params){this.$target.toggleClass('o_bg_img_opt_repeat',widgetValue==='repeat-pattern');this.$target.css('background-position','');this.$target.css('background-size','');},backgroundPositionOverlay:async function(previewMode,widgetValue,params){await new Promise(resolve=>{this.img=document.createElement('img');this.img.addEventListener('load',()=>resolve());this.img.src=getBgImageURL(this.$target[0]);});const position=this.$target.css('background-position').split(' ').map(v=>parseInt(v));const delta=this._getBackgroundDelta();this.originalPosition={left:position[0],top:position[1],};this.currentPosition={left:position[0]/100*delta.x||0,top:position[1]/100*delta.y||0,};this._toggleBgOverlay(true);},selectStyle:function(previewMode,widgetValue,params){if(params.cssProperty==='background-size'&&!this.$target.hasClass('o_bg_img_opt_repeat')){return;}
this._super(...arguments);},_computeVisibility:function(){return this._super(...arguments)&&!!getBgImageURL(this.$target[0]);},_computeWidgetState:function(methodName,params){if(methodName==='backgroundType'){return this.$target.css('background-repeat')==='repeat'?'repeat-pattern':'cover';}
return this._super(...arguments);},_initOverlay:function(){this.$backgroundOverlay=$(qweb.render('web_editor.background_position_overlay'));this.$overlayContent=this.$backgroundOverlay.find('.o_we_overlay_content');this.$overlayBackground=this.$overlayContent.find('.o_overlay_background');this.$backgroundOverlay.on('click','.o_btn_apply',()=>{this.$target.css('background-position',this.$bgDragger.css('background-position'));this._toggleBgOverlay(false);});this.$backgroundOverlay.on('click','.o_btn_discard',()=>{this._toggleBgOverlay(false);});this.$backgroundOverlay.insertAfter(this.$overlay);},_dimensionOverlay:function(){if(!this.$backgroundOverlay.is('.oe_active')){return;}
const $wrapwrap=$('#wrapwrap');const targetOffset=this.$target.offset();this.$backgroundOverlay.css({width:$wrapwrap.innerWidth(),height:$wrapwrap.innerHeight(),});this.$overlayContent.offset(targetOffset);this.$bgDragger.css({width:`${this.$target.innerWidth()}px`,height:`${this.$target.innerHeight()}px`,});const topPos=(parseInt(this.$overlay.css('top'))-parseInt(this.$overlayContent.css('top')));this.$overlayContent.find('.o_we_overlay_buttons').css('top',`${topPos}px`);},_toggleBgOverlay:function(activate){if(!this.$backgroundOverlay||this.$backgroundOverlay.is('.oe_active')===activate){return;}
if(!activate){this.$backgroundOverlay.removeClass('oe_active');this.trigger_up('unblock_preview_overlays');this.trigger_up('activate_snippet',{$snippet:this.$target});$(document).off('click.bgposition');return;}
this.trigger_up('hide_overlay');this.trigger_up('activate_snippet',{$snippet:this.$target,previewMode:true,});this.trigger_up('block_preview_overlays');this.$bgDragger=this.$target.clone().empty();this.$bgDragger.css('background-attachment',this.$target.css('background-attachment'));this.$bgDragger.on('mousedown',this._onDragBackgroundStart.bind(this));this.$bgDragger.tooltip({title:'Click and drag the background to adjust its position!',trigger:'manual',container:this.$backgroundOverlay});this.$overlayBackground.empty().append(this.$bgDragger);this.$backgroundOverlay.addClass('oe_active');this._dimensionOverlay();this.$bgDragger.tooltip('show');window.setTimeout(()=>$(document).on('click.bgposition',this._onDocumentClicked.bind(this)),0);},_getBackgroundDelta:function(){const bgSize=this.$target.css('background-size');if(bgSize!=='cover'){let[width,height]=bgSize.split(' ');if(width==='auto'&&(height==='auto'||!height)){return{x:this.$target.outerWidth()-this.img.naturalWidth,y:this.$target.outerHeight()-this.img.naturalHeight,};}
[width,height]=[parseInt(width),parseInt(height)];return{x:this.$target.outerWidth()-(width||(height*this.img.naturalWidth/this.img.naturalHeight)),y:this.$target.outerHeight()-(height||(width*this.img.naturalHeight/this.img.naturalWidth)),};}
const renderRatio=Math.max(this.$target.outerWidth()/this.img.naturalWidth,this.$target.outerHeight()/this.img.naturalHeight);return{x:this.$target.outerWidth()-Math.round(renderRatio*this.img.naturalWidth),y:this.$target.outerHeight()-Math.round(renderRatio*this.img.naturalHeight),};},_onDragBackgroundStart:function(ev){ev.preventDefault();this.$bgDragger.addClass('o_we_grabbing');const $document=$(this.ownerDocument);$document.on('mousemove.bgposition',this._onDragBackgroundMove.bind(this));$document.one('mouseup',()=>{this.$bgDragger.removeClass('o_we_grabbing');$document.off('mousemove.bgposition');});},_onDragBackgroundMove:function(ev){ev.preventDefault();const delta=this._getBackgroundDelta();this.currentPosition.left=clamp(this.currentPosition.left+ev.originalEvent.movementX,[0,delta.x]);this.currentPosition.top=clamp(this.currentPosition.top+ev.originalEvent.movementY,[0,delta.y]);const percentPosition={left:this.currentPosition.left/delta.x*100,top:this.currentPosition.top/delta.y*100,};percentPosition.left=isFinite(percentPosition.left)?percentPosition.left:this.originalPosition.left;percentPosition.top=isFinite(percentPosition.top)?percentPosition.top:this.originalPosition.top;this.$bgDragger.css('background-position',`${percentPosition.left}% ${percentPosition.top}%`);function clamp(val,bounds){bounds=bounds.sort();return Math.max(bounds[0],Math.min(val,bounds[1]));}},_onDocumentClicked:function(ev){if(!ev.target.closest('.o_we_background_position_overlay')){this._toggleBgOverlay(false);}},});registry.ColoredLevelBackground=registry.BackgroundToggler.extend({start:function(){this._markColorLevel();return this._super(...arguments);},onBuilt:function(){this._markColorLevel();},_markColorLevel:function(){this.$target.addClass('o_colored_level');},});registry.many2one=SnippetOptionWidget.extend({xmlDependencies:['/web_editor/static/src/xml/snippets.xml'],start:function(){var self=this;this.trigger_up('getRecordInfo',_.extend(this.options,{callback:function(recordInfo){_.defaults(self.options,recordInfo);},}));this.Model=this.$target.data('oe-many2one-model');this.ID=+this.$target.data('oe-many2one-id');this.$btn=$(qweb.render('web_editor.many2one.button')).prependTo(this.$el);this.$ul=this.$btn.find('ul');this.$search=this.$ul.find('li:first');this.$search.find('input').on('mousedown click mouseup keyup keydown',function(e){e.stopPropagation();});setTimeout(function(){self.$btn.find('a').on('click',function(e){self._clear();});},0);this.$search.find('input').focus().on('keyup',function(e){self.$overlay.removeClass('o_overlay_hidden');self._findExisting($(this).val());});this.$ul.on('click','li:not(:first) a',function(e){self._selectRecord($(e.currentTarget));});return this._super.apply(this,arguments);},onFocus:function(){this.$target.attr('contentEditable','false');this._clear();},_clear:function(){var self=this;this.$search.siblings().remove();self.$search.find('input').val('');setTimeout(function(){self.$search.find('input').focus();},0);},_findExisting:function(name){var self=this;var domain=[];if(!name||!name.length){self.$search.siblings().remove();return;}
if(isNaN(+name)){if(this.Model!=='res.partner'){domain.push(['name','ilike',name]);}else{domain.push('|',['name','ilike',name],['email','ilike',name]);}}else{domain.push(['id','=',name]);}
return this._rpc({model:this.Model,method:'search_read',args:[domain,this.Model==='res.partner'?['name','display_name','city','country_id']:['name','display_name']],kwargs:{order:[{name:'name',asc:false}],limit:5,context:this.options.context,},}).then(function(result){self.$search.siblings().remove();self.$search.after(qweb.render('web_editor.many2one.search',{contacts:result}));});},_selectRecord:function($li){var self=this;this.ID=+$li.data('id');this.$target.attr('data-oe-many2one-id',this.ID).data('oe-many2one-id',this.ID);this.trigger_up('request_history_undo_record',{$target:this.$target});this.$target.trigger('content_changed');if(self.$target.data('oe-type')==='contact'){$('[data-oe-contact-options]').filter('[data-oe-model="'+self.$target.data('oe-model')+'"]').filter('[data-oe-id="'+self.$target.data('oe-id')+'"]').filter('[data-oe-field="'+self.$target.data('oe-field')+'"]').filter('[data-oe-contact-options!="'+self.$target.data('oe-contact-options')+'"]').add(self.$target).attr('data-oe-many2one-id',self.ID).data('oe-many2one-id',self.ID).each(function(){var $node=$(this);var options=$node.data('oe-contact-options');self._rpc({model:'ir.qweb.field.contact',method:'get_record_to_html',args:[[self.ID]],kwargs:{options:options,context:self.options.context,},}).then(function(html){$node.html(html);});});}else{self.$target.html($li.data('name'));}
this._clear();}});registry.VersionControl=SnippetOptionWidget.extend({xmlDependencies:['/web_editor/static/src/xml/snippets.xml'],start:function(){this.trigger_up('get_snippet_versions',{snippetName:this.$target[0].dataset.snippet,onSuccess:snippetVersions=>{const isUpToDate=snippetVersions&&['vjs','vcss','vxml'].every(key=>this.$target[0].dataset[key]===snippetVersions[key]);if(!isUpToDate){this.$el.prepend(qweb.render('web_editor.outdated_block_message'));}},});return this._super(...arguments);},});registry.SnippetSave=SnippetOptionWidget.extend({xmlDependencies:['/web_editor/static/src/xml/editor.xml'],isTopOption:true,saveSnippet:function(previewMode,widgetValue,params){return new Promise(resolve=>{const dialog=new Dialog(this,{title:_t("Save Your Block"),size:'small',$content:$(qweb.render('web_editor.dialog.save_snippet',{currentSnippetName:_.str.sprintf(_t("Custom %s"),this.data.snippetName),})),buttons:[{text:_t("Save"),classes:'btn-primary',close:true,click:async()=>{const snippetName=dialog.el.querySelector('.o_we_snippet_name_input').value;const targetCopyEl=this.$target[0].cloneNode(true);delete targetCopyEl.dataset.name;const snippetKey=this.$target[0].dataset.snippet;let thumbnailURL;this.trigger_up('snippet_thumbnail_url_request',{key:snippetKey,onSuccess:url=>thumbnailURL=url,});await this._rpc({model:'ir.ui.view',method:'save_snippet',kwargs:{'name':snippetName,'arch':targetCopyEl.outerHTML,'template_key':this.options.snippets,'snippet_key':snippetKey,'thumbnail_url':thumbnailURL,},});this.trigger_up('reload_snippet_template');},},{text:_t("Discard"),close:true,}],}).open();dialog.on('closed',this,()=>resolve());});},});registry.DynamicSvg=SnippetOptionWidget.extend({start(){this.$target.on('image_changed.DynamicSvg',this._onImageChanged.bind(this));return this._super(...arguments);},destroy(){this.$target.off('.DynamicSvg');return this._super(...arguments);},async color(previewMode,widgetValue,params){const target=this.$target[0];switch(previewMode){case true:this.previousSrc=target.getAttribute('src');break;case'reset':target.src=this.previousSrc;return;}
const newURL=new URL(target.src,window.location.origin);newURL.searchParams.set('c1',normalizeColor(widgetValue));const src=newURL.pathname+newURL.search;await loadImage(src);target.src=src;if(!previewMode){this.previousSrc=src;}},_computeWidgetState(methodName,params){switch(methodName){case'color':return new URL(this.$target[0].src,window.location.origin).searchParams.get('c1');}
return this._super(...arguments);},_computeVisibility(methodName,params){return this.$target.is("img[src^='/web_editor/shape/']");},_onImageChanged(methodName,params){return this.updateUI();},});return{SnippetOptionWidget:SnippetOptionWidget,snippetOptionRegistry:registry,NULL_ID:NULL_ID,UserValueWidget:UserValueWidget,userValueWidgetsRegistry:userValueWidgetsRegistry,UnitUserValueWidget:UnitUserValueWidget,addTitleAndAllowedAttributes:_addTitleAndAllowedAttributes,buildElement:_buildElement,buildTitleElement:_buildTitleElement,buildRowElement:_buildRowElement,buildCollapseElement:_buildCollapseElement,Class:SnippetOptionWidget,registry:registry,};});;

/* /web_editor/static/lib/jabberwock/jabberwock.js defined in bundle 'web_editor.assets_wysiwyg' */
;

/* /web_editor/static/src/js/wysiwyg/wysiwyg_translate_attributes.js defined in bundle 'web_editor.assets_wysiwyg' */
;

/* /web_editor/static/src/js/wysiwyg/wysiwyg.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.wysiwyg',function(require){'use strict';var Widget=require('web.Widget');var SummernoteManager=require('web_editor.rte.summernote');var summernoteCustomColors=require('web_editor.rte.summernote_custom_colors');var id=0;var Wysiwyg=Widget.extend({xmlDependencies:[],defaultOptions:{'focus':false,'toolbar':[['style',['style']],['font',['bold','italic','underline','clear']],['fontsize',['fontsize']],['color',['color']],['para',['ul','ol','paragraph']],['table',['table']],['insert',['link','picture']],['history',['undo','redo']],],'styleWithSpan':false,'inlinemedia':['p'],'lang':'odoo','colors':summernoteCustomColors,recordInfo:{context:{},},},init:function(parent,options){this._super.apply(this,arguments);this.id=++id;this.options=options;},willStart:function(){this._summernoteManager=new SummernoteManager(this);this.$target=this.$el;return this._super();},start:function(){this.$target.wrap('<odoo-wysiwyg-container>');this.$el=this.$target.parent();var options=this._editorOptions();this.$target.summernote(options);this.$editor=this.$('.note-editable:first');this.$editor.data('wysiwyg',this);this.$editor.data('oe-model',options.recordInfo.res_model);this.$editor.data('oe-id',options.recordInfo.res_id);$(document).on('mousedown',this._blur);this._value=this.$target.html()||this.$target.val();return this._super.apply(this,arguments);},destroy:function(){$(document).off('mousedown',this._blur);if(this.$target&&this.$target.is('textarea')&&this.$target.next('.note-editor').length){this.$target.summernote('destroy');}
this._super();},getEditable:function(){return this.$editor;},isDirty:function(){return this._value!==(this.$editor.html()||this.$editor.val());},focus:function(){console.log('focus');},getValue:function(options){var $editable=options&&options.$layout||this.$editor.clone();$editable.find('[contenteditable]').removeAttr('contenteditable');$editable.find('[class=""]').removeAttr('class');$editable.find('[style=""]').removeAttr('style');$editable.find('[title=""]').removeAttr('title');$editable.find('[alt=""]').removeAttr('alt');$editable.find('[data-original-title=""]').removeAttr('data-original-title');$editable.find('a.o_image, span.fa, i.fa').html('');$editable.find('[aria-describedby]').removeAttr('aria-describedby').removeAttr('data-original-title');return $editable.html();},save:function(){var isDirty=this.isDirty();var html=this.getValue();if(this.$target.is('textarea')){this.$target.val(html);}else{this.$target.html(html);}
return Promise.resolve({isDirty:isDirty,html:html});},saveModifiedImages:function($editable){return this._summernoteManager.saveModifiedImages($editable);},setValue:function(value,options){if(this.$editor.is('textarea')){this.$target.val(value);}else{this.$target.html(value);}
this.$editor.html(value);},_editorOptions:function(){var self=this;var options=Object.assign({},$.summernote.options,this.defaultOptions,this.options);if(this.options.generateOptions){options=this.options.generateOptions(options);}
options.airPopover=options.toolbar;options.onChange=function(html,$editable){$editable.trigger('content_changed');self.trigger_up('wysiwyg_change');};options.onUpload=function(attachments){self.trigger_up('wysiwyg_attachment',attachments);};options.onFocus=function(){self.trigger_up('wysiwyg_focus');};options.onBlur=function(){self.trigger_up('wysiwyg_blur');};return options;},});Wysiwyg.getRange=function(node){var range=$.summernote.core.range.create();return range&&{sc:range.sc,so:range.so,ec:range.ec,eo:range.eo,};};Wysiwyg.setRange=function(startNode,startOffset,endNode,endOffset){$(startNode).focus();if(endNode){$.summernote.core.range.create(startNode,startOffset,endNode,endOffset).select();}else{$.summernote.core.range.create(startNode,startOffset).select();}
$(startNode.tagName?startNode:startNode.parentNode).trigger('wysiwyg.range');};Wysiwyg.setRangeFromNode=function(node,options){var last=node;while(last.lastChild){last=last.lastChild;}
var first=node;while(first.firstChild){first=first.firstChild;}
if(options&&options.begin&&!options.end){Wysiwyg.setRange(first,0);}else if(options&&!options.begin&&options.end){Wysiwyg.setRange(last,last.textContent.length);}else{Wysiwyg.setRange(first,0,last,last.tagName?last.childNodes.length:last.textContent.length);}};return Wysiwyg;});odoo.define('web_editor.widget',function(require){'use strict';return{Dialog:require('wysiwyg.widgets.Dialog'),MediaDialog:require('wysiwyg.widgets.MediaDialog'),LinkDialog:require('wysiwyg.widgets.LinkDialog'),};});;

/* /web_editor/static/src/js/wysiwyg/wysiwyg_snippets.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.wysiwyg.snippets',function(require){'use strict';var editor=require('web_editor.editor');var Wysiwyg=require('web_editor.wysiwyg');Wysiwyg.include({init:function(parent,options){this._super.apply(this,arguments);this.Editor=editor.Class;if(!this.options.toolbarHandler){this.options.toolbarHandler=$('#web_editor-top-edit');}},start:async function(){if(this.options.snippets){var self=this;this.editor=new(this.Editor)(this,this.options);this.$editor=this.editor.rte.editable();const $body=this.$editor[0]?this.$editor[0].ownerDocument.body:document.body;await this.editor.prependTo($body);this._relocateEditorBar();this.$el.on('content_changed',function(e){self.trigger_up('wysiwyg_change');});}else{return this._super();}},_relocateEditorBar:function(){if(!this.options.toolbarHandler.length){this.options.toolbarHandler=$('.o_we_snippet_text_tools');}
this.options.toolbarHandler.append(this.editor.$el);if(this.editor.snippetsMenu&&!this.editor.snippetsMenu.$el.has(this.options.toolbarHandler).length){this.editor.snippetsMenu.$el.insertAfter(this.options.toolbarHandler);this.editor.snippetsMenu.$snippetEditorArea.insertAfter(this.editor.snippetsMenu.$el);}},});});;

/* /web_editor/static/src/js/wysiwyg/wysiwyg_iframe.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_editor.wysiwyg.iframe',function(require){'use strict';var Wysiwyg=require('web_editor.wysiwyg');var ajax=require('web.ajax');var core=require('web.core');var config=require('web.config');var qweb=core.qweb;var promiseCommon;var promiseWysiwyg;Wysiwyg.include({init:function(parent,options){this._super.apply(this,arguments);if(this.options.inIframe){this._onUpdateIframeId='onLoad_'+this.id;}
this.__extraAssetsForIframe=[];},willStart:function(){if(!this.options.inIframe){return this._super();}
var defAsset;if(this.options.iframeCssAssets){defAsset=ajax.loadAsset(this.options.iframeCssAssets);}else{defAsset=Promise.resolve({cssLibs:[],cssContents:[]});}
promiseWysiwyg=promiseWysiwyg||ajax.loadAsset('web_editor.wysiwyg_iframe_editor_assets');this.defAsset=Promise.all([promiseWysiwyg,defAsset]);this.$target=this.$el;return this.defAsset.then(this._loadIframe.bind(this)).then(this._super.bind(this));},_loadIframe:function(){var self=this;this.$iframe=$('<iframe class="wysiwyg_iframe">').css({'min-height':'55vh',width:'100%'});var avoidDoubleLoad=0;var def=new Promise(function(resolve){window.top[self._onUpdateIframeId]=function(Editor,_avoidDoubleLoad){if(_avoidDoubleLoad!==avoidDoubleLoad){console.warn('Wysiwyg iframe double load detected');return;}
delete window.top[self._onUpdateIframeId];var $iframeTarget=self.$iframe.contents().find('#iframe_target');$iframeTarget.attr("isMobile",config.device.isMobile);$iframeTarget.find('.o_editable').html(self.$target.val());self.options.toolbarHandler=$('#web_editor-top-edit',self.$iframe[0].contentWindow.document);$(qweb.render('web_editor.FieldTextHtml.fullscreen')).appendTo(self.options.toolbarHandler).on('click','.o_fullscreen',function(){$("body").toggleClass("o_field_widgetTextHtml_fullscreen");var full=$("body").hasClass("o_field_widgetTextHtml_fullscreen");self.$iframe.parents().toggleClass('o_form_fullscreen_ancestor',full);$(window).trigger("resize");});self.Editor=Editor;resolve();};});this.$iframe.data('loadDef',def);this.$iframe.on('load',function onLoad(ev){var _avoidDoubleLoad=++avoidDoubleLoad;self.defAsset.then(function(assets){if(_avoidDoubleLoad!==avoidDoubleLoad){console.warn('Wysiwyg immediate iframe double load detected');return;}
var iframeContent=qweb.render('wysiwyg.iframeContent',{assets:assets.concat(self.__extraAssetsForIframe),updateIframeId:self._onUpdateIframeId,avoidDoubleLoad:_avoidDoubleLoad});self.$iframe[0].contentWindow.document.open("text/html","replace").write(iframeContent);});});this.$iframe.insertAfter(this.$target);return def;},});});;

/* /web_unsplash/static/src/js/unsplashapi.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('unsplash.api',function(require){'use strict';var Class=require('web.Class');var rpc=require('web.rpc');var Mixins=require('web.mixins');var ServicesMixin=require('web.ServicesMixin');var UnsplashCore=Class.extend(Mixins.EventDispatcherMixin,ServicesMixin,{init:function(parent){Mixins.EventDispatcherMixin.init.call(this,arguments);this.setParent(parent);this._cache={};this.clientId=false;},getImages:function(query,pageSize){var from=0;var to=pageSize;var cachedData=this._cache[query];if(cachedData&&(cachedData.images.length>=to||(cachedData.totalImages!==0&&cachedData.totalImages<to))){return Promise.resolve({images:cachedData.images.slice(from,to),isMaxed:to>cachedData.totalImages});}
return this._fetchImages(query).then(function(cachedData){return{images:cachedData.images.slice(from,to),isMaxed:to>cachedData.totalImages};});},_fetchImages:function(query){if(!this._cache[query]){this._cache[query]={images:[],maxPages:0,totalImages:0,pageCached:0};}
var cachedData=this._cache[query];var payload={query:query,page:cachedData.pageCached+1,per_page:30,};return this._rpc({route:'/web_unsplash/fetch_images',params:payload,}).then(function(result){if(result.error){return Promise.reject(result.error);}
cachedData.pageCached++;cachedData.images.push.apply(cachedData.images,result.results);cachedData.maxPages=result.total_pages;cachedData.totalImages=result.total;return cachedData;});},});return UnsplashCore;});;

/* /web_unsplash/static/src/js/unsplash_image_widget.js defined in bundle 'web_editor.assets_wysiwyg' */
odoo.define('web_unsplash.image_widgets',function(require){'use strict';var core=require('web.core');var UnsplashAPI=require('unsplash.api');var widgetsMedia=require('wysiwyg.widgets.media');var unsplashAPI=null;const originalEvents=widgetsMedia.ImageWidget.prototype.events;const clickHandler=originalEvents['click .o_existing_attachment_cell'];if(!clickHandler){throw new Error(`Couldn't find a handler for o_existing_attachment_cell clicks.
The unsplash image widget needs to prevent this handler from executing on unsplash attachments.`);}
_.extend(originalEvents,{'click .o_existing_attachment_cell:not(.o_unsplash_attachment_cell)':clickHandler,});delete originalEvents['click .o_existing_attachment_cell'];widgetsMedia.ImageWidget.include({xmlDependencies:widgetsMedia.ImageWidget.prototype.xmlDependencies.concat(['/web_unsplash/static/src/xml/unsplash_image_widget.xml']),events:_.extend({},widgetsMedia.ImageWidget.prototype.events,{'click .o_unsplash_attachment_cell[data-imgid]':'_onUnsplashImgClick','click button.save_unsplash':'_onSaveUnsplashCredentials',}),init:function(){this._super.apply(this,arguments);this._unsplash={selectedImages:{},isMaxed:false,query:false,error:false,records:[],};if(unsplashAPI===null){this.unsplashAPI=new UnsplashAPI(this);unsplashAPI=this.unsplashAPI;}else{this.unsplashAPI=unsplashAPI;this.unsplashAPI.setParent(this);}},destroy:function(){this.unsplashAPI.setParent(undefined);this._super.apply(this,arguments);},_save:async function(){const _super=this._super;if(Object.keys(this._unsplash.selectedImages).length){this.saved=true;const images=await this._rpc({route:'/web_unsplash/attachment/add',params:{unsplashurls:this._unsplash.selectedImages,res_model:this.options.res_model,res_id:this.options.res_id,query:this._unsplash.query,},});this.attachments.push(...images);this.selectedAttachments.push(...images);}
return _super.apply(this,arguments);},search:async function(needle){var self=this;await this._super(...arguments);this._unsplash.query=needle;if(!needle){this._unsplash.records=[];return;}
await this.unsplashAPI.getImages(needle,this.numberOfAttachmentsToDisplay).then(function(res){self._unsplash.isMaxed=res.isMaxed;self._unsplash.records=res.images;self._unsplash.error=false;},function(err){self._unsplash.error=err;});},hasContent(){if(this.searchService==='all'){return this._super(...arguments)||(this.unsplashRecords&&this.unsplashRecords.length);}else if(this.searchService==='unsplash'){return(this.unsplashRecords&&this.unsplashRecords.length);}
return this._super(...arguments);},_highlightSelected:function(){this._super.apply(this,arguments);const $select=this.$('.o_unsplash_attachment_cell[data-imgid]').filter((i,el)=>{return $(el).data('imgid')in this._unsplash.selectedImages;}).addClass('o_we_attachment_selected');return $select;},_loadMoreImages:function(forceSearch){if(!this.$('.o_we_search').val()){return this._super(forceSearch);}
this.numberOfAttachmentsToDisplay+=10;this.search(this.$('.o_we_search').val()).then(()=>this._renderThumbnails());},_renderThumbnails:function(){this._super(...arguments);this.$('.unsplash_error').empty();if(!['all','unsplash'].includes(this.searchService)){return;}
if(this._unsplash.query&&this._unsplash.error){this.$('.unsplash_error').html(core.qweb.render('web_unsplash.dialog.error.content',{status:this._unsplash.error,}));return;}
if(['all','unsplash'].includes(this.searchService)&&this._unsplash.query&&!this._unsplash.isMaxed){this.$('.o_load_more').removeClass('d-none');this.$('.o_load_done_msg').addClass('d-none');}},_renderExisting:function(attachments){this.unsplashRecords=this._unsplash.records.map(record=>{const url=new URL(record.urls.regular);url.searchParams.set('h',2*this.MIN_ROW_HEIGHT);url.searchParams.delete('w');return Object.assign({},record,{url:url.toString(),});});return this._super(...arguments);},_selectAttachement:function(attachment,save){if(!this.options.multiImages){this._unsplash.selectedImages={};}
this._super(...arguments);},_onSaveUnsplashCredentials:function(){var self=this;var key=this.$('#accessKeyInput').val().trim();var appId=this.$('#appIdInput').val().trim();this.$('#accessKeyInput').toggleClass('is-invalid',!key);this.$('#appIdInput').toggleClass('is-invalid',!appId);if(key&&appId){if(!this.$el.find('.is-invalid').length){this._rpc({route:'/web_unsplash/save_unsplash',params:{key:key,appId:appId},}).then(function(){self.unsplashAPI.clientId=key;self._unsplash.error=false;self.search(self._unsplash.query).then(()=>self._renderThumbnails());});}}},_onUnsplashImgClick:function(ev){if(this.saved){return;}
const{imgid,url,downloadUrl,description}=ev.currentTarget.dataset;if(!this.options.multiImages){this._unsplash.selectedImages={};this.selectedAttachments=[];}
if(imgid in this._unsplash.selectedImages){delete this._unsplash.selectedImages[imgid];}else{const _1920Url=new URL(url);_1920Url.searchParams.set('w','1920');this._unsplash.selectedImages[imgid]={url:_1920Url.href,download_url:downloadUrl,description:description};}
this._highlightSelected();if(!this.options.multiImages){this.trigger_up('save_request');}},});});         20190327091201         "                         S             #     
 / *   / w e b _ e d i t o r / s t a t i c / l i b / c r o p p e r j s / c r o p p e r . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ( f u n c t i o n ( g l o b a l , f a c t o r y ) { t y p e o f   e x p o r t s = = = ' o b j e c t ' & & t y p e o f   m o d u l e ! = = ' u n d e f i n e d ' ? m o d u l e . e x p o r t s = f a c t o r y ( ) : t y p e o f   d e f i n e = = = ' f u n c t i o n ' & & d e f i n e . a m d ? d e f i n e ( f a c t o r y ) : ( g l o b a l = g l o b a l | | s e l f , g l o b a l . C r o p p e r = f a c t o r y ( ) ) ; } ( t h i s , f u n c t i o n ( ) { ' u s e   s t r i c t ' ; f u n c t i o n   _ t y p e o f ( o b j ) { i f ( t y p e o f   S y m b o l = = = " f u n c t i o n " & & t y p e o f   S y m b o l . i t e r a t o r = = = " s y m b o l " ) { _ t y p e o f = f u n c t i o n ( o b j ) { r e t u r n   t y p e o f   o b j ; } ; } e l s e { _ t y p e o f = f u n c t i o n ( o b j ) { r e t u r n   o b j & & t y p e o f   S y m b o l = = = " f u n c t i o n " & & o b j . c o n s t r u c t o r = = = S y m b o l & & o b j ! = = S y m b o l . p r o t o t y p e ? " s y m b o l " : t y p e o f   o b j ; } ; } 
 r e t u r n   _ t y p e o f ( o b j ) ; } 
 f u n c t i o n   _ c l a s s C a l l C h e c k ( i n s t a n c e , C o n s t r u c t o r ) { i f ( ! ( i n s t a n c e   i n s t a n c e o f   C o n s t r u c t o r ) ) { t h r o w   n e w   T y p e E r r o r ( " C a n n o t   c a l l   a   c l a s s   a s   a   f u n c t i o n " ) ; } } 
 f u n c t i o n   _ d e f i n e P r o p e r t i e s ( t a r g e t , p r o p s ) { f o r ( v a r   i = 0 ; i < p r o p s . l e n g t h ; i + + ) { v a r   d e s c r i p t o r = p r o p s [ i ] ; d e s c r i p t o r . e n u m e r a b l e = d e s c r i p t o r . e n u m e r a b l e | | f a l s e ; d e s c r i p t o r . c o n f i g u r a b l e = t r u e ; i f ( " v a l u e " i n   d e s c r i p t o r ) d e s c r i p t o r . w r i t a b l e = t r u e ; O b j e c t . d e f i n e P r o p e r t y ( t a r g e t , d e s c r i p t o r . k e y , d e s c r i p t o r ) ; } } 
 f u n c t i o n   _ c r e a t e C l a s s ( C o n s t r u c t o r , p r o t o P r o p s , s t a t i c P r o p s ) { i f ( p r o t o P r o p s ) _ d e f i n e P r o p e r t i e s ( C o n s t r u c t o r . p r o t o t y p e , p r o t o P r o p s ) ; i f ( s t a t i c P r o p s ) _ d e f i n e P r o p e r t i e s ( C o n s t r u c t o r , s t a t i c P r o p s ) ; r e t u r n   C o n s t r u c t o r ; } 
 f u n c t i o n   _ t o C o n s u m a b l e A r r a y ( a r r ) { r e t u r n   _ a r r a y W i t h o u t H o l e s ( a r r ) | | _ i t e r a b l e T o A r r a y ( a r r ) | | _ n o n I t e r a b l e S p r e a d ( ) ; } 
 f u n c t i o n   _ a r r a y W i t h o u t H o l e s ( a r r ) { i f ( A r r a y . i s A r r a y ( a r r ) ) { f o r ( v a r   i = 0 , a r r 2 = n e w   A r r a y ( a r r . l e n g t h ) ; i < a r r . l e n g t h ; i + + ) a r r 2 [ i ] = a r r [ i ] ; r e t u r n   a r r 2 ; } } 
 f u n c t i o n   _ i t e r a b l e T o A r r a y ( i t e r ) { i f ( S y m b o l . i t e r a t o r   i n   O b j e c t ( i t e r ) | | O b j e c t . p r o t o t y p e . t o S t r i n g . c a l l ( i t e r ) = = = " [ o b j e c t   A r g u m e n t s ] " ) r e t u r n   A r r a y . f r o m ( i t e r ) ; } 
 f u n c t i o n   _ n o n I t e r a b l e S p r e a d ( ) { t h r o w   n e w   T y p e E r r o r ( " I n v a l i d   a t t e m p t   t o   s p r e a d   n o n - i t e r a b l e   i n s t a n c e " ) ; } 
 v a r   I S _ B R O W S E R = t y p e o f   w i n d o w ! = = ' u n d e f i n e d ' & & t y p e o f   w i n d o w . d o c u m e n t ! = = ' u n d e f i n e d ' ; v a r   W I N D O W = I S _ B R O W S E R ? w i n d o w : { } ; v a r   I S _ T O U C H _ D E V I C E = I S _ B R O W S E R ? ' o n t o u c h s t a r t ' i n   W I N D O W . d o c u m e n t . d o c u m e n t E l e m e n t : f a l s e ; v a r   H A S _ P O I N T E R _ E V E N T = I S _ B R O W S E R ? ' P o i n t e r E v e n t ' i n   W I N D O W : f a l s e ; v a r   N A M E S P A C E = ' c r o p p e r ' ; v a r   A C T I O N _ A L L = ' a l l ' ; v a r   A C T I O N _ C R O P = ' c r o p ' ; v a r   A C T I O N _ M O V E = ' m o v e ' ; v a r   A C T I O N _ Z O O M = ' z o o m ' ; v a r   A C T I O N _ E A S T = ' e ' ; v a r   A C T I O N _ W E S T = ' w ' ; v a r   A C T I O N _ S O U T H = ' s ' ; v a r   A C T I O N _ N O R T H = ' n ' ; v a r   A C T I O N _ N O R T H _ E A S T = ' n e ' ; v a r   A C T I O N _ N O R T H _ W E S T = ' n w ' ; v a r   A C T I O N _ S O U T H _ E A S T = ' s e ' ; v a r   A C T I O N _ S O U T H _ W E S T = ' s w ' ; v a r   C L A S S _ C R O P = " " . c o n c a t ( N A M E S P A C E , " - c r o p " ) ; v a r   C L A S S _ D I S A B L E D = " " . c o n c a t ( N A M E S P A C E , " - d i s a b l e d " ) ; v a r   C L A S S _ H I D D E N = " " . c o n c a t ( N A M E S P A C E , " - h i d d e n " ) ; v a r   C L A S S _ H I D E = " " . c o n c a t ( N A M E S P A C E , " - h i d e " ) ; v a r   C L A S S _ I N V I S I B L E = " " . c o n c a t ( N A M E S P A C E , " - i n v i s i b l e " ) ; v a r   C L A S S _ M O D A L = " " . c o n c a t ( N A M E S P A C E , " - m o d a l " ) ; v a r   C L A S S _ M O V E = " " . c o n c a t ( N A M E S P A C E , " - m o v e " ) ; v a r   D A T A _ A C T I O N = " " . c o n c a t ( N A M E S P A C E , " A c t i o n " ) ; v a r   D A T A _ P R E V I E W = " " . c o n c a t ( N A M E S P A C E , " P r e v i e w " ) ; v a r   D R A G _ M O D E _ C R O P = ' c r o p ' ; v a r   D R A G _ M O D E _ M O V E = ' m o v e ' ; v a r   D R A G _ M O D E _ N O N E = ' n o n e ' ; v a r   E V E N T _ C R O P = ' c r o p ' ; v a r   E V E N T _ C R O P _ E N D = ' c r o p e n d ' ; v a r   E V E N T _ C R O P _ M O V E = ' c r o p m o v e ' ; v a r   E V E N T _ C R O P _ S T A R T = ' c r o p s t a r t ' ; v a r   E V E N T _ D B L C L I C K = ' d b l c l i c k ' ; v a r   E V E N T _ T O U C H _ S T A R T = I S _ T O U C H _ D E V I C E ? ' t o u c h s t a r t ' : ' m o u s e d o w n ' ; v a r   E V E N T _ T O U C H _ M O V E = I S _ T O U C H _ D E V I C E ? ' t o u c h m o v e ' : ' m o u s e m o v e ' ; v a r   E V E N T _ T O U C H _ E N D = I S _ T O U C H _ D E V I C E ? ' t o u c h e n d   t o u c h c a n c e l ' : ' m o u s e u p ' ; v a r   E V E N T _ P O I N T E R _ D O W N = H A S _ P O I N T E R _ E V E N T ? ' p o i n t e r d o w n ' : E V E N T _ T O U C H _ S T A R T ; v a r   E V E N T _ P O I N T E R _ M O V E = H A S _ P O I N T E R _ E V E N T ? ' p o i n t e r m o v e ' : E V E N T _ T O U C H _ M O V E ; v a r   E V E N T _ P O I N T E R _ U P = H A S _ P O I N T E R _ E V E N T ? ' p o i n t e r u p   p o i n t e r c a n c e l ' : E V E N T _ T O U C H _ E N D ; v a r   E V E N T _ R E A D Y = ' r e a d y ' ; v a r   E V E N T _ R E S I Z E = ' r e s i z e ' ; v a r   E V E N T _ W H E E L = ' w h e e l ' ; v a r   E V E N T _ Z O O M = ' z o o m ' ; v a r   M I M E _ T Y P E _ J P E G = ' i m a g e / j p e g ' ; v a r   R E G E X P _ A C T I O N S = / ^ e | w | s | n | s e | s w | n e | n w | a l l | c r o p | m o v e | z o o m $ / ; v a r   R E G E X P _ D A T A _ U R L = / ^ d a t a : / ; v a r   R E G E X P _ D A T A _ U R L _ J P E G = / ^ d a t a : i m a g e \ / j p e g ; b a s e 6 4 , / ; v a r   R E G E X P _ T A G _ N A M E = / ^ i m g | c a n v a s $ / i ; v a r   M I N _ C O N T A I N E R _ W I D T H = 2 0 0 ; v a r   M I N _ C O N T A I N E R _ H E I G H T = 1 0 0 ; v a r   D E F A U L T S = { v i e w M o d e : 0 , d r a g M o d e : D R A G _ M O D E _ C R O P , i n i t i a l A s p e c t R a t i o : N a N , a s p e c t R a t i o : N a N , d a t a : n u l l , p r e v i e w : ' ' , r e s p o n s i v e : t r u e , r e s t o r e : t r u e , c h e c k C r o s s O r i g i n : t r u e , c h e c k O r i e n t a t i o n : t r u e , m o d a l : t r u e , g u i d e s : t r u e , c e n t e r : t r u e , h i g h l i g h t : t r u e , b a c k g r o u n d : t r u e , a u t o C r o p : t r u e , a u t o C r o p A r e a : 0 . 8 , m o v a b l e : t r u e , r o t a t a b l e : t r u e , s c a l a b l e : t r u e , z o o m a b l e : t r u e , z o o m O n T o u c h : t r u e , z o o m O n W h e e l : t r u e , w h e e l Z o o m R a t i o : 0 . 1 , c r o p B o x M o v a b l e : t r u e , c r o p B o x R e s i z a b l e : t r u e , t o g g l e D r a g M o d e O n D b l c l i c k : t r u e , m i n C a n v a s W i d t h : 0 , m i n C a n v a s H e i g h t : 0 , m i n C r o p B o x W i d t h : 0 , m i n C r o p B o x H e i g h t : 0 , m i n C o n t a i n e r W i d t h : 2 0 0 , m i n C o n t a i n e r H e i g h t : 1 0 0 , r e a d y : n u l l , c r o p s t a r t : n u l l , c r o p m o v e : n u l l , c r o p e n d : n u l l , c r o p : n u l l , z o o m : n u l l } ; v a r   T E M P L A T E = ' < d i v   c l a s s = " c r o p p e r - c o n t a i n e r "   t o u c h - a c t i o n = " n o n e " > ' + ' < d i v   c l a s s = " c r o p p e r - w r a p - b o x " > ' + ' < d i v   c l a s s = " c r o p p e r - c a n v a s " > < / d i v > ' + ' < / d i v > ' + ' < d i v   c l a s s = " c r o p p e r - d r a g - b o x " > < / d i v > ' + ' < d i v   c l a s s = " c r o p p e r - c r o p - b o x " > ' + ' < s p a n   c l a s s = " c r o p p e r - v i e w - b o x " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - d a s h e d   d a s h e d - h " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - d a s h e d   d a s h e d - v " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - c e n t e r " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - f a c e " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - l i n e   l i n e - e "   d a t a - c r o p p e r - a c t i o n = " e " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - l i n e   l i n e - n "   d a t a - c r o p p e r - a c t i o n = " n " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - l i n e   l i n e - w "   d a t a - c r o p p e r - a c t i o n = " w " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - l i n e   l i n e - s "   d a t a - c r o p p e r - a c t i o n = " s " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - e "   d a t a - c r o p p e r - a c t i o n = " e " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - n "   d a t a - c r o p p e r - a c t i o n = " n " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - w "   d a t a - c r o p p e r - a c t i o n = " w " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - s "   d a t a - c r o p p e r - a c t i o n = " s " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - n e "   d a t a - c r o p p e r - a c t i o n = " n e " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - n w "   d a t a - c r o p p e r - a c t i o n = " n w " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - s w "   d a t a - c r o p p e r - a c t i o n = " s w " > < / s p a n > ' + ' < s p a n   c l a s s = " c r o p p e r - p o i n t   p o i n t - s e "   d a t a - c r o p p e r - a c t i o n = " s e " > < / s p a n > ' + ' < / d i v > ' + ' < / d i v > ' ; v a r   i s N a N = N u m b e r . i s N a N | | W I N D O W . i s N a N ; f u n c t i o n   i s N u m b e r ( v a l u e ) { r e t u r n   t y p e o f   v a l u e = = = ' n u m b e r ' & & ! i s N a N ( v a l u e ) ; } 
 v a r   i s P o s i t i v e N u m b e r = f u n c t i o n   i s P o s i t i v e N u m b e r ( v a l u e ) { r e t u r n   v a l u e > 0 & & v a l u e < I n f i n i t y ; } ; f u n c t i o n   i s U n d e f i n e d ( v a l u e ) { r e t u r n   t y p e o f   v a l u e = = = ' u n d e f i n e d ' ; } 
 f u n c t i o n   i s O b j e c t ( v a l u e ) { r e t u r n   _ t y p e o f ( v a l u e ) = = = ' o b j e c t ' & & v a l u e ! = = n u l l ; } 
 v a r   h a s O w n P r o p e r t y = O b j e c t . p r o t o t y p e . h a s O w n P r o p e r t y ; f u n c t i o n   i s P l a i n O b j e c t ( v a l u e ) { i f ( ! i s O b j e c t ( v a l u e ) ) { r e t u r n   f a l s e ; } 
 t r y { v a r   _ c o n s t r u c t o r = v a l u e . c o n s t r u c t o r ; v a r   p r o t o t y p e = _ c o n s t r u c t o r . p r o t o t y p e ; r e t u r n   _ c o n s t r u c t o r & & p r o t o t y p e & & h a s O w n P r o p e r t y . c a l l ( p r o t o t y p e , ' i s P r o t o t y p e O f ' ) ; } c a t c h ( e r r o r ) { r e t u r n   f a l s e ; } } 
 f u n c t i o n   i s F u n c t i o n ( v a l u e ) { r e t u r n   t y p e o f   v a l u e = = = ' f u n c t i o n ' ; } 
 v a r   s l i c e = A r r a y . p r o t o t y p e . s l i c e ; f u n c t i o n   t o A r r a y ( v a l u e ) { r e t u r n   A r r a y . f r o m ? A r r a y . f r o m ( v a l u e ) : s l i c e . c a l l ( v a l u e ) ; } 
 f u n c t i o n   f o r E a c h ( d a t a , c a l l b a c k ) { i f ( d a t a & & i s F u n c t i o n ( c a l l b a c k ) ) { i f ( A r r a y . i s A r r a y ( d a t a ) | | i s N u m b e r ( d a t a . l e n g t h ) ) { t o A r r a y ( d a t a ) . f o r E a c h ( f u n c t i o n ( v a l u e , k e y ) { c a l l b a c k . c a l l ( d a t a , v a l u e , k e y , d a t a ) ; } ) ; } e l s e   i f ( i s O b j e c t ( d a t a ) ) { O b j e c t . k e y s ( d a t a ) . f o r E a c h ( f u n c t i o n ( k e y ) { c a l l b a c k . c a l l ( d a t a , d a t a [ k e y ] , k e y , d a t a ) ; } ) ; } } 
 r e t u r n   d a t a ; } 
 v a r   a s s i g n = O b j e c t . a s s i g n | | f u n c t i o n   a s s i g n ( t a r g e t ) { f o r ( v a r   _ l e n = a r g u m e n t s . l e n g t h , a r g s = n e w   A r r a y ( _ l e n > 1 ? _ l e n - 1 : 0 ) , _ k e y = 1 ; _ k e y < _ l e n ; _ k e y + + ) { a r g s [ _ k e y - 1 ] = a r g u m e n t s [ _ k e y ] ; } 
 i f ( i s O b j e c t ( t a r g e t ) & & a r g s . l e n g t h > 0 ) { a r g s . f o r E a c h ( f u n c t i o n ( a r g ) { i f ( i s O b j e c t ( a r g ) ) { O b j e c t . k e y s ( a r g ) . f o r E a c h ( f u n c t i o n ( k e y ) { t a r g e t [ k e y ] = a r g [ k e y ] ; } ) ; } } ) ; } 
 r e t u r n   t a r g e t ; } ; v a r   R E G E X P _ D E C I M A L S = / \ . \ d * ( ? : 0 | 9 ) { 1 2 } \ d * $ / ; f u n c t i o n   n o r m a l i z e D e c i m a l N u m b e r ( v a l u e ) { v a r   t i m e s = a r g u m e n t s . l e n g t h > 1 & & a r g u m e n t s [ 1 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 1 ] : 1 0 0 0 0 0 0 0 0 0 0 0 ; r e t u r n   R E G E X P _ D E C I M A L S . t e s t ( v a l u e ) ? M a t h . r o u n d ( v a l u e * t i m e s ) / t i m e s : v a l u e ; } 
 v a r   R E G E X P _ S U F F I X = / ^ w i d t h | h e i g h t | l e f t | t o p | m a r g i n L e f t | m a r g i n T o p $ / ; f u n c t i o n   s e t S t y l e ( e l e m e n t , s t y l e s ) { v a r   s t y l e = e l e m e n t . s t y l e ; f o r E a c h ( s t y l e s , f u n c t i o n ( v a l u e , p r o p e r t y ) { i f ( R E G E X P _ S U F F I X . t e s t ( p r o p e r t y ) & & i s N u m b e r ( v a l u e ) ) { v a l u e = " " . c o n c a t ( v a l u e , " p x " ) ; } 
 s t y l e [ p r o p e r t y ] = v a l u e ; } ) ; } 
 f u n c t i o n   h a s C l a s s ( e l e m e n t , v a l u e ) { r e t u r n   e l e m e n t . c l a s s L i s t ? e l e m e n t . c l a s s L i s t . c o n t a i n s ( v a l u e ) : e l e m e n t . c l a s s N a m e . i n d e x O f ( v a l u e ) > - 1 ; } 
 f u n c t i o n   a d d C l a s s ( e l e m e n t , v a l u e ) { i f ( ! v a l u e ) { r e t u r n ; } 
 i f ( i s N u m b e r ( e l e m e n t . l e n g t h ) ) { f o r E a c h ( e l e m e n t , f u n c t i o n ( e l e m ) { a d d C l a s s ( e l e m , v a l u e ) ; } ) ; r e t u r n ; } 
 i f ( e l e m e n t . c l a s s L i s t ) { e l e m e n t . c l a s s L i s t . a d d ( v a l u e ) ; r e t u r n ; } 
 v a r   c l a s s N a m e = e l e m e n t . c l a s s N a m e . t r i m ( ) ; i f ( ! c l a s s N a m e ) { e l e m e n t . c l a s s N a m e = v a l u e ; } e l s e   i f ( c l a s s N a m e . i n d e x O f ( v a l u e ) < 0 ) { e l e m e n t . c l a s s N a m e = " " . c o n c a t ( c l a s s N a m e , "   " ) . c o n c a t ( v a l u e ) ; } } 
 f u n c t i o n   r e m o v e C l a s s ( e l e m e n t , v a l u e ) { i f ( ! v a l u e ) { r e t u r n ; } 
 i f ( i s N u m b e r ( e l e m e n t . l e n g t h ) ) { f o r E a c h ( e l e m e n t , f u n c t i o n ( e l e m ) { r e m o v e C l a s s ( e l e m , v a l u e ) ; } ) ; r e t u r n ; } 
 i f ( e l e m e n t . c l a s s L i s t ) { e l e m e n t . c l a s s L i s t . r e m o v e ( v a l u e ) ; r e t u r n ; } 
 i f ( e l e m e n t . c l a s s N a m e . i n d e x O f ( v a l u e ) > = 0 ) { e l e m e n t . c l a s s N a m e = e l e m e n t . c l a s s N a m e . r e p l a c e ( v a l u e , ' ' ) ; } } 
 f u n c t i o n   t o g g l e C l a s s ( e l e m e n t , v a l u e , a d d e d ) { i f ( ! v a l u e ) { r e t u r n ; } 
 i f ( i s N u m b e r ( e l e m e n t . l e n g t h ) ) { f o r E a c h ( e l e m e n t , f u n c t i o n ( e l e m ) { t o g g l e C l a s s ( e l e m , v a l u e , a d d e d ) ; } ) ; r e t u r n ; } 
 i f ( a d d e d ) { a d d C l a s s ( e l e m e n t , v a l u e ) ; } e l s e { r e m o v e C l a s s ( e l e m e n t , v a l u e ) ; } } 
 v a r   R E G E X P _ C A M E L _ C A S E = / ( [ a - z \ d ] ) ( [ A - Z ] ) / g ; f u n c t i o n   t o P a r a m C a s e ( v a l u e ) { r e t u r n   v a l u e . r e p l a c e ( R E G E X P _ C A M E L _ C A S E , ' $ 1 - $ 2 ' ) . t o L o w e r C a s e ( ) ; } 
 f u n c t i o n   g e t D a t a ( e l e m e n t , n a m e ) { i f ( i s O b j e c t ( e l e m e n t [ n a m e ] ) ) { r e t u r n   e l e m e n t [ n a m e ] ; } 
 i f ( e l e m e n t . d a t a s e t ) { r e t u r n   e l e m e n t . d a t a s e t [ n a m e ] ; } 
 r e t u r n   e l e m e n t . g e t A t t r i b u t e ( " d a t a - " . c o n c a t ( t o P a r a m C a s e ( n a m e ) ) ) ; } 
 f u n c t i o n   s e t D a t a ( e l e m e n t , n a m e , d a t a ) { i f ( i s O b j e c t ( d a t a ) ) { e l e m e n t [ n a m e ] = d a t a ; } e l s e   i f ( e l e m e n t . d a t a s e t ) { e l e m e n t . d a t a s e t [ n a m e ] = d a t a ; } e l s e { e l e m e n t . s e t A t t r i b u t e ( " d a t a - " . c o n c a t ( t o P a r a m C a s e ( n a m e ) ) , d a t a ) ; } } 
 f u n c t i o n   r e m o v e D a t a ( e l e m e n t , n a m e ) { i f ( i s O b j e c t ( e l e m e n t [ n a m e ] ) ) { t r y { d e l e t e   e l e m e n t [ n a m e ] ; } c a t c h ( e r r o r ) { e l e m e n t [ n a m e ] = u n d e f i n e d ; } } e l s e   i f ( e l e m e n t . d a t a s e t ) { t r y { d e l e t e   e l e m e n t . d a t a s e t [ n a m e ] ; } c a t c h ( e r r o r ) { e l e m e n t . d a t a s e t [ n a m e ] = u n d e f i n e d ; } } e l s e { e l e m e n t . r e m o v e A t t r i b u t e ( " d a t a - " . c o n c a t ( t o P a r a m C a s e ( n a m e ) ) ) ; } } 
 v a r   R E G E X P _ S P A C E S = / \ s \ s * / ; v a r   o n c e S u p p o r t e d = f u n c t i o n ( ) { v a r   s u p p o r t e d = f a l s e ; i f ( I S _ B R O W S E R ) { v a r   o n c e = f a l s e ; v a r   l i s t e n e r = f u n c t i o n   l i s t e n e r ( ) { } ; v a r   o p t i o n s = O b j e c t . d e f i n e P r o p e r t y ( { } , ' o n c e ' , { g e t : f u n c t i o n   g e t ( ) { s u p p o r t e d = t r u e ; r e t u r n   o n c e ; } , s e t : f u n c t i o n   s e t ( v a l u e ) { o n c e = v a l u e ; } } ) ; W I N D O W . a d d E v e n t L i s t e n e r ( ' t e s t ' , l i s t e n e r , o p t i o n s ) ; W I N D O W . r e m o v e E v e n t L i s t e n e r ( ' t e s t ' , l i s t e n e r , o p t i o n s ) ; } 
 r e t u r n   s u p p o r t e d ; } ( ) ; f u n c t i o n   r e m o v e L i s t e n e r ( e l e m e n t , t y p e , l i s t e n e r ) { v a r   o p t i o n s = a r g u m e n t s . l e n g t h > 3 & & a r g u m e n t s [ 3 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 3 ] : { } ; v a r   h a n d l e r = l i s t e n e r ; t y p e . t r i m ( ) . s p l i t ( R E G E X P _ S P A C E S ) . f o r E a c h ( f u n c t i o n ( e v e n t ) { i f ( ! o n c e S u p p o r t e d ) { v a r   l i s t e n e r s = e l e m e n t . l i s t e n e r s ; i f ( l i s t e n e r s & & l i s t e n e r s [ e v e n t ] & & l i s t e n e r s [ e v e n t ] [ l i s t e n e r ] ) { h a n d l e r = l i s t e n e r s [ e v e n t ] [ l i s t e n e r ] ; d e l e t e   l i s t e n e r s [ e v e n t ] [ l i s t e n e r ] ; i f ( O b j e c t . k e y s ( l i s t e n e r s [ e v e n t ] ) . l e n g t h = = = 0 ) { d e l e t e   l i s t e n e r s [ e v e n t ] ; } 
 i f ( O b j e c t . k e y s ( l i s t e n e r s ) . l e n g t h = = = 0 ) { d e l e t e   e l e m e n t . l i s t e n e r s ; } } } 
 e l e m e n t . r e m o v e E v e n t L i s t e n e r ( e v e n t , h a n d l e r , o p t i o n s ) ; } ) ; } 
 f u n c t i o n   a d d L i s t e n e r ( e l e m e n t , t y p e , l i s t e n e r ) { v a r   o p t i o n s = a r g u m e n t s . l e n g t h > 3 & & a r g u m e n t s [ 3 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 3 ] : { } ; v a r   _ h a n d l e r = l i s t e n e r ; t y p e . t r i m ( ) . s p l i t ( R E G E X P _ S P A C E S ) . f o r E a c h ( f u n c t i o n ( e v e n t ) { i f ( o p t i o n s . o n c e & & ! o n c e S u p p o r t e d ) { v a r   _ e l e m e n t $ l i s t e n e r s = e l e m e n t . l i s t e n e r s , l i s t e n e r s = _ e l e m e n t $ l i s t e n e r s = = = v o i d   0 ? { } : _ e l e m e n t $ l i s t e n e r s ; _ h a n d l e r = f u n c t i o n   h a n d l e r ( ) { d e l e t e   l i s t e n e r s [ e v e n t ] [ l i s t e n e r ] ; e l e m e n t . r e m o v e E v e n t L i s t e n e r ( e v e n t , _ h a n d l e r , o p t i o n s ) ; f o r ( v a r   _ l e n 2 = a r g u m e n t s . l e n g t h , a r g s = n e w   A r r a y ( _ l e n 2 ) , _ k e y 2 = 0 ; _ k e y 2 < _ l e n 2 ; _ k e y 2 + + ) { a r g s [ _ k e y 2 ] = a r g u m e n t s [ _ k e y 2 ] ; } 
 l i s t e n e r . a p p l y ( e l e m e n t , a r g s ) ; } ; i f ( ! l i s t e n e r s [ e v e n t ] ) { l i s t e n e r s [ e v e n t ] = { } ; } 
 i f ( l i s t e n e r s [ e v e n t ] [ l i s t e n e r ] ) { e l e m e n t . r e m o v e E v e n t L i s t e n e r ( e v e n t , l i s t e n e r s [ e v e n t ] [ l i s t e n e r ] , o p t i o n s ) ; } 
 l i s t e n e r s [ e v e n t ] [ l i s t e n e r ] = _ h a n d l e r ; e l e m e n t . l i s t e n e r s = l i s t e n e r s ; } 
 e l e m e n t . a d d E v e n t L i s t e n e r ( e v e n t , _ h a n d l e r , o p t i o n s ) ; } ) ; } 
 f u n c t i o n   d i s p a t c h E v e n t ( e l e m e n t , t y p e , d a t a ) { v a r   e v e n t ; i f ( i s F u n c t i o n ( E v e n t ) & & i s F u n c t i o n ( C u s t o m E v e n t ) ) { e v e n t = n e w   C u s t o m E v e n t ( t y p e , { d e t a i l : d a t a , b u b b l e s : t r u e , c a n c e l a b l e : t r u e } ) ; } e l s e { e v e n t = d o c u m e n t . c r e a t e E v e n t ( ' C u s t o m E v e n t ' ) ; e v e n t . i n i t C u s t o m E v e n t ( t y p e , t r u e , t r u e , d a t a ) ; } 
 r e t u r n   e l e m e n t . d i s p a t c h E v e n t ( e v e n t ) ; } 
 f u n c t i o n   g e t O f f s e t ( e l e m e n t ) { v a r   b o x = e l e m e n t . g e t B o u n d i n g C l i e n t R e c t ( ) ; r e t u r n { l e f t : b o x . l e f t + ( w i n d o w . p a g e X O f f s e t - d o c u m e n t . d o c u m e n t E l e m e n t . c l i e n t L e f t ) , t o p : b o x . t o p + ( w i n d o w . p a g e Y O f f s e t - d o c u m e n t . d o c u m e n t E l e m e n t . c l i e n t T o p ) } ; } 
 v a r   l o c a t i o n = W I N D O W . l o c a t i o n ; v a r   R E G E X P _ O R I G I N S = / ^ ( \ w + : ) \ / \ / ( [ ^ : / ? # ] * ) : ? ( \ d * ) / i ; f u n c t i o n   i s C r o s s O r i g i n U R L ( u r l ) { v a r   p a r t s = u r l . m a t c h ( R E G E X P _ O R I G I N S ) ; r e t u r n   p a r t s ! = = n u l l & & ( p a r t s [ 1 ] ! = = l o c a t i o n . p r o t o c o l | | p a r t s [ 2 ] ! = = l o c a t i o n . h o s t n a m e | | p a r t s [ 3 ] ! = = l o c a t i o n . p o r t ) ; } 
 f u n c t i o n   a d d T i m e s t a m p ( u r l ) { v a r   t i m e s t a m p = " t i m e s t a m p = " . c o n c a t ( n e w   D a t e ( ) . g e t T i m e ( ) ) ; r e t u r n   u r l + ( u r l . i n d e x O f ( ' ? ' ) = = = - 1 ? ' ? ' : ' & ' ) + t i m e s t a m p ; } 
 f u n c t i o n   g e t T r a n s f o r m s ( _ r e f ) { v a r   r o t a t e = _ r e f . r o t a t e , s c a l e X = _ r e f . s c a l e X , s c a l e Y = _ r e f . s c a l e Y , t r a n s l a t e X = _ r e f . t r a n s l a t e X , t r a n s l a t e Y = _ r e f . t r a n s l a t e Y ; v a r   v a l u e s = [ ] ; i f ( i s N u m b e r ( t r a n s l a t e X ) & & t r a n s l a t e X ! = = 0 ) { v a l u e s . p u s h ( " t r a n s l a t e X ( " . c o n c a t ( t r a n s l a t e X , " p x ) " ) ) ; } 
 i f ( i s N u m b e r ( t r a n s l a t e Y ) & & t r a n s l a t e Y ! = = 0 ) { v a l u e s . p u s h ( " t r a n s l a t e Y ( " . c o n c a t ( t r a n s l a t e Y , " p x ) " ) ) ; } 
 i f ( i s N u m b e r ( r o t a t e ) & & r o t a t e ! = = 0 ) { v a l u e s . p u s h ( " r o t a t e ( " . c o n c a t ( r o t a t e , " d e g ) " ) ) ; } 
 i f ( i s N u m b e r ( s c a l e X ) & & s c a l e X ! = = 1 ) { v a l u e s . p u s h ( " s c a l e X ( " . c o n c a t ( s c a l e X , " ) " ) ) ; } 
 i f ( i s N u m b e r ( s c a l e Y ) & & s c a l e Y ! = = 1 ) { v a l u e s . p u s h ( " s c a l e Y ( " . c o n c a t ( s c a l e Y , " ) " ) ) ; } 
 v a r   t r a n s f o r m = v a l u e s . l e n g t h ? v a l u e s . j o i n ( '   ' ) : ' n o n e ' ; r e t u r n { W e b k i t T r a n s f o r m : t r a n s f o r m , m s T r a n s f o r m : t r a n s f o r m , t r a n s f o r m : t r a n s f o r m } ; } 
 f u n c t i o n   g e t M a x Z o o m R a t i o ( p o i n t e r s ) { v a r   p o i n t e r s 2 = a s s i g n ( { } , p o i n t e r s ) ; v a r   r a t i o s = [ ] ; f o r E a c h ( p o i n t e r s , f u n c t i o n ( p o i n t e r , p o i n t e r I d ) { d e l e t e   p o i n t e r s 2 [ p o i n t e r I d ] ; f o r E a c h ( p o i n t e r s 2 , f u n c t i o n ( p o i n t e r 2 ) { v a r   x 1 = M a t h . a b s ( p o i n t e r . s t a r t X - p o i n t e r 2 . s t a r t X ) ; v a r   y 1 = M a t h . a b s ( p o i n t e r . s t a r t Y - p o i n t e r 2 . s t a r t Y ) ; v a r   x 2 = M a t h . a b s ( p o i n t e r . e n d X - p o i n t e r 2 . e n d X ) ; v a r   y 2 = M a t h . a b s ( p o i n t e r . e n d Y - p o i n t e r 2 . e n d Y ) ; v a r   z 1 = M a t h . s q r t ( x 1 * x 1 + y 1 * y 1 ) ; v a r   z 2 = M a t h . s q r t ( x 2 * x 2 + y 2 * y 2 ) ; v a r   r a t i o = ( z 2 - z 1 ) / z 1 ; r a t i o s . p u s h ( r a t i o ) ; } ) ; } ) ; r a t i o s . s o r t ( f u n c t i o n ( a , b ) { r e t u r n   M a t h . a b s ( a ) < M a t h . a b s ( b ) ; } ) ; r e t u r n   r a t i o s [ 0 ] ; } 
 f u n c t i o n   g e t P o i n t e r ( _ r e f 2 , e n d O n l y ) { v a r   p a g e X = _ r e f 2 . p a g e X , p a g e Y = _ r e f 2 . p a g e Y ; v a r   e n d = { e n d X : p a g e X , e n d Y : p a g e Y } ; r e t u r n   e n d O n l y ? e n d : a s s i g n ( { s t a r t X : p a g e X , s t a r t Y : p a g e Y } , e n d ) ; } 
 f u n c t i o n   g e t P o i n t e r s C e n t e r ( p o i n t e r s ) { v a r   p a g e X = 0 ; v a r   p a g e Y = 0 ; v a r   c o u n t = 0 ; f o r E a c h ( p o i n t e r s , f u n c t i o n ( _ r e f 3 ) { v a r   s t a r t X = _ r e f 3 . s t a r t X , s t a r t Y = _ r e f 3 . s t a r t Y ; p a g e X + = s t a r t X ; p a g e Y + = s t a r t Y ; c o u n t + = 1 ; } ) ; p a g e X / = c o u n t ; p a g e Y / = c o u n t ; r e t u r n { p a g e X : p a g e X , p a g e Y : p a g e Y } ; } 
 f u n c t i o n   g e t A d j u s t e d S i z e s ( _ r e f 4 ) 
 { v a r   a s p e c t R a t i o = _ r e f 4 . a s p e c t R a t i o , h e i g h t = _ r e f 4 . h e i g h t , w i d t h = _ r e f 4 . w i d t h ; v a r   t y p e = a r g u m e n t s . l e n g t h > 1 & & a r g u m e n t s [ 1 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 1 ] : ' c o n t a i n ' ; v a r   i s V a l i d W i d t h = i s P o s i t i v e N u m b e r ( w i d t h ) ; v a r   i s V a l i d H e i g h t = i s P o s i t i v e N u m b e r ( h e i g h t ) ; i f ( i s V a l i d W i d t h & & i s V a l i d H e i g h t ) { v a r   a d j u s t e d W i d t h = h e i g h t * a s p e c t R a t i o ; i f ( t y p e = = = ' c o n t a i n ' & & a d j u s t e d W i d t h > w i d t h | | t y p e = = = ' c o v e r ' & & a d j u s t e d W i d t h < w i d t h ) { h e i g h t = w i d t h / a s p e c t R a t i o ; } e l s e { w i d t h = h e i g h t * a s p e c t R a t i o ; } } e l s e   i f ( i s V a l i d W i d t h ) { h e i g h t = w i d t h / a s p e c t R a t i o ; } e l s e   i f ( i s V a l i d H e i g h t ) { w i d t h = h e i g h t * a s p e c t R a t i o ; } 
 r e t u r n { w i d t h : w i d t h , h e i g h t : h e i g h t } ; } 
 f u n c t i o n   g e t R o t a t e d S i z e s ( _ r e f 5 ) { v a r   w i d t h = _ r e f 5 . w i d t h , h e i g h t = _ r e f 5 . h e i g h t , d e g r e e = _ r e f 5 . d e g r e e ; d e g r e e = M a t h . a b s ( d e g r e e ) % 1 8 0 ; i f ( d e g r e e = = = 9 0 ) { r e t u r n { w i d t h : h e i g h t , h e i g h t : w i d t h } ; } 
 v a r   a r c = d e g r e e % 9 0 * M a t h . P I / 1 8 0 ; v a r   s i n A r c = M a t h . s i n ( a r c ) ; v a r   c o s A r c = M a t h . c o s ( a r c ) ; v a r   n e w W i d t h = w i d t h * c o s A r c + h e i g h t * s i n A r c ; v a r   n e w H e i g h t = w i d t h * s i n A r c + h e i g h t * c o s A r c ; r e t u r n   d e g r e e > 9 0 ? { w i d t h : n e w H e i g h t , h e i g h t : n e w W i d t h } : { w i d t h : n e w W i d t h , h e i g h t : n e w H e i g h t } ; } 
 f u n c t i o n   g e t S o u r c e C a n v a s ( i m a g e , _ r e f 6 , _ r e f 7 , _ r e f 8 ) { v a r   i m a g e A s p e c t R a t i o = _ r e f 6 . a s p e c t R a t i o , i m a g e N a t u r a l W i d t h = _ r e f 6 . n a t u r a l W i d t h , i m a g e N a t u r a l H e i g h t = _ r e f 6 . n a t u r a l H e i g h t , _ r e f 6 $ r o t a t e = _ r e f 6 . r o t a t e , r o t a t e = _ r e f 6 $ r o t a t e = = = v o i d   0 ? 0 : _ r e f 6 $ r o t a t e , _ r e f 6 $ s c a l e X = _ r e f 6 . s c a l e X , s c a l e X = _ r e f 6 $ s c a l e X = = = v o i d   0 ? 1 : _ r e f 6 $ s c a l e X , _ r e f 6 $ s c a l e Y = _ r e f 6 . s c a l e Y , s c a l e Y = _ r e f 6 $ s c a l e Y = = = v o i d   0 ? 1 : _ r e f 6 $ s c a l e Y ; v a r   a s p e c t R a t i o = _ r e f 7 . a s p e c t R a t i o , n a t u r a l W i d t h = _ r e f 7 . n a t u r a l W i d t h , n a t u r a l H e i g h t = _ r e f 7 . n a t u r a l H e i g h t ; v a r   _ r e f 8 $ f i l l C o l o r = _ r e f 8 . f i l l C o l o r , f i l l C o l o r = _ r e f 8 $ f i l l C o l o r = = = v o i d   0 ? ' t r a n s p a r e n t ' : _ r e f 8 $ f i l l C o l o r , _ r e f 8 $ i m a g e S m o o t h i n g E = _ r e f 8 . i m a g e S m o o t h i n g E n a b l e d , i m a g e S m o o t h i n g E n a b l e d = _ r e f 8 $ i m a g e S m o o t h i n g E = = = v o i d   0 ? t r u e : _ r e f 8 $ i m a g e S m o o t h i n g E , _ r e f 8 $ i m a g e S m o o t h i n g Q = _ r e f 8 . i m a g e S m o o t h i n g Q u a l i t y , i m a g e S m o o t h i n g Q u a l i t y = _ r e f 8 $ i m a g e S m o o t h i n g Q = = = v o i d   0 ? ' l o w ' : _ r e f 8 $ i m a g e S m o o t h i n g Q , _ r e f 8 $ m a x W i d t h = _ r e f 8 . m a x W i d t h , m a x W i d t h = _ r e f 8 $ m a x W i d t h = = = v o i d   0 ? I n f i n i t y : _ r e f 8 $ m a x W i d t h , _ r e f 8 $ m a x H e i g h t = _ r e f 8 . m a x H e i g h t , m a x H e i g h t = _ r e f 8 $ m a x H e i g h t = = = v o i d   0 ? I n f i n i t y : _ r e f 8 $ m a x H e i g h t , _ r e f 8 $ m i n W i d t h = _ r e f 8 . m i n W i d t h , m i n W i d t h = _ r e f 8 $ m i n W i d t h = = = v o i d   0 ? 0 : _ r e f 8 $ m i n W i d t h , _ r e f 8 $ m i n H e i g h t = _ r e f 8 . m i n H e i g h t , m i n H e i g h t = _ r e f 8 $ m i n H e i g h t = = = v o i d   0 ? 0 : _ r e f 8 $ m i n H e i g h t ; v a r   c a n v a s = d o c u m e n t . c r e a t e E l e m e n t ( ' c a n v a s ' ) ; v a r   c o n t e x t = c a n v a s . g e t C o n t e x t ( ' 2 d ' ) ; v a r   m a x S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : a s p e c t R a t i o , w i d t h : m a x W i d t h , h e i g h t : m a x H e i g h t } ) ; v a r   m i n S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : a s p e c t R a t i o , w i d t h : m i n W i d t h , h e i g h t : m i n H e i g h t } , ' c o v e r ' ) ; v a r   w i d t h = M a t h . m i n ( m a x S i z e s . w i d t h , M a t h . m a x ( m i n S i z e s . w i d t h , n a t u r a l W i d t h ) ) ; v a r   h e i g h t = M a t h . m i n ( m a x S i z e s . h e i g h t , M a t h . m a x ( m i n S i z e s . h e i g h t , n a t u r a l H e i g h t ) ) ; v a r   d e s t M a x S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : i m a g e A s p e c t R a t i o , w i d t h : m a x W i d t h , h e i g h t : m a x H e i g h t } ) ; v a r   d e s t M i n S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : i m a g e A s p e c t R a t i o , w i d t h : m i n W i d t h , h e i g h t : m i n H e i g h t } , ' c o v e r ' ) ; v a r   d e s t W i d t h = M a t h . m i n ( d e s t M a x S i z e s . w i d t h , M a t h . m a x ( d e s t M i n S i z e s . w i d t h , i m a g e N a t u r a l W i d t h ) ) ; v a r   d e s t H e i g h t = M a t h . m i n ( d e s t M a x S i z e s . h e i g h t , M a t h . m a x ( d e s t M i n S i z e s . h e i g h t , i m a g e N a t u r a l H e i g h t ) ) ; v a r   p a r a m s = [ - d e s t W i d t h / 2 , - d e s t H e i g h t / 2 , d e s t W i d t h , d e s t H e i g h t ] ; c a n v a s . w i d t h = n o r m a l i z e D e c i m a l N u m b e r ( w i d t h ) ; c a n v a s . h e i g h t = n o r m a l i z e D e c i m a l N u m b e r ( h e i g h t ) ; c o n t e x t . f i l l S t y l e = f i l l C o l o r ; c o n t e x t . f i l l R e c t ( 0 , 0 , w i d t h , h e i g h t ) ; c o n t e x t . s a v e ( ) ; c o n t e x t . t r a n s l a t e ( w i d t h / 2 , h e i g h t / 2 ) ; c o n t e x t . r o t a t e ( r o t a t e * M a t h . P I / 1 8 0 ) ; c o n t e x t . s c a l e ( s c a l e X , s c a l e Y ) ; c o n t e x t . i m a g e S m o o t h i n g E n a b l e d = i m a g e S m o o t h i n g E n a b l e d ; c o n t e x t . i m a g e S m o o t h i n g Q u a l i t y = i m a g e S m o o t h i n g Q u a l i t y ; c o n t e x t . d r a w I m a g e . a p p l y ( c o n t e x t , [ i m a g e ] . c o n c a t ( _ t o C o n s u m a b l e A r r a y ( p a r a m s . m a p ( f u n c t i o n ( p a r a m ) { r e t u r n   M a t h . f l o o r ( n o r m a l i z e D e c i m a l N u m b e r ( p a r a m ) ) ; } ) ) ) ) ; c o n t e x t . r e s t o r e ( ) ; r e t u r n   c a n v a s ; } 
 v a r   f r o m C h a r C o d e = S t r i n g . f r o m C h a r C o d e ; f u n c t i o n   g e t S t r i n g F r o m C h a r C o d e ( d a t a V i e w , s t a r t , l e n g t h ) { v a r   s t r = ' ' ; l e n g t h + = s t a r t ; f o r ( v a r   i = s t a r t ; i < l e n g t h ; i + = 1 ) { s t r + = f r o m C h a r C o d e ( d a t a V i e w . g e t U i n t 8 ( i ) ) ; } 
 r e t u r n   s t r ; } 
 v a r   R E G E X P _ D A T A _ U R L _ H E A D = / ^ d a t a : . * , / ; f u n c t i o n   d a t a U R L T o A r r a y B u f f e r ( d a t a U R L ) { v a r   b a s e 6 4 = d a t a U R L . r e p l a c e ( R E G E X P _ D A T A _ U R L _ H E A D , ' ' ) ; v a r   b i n a r y = a t o b ( b a s e 6 4 ) ; v a r   a r r a y B u f f e r = n e w   A r r a y B u f f e r ( b i n a r y . l e n g t h ) ; v a r   u i n t 8 = n e w   U i n t 8 A r r a y ( a r r a y B u f f e r ) ; f o r E a c h ( u i n t 8 , f u n c t i o n ( v a l u e , i ) { u i n t 8 [ i ] = b i n a r y . c h a r C o d e A t ( i ) ; } ) ; r e t u r n   a r r a y B u f f e r ; } 
 f u n c t i o n   a r r a y B u f f e r T o D a t a U R L ( a r r a y B u f f e r , m i m e T y p e ) { v a r   c h u n k s = [ ] ; v a r   c h u n k S i z e = 8 1 9 2 ; v a r   u i n t 8 = n e w   U i n t 8 A r r a y ( a r r a y B u f f e r ) ; w h i l e ( u i n t 8 . l e n g t h > 0 ) { c h u n k s . p u s h ( f r o m C h a r C o d e . a p p l y ( n u l l , t o A r r a y ( u i n t 8 . s u b a r r a y ( 0 , c h u n k S i z e ) ) ) ) ; u i n t 8 = u i n t 8 . s u b a r r a y ( c h u n k S i z e ) ; } 
 r e t u r n " d a t a : " . c o n c a t ( m i m e T y p e , " ; b a s e 6 4 , " ) . c o n c a t ( b t o a ( c h u n k s . j o i n ( ' ' ) ) ) ; } 
 f u n c t i o n   r e s e t A n d G e t O r i e n t a t i o n ( a r r a y B u f f e r ) { v a r   d a t a V i e w = n e w   D a t a V i e w ( a r r a y B u f f e r ) ; v a r   o r i e n t a t i o n ; t r y { v a r   l i t t l e E n d i a n ; v a r   a p p 1 S t a r t ; v a r   i f d S t a r t ; i f ( d a t a V i e w . g e t U i n t 8 ( 0 ) = = = 0 x F F & & d a t a V i e w . g e t U i n t 8 ( 1 ) = = = 0 x D 8 ) { v a r   l e n g t h = d a t a V i e w . b y t e L e n g t h ; v a r   o f f s e t = 2 ; w h i l e ( o f f s e t + 1 < l e n g t h ) { i f ( d a t a V i e w . g e t U i n t 8 ( o f f s e t ) = = = 0 x F F & & d a t a V i e w . g e t U i n t 8 ( o f f s e t + 1 ) = = = 0 x E 1 ) { a p p 1 S t a r t = o f f s e t ; b r e a k ; } 
 o f f s e t + = 1 ; } } 
 i f ( a p p 1 S t a r t ) { v a r   e x i f I D C o d e = a p p 1 S t a r t + 4 ; v a r   t i f f O f f s e t = a p p 1 S t a r t + 1 0 ; i f ( g e t S t r i n g F r o m C h a r C o d e ( d a t a V i e w , e x i f I D C o d e , 4 ) = = = ' E x i f ' ) { v a r   e n d i a n n e s s = d a t a V i e w . g e t U i n t 1 6 ( t i f f O f f s e t ) ; l i t t l e E n d i a n = e n d i a n n e s s = = = 0 x 4 9 4 9 ; i f ( l i t t l e E n d i a n | | e n d i a n n e s s = = = 0 x 4 D 4 D ) { i f ( d a t a V i e w . g e t U i n t 1 6 ( t i f f O f f s e t + 2 , l i t t l e E n d i a n ) = = = 0 x 0 0 2 A ) { v a r   f i r s t I F D O f f s e t = d a t a V i e w . g e t U i n t 3 2 ( t i f f O f f s e t + 4 , l i t t l e E n d i a n ) ; i f ( f i r s t I F D O f f s e t > = 0 x 0 0 0 0 0 0 0 8 ) { i f d S t a r t = t i f f O f f s e t + f i r s t I F D O f f s e t ; } } } } } 
 i f ( i f d S t a r t ) { v a r   _ l e n g t h = d a t a V i e w . g e t U i n t 1 6 ( i f d S t a r t , l i t t l e E n d i a n ) ; v a r   _ o f f s e t ; v a r   i ; f o r ( i = 0 ; i < _ l e n g t h ; i + = 1 ) { _ o f f s e t = i f d S t a r t + i * 1 2 + 2 ; i f ( d a t a V i e w . g e t U i n t 1 6 ( _ o f f s e t , l i t t l e E n d i a n ) = = = 0 x 0 1 1 2 ) { _ o f f s e t + = 8 ; o r i e n t a t i o n = d a t a V i e w . g e t U i n t 1 6 ( _ o f f s e t , l i t t l e E n d i a n ) ; d a t a V i e w . s e t U i n t 1 6 ( _ o f f s e t , 1 , l i t t l e E n d i a n ) ; b r e a k ; } } } } c a t c h ( e r r o r ) { o r i e n t a t i o n = 1 ; } 
 r e t u r n   o r i e n t a t i o n ; } 
 f u n c t i o n   p a r s e O r i e n t a t i o n ( o r i e n t a t i o n ) { v a r   r o t a t e = 0 ; v a r   s c a l e X = 1 ; v a r   s c a l e Y = 1 ; s w i t c h ( o r i e n t a t i o n ) { c a s e   2 : s c a l e X = - 1 ; b r e a k ; c a s e   3 : r o t a t e = - 1 8 0 ; b r e a k ; c a s e   4 : s c a l e Y = - 1 ; b r e a k ; c a s e   5 : r o t a t e = 9 0 ; s c a l e Y = - 1 ; b r e a k ; c a s e   6 : r o t a t e = 9 0 ; b r e a k ; c a s e   7 : r o t a t e = 9 0 ; s c a l e X = - 1 ; b r e a k ; c a s e   8 : r o t a t e = - 9 0 ; b r e a k ; d e f a u l t : } 
 r e t u r n { r o t a t e : r o t a t e , s c a l e X : s c a l e X , s c a l e Y : s c a l e Y } ; } 
 v a r   r e n d e r = { r e n d e r : f u n c t i o n   r e n d e r ( ) { t h i s . i n i t C o n t a i n e r ( ) ; t h i s . i n i t C a n v a s ( ) ; t h i s . i n i t C r o p B o x ( ) ; t h i s . r e n d e r C a n v a s ( ) ; i f ( t h i s . c r o p p e d ) { t h i s . r e n d e r C r o p B o x ( ) ; } } , i n i t C o n t a i n e r : f u n c t i o n   i n i t C o n t a i n e r ( ) { v a r   e l e m e n t = t h i s . e l e m e n t , o p t i o n s = t h i s . o p t i o n s , c o n t a i n e r = t h i s . c o n t a i n e r , c r o p p e r = t h i s . c r o p p e r ; a d d C l a s s ( c r o p p e r , C L A S S _ H I D D E N ) ; r e m o v e C l a s s ( e l e m e n t , C L A S S _ H I D D E N ) ; v a r   c o n t a i n e r D a t a = { w i d t h : M a t h . m a x ( c o n t a i n e r . o f f s e t W i d t h , N u m b e r ( o p t i o n s . m i n C o n t a i n e r W i d t h ) | | 2 0 0 ) , h e i g h t : M a t h . m a x ( c o n t a i n e r . o f f s e t H e i g h t , N u m b e r ( o p t i o n s . m i n C o n t a i n e r H e i g h t ) | | 1 0 0 ) } ; t h i s . c o n t a i n e r D a t a = c o n t a i n e r D a t a ; s e t S t y l e ( c r o p p e r , { w i d t h : c o n t a i n e r D a t a . w i d t h , h e i g h t : c o n t a i n e r D a t a . h e i g h t } ) ; a d d C l a s s ( e l e m e n t , C L A S S _ H I D D E N ) ; r e m o v e C l a s s ( c r o p p e r , C L A S S _ H I D D E N ) ; } , i n i t C a n v a s : f u n c t i o n   i n i t C a n v a s ( ) { v a r   c o n t a i n e r D a t a = t h i s . c o n t a i n e r D a t a , i m a g e D a t a = t h i s . i m a g e D a t a ; v a r   v i e w M o d e = t h i s . o p t i o n s . v i e w M o d e ; v a r   r o t a t e d = M a t h . a b s ( i m a g e D a t a . r o t a t e ) % 1 8 0 = = = 9 0 ; v a r   n a t u r a l W i d t h = r o t a t e d ? i m a g e D a t a . n a t u r a l H e i g h t : i m a g e D a t a . n a t u r a l W i d t h ; v a r   n a t u r a l H e i g h t = r o t a t e d ? i m a g e D a t a . n a t u r a l W i d t h : i m a g e D a t a . n a t u r a l H e i g h t ; v a r   a s p e c t R a t i o = n a t u r a l W i d t h / n a t u r a l H e i g h t ; v a r   c a n v a s W i d t h = c o n t a i n e r D a t a . w i d t h ; v a r   c a n v a s H e i g h t = c o n t a i n e r D a t a . h e i g h t ; i f ( c o n t a i n e r D a t a . h e i g h t * a s p e c t R a t i o > c o n t a i n e r D a t a . w i d t h ) { i f ( v i e w M o d e = = = 3 ) { c a n v a s W i d t h = c o n t a i n e r D a t a . h e i g h t * a s p e c t R a t i o ; } e l s e { c a n v a s H e i g h t = c o n t a i n e r D a t a . w i d t h / a s p e c t R a t i o ; } } e l s e   i f ( v i e w M o d e = = = 3 ) { c a n v a s H e i g h t = c o n t a i n e r D a t a . w i d t h / a s p e c t R a t i o ; } e l s e { c a n v a s W i d t h = c o n t a i n e r D a t a . h e i g h t * a s p e c t R a t i o ; } 
 v a r   c a n v a s D a t a = { a s p e c t R a t i o : a s p e c t R a t i o , n a t u r a l W i d t h : n a t u r a l W i d t h , n a t u r a l H e i g h t : n a t u r a l H e i g h t , w i d t h : c a n v a s W i d t h , h e i g h t : c a n v a s H e i g h t } ; c a n v a s D a t a . l e f t = ( c o n t a i n e r D a t a . w i d t h - c a n v a s W i d t h ) / 2 ; c a n v a s D a t a . t o p = ( c o n t a i n e r D a t a . h e i g h t - c a n v a s H e i g h t ) / 2 ; c a n v a s D a t a . o l d L e f t = c a n v a s D a t a . l e f t ; c a n v a s D a t a . o l d T o p = c a n v a s D a t a . t o p ; t h i s . c a n v a s D a t a = c a n v a s D a t a ; t h i s . l i m i t e d = v i e w M o d e = = = 1 | | v i e w M o d e = = = 2 ; t h i s . l i m i t C a n v a s ( t r u e , t r u e ) ; t h i s . i n i t i a l I m a g e D a t a = a s s i g n ( { } , i m a g e D a t a ) ; t h i s . i n i t i a l C a n v a s D a t a = a s s i g n ( { } , c a n v a s D a t a ) ; } , l i m i t C a n v a s : f u n c t i o n   l i m i t C a n v a s ( s i z e L i m i t e d , p o s i t i o n L i m i t e d ) { v a r   o p t i o n s = t h i s . o p t i o n s , c o n t a i n e r D a t a = t h i s . c o n t a i n e r D a t a , c a n v a s D a t a = t h i s . c a n v a s D a t a , c r o p B o x D a t a = t h i s . c r o p B o x D a t a ; v a r   v i e w M o d e = o p t i o n s . v i e w M o d e ; v a r   a s p e c t R a t i o = c a n v a s D a t a . a s p e c t R a t i o ; v a r   c r o p p e d = t h i s . c r o p p e d & & c r o p B o x D a t a ; i f ( s i z e L i m i t e d ) { v a r   m i n C a n v a s W i d t h = N u m b e r ( o p t i o n s . m i n C a n v a s W i d t h ) | | 0 ; v a r   m i n C a n v a s H e i g h t = N u m b e r ( o p t i o n s . m i n C a n v a s H e i g h t ) | | 0 ; i f ( v i e w M o d e > 1 ) { m i n C a n v a s W i d t h = M a t h . m a x ( m i n C a n v a s W i d t h , c o n t a i n e r D a t a . w i d t h ) ; m i n C a n v a s H e i g h t = M a t h . m a x ( m i n C a n v a s H e i g h t , c o n t a i n e r D a t a . h e i g h t ) ; i f ( v i e w M o d e = = = 3 ) { i f ( m i n C a n v a s H e i g h t * a s p e c t R a t i o > m i n C a n v a s W i d t h ) { m i n C a n v a s W i d t h = m i n C a n v a s H e i g h t * a s p e c t R a t i o ; } e l s e { m i n C a n v a s H e i g h t = m i n C a n v a s W i d t h / a s p e c t R a t i o ; } } } e l s e   i f ( v i e w M o d e > 0 ) { i f ( m i n C a n v a s W i d t h ) { m i n C a n v a s W i d t h = M a t h . m a x ( m i n C a n v a s W i d t h , c r o p p e d ? c r o p B o x D a t a . w i d t h : 0 ) ; } e l s e   i f ( m i n C a n v a s H e i g h t ) { m i n C a n v a s H e i g h t = M a t h . m a x ( m i n C a n v a s H e i g h t , c r o p p e d ? c r o p B o x D a t a . h e i g h t : 0 ) ; } e l s e   i f ( c r o p p e d ) { m i n C a n v a s W i d t h = c r o p B o x D a t a . w i d t h ; m i n C a n v a s H e i g h t = c r o p B o x D a t a . h e i g h t ; i f ( m i n C a n v a s H e i g h t * a s p e c t R a t i o > m i n C a n v a s W i d t h ) { m i n C a n v a s W i d t h = m i n C a n v a s H e i g h t * a s p e c t R a t i o ; } e l s e { m i n C a n v a s H e i g h t = m i n C a n v a s W i d t h / a s p e c t R a t i o ; } } } 
 v a r   _ g e t A d j u s t e d S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : a s p e c t R a t i o , w i d t h : m i n C a n v a s W i d t h , h e i g h t : m i n C a n v a s H e i g h t } ) ; m i n C a n v a s W i d t h = _ g e t A d j u s t e d S i z e s . w i d t h ; m i n C a n v a s H e i g h t = _ g e t A d j u s t e d S i z e s . h e i g h t ; c a n v a s D a t a . m i n W i d t h = m i n C a n v a s W i d t h ; c a n v a s D a t a . m i n H e i g h t = m i n C a n v a s H e i g h t ; c a n v a s D a t a . m a x W i d t h = I n f i n i t y ; c a n v a s D a t a . m a x H e i g h t = I n f i n i t y ; } 
 i f ( p o s i t i o n L i m i t e d ) { i f ( v i e w M o d e > ( c r o p p e d ? 0 : 1 ) ) { v a r   n e w C a n v a s L e f t = c o n t a i n e r D a t a . w i d t h - c a n v a s D a t a . w i d t h ; v a r   n e w C a n v a s T o p = c o n t a i n e r D a t a . h e i g h t - c a n v a s D a t a . h e i g h t ; c a n v a s D a t a . m i n L e f t = M a t h . m i n ( 0 , n e w C a n v a s L e f t ) ; c a n v a s D a t a . m i n T o p = M a t h . m i n ( 0 , n e w C a n v a s T o p ) ; c a n v a s D a t a . m a x L e f t = M a t h . m a x ( 0 , n e w C a n v a s L e f t ) ; c a n v a s D a t a . m a x T o p = M a t h . m a x ( 0 , n e w C a n v a s T o p ) ; i f ( c r o p p e d & & t h i s . l i m i t e d ) { c a n v a s D a t a . m i n L e f t = M a t h . m i n ( c r o p B o x D a t a . l e f t , c r o p B o x D a t a . l e f t + ( c r o p B o x D a t a . w i d t h - c a n v a s D a t a . w i d t h ) ) ; c a n v a s D a t a . m i n T o p = M a t h . m i n ( c r o p B o x D a t a . t o p , c r o p B o x D a t a . t o p + ( c r o p B o x D a t a . h e i g h t - c a n v a s D a t a . h e i g h t ) ) ; c a n v a s D a t a . m a x L e f t = c r o p B o x D a t a . l e f t ; c a n v a s D a t a . m a x T o p = c r o p B o x D a t a . t o p ; i f ( v i e w M o d e = = = 2 ) { i f ( c a n v a s D a t a . w i d t h > = c o n t a i n e r D a t a . w i d t h ) { c a n v a s D a t a . m i n L e f t = M a t h . m i n ( 0 , n e w C a n v a s L e f t ) ; c a n v a s D a t a . m a x L e f t = M a t h . m a x ( 0 , n e w C a n v a s L e f t ) ; } 
 i f ( c a n v a s D a t a . h e i g h t > = c o n t a i n e r D a t a . h e i g h t ) { c a n v a s D a t a . m i n T o p = M a t h . m i n ( 0 , n e w C a n v a s T o p ) ; c a n v a s D a t a . m a x T o p = M a t h . m a x ( 0 , n e w C a n v a s T o p ) ; } } } } e l s e { c a n v a s D a t a . m i n L e f t = - c a n v a s D a t a . w i d t h ; c a n v a s D a t a . m i n T o p = - c a n v a s D a t a . h e i g h t ; c a n v a s D a t a . m a x L e f t = c o n t a i n e r D a t a . w i d t h ; c a n v a s D a t a . m a x T o p = c o n t a i n e r D a t a . h e i g h t ; } } } , r e n d e r C a n v a s : f u n c t i o n   r e n d e r C a n v a s ( c h a n g e d , t r a n s f o r m e d ) { v a r   c a n v a s D a t a = t h i s . c a n v a s D a t a , i m a g e D a t a = t h i s . i m a g e D a t a ; i f ( t r a n s f o r m e d ) { v a r   _ g e t R o t a t e d S i z e s = g e t R o t a t e d S i z e s ( { w i d t h : i m a g e D a t a . n a t u r a l W i d t h * M a t h . a b s ( i m a g e D a t a . s c a l e X | | 1 ) , h e i g h t : i m a g e D a t a . n a t u r a l H e i g h t * M a t h . a b s ( i m a g e D a t a . s c a l e Y | | 1 ) , d e g r e e : i m a g e D a t a . r o t a t e | | 0 } ) , n a t u r a l W i d t h = _ g e t R o t a t e d S i z e s . w i d t h , n a t u r a l H e i g h t = _ g e t R o t a t e d S i z e s . h e i g h t ; v a r   w i d t h = c a n v a s D a t a . w i d t h * ( n a t u r a l W i d t h / c a n v a s D a t a . n a t u r a l W i d t h ) ; v a r   h e i g h t = c a n v a s D a t a . h e i g h t * ( n a t u r a l H e i g h t / c a n v a s D a t a . n a t u r a l H e i g h t ) ; c a n v a s D a t a . l e f t - = ( w i d t h - c a n v a s D a t a . w i d t h ) / 2 ; c a n v a s D a t a . t o p - = ( h e i g h t - c a n v a s D a t a . h e i g h t ) / 2 ; c a n v a s D a t a . w i d t h = w i d t h ; c a n v a s D a t a . h e i g h t = h e i g h t ; c a n v a s D a t a . a s p e c t R a t i o = n a t u r a l W i d t h / n a t u r a l H e i g h t ; c a n v a s D a t a . n a t u r a l W i d t h = n a t u r a l W i d t h ; c a n v a s D a t a . n a t u r a l H e i g h t = n a t u r a l H e i g h t ; t h i s . l i m i t C a n v a s ( t r u e , f a l s e ) ; } 
 i f ( c a n v a s D a t a . w i d t h > c a n v a s D a t a . m a x W i d t h | | c a n v a s D a t a . w i d t h < c a n v a s D a t a . m i n W i d t h ) { c a n v a s D a t a . l e f t = c a n v a s D a t a . o l d L e f t ; } 
 i f ( c a n v a s D a t a . h e i g h t > c a n v a s D a t a . m a x H e i g h t | | c a n v a s D a t a . h e i g h t < c a n v a s D a t a . m i n H e i g h t ) { c a n v a s D a t a . t o p = c a n v a s D a t a . o l d T o p ; } 
 c a n v a s D a t a . w i d t h = M a t h . m i n ( M a t h . m a x ( c a n v a s D a t a . w i d t h , c a n v a s D a t a . m i n W i d t h ) , c a n v a s D a t a . m a x W i d t h ) ; c a n v a s D a t a . h e i g h t = M a t h . m i n ( M a t h . m a x ( c a n v a s D a t a . h e i g h t , c a n v a s D a t a . m i n H e i g h t ) , c a n v a s D a t a . m a x H e i g h t ) ; t h i s . l i m i t C a n v a s ( f a l s e , t r u e ) ; c a n v a s D a t a . l e f t = M a t h . m i n ( M a t h . m a x ( c a n v a s D a t a . l e f t , c a n v a s D a t a . m i n L e f t ) , c a n v a s D a t a . m a x L e f t ) ; c a n v a s D a t a . t o p = M a t h . m i n ( M a t h . m a x ( c a n v a s D a t a . t o p , c a n v a s D a t a . m i n T o p ) , c a n v a s D a t a . m a x T o p ) ; c a n v a s D a t a . o l d L e f t = c a n v a s D a t a . l e f t ; c a n v a s D a t a . o l d T o p = c a n v a s D a t a . t o p ; s e t S t y l e ( t h i s . c a n v a s , a s s i g n ( { w i d t h : c a n v a s D a t a . w i d t h , h e i g h t : c a n v a s D a t a . h e i g h t } , g e t T r a n s f o r m s ( { t r a n s l a t e X : c a n v a s D a t a . l e f t , t r a n s l a t e Y : c a n v a s D a t a . t o p } ) ) ) ; t h i s . r e n d e r I m a g e ( c h a n g e d ) ; i f ( t h i s . c r o p p e d & & t h i s . l i m i t e d ) { t h i s . l i m i t C r o p B o x ( t r u e , t r u e ) ; } } , r e n d e r I m a g e : f u n c t i o n   r e n d e r I m a g e ( c h a n g e d ) { v a r   c a n v a s D a t a = t h i s . c a n v a s D a t a , i m a g e D a t a = t h i s . i m a g e D a t a ; v a r   w i d t h = i m a g e D a t a . n a t u r a l W i d t h * ( c a n v a s D a t a . w i d t h / c a n v a s D a t a . n a t u r a l W i d t h ) ; v a r   h e i g h t = i m a g e D a t a . n a t u r a l H e i g h t * ( c a n v a s D a t a . h e i g h t / c a n v a s D a t a . n a t u r a l H e i g h t ) ; a s s i g n ( i m a g e D a t a , { w i d t h : w i d t h , h e i g h t : h e i g h t , l e f t : ( c a n v a s D a t a . w i d t h - w i d t h ) / 2 , t o p : ( c a n v a s D a t a . h e i g h t - h e i g h t ) / 2 } ) ; s e t S t y l e ( t h i s . i m a g e , a s s i g n ( { w i d t h : i m a g e D a t a . w i d t h , h e i g h t : i m a g e D a t a . h e i g h t } , g e t T r a n s f o r m s ( a s s i g n ( { t r a n s l a t e X : i m a g e D a t a . l e f t , t r a n s l a t e Y : i m a g e D a t a . t o p } , i m a g e D a t a ) ) ) ) ; i f ( c h a n g e d ) { t h i s . o u t p u t ( ) ; } } , i n i t C r o p B o x : f u n c t i o n   i n i t C r o p B o x ( ) { v a r   o p t i o n s = t h i s . o p t i o n s , c a n v a s D a t a = t h i s . c a n v a s D a t a ; v a r   a s p e c t R a t i o = o p t i o n s . a s p e c t R a t i o | | o p t i o n s . i n i t i a l A s p e c t R a t i o ; v a r   a u t o C r o p A r e a = N u m b e r ( o p t i o n s . a u t o C r o p A r e a ) | | 0 . 8 ; v a r   c r o p B o x D a t a = { w i d t h : c a n v a s D a t a . w i d t h , h e i g h t : c a n v a s D a t a . h e i g h t } ; i f ( a s p e c t R a t i o ) { i f ( c a n v a s D a t a . h e i g h t * a s p e c t R a t i o > c a n v a s D a t a . w i d t h ) { c r o p B o x D a t a . h e i g h t = c r o p B o x D a t a . w i d t h / a s p e c t R a t i o ; } e l s e { c r o p B o x D a t a . w i d t h = c r o p B o x D a t a . h e i g h t * a s p e c t R a t i o ; } } 
 t h i s . c r o p B o x D a t a = c r o p B o x D a t a ; t h i s . l i m i t C r o p B o x ( t r u e , t r u e ) ; c r o p B o x D a t a . w i d t h = M a t h . m i n ( M a t h . m a x ( c r o p B o x D a t a . w i d t h , c r o p B o x D a t a . m i n W i d t h ) , c r o p B o x D a t a . m a x W i d t h ) ; c r o p B o x D a t a . h e i g h t = M a t h . m i n ( M a t h . m a x ( c r o p B o x D a t a . h e i g h t , c r o p B o x D a t a . m i n H e i g h t ) , c r o p B o x D a t a . m a x H e i g h t ) ; c r o p B o x D a t a . w i d t h = M a t h . m a x ( c r o p B o x D a t a . m i n W i d t h , c r o p B o x D a t a . w i d t h * a u t o C r o p A r e a ) ; c r o p B o x D a t a . h e i g h t = M a t h . m a x ( c r o p B o x D a t a . m i n H e i g h t , c r o p B o x D a t a . h e i g h t * a u t o C r o p A r e a ) ; c r o p B o x D a t a . l e f t = c a n v a s D a t a . l e f t + ( c a n v a s D a t a . w i d t h - c r o p B o x D a t a . w i d t h ) / 2 ; c r o p B o x D a t a . t o p = c a n v a s D a t a . t o p + ( c a n v a s D a t a . h e i g h t - c r o p B o x D a t a . h e i g h t ) / 2 ; c r o p B o x D a t a . o l d L e f t = c r o p B o x D a t a . l e f t ; c r o p B o x D a t a . o l d T o p = c r o p B o x D a t a . t o p ; t h i s . i n i t i a l C r o p B o x D a t a = a s s i g n ( { } , c r o p B o x D a t a ) ; } , l i m i t C r o p B o x : f u n c t i o n   l i m i t C r o p B o x ( s i z e L i m i t e d , p o s i t i o n L i m i t e d ) { v a r   o p t i o n s = t h i s . o p t i o n s , c o n t a i n e r D a t a = t h i s . c o n t a i n e r D a t a , c a n v a s D a t a = t h i s . c a n v a s D a t a , c r o p B o x D a t a = t h i s . c r o p B o x D a t a , l i m i t e d = t h i s . l i m i t e d ; v a r   a s p e c t R a t i o = o p t i o n s . a s p e c t R a t i o ; i f ( s i z e L i m i t e d ) { v a r   m i n C r o p B o x W i d t h = N u m b e r ( o p t i o n s . m i n C r o p B o x W i d t h ) | | 0 ; v a r   m i n C r o p B o x H e i g h t = N u m b e r ( o p t i o n s . m i n C r o p B o x H e i g h t ) | | 0 ; v a r   m a x C r o p B o x W i d t h = l i m i t e d ? M a t h . m i n ( c o n t a i n e r D a t a . w i d t h , c a n v a s D a t a . w i d t h , c a n v a s D a t a . w i d t h + c a n v a s D a t a . l e f t , c o n t a i n e r D a t a . w i d t h - c a n v a s D a t a . l e f t ) : c o n t a i n e r D a t a . w i d t h ; v a r   m a x C r o p B o x H e i g h t = l i m i t e d ? M a t h . m i n ( c o n t a i n e r D a t a . h e i g h t , c a n v a s D a t a . h e i g h t , c a n v a s D a t a . h e i g h t + c a n v a s D a t a . t o p , c o n t a i n e r D a t a . h e i g h t - c a n v a s D a t a . t o p ) : c o n t a i n e r D a t a . h e i g h t ; m i n C r o p B o x W i d t h = M a t h . m i n ( m i n C r o p B o x W i d t h , c o n t a i n e r D a t a . w i d t h ) ; m i n C r o p B o x H e i g h t = M a t h . m i n ( m i n C r o p B o x H e i g h t , c o n t a i n e r D a t a . h e i g h t ) ; i f ( a s p e c t R a t i o ) { i f ( m i n C r o p B o x W i d t h & & m i n C r o p B o x H e i g h t ) { i f ( m i n C r o p B o x H e i g h t * a s p e c t R a t i o > m i n C r o p B o x W i d t h ) { m i n C r o p B o x H e i g h t = m i n C r o p B o x W i d t h / a s p e c t R a t i o ; } e l s e { m i n C r o p B o x W i d t h = m i n C r o p B o x H e i g h t * a s p e c t R a t i o ; } } e l s e   i f ( m i n C r o p B o x W i d t h ) { m i n C r o p B o x H e i g h t = m i n C r o p B o x W i d t h / a s p e c t R a t i o ; } e l s e   i f ( m i n C r o p B o x H e i g h t ) { m i n C r o p B o x W i d t h = m i n C r o p B o x H e i g h t * a s p e c t R a t i o ; } 
 i f ( m a x C r o p B o x H e i g h t * a s p e c t R a t i o > m a x C r o p B o x W i d t h ) { m a x C r o p B o x H e i g h t = m a x C r o p B o x W i d t h / a s p e c t R a t i o ; } e l s e { m a x C r o p B o x W i d t h = m a x C r o p B o x H e i g h t * a s p e c t R a t i o ; } } 
 c r o p B o x D a t a . m i n W i d t h = M a t h . m i n ( m i n C r o p B o x W i d t h , m a x C r o p B o x W i d t h ) ; c r o p B o x D a t a . m i n H e i g h t = M a t h . m i n ( m i n C r o p B o x H e i g h t , m a x C r o p B o x H e i g h t ) ; c r o p B o x D a t a . m a x W i d t h = m a x C r o p B o x W i d t h ; c r o p B o x D a t a . m a x H e i g h t = m a x C r o p B o x H e i g h t ; } 
 i f ( p o s i t i o n L i m i t e d ) { i f ( l i m i t e d ) { c r o p B o x D a t a . m i n L e f t = M a t h . m a x ( 0 , c a n v a s D a t a . l e f t ) ; c r o p B o x D a t a . m i n T o p = M a t h . m a x ( 0 , c a n v a s D a t a . t o p ) ; c r o p B o x D a t a . m a x L e f t = M a t h . m i n ( c o n t a i n e r D a t a . w i d t h , c a n v a s D a t a . l e f t + c a n v a s D a t a . w i d t h ) - c r o p B o x D a t a . w i d t h ; c r o p B o x D a t a . m a x T o p = M a t h . m i n ( c o n t a i n e r D a t a . h e i g h t , c a n v a s D a t a . t o p + c a n v a s D a t a . h e i g h t ) - c r o p B o x D a t a . h e i g h t ; } e l s e { c r o p B o x D a t a . m i n L e f t = 0 ; c r o p B o x D a t a . m i n T o p = 0 ; c r o p B o x D a t a . m a x L e f t = c o n t a i n e r D a t a . w i d t h - c r o p B o x D a t a . w i d t h ; c r o p B o x D a t a . m a x T o p = c o n t a i n e r D a t a . h e i g h t - c r o p B o x D a t a . h e i g h t ; } } } , r e n d e r C r o p B o x : f u n c t i o n   r e n d e r C r o p B o x ( ) { v a r   o p t i o n s = t h i s . o p t i o n s , c o n t a i n e r D a t a = t h i s . c o n t a i n e r D a t a , c r o p B o x D a t a = t h i s . c r o p B o x D a t a ; i f ( c r o p B o x D a t a . w i d t h > c r o p B o x D a t a . m a x W i d t h | | c r o p B o x D a t a . w i d t h < c r o p B o x D a t a . m i n W i d t h ) { c r o p B o x D a t a . l e f t = c r o p B o x D a t a . o l d L e f t ; } 
 i f ( c r o p B o x D a t a . h e i g h t > c r o p B o x D a t a . m a x H e i g h t | | c r o p B o x D a t a . h e i g h t < c r o p B o x D a t a . m i n H e i g h t ) { c r o p B o x D a t a . t o p = c r o p B o x D a t a . o l d T o p ; } 
 c r o p B o x D a t a . w i d t h = M a t h . m i n ( M a t h . m a x ( c r o p B o x D a t a . w i d t h , c r o p B o x D a t a . m i n W i d t h ) , c r o p B o x D a t a . m a x W i d t h ) ; c r o p B o x D a t a . h e i g h t = M a t h . m i n ( M a t h . m a x ( c r o p B o x D a t a . h e i g h t , c r o p B o x D a t a . m i n H e i g h t ) , c r o p B o x D a t a . m a x H e i g h t ) ; t h i s . l i m i t C r o p B o x ( f a l s e , t r u e ) ; c r o p B o x D a t a . l e f t = M a t h . m i n ( M a t h . m a x ( c r o p B o x D a t a . l e f t , c r o p B o x D a t a . m i n L e f t ) , c r o p B o x D a t a . m a x L e f t ) ; c r o p B o x D a t a . t o p = M a t h . m i n ( M a t h . m a x ( c r o p B o x D a t a . t o p , c r o p B o x D a t a . m i n T o p ) , c r o p B o x D a t a . m a x T o p ) ; c r o p B o x D a t a . o l d L e f t = c r o p B o x D a t a . l e f t ; c r o p B o x D a t a . o l d T o p = c r o p B o x D a t a . t o p ; i f ( o p t i o n s . m o v a b l e & & o p t i o n s . c r o p B o x M o v a b l e ) { s e t D a t a ( t h i s . f a c e , D A T A _ A C T I O N , c r o p B o x D a t a . w i d t h > = c o n t a i n e r D a t a . w i d t h & & c r o p B o x D a t a . h e i g h t > = c o n t a i n e r D a t a . h e i g h t ? A C T I O N _ M O V E : A C T I O N _ A L L ) ; } 
 s e t S t y l e ( t h i s . c r o p B o x , a s s i g n ( { w i d t h : c r o p B o x D a t a . w i d t h , h e i g h t : c r o p B o x D a t a . h e i g h t } , g e t T r a n s f o r m s ( { t r a n s l a t e X : c r o p B o x D a t a . l e f t , t r a n s l a t e Y : c r o p B o x D a t a . t o p } ) ) ) ; i f ( t h i s . c r o p p e d & & t h i s . l i m i t e d ) { t h i s . l i m i t C a n v a s ( t r u e , t r u e ) ; } 
 i f ( ! t h i s . d i s a b l e d ) { t h i s . o u t p u t ( ) ; } } , o u t p u t : f u n c t i o n   o u t p u t ( ) { t h i s . p r e v i e w ( ) ; d i s p a t c h E v e n t ( t h i s . e l e m e n t , E V E N T _ C R O P , t h i s . g e t D a t a ( ) ) ; } } ; v a r   p r e v i e w = { i n i t P r e v i e w : f u n c t i o n   i n i t P r e v i e w ( ) { v a r   e l e m e n t = t h i s . e l e m e n t , c r o s s O r i g i n = t h i s . c r o s s O r i g i n ; v a r   p r e v i e w = t h i s . o p t i o n s . p r e v i e w ; v a r   u r l = c r o s s O r i g i n ? t h i s . c r o s s O r i g i n U r l : t h i s . u r l ; v a r   a l t = e l e m e n t . a l t | | ' T h e   i m a g e   t o   p r e v i e w ' ; v a r   i m a g e = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; i f ( c r o s s O r i g i n ) { i m a g e . c r o s s O r i g i n = c r o s s O r i g i n ; } 
 i m a g e . s r c = u r l ; i m a g e . a l t = a l t ; t h i s . v i e w B o x . a p p e n d C h i l d ( i m a g e ) ; t h i s . v i e w B o x I m a g e = i m a g e ; i f ( ! p r e v i e w ) { r e t u r n ; } 
 v a r   p r e v i e w s = p r e v i e w ; i f ( t y p e o f   p r e v i e w = = = ' s t r i n g ' ) { p r e v i e w s = e l e m e n t . o w n e r D o c u m e n t . q u e r y S e l e c t o r A l l ( p r e v i e w ) ; } e l s e   i f ( p r e v i e w . q u e r y S e l e c t o r ) { p r e v i e w s = [ p r e v i e w ] ; } 
 t h i s . p r e v i e w s = p r e v i e w s ; f o r E a c h ( p r e v i e w s , f u n c t i o n ( e l ) { v a r   i m g = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; s e t D a t a ( e l , D A T A _ P R E V I E W , { w i d t h : e l . o f f s e t W i d t h , h e i g h t : e l . o f f s e t H e i g h t , h t m l : e l . i n n e r H T M L } ) ; i f ( c r o s s O r i g i n ) { i m g . c r o s s O r i g i n = c r o s s O r i g i n ; } 
 i m g . s r c = u r l ; i m g . a l t = a l t ; i m g . s t y l e . c s s T e x t = ' d i s p l a y : b l o c k ; ' + ' w i d t h : 1 0 0 % ; ' + ' h e i g h t : a u t o ; ' + ' m i n - w i d t h : 0 ! i m p o r t a n t ; ' + ' m i n - h e i g h t : 0 ! i m p o r t a n t ; ' + ' m a x - w i d t h : n o n e ! i m p o r t a n t ; ' + ' m a x - h e i g h t : n o n e ! i m p o r t a n t ; ' + ' i m a g e - o r i e n t a t i o n : 0 d e g ! i m p o r t a n t ; " ' ; e l . i n n e r H T M L = ' ' ; e l . a p p e n d C h i l d ( i m g ) ; } ) ; } , r e s e t P r e v i e w : f u n c t i o n   r e s e t P r e v i e w ( ) { f o r E a c h ( t h i s . p r e v i e w s , f u n c t i o n ( e l e m e n t ) { v a r   d a t a = g e t D a t a ( e l e m e n t , D A T A _ P R E V I E W ) ; s e t S t y l e ( e l e m e n t , { w i d t h : d a t a . w i d t h , h e i g h t : d a t a . h e i g h t } ) ; e l e m e n t . i n n e r H T M L = d a t a . h t m l ; r e m o v e D a t a ( e l e m e n t , D A T A _ P R E V I E W ) ; } ) ; } , p r e v i e w : f u n c t i o n   p r e v i e w ( ) { v a r   i m a g e D a t a = t h i s . i m a g e D a t a , c a n v a s D a t a = t h i s . c a n v a s D a t a , c r o p B o x D a t a = t h i s . c r o p B o x D a t a ; v a r   c r o p B o x W i d t h = c r o p B o x D a t a . w i d t h , c r o p B o x H e i g h t = c r o p B o x D a t a . h e i g h t ; v a r   w i d t h = i m a g e D a t a . w i d t h , h e i g h t = i m a g e D a t a . h e i g h t ; v a r   l e f t = c r o p B o x D a t a . l e f t - c a n v a s D a t a . l e f t - i m a g e D a t a . l e f t ; v a r   t o p = c r o p B o x D a t a . t o p - c a n v a s D a t a . t o p - i m a g e D a t a . t o p ; i f ( ! t h i s . c r o p p e d | | t h i s . d i s a b l e d ) { r e t u r n ; } 
 s e t S t y l e ( t h i s . v i e w B o x I m a g e , a s s i g n ( { w i d t h : w i d t h , h e i g h t : h e i g h t } , g e t T r a n s f o r m s ( a s s i g n ( { t r a n s l a t e X : - l e f t , t r a n s l a t e Y : - t o p } , i m a g e D a t a ) ) ) ) ; f o r E a c h ( t h i s . p r e v i e w s , f u n c t i o n ( e l e m e n t ) { v a r   d a t a = g e t D a t a ( e l e m e n t , D A T A _ P R E V I E W ) ; v a r   o r i g i n a l W i d t h = d a t a . w i d t h ; v a r   o r i g i n a l H e i g h t = d a t a . h e i g h t ; v a r   n e w W i d t h = o r i g i n a l W i d t h ; v a r   n e w H e i g h t = o r i g i n a l H e i g h t ; v a r   r a t i o = 1 ; i f ( c r o p B o x W i d t h ) { r a t i o = o r i g i n a l W i d t h / c r o p B o x W i d t h ; n e w H e i g h t = c r o p B o x H e i g h t * r a t i o ; } 
 i f ( c r o p B o x H e i g h t & & n e w H e i g h t > o r i g i n a l H e i g h t ) { r a t i o = o r i g i n a l H e i g h t / c r o p B o x H e i g h t ; n e w W i d t h = c r o p B o x W i d t h * r a t i o ; n e w H e i g h t = o r i g i n a l H e i g h t ; } 
 s e t S t y l e ( e l e m e n t , { w i d t h : n e w W i d t h , h e i g h t : n e w H e i g h t } ) ; s e t S t y l e ( e l e m e n t . g e t E l e m e n t s B y T a g N a m e ( ' i m g ' ) [ 0 ] , a s s i g n ( { w i d t h : w i d t h * r a t i o , h e i g h t : h e i g h t * r a t i o } , g e t T r a n s f o r m s ( a s s i g n ( { t r a n s l a t e X : - l e f t * r a t i o , t r a n s l a t e Y : - t o p * r a t i o } , i m a g e D a t a ) ) ) ) ; } ) ; } } ; v a r   e v e n t s = { b i n d : f u n c t i o n   b i n d ( ) { v a r   e l e m e n t = t h i s . e l e m e n t , o p t i o n s = t h i s . o p t i o n s , c r o p p e r = t h i s . c r o p p e r ; i f ( i s F u n c t i o n ( o p t i o n s . c r o p s t a r t ) ) { a d d L i s t e n e r ( e l e m e n t , E V E N T _ C R O P _ S T A R T , o p t i o n s . c r o p s t a r t ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . c r o p m o v e ) ) { a d d L i s t e n e r ( e l e m e n t , E V E N T _ C R O P _ M O V E , o p t i o n s . c r o p m o v e ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . c r o p e n d ) ) { a d d L i s t e n e r ( e l e m e n t , E V E N T _ C R O P _ E N D , o p t i o n s . c r o p e n d ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . c r o p ) ) { a d d L i s t e n e r ( e l e m e n t , E V E N T _ C R O P , o p t i o n s . c r o p ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . z o o m ) ) { a d d L i s t e n e r ( e l e m e n t , E V E N T _ Z O O M , o p t i o n s . z o o m ) ; } 
 a d d L i s t e n e r ( c r o p p e r , E V E N T _ P O I N T E R _ D O W N , t h i s . o n C r o p S t a r t = t h i s . c r o p S t a r t . b i n d ( t h i s ) ) ; i f ( o p t i o n s . z o o m a b l e & & o p t i o n s . z o o m O n W h e e l ) { a d d L i s t e n e r ( c r o p p e r , E V E N T _ W H E E L , t h i s . o n W h e e l = t h i s . w h e e l . b i n d ( t h i s ) , { p a s s i v e : f a l s e , c a p t u r e : t r u e } ) ; } 
 i f ( o p t i o n s . t o g g l e D r a g M o d e O n D b l c l i c k ) { a d d L i s t e n e r ( c r o p p e r , E V E N T _ D B L C L I C K , t h i s . o n D b l c l i c k = t h i s . d b l c l i c k . b i n d ( t h i s ) ) ; } 
 a d d L i s t e n e r ( e l e m e n t . o w n e r D o c u m e n t , E V E N T _ P O I N T E R _ M O V E , t h i s . o n C r o p M o v e = t h i s . c r o p M o v e . b i n d ( t h i s ) ) ; a d d L i s t e n e r ( e l e m e n t . o w n e r D o c u m e n t , E V E N T _ P O I N T E R _ U P , t h i s . o n C r o p E n d = t h i s . c r o p E n d . b i n d ( t h i s ) ) ; i f ( o p t i o n s . r e s p o n s i v e ) { a d d L i s t e n e r ( w i n d o w , E V E N T _ R E S I Z E , t h i s . o n R e s i z e = t h i s . r e s i z e . b i n d ( t h i s ) ) ; } } , u n b i n d : f u n c t i o n   u n b i n d ( ) { v a r   e l e m e n t = t h i s . e l e m e n t , o p t i o n s = t h i s . o p t i o n s , c r o p p e r = t h i s . c r o p p e r ; i f ( i s F u n c t i o n ( o p t i o n s . c r o p s t a r t ) ) { r e m o v e L i s t e n e r ( e l e m e n t , E V E N T _ C R O P _ S T A R T , o p t i o n s . c r o p s t a r t ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . c r o p m o v e ) ) { r e m o v e L i s t e n e r ( e l e m e n t , E V E N T _ C R O P _ M O V E , o p t i o n s . c r o p m o v e ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . c r o p e n d ) ) { r e m o v e L i s t e n e r ( e l e m e n t , E V E N T _ C R O P _ E N D , o p t i o n s . c r o p e n d ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . c r o p ) ) { r e m o v e L i s t e n e r ( e l e m e n t , E V E N T _ C R O P , o p t i o n s . c r o p ) ; } 
 i f ( i s F u n c t i o n ( o p t i o n s . z o o m ) ) { r e m o v e L i s t e n e r ( e l e m e n t , E V E N T _ Z O O M , o p t i o n s . z o o m ) ; } 
 r e m o v e L i s t e n e r ( c r o p p e r , E V E N T _ P O I N T E R _ D O W N , t h i s . o n C r o p S t a r t ) ; i f ( o p t i o n s . z o o m a b l e & & o p t i o n s . z o o m O n W h e e l ) { r e m o v e L i s t e n e r ( c r o p p e r , E V E N T _ W H E E L , t h i s . o n W h e e l , { p a s s i v e : f a l s e , c a p t u r e : t r u e } ) ; } 
 i f ( o p t i o n s . t o g g l e D r a g M o d e O n D b l c l i c k ) { r e m o v e L i s t e n e r ( c r o p p e r , E V E N T _ D B L C L I C K , t h i s . o n D b l c l i c k ) ; } 
 r e m o v e L i s t e n e r ( e l e m e n t . o w n e r D o c u m e n t , E V E N T _ P O I N T E R _ M O V E , t h i s . o n C r o p M o v e ) ; r e m o v e L i s t e n e r ( e l e m e n t . o w n e r D o c u m e n t , E V E N T _ P O I N T E R _ U P , t h i s . o n C r o p E n d ) ; i f ( o p t i o n s . r e s p o n s i v e ) { r e m o v e L i s t e n e r ( w i n d o w , E V E N T _ R E S I Z E , t h i s . o n R e s i z e ) ; } } } ; v a r   h a n d l e r s = { r e s i z e : f u n c t i o n   r e s i z e ( ) { v a r   o p t i o n s = t h i s . o p t i o n s , c o n t a i n e r = t h i s . c o n t a i n e r , c o n t a i n e r D a t a = t h i s . c o n t a i n e r D a t a ; v a r   m i n C o n t a i n e r W i d t h = N u m b e r ( o p t i o n s . m i n C o n t a i n e r W i d t h ) | | M I N _ C O N T A I N E R _ W I D T H ; v a r   m i n C o n t a i n e r H e i g h t = N u m b e r ( o p t i o n s . m i n C o n t a i n e r H e i g h t ) | | M I N _ C O N T A I N E R _ H E I G H T ; i f ( t h i s . d i s a b l e d | | c o n t a i n e r D a t a . w i d t h < = m i n C o n t a i n e r W i d t h | | c o n t a i n e r D a t a . h e i g h t < = m i n C o n t a i n e r H e i g h t ) { r e t u r n ; } 
 v a r   r a t i o = c o n t a i n e r . o f f s e t W i d t h / c o n t a i n e r D a t a . w i d t h ; i f ( r a t i o ! = = 1 | | c o n t a i n e r . o f f s e t H e i g h t ! = = c o n t a i n e r D a t a . h e i g h t ) { v a r   c a n v a s D a t a ; v a r   c r o p B o x D a t a ; i f ( o p t i o n s . r e s t o r e ) { c a n v a s D a t a = t h i s . g e t C a n v a s D a t a ( ) ; c r o p B o x D a t a = t h i s . g e t C r o p B o x D a t a ( ) ; } 
 t h i s . r e n d e r ( ) ; i f ( o p t i o n s . r e s t o r e ) { t h i s . s e t C a n v a s D a t a ( f o r E a c h ( c a n v a s D a t a , f u n c t i o n ( n , i ) { c a n v a s D a t a [ i ] = n * r a t i o ; } ) ) ; t h i s . s e t C r o p B o x D a t a ( f o r E a c h ( c r o p B o x D a t a , f u n c t i o n ( n , i ) { c r o p B o x D a t a [ i ] = n * r a t i o ; } ) ) ; } } } , d b l c l i c k : f u n c t i o n   d b l c l i c k ( ) { i f ( t h i s . d i s a b l e d | | t h i s . o p t i o n s . d r a g M o d e = = = D R A G _ M O D E _ N O N E ) { r e t u r n ; } 
 t h i s . s e t D r a g M o d e ( h a s C l a s s ( t h i s . d r a g B o x , C L A S S _ C R O P ) ? D R A G _ M O D E _ M O V E : D R A G _ M O D E _ C R O P ) ; } , w h e e l : f u n c t i o n   w h e e l ( e v e n t ) { v a r   _ t h i s = t h i s ; v a r   r a t i o = N u m b e r ( t h i s . o p t i o n s . w h e e l Z o o m R a t i o ) | | 0 . 1 ; v a r   d e l t a = 1 ; i f ( t h i s . d i s a b l e d ) { r e t u r n ; } 
 e v e n t . p r e v e n t D e f a u l t ( ) ; i f ( t h i s . w h e e l i n g ) { r e t u r n ; } 
 t h i s . w h e e l i n g = t r u e ; s e t T i m e o u t ( f u n c t i o n ( ) { _ t h i s . w h e e l i n g = f a l s e ; } , 5 0 ) ; i f ( e v e n t . d e l t a Y ) { d e l t a = e v e n t . d e l t a Y > 0 ? 1 : - 1 ; } e l s e   i f ( e v e n t . w h e e l D e l t a ) { d e l t a = - e v e n t . w h e e l D e l t a / 1 2 0 ; } e l s e   i f ( e v e n t . d e t a i l ) { d e l t a = e v e n t . d e t a i l > 0 ? 1 : - 1 ; } 
 t h i s . z o o m ( - d e l t a * r a t i o , e v e n t ) ; } , c r o p S t a r t : f u n c t i o n   c r o p S t a r t ( e v e n t ) { v a r   b u t t o n s = e v e n t . b u t t o n s , b u t t o n = e v e n t . b u t t o n ; i f ( t h i s . d i s a b l e d | | i s N u m b e r ( b u t t o n s ) & & b u t t o n s ! = = 1 | | i s N u m b e r ( b u t t o n ) & & b u t t o n ! = = 0 | | e v e n t . c t r l K e y ) { r e t u r n ; } 
 v a r   o p t i o n s = t h i s . o p t i o n s , p o i n t e r s = t h i s . p o i n t e r s ; v a r   a c t i o n ; i f ( e v e n t . c h a n g e d T o u c h e s ) { f o r E a c h ( e v e n t . c h a n g e d T o u c h e s , f u n c t i o n ( t o u c h ) { p o i n t e r s [ t o u c h . i d e n t i f i e r ] = g e t P o i n t e r ( t o u c h ) ; } ) ; } e l s e { p o i n t e r s [ e v e n t . p o i n t e r I d | | 0 ] = g e t P o i n t e r ( e v e n t ) ; } 
 i f ( O b j e c t . k e y s ( p o i n t e r s ) . l e n g t h > 1 & & o p t i o n s . z o o m a b l e & & o p t i o n s . z o o m O n T o u c h ) { a c t i o n = A C T I O N _ Z O O M ; } e l s e { a c t i o n = g e t D a t a ( e v e n t . t a r g e t , D A T A _ A C T I O N ) ; } 
 i f ( ! R E G E X P _ A C T I O N S . t e s t ( a c t i o n ) ) { r e t u r n ; } 
 i f ( d i s p a t c h E v e n t ( t h i s . e l e m e n t , E V E N T _ C R O P _ S T A R T , { o r i g i n a l E v e n t : e v e n t , a c t i o n : a c t i o n } ) = = = f a l s e ) { r e t u r n ; } 
 e v e n t . p r e v e n t D e f a u l t ( ) ; t h i s . a c t i o n = a c t i o n ; t h i s . c r o p p i n g = f a l s e ; i f ( a c t i o n = = = A C T I O N _ C R O P ) { t h i s . c r o p p i n g = t r u e ; a d d C l a s s ( t h i s . d r a g B o x , C L A S S _ M O D A L ) ; } } , c r o p M o v e : f u n c t i o n   c r o p M o v e ( e v e n t ) { v a r   a c t i o n = t h i s . a c t i o n ; i f ( t h i s . d i s a b l e d | | ! a c t i o n ) { r e t u r n ; } 
 v a r   p o i n t e r s = t h i s . p o i n t e r s ; e v e n t . p r e v e n t D e f a u l t ( ) ; i f ( d i s p a t c h E v e n t ( t h i s . e l e m e n t , E V E N T _ C R O P _ M O V E , { o r i g i n a l E v e n t : e v e n t , a c t i o n : a c t i o n } ) = = = f a l s e ) { r e t u r n ; } 
 i f ( e v e n t . c h a n g e d T o u c h e s ) { f o r E a c h ( e v e n t . c h a n g e d T o u c h e s , f u n c t i o n ( t o u c h ) { a s s i g n ( p o i n t e r s [ t o u c h . i d e n t i f i e r ] | | { } , g e t P o i n t e r ( t o u c h , t r u e ) ) ; } ) ; } e l s e { a s s i g n ( p o i n t e r s [ e v e n t . p o i n t e r I d | | 0 ] | | { } , g e t P o i n t e r ( e v e n t , t r u e ) ) ; } 
 t h i s . c h a n g e ( e v e n t ) ; } , c r o p E n d : f u n c t i o n   c r o p E n d ( e v e n t ) { i f ( t h i s . d i s a b l e d ) { r e t u r n ; } 
 v a r   a c t i o n = t h i s . a c t i o n , p o i n t e r s = t h i s . p o i n t e r s ; i f ( e v e n t . c h a n g e d T o u c h e s ) { f o r E a c h ( e v e n t . c h a n g e d T o u c h e s , f u n c t i o n ( t o u c h ) { d e l e t e   p o i n t e r s [ t o u c h . i d e n t i f i e r ] ; } ) ; } e l s e { d e l e t e   p o i n t e r s [ e v e n t . p o i n t e r I d | | 0 ] ; } 
 i f ( ! a c t i o n ) { r e t u r n ; } 
 e v e n t . p r e v e n t D e f a u l t ( ) ; i f ( ! O b j e c t . k e y s ( p o i n t e r s ) . l e n g t h ) { t h i s . a c t i o n = ' ' ; } 
 i f ( t h i s . c r o p p i n g ) { t h i s . c r o p p i n g = f a l s e ; t o g g l e C l a s s ( t h i s . d r a g B o x , C L A S S _ M O D A L , t h i s . c r o p p e d & & t h i s . o p t i o n s . m o d a l ) ; } 
 d i s p a t c h E v e n t ( t h i s . e l e m e n t , E V E N T _ C R O P _ E N D , { o r i g i n a l E v e n t : e v e n t , a c t i o n : a c t i o n } ) ; } } ; v a r   c h a n g e = { c h a n g e : f u n c t i o n   c h a n g e ( e v e n t ) { v a r   o p t i o n s = t h i s . o p t i o n s , c a n v a s D a t a = t h i s . c a n v a s D a t a , c o n t a i n e r D a t a = t h i s . c o n t a i n e r D a t a , c r o p B o x D a t a = t h i s . c r o p B o x D a t a , p o i n t e r s = t h i s . p o i n t e r s ; v a r   a c t i o n = t h i s . a c t i o n ; v a r   a s p e c t R a t i o = o p t i o n s . a s p e c t R a t i o ; v a r   l e f t = c r o p B o x D a t a . l e f t , t o p = c r o p B o x D a t a . t o p , w i d t h = c r o p B o x D a t a . w i d t h , h e i g h t = c r o p B o x D a t a . h e i g h t ; v a r   r i g h t = l e f t + w i d t h ; v a r   b o t t o m = t o p + h e i g h t ; v a r   m i n L e f t = 0 ; v a r   m i n T o p = 0 ; v a r   m a x W i d t h = c o n t a i n e r D a t a . w i d t h ; v a r   m a x H e i g h t = c o n t a i n e r D a t a . h e i g h t ; v a r   r e n d e r a b l e = t r u e ; v a r   o f f s e t ; i f ( ! a s p e c t R a t i o & & e v e n t . s h i f t K e y ) { a s p e c t R a t i o = w i d t h & & h e i g h t ? w i d t h / h e i g h t : 1 ; } 
 i f ( t h i s . l i m i t e d ) { m i n L e f t = c r o p B o x D a t a . m i n L e f t ; m i n T o p = c r o p B o x D a t a . m i n T o p ; m a x W i d t h = m i n L e f t + M a t h . m i n ( c o n t a i n e r D a t a . w i d t h , c a n v a s D a t a . w i d t h , c a n v a s D a t a . l e f t + c a n v a s D a t a . w i d t h ) ; m a x H e i g h t = m i n T o p + M a t h . m i n ( c o n t a i n e r D a t a . h e i g h t , c a n v a s D a t a . h e i g h t , c a n v a s D a t a . t o p + c a n v a s D a t a . h e i g h t ) ; } 
 v a r   p o i n t e r = p o i n t e r s [ O b j e c t . k e y s ( p o i n t e r s ) [ 0 ] ] ; v a r   r a n g e = { x : p o i n t e r . e n d X - p o i n t e r . s t a r t X , y : p o i n t e r . e n d Y - p o i n t e r . s t a r t Y } ; v a r   c h e c k = f u n c t i o n   c h e c k ( s i d e ) { s w i t c h ( s i d e ) { c a s e   A C T I O N _ E A S T : i f ( r i g h t + r a n g e . x > m a x W i d t h ) { r a n g e . x = m a x W i d t h - r i g h t ; } 
 b r e a k ; c a s e   A C T I O N _ W E S T : i f ( l e f t + r a n g e . x < m i n L e f t ) { r a n g e . x = m i n L e f t - l e f t ; } 
 b r e a k ; c a s e   A C T I O N _ N O R T H : i f ( t o p + r a n g e . y < m i n T o p ) { r a n g e . y = m i n T o p - t o p ; } 
 b r e a k ; c a s e   A C T I O N _ S O U T H : i f ( b o t t o m + r a n g e . y > m a x H e i g h t ) { r a n g e . y = m a x H e i g h t - b o t t o m ; } 
 b r e a k ; d e f a u l t : } } ; s w i t c h ( a c t i o n ) { c a s e   A C T I O N _ A L L : l e f t + = r a n g e . x ; t o p + = r a n g e . y ; b r e a k ; c a s e   A C T I O N _ E A S T : i f ( r a n g e . x > = 0 & & ( r i g h t > = m a x W i d t h | | a s p e c t R a t i o & & ( t o p < = m i n T o p | | b o t t o m > = m a x H e i g h t ) ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ E A S T ) ; w i d t h + = r a n g e . x ; i f ( w i d t h < 0 ) { a c t i o n = A C T I O N _ W E S T ; w i d t h = - w i d t h ; l e f t - = w i d t h ; } 
 i f ( a s p e c t R a t i o ) { h e i g h t = w i d t h / a s p e c t R a t i o ; t o p + = ( c r o p B o x D a t a . h e i g h t - h e i g h t ) / 2 ; } 
 b r e a k ; c a s e   A C T I O N _ N O R T H : i f ( r a n g e . y < = 0 & & ( t o p < = m i n T o p | | a s p e c t R a t i o & & ( l e f t < = m i n L e f t | | r i g h t > = m a x W i d t h ) ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ N O R T H ) ; h e i g h t - = r a n g e . y ; t o p + = r a n g e . y ; i f ( h e i g h t < 0 ) { a c t i o n = A C T I O N _ S O U T H ; h e i g h t = - h e i g h t ; t o p - = h e i g h t ; } 
 i f ( a s p e c t R a t i o ) { w i d t h = h e i g h t * a s p e c t R a t i o ; l e f t + = ( c r o p B o x D a t a . w i d t h - w i d t h ) / 2 ; } 
 b r e a k ; c a s e   A C T I O N _ W E S T : i f ( r a n g e . x < = 0 & & ( l e f t < = m i n L e f t | | a s p e c t R a t i o & & ( t o p < = m i n T o p | | b o t t o m > = m a x H e i g h t ) ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ W E S T ) ; w i d t h - = r a n g e . x ; l e f t + = r a n g e . x ; i f ( w i d t h < 0 ) { a c t i o n = A C T I O N _ E A S T ; w i d t h = - w i d t h ; l e f t - = w i d t h ; } 
 i f ( a s p e c t R a t i o ) { h e i g h t = w i d t h / a s p e c t R a t i o ; t o p + = ( c r o p B o x D a t a . h e i g h t - h e i g h t ) / 2 ; } 
 b r e a k ; c a s e   A C T I O N _ S O U T H : i f ( r a n g e . y > = 0 & & ( b o t t o m > = m a x H e i g h t | | a s p e c t R a t i o & & ( l e f t < = m i n L e f t | | r i g h t > = m a x W i d t h ) ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ S O U T H ) ; h e i g h t + = r a n g e . y ; i f ( h e i g h t < 0 ) { a c t i o n = A C T I O N _ N O R T H ; h e i g h t = - h e i g h t ; t o p - = h e i g h t ; } 
 i f ( a s p e c t R a t i o ) { w i d t h = h e i g h t * a s p e c t R a t i o ; l e f t + = ( c r o p B o x D a t a . w i d t h - w i d t h ) / 2 ; } 
 b r e a k ; c a s e   A C T I O N _ N O R T H _ E A S T : i f ( a s p e c t R a t i o ) { i f ( r a n g e . y < = 0 & & ( t o p < = m i n T o p | | r i g h t > = m a x W i d t h ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ N O R T H ) ; h e i g h t - = r a n g e . y ; t o p + = r a n g e . y ; w i d t h = h e i g h t * a s p e c t R a t i o ; } e l s e { c h e c k ( A C T I O N _ N O R T H ) ; c h e c k ( A C T I O N _ E A S T ) ; i f ( r a n g e . x > = 0 ) { i f ( r i g h t < m a x W i d t h ) { w i d t h + = r a n g e . x ; } e l s e   i f ( r a n g e . y < = 0 & & t o p < = m i n T o p ) { r e n d e r a b l e = f a l s e ; } } e l s e { w i d t h + = r a n g e . x ; } 
 i f ( r a n g e . y < = 0 ) { i f ( t o p > m i n T o p ) { h e i g h t - = r a n g e . y ; t o p + = r a n g e . y ; } } e l s e { h e i g h t - = r a n g e . y ; t o p + = r a n g e . y ; } } 
 i f ( w i d t h < 0 & & h e i g h t < 0 ) { a c t i o n = A C T I O N _ S O U T H _ W E S T ; h e i g h t = - h e i g h t ; w i d t h = - w i d t h ; t o p - = h e i g h t ; l e f t - = w i d t h ; } e l s e   i f ( w i d t h < 0 ) { a c t i o n = A C T I O N _ N O R T H _ W E S T ; w i d t h = - w i d t h ; l e f t - = w i d t h ; } e l s e   i f ( h e i g h t < 0 ) { a c t i o n = A C T I O N _ S O U T H _ E A S T ; h e i g h t = - h e i g h t ; t o p - = h e i g h t ; } 
 b r e a k ; c a s e   A C T I O N _ N O R T H _ W E S T : i f ( a s p e c t R a t i o ) { i f ( r a n g e . y < = 0 & & ( t o p < = m i n T o p | | l e f t < = m i n L e f t ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ N O R T H ) ; h e i g h t - = r a n g e . y ; t o p + = r a n g e . y ; w i d t h = h e i g h t * a s p e c t R a t i o ; l e f t + = c r o p B o x D a t a . w i d t h - w i d t h ; } e l s e { c h e c k ( A C T I O N _ N O R T H ) ; c h e c k ( A C T I O N _ W E S T ) ; i f ( r a n g e . x < = 0 ) { i f ( l e f t > m i n L e f t ) { w i d t h - = r a n g e . x ; l e f t + = r a n g e . x ; } e l s e   i f ( r a n g e . y < = 0 & & t o p < = m i n T o p ) { r e n d e r a b l e = f a l s e ; } } e l s e { w i d t h - = r a n g e . x ; l e f t + = r a n g e . x ; } 
 i f ( r a n g e . y < = 0 ) { i f ( t o p > m i n T o p ) { h e i g h t - = r a n g e . y ; t o p + = r a n g e . y ; } } e l s e { h e i g h t - = r a n g e . y ; t o p + = r a n g e . y ; } } 
 i f ( w i d t h < 0 & & h e i g h t < 0 ) { a c t i o n = A C T I O N _ S O U T H _ E A S T ; h e i g h t = - h e i g h t ; w i d t h = - w i d t h ; t o p - = h e i g h t ; l e f t - = w i d t h ; } e l s e   i f ( w i d t h < 0 ) { a c t i o n = A C T I O N _ N O R T H _ E A S T ; w i d t h = - w i d t h ; l e f t - = w i d t h ; } e l s e   i f ( h e i g h t < 0 ) { a c t i o n = A C T I O N _ S O U T H _ W E S T ; h e i g h t = - h e i g h t ; t o p - = h e i g h t ; } 
 b r e a k ; c a s e   A C T I O N _ S O U T H _ W E S T : i f ( a s p e c t R a t i o ) { i f ( r a n g e . x < = 0 & & ( l e f t < = m i n L e f t | | b o t t o m > = m a x H e i g h t ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ W E S T ) ; w i d t h - = r a n g e . x ; l e f t + = r a n g e . x ; h e i g h t = w i d t h / a s p e c t R a t i o ; } e l s e { c h e c k ( A C T I O N _ S O U T H ) ; c h e c k ( A C T I O N _ W E S T ) ; i f ( r a n g e . x < = 0 ) { i f ( l e f t > m i n L e f t ) { w i d t h - = r a n g e . x ; l e f t + = r a n g e . x ; } e l s e   i f ( r a n g e . y > = 0 & & b o t t o m > = m a x H e i g h t ) { r e n d e r a b l e = f a l s e ; } } e l s e { w i d t h - = r a n g e . x ; l e f t + = r a n g e . x ; } 
 i f ( r a n g e . y > = 0 ) { i f ( b o t t o m < m a x H e i g h t ) { h e i g h t + = r a n g e . y ; } } e l s e { h e i g h t + = r a n g e . y ; } } 
 i f ( w i d t h < 0 & & h e i g h t < 0 ) { a c t i o n = A C T I O N _ N O R T H _ E A S T ; h e i g h t = - h e i g h t ; w i d t h = - w i d t h ; t o p - = h e i g h t ; l e f t - = w i d t h ; } e l s e   i f ( w i d t h < 0 ) { a c t i o n = A C T I O N _ S O U T H _ E A S T ; w i d t h = - w i d t h ; l e f t - = w i d t h ; } e l s e   i f ( h e i g h t < 0 ) { a c t i o n = A C T I O N _ N O R T H _ W E S T ; h e i g h t = - h e i g h t ; t o p - = h e i g h t ; } 
 b r e a k ; c a s e   A C T I O N _ S O U T H _ E A S T : i f ( a s p e c t R a t i o ) { i f ( r a n g e . x > = 0 & & ( r i g h t > = m a x W i d t h | | b o t t o m > = m a x H e i g h t ) ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 c h e c k ( A C T I O N _ E A S T ) ; w i d t h + = r a n g e . x ; h e i g h t = w i d t h / a s p e c t R a t i o ; } e l s e { c h e c k ( A C T I O N _ S O U T H ) ; c h e c k ( A C T I O N _ E A S T ) ; i f ( r a n g e . x > = 0 ) { i f ( r i g h t < m a x W i d t h ) { w i d t h + = r a n g e . x ; } e l s e   i f ( r a n g e . y > = 0 & & b o t t o m > = m a x H e i g h t ) { r e n d e r a b l e = f a l s e ; } } e l s e { w i d t h + = r a n g e . x ; } 
 i f ( r a n g e . y > = 0 ) { i f ( b o t t o m < m a x H e i g h t ) { h e i g h t + = r a n g e . y ; } } e l s e { h e i g h t + = r a n g e . y ; } } 
 i f ( w i d t h < 0 & & h e i g h t < 0 ) { a c t i o n = A C T I O N _ N O R T H _ W E S T ; h e i g h t = - h e i g h t ; w i d t h = - w i d t h ; t o p - = h e i g h t ; l e f t - = w i d t h ; } e l s e   i f ( w i d t h < 0 ) { a c t i o n = A C T I O N _ S O U T H _ W E S T ; w i d t h = - w i d t h ; l e f t - = w i d t h ; } e l s e   i f ( h e i g h t < 0 ) { a c t i o n = A C T I O N _ N O R T H _ E A S T ; h e i g h t = - h e i g h t ; t o p - = h e i g h t ; } 
 b r e a k ; c a s e   A C T I O N _ M O V E : t h i s . m o v e ( r a n g e . x , r a n g e . y ) ; r e n d e r a b l e = f a l s e ; b r e a k ; c a s e   A C T I O N _ Z O O M : t h i s . z o o m ( g e t M a x Z o o m R a t i o ( p o i n t e r s ) , e v e n t ) ; r e n d e r a b l e = f a l s e ; b r e a k ; c a s e   A C T I O N _ C R O P : i f ( ! r a n g e . x | | ! r a n g e . y ) { r e n d e r a b l e = f a l s e ; b r e a k ; } 
 o f f s e t = g e t O f f s e t ( t h i s . c r o p p e r ) ; l e f t = p o i n t e r . s t a r t X - o f f s e t . l e f t ; t o p = p o i n t e r . s t a r t Y - o f f s e t . t o p ; w i d t h = c r o p B o x D a t a . m i n W i d t h ; h e i g h t = c r o p B o x D a t a . m i n H e i g h t ; i f ( r a n g e . x > 0 ) { a c t i o n = r a n g e . y > 0 ? A C T I O N _ S O U T H _ E A S T : A C T I O N _ N O R T H _ E A S T ; } e l s e   i f ( r a n g e . x < 0 ) { l e f t - = w i d t h ; a c t i o n = r a n g e . y > 0 ? A C T I O N _ S O U T H _ W E S T : A C T I O N _ N O R T H _ W E S T ; } 
 i f ( r a n g e . y < 0 ) { t o p - = h e i g h t ; } 
 i f ( ! t h i s . c r o p p e d ) { r e m o v e C l a s s ( t h i s . c r o p B o x , C L A S S _ H I D D E N ) ; t h i s . c r o p p e d = t r u e ; i f ( t h i s . l i m i t e d ) { t h i s . l i m i t C r o p B o x ( t r u e , t r u e ) ; } } 
 b r e a k ; d e f a u l t : } 
 i f ( r e n d e r a b l e ) { c r o p B o x D a t a . w i d t h = w i d t h ; c r o p B o x D a t a . h e i g h t = h e i g h t ; c r o p B o x D a t a . l e f t = l e f t ; c r o p B o x D a t a . t o p = t o p ; t h i s . a c t i o n = a c t i o n ; t h i s . r e n d e r C r o p B o x ( ) ; } 
 f o r E a c h ( p o i n t e r s , f u n c t i o n ( p ) { p . s t a r t X = p . e n d X ; p . s t a r t Y = p . e n d Y ; } ) ; } } ; v a r   m e t h o d s = { c r o p : f u n c t i o n   c r o p ( ) { i f ( t h i s . r e a d y & & ! t h i s . c r o p p e d & & ! t h i s . d i s a b l e d ) { t h i s . c r o p p e d = t r u e ; t h i s . l i m i t C r o p B o x ( t r u e , t r u e ) ; i f ( t h i s . o p t i o n s . m o d a l ) { a d d C l a s s ( t h i s . d r a g B o x , C L A S S _ M O D A L ) ; } 
 r e m o v e C l a s s ( t h i s . c r o p B o x , C L A S S _ H I D D E N ) ; t h i s . s e t C r o p B o x D a t a ( t h i s . i n i t i a l C r o p B o x D a t a ) ; } 
 r e t u r n   t h i s ; } , r e s e t : f u n c t i o n   r e s e t ( ) { i f ( t h i s . r e a d y & & ! t h i s . d i s a b l e d ) { t h i s . i m a g e D a t a = a s s i g n ( { } , t h i s . i n i t i a l I m a g e D a t a ) ; t h i s . c a n v a s D a t a = a s s i g n ( { } , t h i s . i n i t i a l C a n v a s D a t a ) ; t h i s . c r o p B o x D a t a = a s s i g n ( { } , t h i s . i n i t i a l C r o p B o x D a t a ) ; t h i s . r e n d e r C a n v a s ( ) ; i f ( t h i s . c r o p p e d ) { t h i s . r e n d e r C r o p B o x ( ) ; } } 
 r e t u r n   t h i s ; } , c l e a r : f u n c t i o n   c l e a r ( ) { i f ( t h i s . c r o p p e d & & ! t h i s . d i s a b l e d ) { a s s i g n ( t h i s . c r o p B o x D a t a , { l e f t : 0 , t o p : 0 , w i d t h : 0 , h e i g h t : 0 } ) ; t h i s . c r o p p e d = f a l s e ; t h i s . r e n d e r C r o p B o x ( ) ; t h i s . l i m i t C a n v a s ( t r u e , t r u e ) ; t h i s . r e n d e r C a n v a s ( ) ; r e m o v e C l a s s ( t h i s . d r a g B o x , C L A S S _ M O D A L ) ; a d d C l a s s ( t h i s . c r o p B o x , C L A S S _ H I D D E N ) ; } 
 r e t u r n   t h i s ; } , r e p l a c e : f u n c t i o n   r e p l a c e ( u r l ) { v a r   h a s S a m e S i z e = a r g u m e n t s . l e n g t h > 1 & & a r g u m e n t s [ 1 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 1 ] : f a l s e ; i f ( ! t h i s . d i s a b l e d & & u r l ) { i f ( t h i s . i s I m g ) { t h i s . e l e m e n t . s r c = u r l ; } 
 i f ( h a s S a m e S i z e ) { t h i s . u r l = u r l ; t h i s . i m a g e . s r c = u r l ; i f ( t h i s . r e a d y ) { t h i s . v i e w B o x I m a g e . s r c = u r l ; f o r E a c h ( t h i s . p r e v i e w s , f u n c t i o n ( e l e m e n t ) { e l e m e n t . g e t E l e m e n t s B y T a g N a m e ( ' i m g ' ) [ 0 ] . s r c = u r l ; } ) ; } } e l s e { i f ( t h i s . i s I m g ) { t h i s . r e p l a c e d = t r u e ; } 
 t h i s . o p t i o n s . d a t a = n u l l ; t h i s . u n c r e a t e ( ) ; t h i s . l o a d ( u r l ) ; } } 
 r e t u r n   t h i s ; } , e n a b l e : f u n c t i o n   e n a b l e ( ) { i f ( t h i s . r e a d y & & t h i s . d i s a b l e d ) { t h i s . d i s a b l e d = f a l s e ; r e m o v e C l a s s ( t h i s . c r o p p e r , C L A S S _ D I S A B L E D ) ; } 
 r e t u r n   t h i s ; } , d i s a b l e : f u n c t i o n   d i s a b l e ( ) { i f ( t h i s . r e a d y & & ! t h i s . d i s a b l e d ) { t h i s . d i s a b l e d = t r u e ; a d d C l a s s ( t h i s . c r o p p e r , C L A S S _ D I S A B L E D ) ; } 
 r e t u r n   t h i s ; } , d e s t r o y : f u n c t i o n   d e s t r o y ( ) { v a r   e l e m e n t = t h i s . e l e m e n t ; i f ( ! e l e m e n t [ N A M E S P A C E ] ) { r e t u r n   t h i s ; } 
 e l e m e n t [ N A M E S P A C E ] = u n d e f i n e d ; i f ( t h i s . i s I m g & & t h i s . r e p l a c e d ) { e l e m e n t . s r c = t h i s . o r i g i n a l U r l ; } 
 t h i s . u n c r e a t e ( ) ; r e t u r n   t h i s ; } , m o v e : f u n c t i o n   m o v e ( o f f s e t X ) { v a r   o f f s e t Y = a r g u m e n t s . l e n g t h > 1 & & a r g u m e n t s [ 1 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 1 ] : o f f s e t X ; v a r   _ t h i s $ c a n v a s D a t a = t h i s . c a n v a s D a t a , l e f t = _ t h i s $ c a n v a s D a t a . l e f t , t o p = _ t h i s $ c a n v a s D a t a . t o p ; r e t u r n   t h i s . m o v e T o ( i s U n d e f i n e d ( o f f s e t X ) ? o f f s e t X : l e f t + N u m b e r ( o f f s e t X ) , i s U n d e f i n e d ( o f f s e t Y ) ? o f f s e t Y : t o p + N u m b e r ( o f f s e t Y ) ) ; } , m o v e T o : f u n c t i o n   m o v e T o ( x ) { v a r   y = a r g u m e n t s . l e n g t h > 1 & & a r g u m e n t s [ 1 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 1 ] : x ; v a r   c a n v a s D a t a = t h i s . c a n v a s D a t a ; v a r   c h a n g e d = f a l s e ; x = N u m b e r ( x ) ; y = N u m b e r ( y ) ; i f ( t h i s . r e a d y & & ! t h i s . d i s a b l e d & & t h i s . o p t i o n s . m o v a b l e ) { i f ( i s N u m b e r ( x ) ) { c a n v a s D a t a . l e f t = x ; c h a n g e d = t r u e ; } 
 i f ( i s N u m b e r ( y ) ) { c a n v a s D a t a . t o p = y ; c h a n g e d = t r u e ; } 
 i f ( c h a n g e d ) { t h i s . r e n d e r C a n v a s ( t r u e ) ; } } 
 r e t u r n   t h i s ; } , z o o m : f u n c t i o n   z o o m ( r a t i o , _ o r i g i n a l E v e n t ) { v a r   c a n v a s D a t a = t h i s . c a n v a s D a t a ; r a t i o = N u m b e r ( r a t i o ) ; i f ( r a t i o < 0 ) { r a t i o = 1 / ( 1 - r a t i o ) ; } e l s e { r a t i o = 1 + r a t i o ; } 
 r e t u r n   t h i s . z o o m T o ( c a n v a s D a t a . w i d t h * r a t i o / c a n v a s D a t a . n a t u r a l W i d t h , n u l l , _ o r i g i n a l E v e n t ) ; } , z o o m T o : f u n c t i o n   z o o m T o ( r a t i o , p i v o t , _ o r i g i n a l E v e n t ) { v a r   o p t i o n s = t h i s . o p t i o n s , c a n v a s D a t a = t h i s . c a n v a s D a t a ; v a r   w i d t h = c a n v a s D a t a . w i d t h , h e i g h t = c a n v a s D a t a . h e i g h t , n a t u r a l W i d t h = c a n v a s D a t a . n a t u r a l W i d t h , n a t u r a l H e i g h t = c a n v a s D a t a . n a t u r a l H e i g h t ; r a t i o = N u m b e r ( r a t i o ) ; i f ( r a t i o > = 0 & & t h i s . r e a d y & & ! t h i s . d i s a b l e d & & o p t i o n s . z o o m a b l e ) { v a r   n e w W i d t h = n a t u r a l W i d t h * r a t i o ; v a r   n e w H e i g h t = n a t u r a l H e i g h t * r a t i o ; i f ( d i s p a t c h E v e n t ( t h i s . e l e m e n t , E V E N T _ Z O O M , { r a t i o : r a t i o , o l d R a t i o : w i d t h / n a t u r a l W i d t h , o r i g i n a l E v e n t : _ o r i g i n a l E v e n t } ) = = = f a l s e ) { r e t u r n   t h i s ; } 
 i f ( _ o r i g i n a l E v e n t ) { v a r   p o i n t e r s = t h i s . p o i n t e r s ; v a r   o f f s e t = g e t O f f s e t ( t h i s . c r o p p e r ) ; v a r   c e n t e r = p o i n t e r s & & O b j e c t . k e y s ( p o i n t e r s ) . l e n g t h ? g e t P o i n t e r s C e n t e r ( p o i n t e r s ) : { p a g e X : _ o r i g i n a l E v e n t . p a g e X , p a g e Y : _ o r i g i n a l E v e n t . p a g e Y } ; c a n v a s D a t a . l e f t - = ( n e w W i d t h - w i d t h ) * ( ( c e n t e r . p a g e X - o f f s e t . l e f t - c a n v a s D a t a . l e f t ) / w i d t h ) ; c a n v a s D a t a . t o p - = ( n e w H e i g h t - h e i g h t ) * ( ( c e n t e r . p a g e Y - o f f s e t . t o p - c a n v a s D a t a . t o p ) / h e i g h t ) ; } e l s e   i f ( i s P l a i n O b j e c t ( p i v o t ) & & i s N u m b e r ( p i v o t . x ) & & i s N u m b e r ( p i v o t . y ) ) { c a n v a s D a t a . l e f t - = ( n e w W i d t h - w i d t h ) * ( ( p i v o t . x - c a n v a s D a t a . l e f t ) / w i d t h ) ; c a n v a s D a t a . t o p - = ( n e w H e i g h t - h e i g h t ) * ( ( p i v o t . y - c a n v a s D a t a . t o p ) / h e i g h t ) ; } e l s e { c a n v a s D a t a . l e f t - = ( n e w W i d t h - w i d t h ) / 2 ; c a n v a s D a t a . t o p - = ( n e w H e i g h t - h e i g h t ) / 2 ; } 
 c a n v a s D a t a . w i d t h = n e w W i d t h ; c a n v a s D a t a . h e i g h t = n e w H e i g h t ; t h i s . r e n d e r C a n v a s ( t r u e ) ; } 
 r e t u r n   t h i s ; } , r o t a t e : f u n c t i o n   r o t a t e ( d e g r e e ) { r e t u r n   t h i s . r o t a t e T o ( ( t h i s . i m a g e D a t a . r o t a t e | | 0 ) + N u m b e r ( d e g r e e ) ) ; } , r o t a t e T o : f u n c t i o n   r o t a t e T o ( d e g r e e ) { d e g r e e = N u m b e r ( d e g r e e ) ; i f ( i s N u m b e r ( d e g r e e ) & & t h i s . r e a d y & & ! t h i s . d i s a b l e d & & t h i s . o p t i o n s . r o t a t a b l e ) { t h i s . i m a g e D a t a . r o t a t e = d e g r e e % 3 6 0 ; t h i s . r e n d e r C a n v a s ( t r u e , t r u e ) ; } 
 r e t u r n   t h i s ; } , s c a l e X : f u n c t i o n   s c a l e X ( _ s c a l e X ) { v a r   s c a l e Y = t h i s . i m a g e D a t a . s c a l e Y ; r e t u r n   t h i s . s c a l e ( _ s c a l e X , i s N u m b e r ( s c a l e Y ) ? s c a l e Y : 1 ) ; } , s c a l e Y : f u n c t i o n   s c a l e Y ( _ s c a l e Y ) { v a r   s c a l e X = t h i s . i m a g e D a t a . s c a l e X ; r e t u r n   t h i s . s c a l e ( i s N u m b e r ( s c a l e X ) ? s c a l e X : 1 , _ s c a l e Y ) ; } , s c a l e : f u n c t i o n   s c a l e ( s c a l e X ) { v a r   s c a l e Y = a r g u m e n t s . l e n g t h > 1 & & a r g u m e n t s [ 1 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 1 ] : s c a l e X ; v a r   i m a g e D a t a = t h i s . i m a g e D a t a ; v a r   t r a n s f o r m e d = f a l s e ; s c a l e X = N u m b e r ( s c a l e X ) ; s c a l e Y = N u m b e r ( s c a l e Y ) ; i f ( t h i s . r e a d y & & ! t h i s . d i s a b l e d & & t h i s . o p t i o n s . s c a l a b l e ) { i f ( i s N u m b e r ( s c a l e X ) ) { i m a g e D a t a . s c a l e X = s c a l e X ; t r a n s f o r m e d = t r u e ; } 
 i f ( i s N u m b e r ( s c a l e Y ) ) { i m a g e D a t a . s c a l e Y = s c a l e Y ; t r a n s f o r m e d = t r u e ; } 
 i f ( t r a n s f o r m e d ) { t h i s . r e n d e r C a n v a s ( t r u e , t r u e ) ; } } 
 r e t u r n   t h i s ; } , g e t D a t a : f u n c t i o n   g e t D a t a ( ) { v a r   r o u n d e d = a r g u m e n t s . l e n g t h > 0 & & a r g u m e n t s [ 0 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 0 ] : f a l s e ; v a r   o p t i o n s = t h i s . o p t i o n s , i m a g e D a t a = t h i s . i m a g e D a t a , c a n v a s D a t a = t h i s . c a n v a s D a t a , c r o p B o x D a t a = t h i s . c r o p B o x D a t a ; v a r   d a t a ; i f ( t h i s . r e a d y & & t h i s . c r o p p e d ) { d a t a = { x : c r o p B o x D a t a . l e f t - c a n v a s D a t a . l e f t , y : c r o p B o x D a t a . t o p - c a n v a s D a t a . t o p , w i d t h : c r o p B o x D a t a . w i d t h , h e i g h t : c r o p B o x D a t a . h e i g h t } ; v a r   r a t i o = i m a g e D a t a . w i d t h / i m a g e D a t a . n a t u r a l W i d t h ; f o r E a c h ( d a t a , f u n c t i o n ( n , i ) { d a t a [ i ] = n / r a t i o ; } ) ; i f ( r o u n d e d ) { v a r   b o t t o m = M a t h . r o u n d ( d a t a . y + d a t a . h e i g h t ) ; v a r   r i g h t = M a t h . r o u n d ( d a t a . x + d a t a . w i d t h ) ; d a t a . x = M a t h . r o u n d ( d a t a . x ) ; d a t a . y = M a t h . r o u n d ( d a t a . y ) ; d a t a . w i d t h = r i g h t - d a t a . x ; d a t a . h e i g h t = b o t t o m - d a t a . y ; } } e l s e { d a t a = { x : 0 , y : 0 , w i d t h : 0 , h e i g h t : 0 } ; } 
 i f ( o p t i o n s . r o t a t a b l e ) { d a t a . r o t a t e = i m a g e D a t a . r o t a t e | | 0 ; } 
 i f ( o p t i o n s . s c a l a b l e ) { d a t a . s c a l e X = i m a g e D a t a . s c a l e X | | 1 ; d a t a . s c a l e Y = i m a g e D a t a . s c a l e Y | | 1 ; } 
 r e t u r n   d a t a ; } , s e t D a t a : f u n c t i o n   s e t D a t a ( d a t a ) { v a r   o p t i o n s = t h i s . o p t i o n s , i m a g e D a t a = t h i s . i m a g e D a t a , c a n v a s D a t a = t h i s . c a n v a s D a t a ; v a r   c r o p B o x D a t a = { } ; i f ( t h i s . r e a d y & & ! t h i s . d i s a b l e d & & i s P l a i n O b j e c t ( d a t a ) ) { v a r   t r a n s f o r m e d = f a l s e ; i f ( o p t i o n s . r o t a t a b l e ) { i f ( i s N u m b e r ( d a t a . r o t a t e ) & & d a t a . r o t a t e ! = = i m a g e D a t a . r o t a t e ) { i m a g e D a t a . r o t a t e = d a t a . r o t a t e ; t r a n s f o r m e d = t r u e ; } } 
 i f ( o p t i o n s . s c a l a b l e ) { i f ( i s N u m b e r ( d a t a . s c a l e X ) & & d a t a . s c a l e X ! = = i m a g e D a t a . s c a l e X ) { i m a g e D a t a . s c a l e X = d a t a . s c a l e X ; t r a n s f o r m e d = t r u e ; } 
 i f ( i s N u m b e r ( d a t a . s c a l e Y ) & & d a t a . s c a l e Y ! = = i m a g e D a t a . s c a l e Y ) { i m a g e D a t a . s c a l e Y = d a t a . s c a l e Y ; t r a n s f o r m e d = t r u e ; } } 
 i f ( t r a n s f o r m e d ) { t h i s . r e n d e r C a n v a s ( t r u e , t r u e ) ; } 
 v a r   r a t i o = i m a g e D a t a . w i d t h / i m a g e D a t a . n a t u r a l W i d t h ; i f ( i s N u m b e r ( d a t a . x ) ) { c r o p B o x D a t a . l e f t = d a t a . x * r a t i o + c a n v a s D a t a . l e f t ; } 
 i f ( i s N u m b e r ( d a t a . y ) ) { c r o p B o x D a t a . t o p = d a t a . y * r a t i o + c a n v a s D a t a . t o p ; } 
 i f ( i s N u m b e r ( d a t a . w i d t h ) ) { c r o p B o x D a t a . w i d t h = d a t a . w i d t h * r a t i o ; } 
 i f ( i s N u m b e r ( d a t a . h e i g h t ) ) { c r o p B o x D a t a . h e i g h t = d a t a . h e i g h t * r a t i o ; } 
 t h i s . s e t C r o p B o x D a t a ( c r o p B o x D a t a ) ; } 
 r e t u r n   t h i s ; } , g e t C o n t a i n e r D a t a : f u n c t i o n   g e t C o n t a i n e r D a t a ( ) { r e t u r n   t h i s . r e a d y ? a s s i g n ( { } , t h i s . c o n t a i n e r D a t a ) : { } ; } , g e t I m a g e D a t a : f u n c t i o n   g e t I m a g e D a t a ( ) { r e t u r n   t h i s . s i z e d ? a s s i g n ( { } , t h i s . i m a g e D a t a ) : { } ; } , g e t C a n v a s D a t a : f u n c t i o n   g e t C a n v a s D a t a ( ) { v a r   c a n v a s D a t a = t h i s . c a n v a s D a t a ; v a r   d a t a = { } ; i f ( t h i s . r e a d y ) { f o r E a c h ( [ ' l e f t ' , ' t o p ' , ' w i d t h ' , ' h e i g h t ' , ' n a t u r a l W i d t h ' , ' n a t u r a l H e i g h t ' ] , f u n c t i o n ( n ) { d a t a [ n ] = c a n v a s D a t a [ n ] ; } ) ; } 
 r e t u r n   d a t a ; } , s e t C a n v a s D a t a : f u n c t i o n   s e t C a n v a s D a t a ( d a t a ) { v a r   c a n v a s D a t a = t h i s . c a n v a s D a t a ; v a r   a s p e c t R a t i o = c a n v a s D a t a . a s p e c t R a t i o ; i f ( t h i s . r e a d y & & ! t h i s . d i s a b l e d & & i s P l a i n O b j e c t ( d a t a ) ) { i f ( i s N u m b e r ( d a t a . l e f t ) ) { c a n v a s D a t a . l e f t = d a t a . l e f t ; } 
 i f ( i s N u m b e r ( d a t a . t o p ) ) { c a n v a s D a t a . t o p = d a t a . t o p ; } 
 i f ( i s N u m b e r ( d a t a . w i d t h ) ) { c a n v a s D a t a . w i d t h = d a t a . w i d t h ; c a n v a s D a t a . h e i g h t = d a t a . w i d t h / a s p e c t R a t i o ; } e l s e   i f ( i s N u m b e r ( d a t a . h e i g h t ) ) { c a n v a s D a t a . h e i g h t = d a t a . h e i g h t ; c a n v a s D a t a . w i d t h = d a t a . h e i g h t * a s p e c t R a t i o ; } 
 t h i s . r e n d e r C a n v a s ( t r u e ) ; } 
 r e t u r n   t h i s ; } , g e t C r o p B o x D a t a : f u n c t i o n   g e t C r o p B o x D a t a ( ) { v a r   c r o p B o x D a t a = t h i s . c r o p B o x D a t a ; v a r   d a t a ; i f ( t h i s . r e a d y & & t h i s . c r o p p e d ) { d a t a = { l e f t : c r o p B o x D a t a . l e f t , t o p : c r o p B o x D a t a . t o p , w i d t h : c r o p B o x D a t a . w i d t h , h e i g h t : c r o p B o x D a t a . h e i g h t } ; } 
 r e t u r n   d a t a | | { } ; } , s e t C r o p B o x D a t a : f u n c t i o n   s e t C r o p B o x D a t a ( d a t a ) { v a r   c r o p B o x D a t a = t h i s . c r o p B o x D a t a ; v a r   a s p e c t R a t i o = t h i s . o p t i o n s . a s p e c t R a t i o ; v a r   w i d t h C h a n g e d ; v a r   h e i g h t C h a n g e d ; i f ( t h i s . r e a d y & & t h i s . c r o p p e d & & ! t h i s . d i s a b l e d & & i s P l a i n O b j e c t ( d a t a ) ) { i f ( i s N u m b e r ( d a t a . l e f t ) ) { c r o p B o x D a t a . l e f t = d a t a . l e f t ; } 
 i f ( i s N u m b e r ( d a t a . t o p ) ) { c r o p B o x D a t a . t o p = d a t a . t o p ; } 
 i f ( i s N u m b e r ( d a t a . w i d t h ) & & d a t a . w i d t h ! = = c r o p B o x D a t a . w i d t h ) { w i d t h C h a n g e d = t r u e ; c r o p B o x D a t a . w i d t h = d a t a . w i d t h ; } 
 i f ( i s N u m b e r ( d a t a . h e i g h t ) & & d a t a . h e i g h t ! = = c r o p B o x D a t a . h e i g h t ) { h e i g h t C h a n g e d = t r u e ; c r o p B o x D a t a . h e i g h t = d a t a . h e i g h t ; } 
 i f ( a s p e c t R a t i o ) { i f ( w i d t h C h a n g e d ) { c r o p B o x D a t a . h e i g h t = c r o p B o x D a t a . w i d t h / a s p e c t R a t i o ; } e l s e   i f ( h e i g h t C h a n g e d ) { c r o p B o x D a t a . w i d t h = c r o p B o x D a t a . h e i g h t * a s p e c t R a t i o ; } } 
 t h i s . r e n d e r C r o p B o x ( ) ; } 
 r e t u r n   t h i s ; } , g e t C r o p p e d C a n v a s : f u n c t i o n   g e t C r o p p e d C a n v a s ( ) { v a r   o p t i o n s = a r g u m e n t s . l e n g t h > 0 & & a r g u m e n t s [ 0 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 0 ] : { } ; i f ( ! t h i s . r e a d y | | ! w i n d o w . H T M L C a n v a s E l e m e n t ) { r e t u r n   n u l l ; } 
 v a r   c a n v a s D a t a = t h i s . c a n v a s D a t a ; v a r   s o u r c e = g e t S o u r c e C a n v a s ( t h i s . i m a g e , t h i s . i m a g e D a t a , c a n v a s D a t a , o p t i o n s ) ; i f ( ! t h i s . c r o p p e d ) { r e t u r n   s o u r c e ; } 
 v a r   _ t h i s $ g e t D a t a = t h i s . g e t D a t a ( ) , i n i t i a l X = _ t h i s $ g e t D a t a . x , i n i t i a l Y = _ t h i s $ g e t D a t a . y , i n i t i a l W i d t h = _ t h i s $ g e t D a t a . w i d t h , i n i t i a l H e i g h t = _ t h i s $ g e t D a t a . h e i g h t ; v a r   r a t i o = s o u r c e . w i d t h / M a t h . f l o o r ( c a n v a s D a t a . n a t u r a l W i d t h ) ; i f ( r a t i o ! = = 1 ) { i n i t i a l X * = r a t i o ; i n i t i a l Y * = r a t i o ; i n i t i a l W i d t h * = r a t i o ; i n i t i a l H e i g h t * = r a t i o ; } 
 v a r   a s p e c t R a t i o = i n i t i a l W i d t h / i n i t i a l H e i g h t ; v a r   m a x S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : a s p e c t R a t i o , w i d t h : o p t i o n s . m a x W i d t h | | I n f i n i t y , h e i g h t : o p t i o n s . m a x H e i g h t | | I n f i n i t y } ) ; v a r   m i n S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : a s p e c t R a t i o , w i d t h : o p t i o n s . m i n W i d t h | | 0 , h e i g h t : o p t i o n s . m i n H e i g h t | | 0 } , ' c o v e r ' ) ; v a r   _ g e t A d j u s t e d S i z e s = g e t A d j u s t e d S i z e s ( { a s p e c t R a t i o : a s p e c t R a t i o , w i d t h : o p t i o n s . w i d t h | | ( r a t i o ! = = 1 ? s o u r c e . w i d t h : i n i t i a l W i d t h ) , h e i g h t : o p t i o n s . h e i g h t | | ( r a t i o ! = = 1 ? s o u r c e . h e i g h t : i n i t i a l H e i g h t ) } ) , w i d t h = _ g e t A d j u s t e d S i z e s . w i d t h , h e i g h t = _ g e t A d j u s t e d S i z e s . h e i g h t ; w i d t h = M a t h . m i n ( m a x S i z e s . w i d t h , M a t h . m a x ( m i n S i z e s . w i d t h , w i d t h ) ) ; h e i g h t = M a t h . m i n ( m a x S i z e s . h e i g h t , M a t h . m a x ( m i n S i z e s . h e i g h t , h e i g h t ) ) ; v a r   c a n v a s = d o c u m e n t . c r e a t e E l e m e n t ( ' c a n v a s ' ) ; v a r   c o n t e x t = c a n v a s . g e t C o n t e x t ( ' 2 d ' ) ; c a n v a s . w i d t h = n o r m a l i z e D e c i m a l N u m b e r ( w i d t h ) ; c a n v a s . h e i g h t = n o r m a l i z e D e c i m a l N u m b e r ( h e i g h t ) ; c o n t e x t . f i l l S t y l e = o p t i o n s . f i l l C o l o r | | ' t r a n s p a r e n t ' ; c o n t e x t . f i l l R e c t ( 0 , 0 , w i d t h , h e i g h t ) ; v a r   _ o p t i o n s $ i m a g e S m o o t h i = o p t i o n s . i m a g e S m o o t h i n g E n a b l e d , i m a g e S m o o t h i n g E n a b l e d = _ o p t i o n s $ i m a g e S m o o t h i = = = v o i d   0 ? t r u e : _ o p t i o n s $ i m a g e S m o o t h i , i m a g e S m o o t h i n g Q u a l i t y = o p t i o n s . i m a g e S m o o t h i n g Q u a l i t y ; c o n t e x t . i m a g e S m o o t h i n g E n a b l e d = i m a g e S m o o t h i n g E n a b l e d ; i f ( i m a g e S m o o t h i n g Q u a l i t y ) { c o n t e x t . i m a g e S m o o t h i n g Q u a l i t y = i m a g e S m o o t h i n g Q u a l i t y ; } 
 v a r   s o u r c e W i d t h = s o u r c e . w i d t h ; v a r   s o u r c e H e i g h t = s o u r c e . h e i g h t ; v a r   s r c X = i n i t i a l X ; v a r   s r c Y = i n i t i a l Y ; v a r   s r c W i d t h ; v a r   s r c H e i g h t ; v a r   d s t X ; v a r   d s t Y ; v a r   d s t W i d t h ; v a r   d s t H e i g h t ; i f ( s r c X < = - i n i t i a l W i d t h | | s r c X > s o u r c e W i d t h ) { s r c X = 0 ; s r c W i d t h = 0 ; d s t X = 0 ; d s t W i d t h = 0 ; } e l s e   i f ( s r c X < = 0 ) { d s t X = - s r c X ; s r c X = 0 ; s r c W i d t h = M a t h . m i n ( s o u r c e W i d t h , i n i t i a l W i d t h + s r c X ) ; d s t W i d t h = s r c W i d t h ; } e l s e   i f ( s r c X < = s o u r c e W i d t h ) { d s t X = 0 ; s r c W i d t h = M a t h . m i n ( i n i t i a l W i d t h , s o u r c e W i d t h - s r c X ) ; d s t W i d t h = s r c W i d t h ; } 
 i f ( s r c W i d t h < = 0 | | s r c Y < = - i n i t i a l H e i g h t | | s r c Y > s o u r c e H e i g h t ) { s r c Y = 0 ; s r c H e i g h t = 0 ; d s t Y = 0 ; d s t H e i g h t = 0 ; } e l s e   i f ( s r c Y < = 0 ) { d s t Y = - s r c Y ; s r c Y = 0 ; s r c H e i g h t = M a t h . m i n ( s o u r c e H e i g h t , i n i t i a l H e i g h t + s r c Y ) ; d s t H e i g h t = s r c H e i g h t ; } e l s e   i f ( s r c Y < = s o u r c e H e i g h t ) { d s t Y = 0 ; s r c H e i g h t = M a t h . m i n ( i n i t i a l H e i g h t , s o u r c e H e i g h t - s r c Y ) ; d s t H e i g h t = s r c H e i g h t ; } 
 v a r   p a r a m s = [ s r c X , s r c Y , s r c W i d t h , s r c H e i g h t ] ; i f ( d s t W i d t h > 0 & & d s t H e i g h t > 0 ) { v a r   s c a l e = w i d t h / i n i t i a l W i d t h ; p a r a m s . p u s h ( d s t X * s c a l e , d s t Y * s c a l e , d s t W i d t h * s c a l e , d s t H e i g h t * s c a l e ) ; } 
 c o n t e x t . d r a w I m a g e . a p p l y ( c o n t e x t , [ s o u r c e ] . c o n c a t ( _ t o C o n s u m a b l e A r r a y ( p a r a m s . m a p ( f u n c t i o n ( p a r a m ) { r e t u r n   M a t h . f l o o r ( n o r m a l i z e D e c i m a l N u m b e r ( p a r a m ) ) ; } ) ) ) ) ; r e t u r n   c a n v a s ; } , s e t A s p e c t R a t i o : f u n c t i o n   s e t A s p e c t R a t i o ( a s p e c t R a t i o ) { v a r   o p t i o n s = t h i s . o p t i o n s ; i f ( ! t h i s . d i s a b l e d & & ! i s U n d e f i n e d ( a s p e c t R a t i o ) ) { o p t i o n s . a s p e c t R a t i o = M a t h . m a x ( 0 , a s p e c t R a t i o ) | | N a N ; i f ( t h i s . r e a d y ) { t h i s . i n i t C r o p B o x ( ) ; i f ( t h i s . c r o p p e d ) { t h i s . r e n d e r C r o p B o x ( ) ; } } } 
 r e t u r n   t h i s ; } , s e t D r a g M o d e : f u n c t i o n   s e t D r a g M o d e ( m o d e ) { v a r   o p t i o n s = t h i s . o p t i o n s , d r a g B o x = t h i s . d r a g B o x , f a c e = t h i s . f a c e ; i f ( t h i s . r e a d y & & ! t h i s . d i s a b l e d ) { v a r   c r o p p a b l e = m o d e = = = D R A G _ M O D E _ C R O P ; v a r   m o v a b l e = o p t i o n s . m o v a b l e & & m o d e = = = D R A G _ M O D E _ M O V E ; m o d e = c r o p p a b l e | | m o v a b l e ? m o d e : D R A G _ M O D E _ N O N E ; o p t i o n s . d r a g M o d e = m o d e ; s e t D a t a ( d r a g B o x , D A T A _ A C T I O N , m o d e ) ; t o g g l e C l a s s ( d r a g B o x , C L A S S _ C R O P , c r o p p a b l e ) ; t o g g l e C l a s s ( d r a g B o x , C L A S S _ M O V E , m o v a b l e ) ; i f ( ! o p t i o n s . c r o p B o x M o v a b l e ) { s e t D a t a ( f a c e , D A T A _ A C T I O N , m o d e ) ; t o g g l e C l a s s ( f a c e , C L A S S _ C R O P , c r o p p a b l e ) ; t o g g l e C l a s s ( f a c e , C L A S S _ M O V E , m o v a b l e ) ; } } 
 r e t u r n   t h i s ; } } ; v a r   A n o t h e r C r o p p e r = W I N D O W . C r o p p e r ; v a r   C r o p p e r = f u n c t i o n ( ) { f u n c t i o n   C r o p p e r ( e l e m e n t ) { v a r   o p t i o n s = a r g u m e n t s . l e n g t h > 1 & & a r g u m e n t s [ 1 ] ! = = u n d e f i n e d ? a r g u m e n t s [ 1 ] : { } ; _ c l a s s C a l l C h e c k ( t h i s , C r o p p e r ) ; i f ( ! e l e m e n t | | ! R E G E X P _ T A G _ N A M E . t e s t ( e l e m e n t . t a g N a m e ) ) { t h r o w   n e w   E r r o r ( ' T h e   f i r s t   a r g u m e n t   i s   r e q u i r e d   a n d   m u s t   b e   a n   < i m g >   o r   < c a n v a s >   e l e m e n t . ' ) ; } 
 t h i s . e l e m e n t = e l e m e n t ; t h i s . o p t i o n s = a s s i g n ( { } , D E F A U L T S , i s P l a i n O b j e c t ( o p t i o n s ) & & o p t i o n s ) ; t h i s . c r o p p e d = f a l s e ; t h i s . d i s a b l e d = f a l s e ; t h i s . p o i n t e r s = { } ; t h i s . r e a d y = f a l s e ; t h i s . r e l o a d i n g = f a l s e ; t h i s . r e p l a c e d = f a l s e ; t h i s . s i z e d = f a l s e ; t h i s . s i z i n g = f a l s e ; t h i s . i n i t ( ) ; } 
 _ c r e a t e C l a s s ( C r o p p e r , [ { k e y : " i n i t " , v a l u e : f u n c t i o n   i n i t ( ) { v a r   e l e m e n t = t h i s . e l e m e n t ; v a r   t a g N a m e = e l e m e n t . t a g N a m e . t o L o w e r C a s e ( ) ; v a r   u r l ; i f ( e l e m e n t [ N A M E S P A C E ] ) { r e t u r n ; } 
 e l e m e n t [ N A M E S P A C E ] = t h i s ; i f ( t a g N a m e = = = ' i m g ' ) { t h i s . i s I m g = t r u e ; u r l = e l e m e n t . g e t A t t r i b u t e ( ' s r c ' ) | | ' ' ; t h i s . o r i g i n a l U r l = u r l ; i f ( ! u r l ) { r e t u r n ; } 
 u r l = e l e m e n t . s r c ; } e l s e   i f ( t a g N a m e = = = ' c a n v a s ' & & w i n d o w . H T M L C a n v a s E l e m e n t ) { u r l = e l e m e n t . t o D a t a U R L ( ) ; } 
 t h i s . l o a d ( u r l ) ; } } , { k e y : " l o a d " , v a l u e : f u n c t i o n   l o a d ( u r l ) { v a r   _ t h i s = t h i s ; i f ( ! u r l ) { r e t u r n ; } 
 t h i s . u r l = u r l ; t h i s . i m a g e D a t a = { } ; v a r   e l e m e n t = t h i s . e l e m e n t , o p t i o n s = t h i s . o p t i o n s ; i f ( ! o p t i o n s . r o t a t a b l e & & ! o p t i o n s . s c a l a b l e ) { o p t i o n s . c h e c k O r i e n t a t i o n = f a l s e ; } 
 i f ( ! o p t i o n s . c h e c k O r i e n t a t i o n | | ! w i n d o w . A r r a y B u f f e r ) { t h i s . c l o n e ( ) ; r e t u r n ; } 
 i f ( R E G E X P _ D A T A _ U R L . t e s t ( u r l ) ) { i f ( R E G E X P _ D A T A _ U R L _ J P E G . t e s t ( u r l ) ) { t h i s . r e a d ( d a t a U R L T o A r r a y B u f f e r ( u r l ) ) ; } e l s e { t h i s . c l o n e ( ) ; } 
 r e t u r n ; } 
 v a r   x h r = n e w   X M L H t t p R e q u e s t ( ) ; v a r   c l o n e = t h i s . c l o n e . b i n d ( t h i s ) ; t h i s . r e l o a d i n g = t r u e ; t h i s . x h r = x h r ; x h r . o n a b o r t = c l o n e ; x h r . o n e r r o r = c l o n e ; x h r . o n t i m e o u t = c l o n e ; x h r . o n p r o g r e s s = f u n c t i o n ( ) { i f ( x h r . g e t R e s p o n s e H e a d e r ( ' c o n t e n t - t y p e ' ) ! = = M I M E _ T Y P E _ J P E G ) { x h r . a b o r t ( ) ; } } ; x h r . o n l o a d = f u n c t i o n ( ) { _ t h i s . r e a d ( x h r . r e s p o n s e ) ; } ; x h r . o n l o a d e n d = f u n c t i o n ( ) { _ t h i s . r e l o a d i n g = f a l s e ; _ t h i s . x h r = n u l l ; } ; i f ( o p t i o n s . c h e c k C r o s s O r i g i n & & i s C r o s s O r i g i n U R L ( u r l ) & & e l e m e n t . c r o s s O r i g i n ) { u r l = a d d T i m e s t a m p ( u r l ) ; } 
 x h r . o p e n ( ' G E T ' , u r l ) ; x h r . r e s p o n s e T y p e = ' a r r a y b u f f e r ' ; x h r . w i t h C r e d e n t i a l s = e l e m e n t . c r o s s O r i g i n = = = ' u s e - c r e d e n t i a l s ' ; x h r . s e n d ( ) ; } } , { k e y : " r e a d " , v a l u e : f u n c t i o n   r e a d ( a r r a y B u f f e r ) { v a r   o p t i o n s = t h i s . o p t i o n s , i m a g e D a t a = t h i s . i m a g e D a t a ; v a r   o r i e n t a t i o n = r e s e t A n d G e t O r i e n t a t i o n ( a r r a y B u f f e r ) ; v a r   r o t a t e = 0 ; v a r   s c a l e X = 1 ; v a r   s c a l e Y = 1 ; i f ( o r i e n t a t i o n > 1 ) { t h i s . u r l = a r r a y B u f f e r T o D a t a U R L ( a r r a y B u f f e r , M I M E _ T Y P E _ J P E G ) ; v a r   _ p a r s e O r i e n t a t i o n = p a r s e O r i e n t a t i o n ( o r i e n t a t i o n ) ; r o t a t e = _ p a r s e O r i e n t a t i o n . r o t a t e ; s c a l e X = _ p a r s e O r i e n t a t i o n . s c a l e X ; s c a l e Y = _ p a r s e O r i e n t a t i o n . s c a l e Y ; } 
 i f ( o p t i o n s . r o t a t a b l e ) { i m a g e D a t a . r o t a t e = r o t a t e ; } 
 i f ( o p t i o n s . s c a l a b l e ) { i m a g e D a t a . s c a l e X = s c a l e X ; i m a g e D a t a . s c a l e Y = s c a l e Y ; } 
 t h i s . c l o n e ( ) ; } } , { k e y : " c l o n e " , v a l u e : f u n c t i o n   c l o n e ( ) { v a r   e l e m e n t = t h i s . e l e m e n t , u r l = t h i s . u r l ; v a r   c r o s s O r i g i n = e l e m e n t . c r o s s O r i g i n ; v a r   c r o s s O r i g i n U r l = u r l ; i f ( t h i s . o p t i o n s . c h e c k C r o s s O r i g i n & & i s C r o s s O r i g i n U R L ( u r l ) ) { i f ( ! c r o s s O r i g i n ) { c r o s s O r i g i n = ' a n o n y m o u s ' ; } 
 c r o s s O r i g i n U r l = a d d T i m e s t a m p ( u r l ) ; } 
 t h i s . c r o s s O r i g i n = c r o s s O r i g i n ; t h i s . c r o s s O r i g i n U r l = c r o s s O r i g i n U r l ; v a r   i m a g e = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; i f ( c r o s s O r i g i n ) { i m a g e . c r o s s O r i g i n = c r o s s O r i g i n ; } 
 i m a g e . s r c = c r o s s O r i g i n U r l | | u r l ; i m a g e . a l t = e l e m e n t . a l t | | ' T h e   i m a g e   t o   c r o p ' ; t h i s . i m a g e = i m a g e ; i m a g e . o n l o a d = t h i s . s t a r t . b i n d ( t h i s ) ; i m a g e . o n e r r o r = t h i s . s t o p . b i n d ( t h i s ) ; a d d C l a s s ( i m a g e , C L A S S _ H I D E ) ; e l e m e n t . p a r e n t N o d e . i n s e r t B e f o r e ( i m a g e , e l e m e n t . n e x t S i b l i n g ) ; } } , { k e y : " s t a r t " , v a l u e : f u n c t i o n   s t a r t ( ) { v a r   _ t h i s 2 = t h i s ; v a r   i m a g e = t h i s . i m a g e ; i m a g e . o n l o a d = n u l l ; i m a g e . o n e r r o r = n u l l ; t h i s . s i z i n g = t r u e ; v a r   i s I O S W e b K i t = W I N D O W . n a v i g a t o r & & / ( ? : i P a d | i P h o n e | i P o d ) . * ? A p p l e W e b K i t / i . t e s t ( W I N D O W . n a v i g a t o r . u s e r A g e n t ) ; v a r   d o n e = f u n c t i o n   d o n e ( n a t u r a l W i d t h , n a t u r a l H e i g h t ) { a s s i g n ( _ t h i s 2 . i m a g e D a t a , { n a t u r a l W i d t h : n a t u r a l W i d t h , n a t u r a l H e i g h t : n a t u r a l H e i g h t , a s p e c t R a t i o : n a t u r a l W i d t h / n a t u r a l H e i g h t } ) ; _ t h i s 2 . s i z i n g = f a l s e ; _ t h i s 2 . s i z e d = t r u e ; _ t h i s 2 . b u i l d ( ) ; } ; i f ( i m a g e . n a t u r a l W i d t h & & ! i s I O S W e b K i t ) { d o n e ( i m a g e . n a t u r a l W i d t h , i m a g e . n a t u r a l H e i g h t ) ; r e t u r n ; } 
 v a r   s i z i n g I m a g e = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; v a r   b o d y = d o c u m e n t . b o d y | | d o c u m e n t . d o c u m e n t E l e m e n t ; t h i s . s i z i n g I m a g e = s i z i n g I m a g e ; s i z i n g I m a g e . o n l o a d = f u n c t i o n ( ) { d o n e ( s i z i n g I m a g e . w i d t h , s i z i n g I m a g e . h e i g h t ) ; i f ( ! i s I O S W e b K i t ) { b o d y . r e m o v e C h i l d ( s i z i n g I m a g e ) ; } } ; s i z i n g I m a g e . s r c = i m a g e . s r c ; i f ( ! i s I O S W e b K i t ) { s i z i n g I m a g e . s t y l e . c s s T e x t = ' l e f t : 0 ; ' + ' m a x - h e i g h t : n o n e ! i m p o r t a n t ; ' + ' m a x - w i d t h : n o n e ! i m p o r t a n t ; ' + ' m i n - h e i g h t : 0 ! i m p o r t a n t ; ' + ' m i n - w i d t h : 0 ! i m p o r t a n t ; ' + ' o p a c i t y : 0 ; ' + ' p o s i t i o n : a b s o l u t e ; ' + ' t o p : 0 ; ' + ' z - i n d e x : - 1 ; ' ; b o d y . a p p e n d C h i l d ( s i z i n g I m a g e ) ; } } } , { k e y : " s t o p " , v a l u e : f u n c t i o n   s t o p ( ) { v a r   i m a g e = t h i s . i m a g e ; i m a g e . o n l o a d = n u l l ; i m a g e . o n e r r o r = n u l l ; i m a g e . p a r e n t N o d e . r e m o v e C h i l d ( i m a g e ) ; t h i s . i m a g e = n u l l ; } } , { k e y : " b u i l d " , v a l u e : f u n c t i o n   b u i l d ( ) { i f ( ! t h i s . s i z e d | | t h i s . r e a d y ) { r e t u r n ; } 
 v a r   e l e m e n t = t h i s . e l e m e n t , o p t i o n s = t h i s . o p t i o n s , i m a g e = t h i s . i m a g e ; v a r   c o n t a i n e r = e l e m e n t . p a r e n t N o d e ; v a r   t e m p l a t e = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; t e m p l a t e . i n n e r H T M L = T E M P L A T E ; v a r   c r o p p e r = t e m p l a t e . q u e r y S e l e c t o r ( " . " . c o n c a t ( N A M E S P A C E , " - c o n t a i n e r " ) ) ; v a r   c a n v a s = c r o p p e r . q u e r y S e l e c t o r ( " . " . c o n c a t ( N A M E S P A C E , " - c a n v a s " ) ) ; v a r   d r a g B o x = c r o p p e r . q u e r y S e l e c t o r ( " . " . c o n c a t ( N A M E S P A C E , " - d r a g - b o x " ) ) ; v a r   c r o p B o x = c r o p p e r . q u e r y S e l e c t o r ( " . " . c o n c a t ( N A M E S P A C E , " - c r o p - b o x " ) ) ; v a r   f a c e = c r o p B o x . q u e r y S e l e c t o r ( " . " . c o n c a t ( N A M E S P A C E , " - f a c e " ) ) ; t h i s . c o n t a i n e r = c o n t a i n e r ; t h i s . c r o p p e r = c r o p p e r ; t h i s . c a n v a s = c a n v a s ; t h i s . d r a g B o x = d r a g B o x ; t h i s . c r o p B o x = c r o p B o x ; t h i s . v i e w B o x = c r o p p e r . q u e r y S e l e c t o r ( " . " . c o n c a t ( N A M E S P A C E , " - v i e w - b o x " ) ) ; t h i s . f a c e = f a c e ; c a n v a s . a p p e n d C h i l d ( i m a g e ) ; a d d C l a s s ( e l e m e n t , C L A S S _ H I D D E N ) ; c o n t a i n e r . i n s e r t B e f o r e ( c r o p p e r , e l e m e n t . n e x t S i b l i n g ) ; i f ( ! t h i s . i s I m g ) { r e m o v e C l a s s ( i m a g e , C L A S S _ H I D E ) ; } 
 t h i s . i n i t P r e v i e w ( ) ; t h i s . b i n d ( ) ; o p t i o n s . i n i t i a l A s p e c t R a t i o = M a t h . m a x ( 0 , o p t i o n s . i n i t i a l A s p e c t R a t i o ) | | N a N ; o p t i o n s . a s p e c t R a t i o = M a t h . m a x ( 0 , o p t i o n s . a s p e c t R a t i o ) | | N a N ; o p t i o n s . v i e w M o d e = M a t h . m a x ( 0 , M a t h . m i n ( 3 , M a t h . r o u n d ( o p t i o n s . v i e w M o d e ) ) ) | | 0 ; a d d C l a s s ( c r o p B o x , C L A S S _ H I D D E N ) ; i f ( ! o p t i o n s . g u i d e s ) { a d d C l a s s ( c r o p B o x . g e t E l e m e n t s B y C l a s s N a m e ( " " . c o n c a t ( N A M E S P A C E , " - d a s h e d " ) ) , C L A S S _ H I D D E N ) ; } 
 i f ( ! o p t i o n s . c e n t e r ) { a d d C l a s s ( c r o p B o x . g e t E l e m e n t s B y C l a s s N a m e ( " " . c o n c a t ( N A M E S P A C E , " - c e n t e r " ) ) , C L A S S _ H I D D E N ) ; } 
 i f ( o p t i o n s . b a c k g r o u n d ) { a d d C l a s s ( c r o p p e r , " " . c o n c a t ( N A M E S P A C E , " - b g " ) ) ; } 
 i f ( ! o p t i o n s . h i g h l i g h t ) { a d d C l a s s ( f a c e , C L A S S _ I N V I S I B L E ) ; } 
 i f ( o p t i o n s . c r o p B o x M o v a b l e ) { a d d C l a s s ( f a c e , C L A S S _ M O V E ) ; s e t D a t a ( f a c e , D A T A _ A C T I O N , A C T I O N _ A L L ) ; } 
 i f ( ! o p t i o n s . c r o p B o x R e s i z a b l e ) { a d d C l a s s ( c r o p B o x . g e t E l e m e n t s B y C l a s s N a m e ( " " . c o n c a t ( N A M E S P A C E , " - l i n e " ) ) , C L A S S _ H I D D E N ) ; a d d C l a s s ( c r o p B o x . g e t E l e m e n t s B y C l a s s N a m e ( " " . c o n c a t ( N A M E S P A C E , " - p o i n t " ) ) , C L A S S _ H I D D E N ) ; } 
 t h i s . r e n d e r ( ) ; t h i s . r e a d y = t r u e ; t h i s . s e t D r a g M o d e ( o p t i o n s . d r a g M o d e ) ; i f ( o p t i o n s . a u t o C r o p ) { t h i s . c r o p ( ) ; } 
 t h i s . s e t D a t a ( o p t i o n s . d a t a ) ; i f ( i s F u n c t i o n ( o p t i o n s . r e a d y ) ) { a d d L i s t e n e r ( e l e m e n t , E V E N T _ R E A D Y , o p t i o n s . r e a d y , { o n c e : t r u e } ) ; } 
 d i s p a t c h E v e n t ( e l e m e n t , E V E N T _ R E A D Y ) ; } } , { k e y : " u n b u i l d " , v a l u e : f u n c t i o n   u n b u i l d ( ) { i f ( ! t h i s . r e a d y ) { r e t u r n ; } 
 t h i s . r e a d y = f a l s e ; t h i s . u n b i n d ( ) ; t h i s . r e s e t P r e v i e w ( ) ; t h i s . c r o p p e r . p a r e n t N o d e . r e m o v e C h i l d ( t h i s . c r o p p e r ) ; r e m o v e C l a s s ( t h i s . e l e m e n t , C L A S S _ H I D D E N ) ; } } , { k e y : " u n c r e a t e " , v a l u e : f u n c t i o n   u n c r e a t e ( ) { i f ( t h i s . r e a d y ) { t h i s . u n b u i l d ( ) ; t h i s . r e a d y = f a l s e ; t h i s . c r o p p e d = f a l s e ; } e l s e   i f ( t h i s . s i z i n g ) { t h i s . s i z i n g I m a g e . o n l o a d = n u l l ; t h i s . s i z i n g = f a l s e ; t h i s . s i z e d = f a l s e ; } e l s e   i f ( t h i s . r e l o a d i n g ) { t h i s . x h r . o n a b o r t = n u l l ; t h i s . x h r . a b o r t ( ) ; } e l s e   i f ( t h i s . i m a g e ) { t h i s . s t o p ( ) ; } } } ] , [ { k e y : " n o C o n f l i c t " , v a l u e : f u n c t i o n   n o C o n f l i c t ( ) { w i n d o w . C r o p p e r = A n o t h e r C r o p p e r ; r e t u r n   C r o p p e r ; } } , { k e y : " s e t D e f a u l t s " , v a l u e : f u n c t i o n   s e t D e f a u l t s ( o p t i o n s ) { a s s i g n ( D E F A U L T S , i s P l a i n O b j e c t ( o p t i o n s ) & & o p t i o n s ) ; } } ] ) ; r e t u r n   C r o p p e r ; } ( ) ; a s s i g n ( C r o p p e r . p r o t o t y p e , r e n d e r , p r e v i e w , e v e n t s , h a n d l e r s , c h a n g e , m e t h o d s ) ; r e t u r n   C r o p p e r ; } ) ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / l i b / j q u e r y - c r o p p e r / j q u e r y - c r o p p e r . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ( f u n c t i o n ( g l o b a l , f a c t o r y ) { t y p e o f   e x p o r t s = = = ' o b j e c t ' & & t y p e o f   m o d u l e ! = = ' u n d e f i n e d ' ? f a c t o r y ( r e q u i r e ( ' j q u e r y ' ) , r e q u i r e ( ' c r o p p e r j s ' ) ) : t y p e o f   d e f i n e = = = ' f u n c t i o n ' & & d e f i n e . a m d ? d e f i n e ( [ ' j q u e r y ' , ' c r o p p e r j s ' ] , f a c t o r y ) : ( f a c t o r y ( g l o b a l . j Q u e r y , g l o b a l . C r o p p e r ) ) ; } ( t h i s , ( f u n c t i o n ( $ , C r o p p e r ) { ' u s e   s t r i c t ' ; $ = $ & & $ . h a s O w n P r o p e r t y ( ' d e f a u l t ' ) ? $ [ ' d e f a u l t ' ] : $ ; C r o p p e r = C r o p p e r & & C r o p p e r . h a s O w n P r o p e r t y ( ' d e f a u l t ' ) ? C r o p p e r [ ' d e f a u l t ' ] : C r o p p e r ; i f ( $ . f n ) { v a r   A n o t h e r C r o p p e r = $ . f n . c r o p p e r ; v a r   N A M E S P A C E = ' c r o p p e r ' ; $ . f n . c r o p p e r = f u n c t i o n   j Q u e r y C r o p p e r ( o p t i o n ) { f o r ( v a r   _ l e n = a r g u m e n t s . l e n g t h , a r g s = A r r a y ( _ l e n > 1 ? _ l e n - 1 : 0 ) , _ k e y = 1 ; _ k e y < _ l e n ; _ k e y + + ) { a r g s [ _ k e y - 1 ] = a r g u m e n t s [ _ k e y ] ; } 
 v a r   r e s u l t = v o i d   0 ; t h i s . e a c h ( f u n c t i o n ( i , e l e m e n t ) { v a r   $ e l e m e n t = $ ( e l e m e n t ) ; v a r   i s D e s t r o y = o p t i o n = = = ' d e s t r o y ' ; v a r   c r o p p e r = $ e l e m e n t . d a t a ( N A M E S P A C E ) ; i f ( ! c r o p p e r ) { i f ( i s D e s t r o y ) { r e t u r n ; } 
 v a r   o p t i o n s = $ . e x t e n d ( { } , $ e l e m e n t . d a t a ( ) , $ . i s P l a i n O b j e c t ( o p t i o n ) & & o p t i o n ) ; c r o p p e r = n e w   C r o p p e r ( e l e m e n t , o p t i o n s ) ; $ e l e m e n t . d a t a ( N A M E S P A C E , c r o p p e r ) ; } 
 i f ( t y p e o f   o p t i o n = = = ' s t r i n g ' ) { v a r   f n = c r o p p e r [ o p t i o n ] ; i f ( $ . i s F u n c t i o n ( f n ) ) { r e s u l t = f n . a p p l y ( c r o p p e r , a r g s ) ; i f ( r e s u l t = = = c r o p p e r ) { r e s u l t = u n d e f i n e d ; } 
 i f ( i s D e s t r o y ) { $ e l e m e n t . r e m o v e D a t a ( N A M E S P A C E ) ; } } } } ) ; r e t u r n   r e s u l t ! = = u n d e f i n e d ? r e s u l t : t h i s ; } ; $ . f n . c r o p p e r . C o n s t r u c t o r = C r o p p e r ; $ . f n . c r o p p e r . s e t D e f a u l t s = C r o p p e r . s e t D e f a u l t s ; $ . f n . c r o p p e r . n o C o n f l i c t = f u n c t i o n   n o C o n f l i c t ( ) { $ . f n . c r o p p e r = A n o t h e r C r o p p e r ; r e t u r n   t h i s ; } ; } } ) ) ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / l i b / j Q u e r y . t r a n s f o . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ( f u n c t i o n ( $ ) { ' u s e   s t r i c t ' ; v a r   r a d = M a t h . P I / 1 8 0 ; v a r   m e t h o d s = { i n i t : f u n c t i o n ( s e t t i n g s ) { r e t u r n   t h i s . e a c h ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) , t r a n s f o = $ t h i s . d a t a ( ' t r a n s f o ' ) ; i f ( ! t r a n s f o ) { _ i n i t ( $ t h i s , s e t t i n g s ) ; } e l s e { _ o v e r w r i t e O p t i o n s ( $ t h i s , t r a n s f o , s e t t i n g s ) ; _ t a r g e t C s s ( $ t h i s , t r a n s f o ) ; } } ) ; } , d e s t r o y : f u n c t i o n ( ) { r e t u r n   t h i s . e a c h ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) ; i f ( $ t h i s . d a t a ( ' t r a n s f o ' ) ) { _ d e s t r o y ( $ t h i s ) ; } } ) ; } , r e s e t : f u n c t i o n ( ) { r e t u r n   t h i s . e a c h ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) ; i f ( $ t h i s . d a t a ( ' t r a n s f o ' ) ) { _ r e s e t ( $ t h i s ) ; } } ) ; } , t o g g l e : f u n c t i o n ( ) { r e t u r n   t h i s . e a c h ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) ; v a r   t r a n s f o = $ t h i s . d a t a ( ' t r a n s f o ' ) ; i f ( t r a n s f o ) { t r a n s f o . s e t t i n g s . h i d e = ! t r a n s f o . s e t t i n g s . h i d e ; _ s h o w H i d e ( $ t h i s , t r a n s f o ) ; } } ) ; } , h i d e : f u n c t i o n ( ) { r e t u r n   t h i s . e a c h ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) ; v a r   t r a n s f o = $ t h i s . d a t a ( ' t r a n s f o ' ) ; i f ( t r a n s f o ) { t r a n s f o . s e t t i n g s . h i d e = t r u e ; _ s h o w H i d e ( $ t h i s , t r a n s f o ) ; } } ) ; } , s h o w : f u n c t i o n ( ) { r e t u r n   t h i s . e a c h ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) ; v a r   t r a n s f o = $ t h i s . d a t a ( ' t r a n s f o ' ) ; i f ( t r a n s f o ) { t r a n s f o . s e t t i n g s . h i d e = f a l s e ; _ s h o w H i d e ( $ t h i s , t r a n s f o ) ; } } ) ; } , s e t t i n g s : f u n c t i o n ( ) { i f ( t h i s . l e n g t h > 1 ) { t h i s . m a p ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) ; r e t u r n   $ t h i s . d a t a ( ' t r a n s f o ' ) & & $ t h i s . d a t a ( ' t r a n s f o ' ) . s e t t i n g s ; } ) ; } 
 r e t u r n   t h i s . d a t a ( ' t r a n s f o ' ) & & $ t h i s . d a t a ( ' t r a n s f o ' ) . s e t t i n g s ; } , c e n t e r : f u n c t i o n ( ) { i f ( t h i s . l e n g t h > 1 ) { t h i s . m a p ( f u n c t i o n ( ) { v a r   $ t h i s = $ ( t h i s ) ; r e t u r n   $ t h i s . d a t a ( ' t r a n s f o ' ) & & $ t h i s . d a t a ( ' t r a n s f o ' ) . $ c e n t e r . o f f s e t ( ) ; } ) ; } 
 r e t u r n   t h i s . d a t a ( ' t r a n s f o ' ) & & t h i s . d a t a ( ' t r a n s f o ' ) . $ c e n t e r . o f f s e t ( ) ; } } ; $ . f n . t r a n s f o = f u n c t i o n ( m e t h o d ) { i f ( m e t h o d s [ m e t h o d ] ) { r e t u r n   m e t h o d s [ m e t h o d ] . a p p l y ( t h i s , A r r a y . p r o t o t y p e . s l i c e . c a l l ( a r g u m e n t s , 1 ) ) ; } e l s e   i f ( t y p e o f   m e t h o d = = = ' o b j e c t ' | | ! m e t h o d ) { r e t u r n   m e t h o d s . i n i t . a p p l y ( t h i s , a r g u m e n t s ) ; } e l s e { $ . e r r o r ( ' M e t h o d   ' + m e t h o d + '   d o e s   n o t   e x i s t   o n   j Q u e r y . t r a n s f o ' ) ; } 
 r e t u r n   f a l s e ; } ; f u n c t i o n   _ i n i t ( $ t h i s , s e t t i n g s ) { v a r   t r a n s f o = { } ; $ t h i s . d a t a ( ' t r a n s f o ' , t r a n s f o ) ; t r a n s f o . s e t t i n g s = s e t t i n g s ; v a r   c s s = " b o x - s i z i n g :   b o r d e r - b o x ;   p o s i t i o n :   a b s o l u t e ;   b a c k g r o u n d - c o l o r :   # f f f ;   b o r d e r :   1 p x   s o l i d   # c c c ;   w i d t h :   8 p x ;   h e i g h t :   8 p x ;   m a r g i n - l e f t :   - 4 p x ;   m a r g i n - t o p :   - 4 p x ; " ; t r a n s f o . $ m a r k u p = $ ( ' ' 
 + ' < d i v   c l a s s = " t r a n s f o - c o n t a i n e r " > ' 
 + ' < d i v   c l a s s = " t r a n s f o - c o n t r o l s " > ' 
 + ' < d i v   s t y l e = " c u r s o r :   c r o s s h a i r ;   p o s i t i o n :   a b s o l u t e ;   m a r g i n :   - 3 0 p x ;   t o p :   0 ;   r i g h t :   0 ;   p a d d i n g :   1 p x   0   0   1 p x ; "   c l a s s = " t r a n s f o - r o t a t o r " > ' 
 + ' < s p a n   c l a s s = " f a - s t a c k   f a - l g " > ' 
 + ' < i   c l a s s = " f a   f a - c i r c l e   f a - s t a c k - 2 x " > < / i > ' 
 + ' < i   c l a s s = " f a   f a - r e p e a t   f a - s t a c k - 1 x   f a - i n v e r s e " > < / i > ' 
 + ' < / s p a n > ' 
 + ' < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   0 % ;   l e f t :   0 % ;   c u r s o r :   n w - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - t l " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   0 % ;   l e f t :   1 0 0 % ;   c u r s o r :   n e - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - t r " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   1 0 0 % ;   l e f t :   1 0 0 % ;   c u r s o r :   s e - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - b r " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   1 0 0 % ;   l e f t :   0 % ;   c u r s o r :   s w - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - b l " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   0 % ;   l e f t :   5 0 % ;   c u r s o r :   n - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - t c " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   1 0 0 % ;   l e f t :   5 0 % ;   c u r s o r :   s - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - b c " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   5 0 % ;   l e f t :   0 % ;   c u r s o r :   w - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - m l " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' t o p :   5 0 % ;   l e f t :   1 0 0 % ;   c u r s o r :   e - r e s i z e ; "   c l a s s = " t r a n s f o - s c a l e r - m r " > < / d i v > ' 
 + ' < d i v   s t y l e = " ' + c s s + ' b o r d e r :   0 ;   w i d t h :   0 p x ;   h e i g h t :   0 p x ;   t o p :   5 0 % ;   l e f t :   5 0 % ; "   c l a s s = " t r a n s f o - s c a l e r - m c " > < / d i v > ' 
 + ' < / d i v > ' 
 + ' < / d i v > ' ) ; t r a n s f o . $ c e n t e r = t r a n s f o . $ m a r k u p . f i n d ( " . t r a n s f o - s c a l e r - m c " ) ; _ s e t O p t i o n s ( $ t h i s , t r a n s f o ) ; _ o v e r w r i t e O p t i o n s ( $ t h i s , t r a n s f o , s e t t i n g s ) ; $ ( " b o d y " ) . a p p e n d ( t r a n s f o . $ m a r k u p ) ; s e t T i m e o u t ( f u n c t i o n ( ) { _ t a r g e t C s s ( $ t h i s , t r a n s f o ) ; } , 0 ) ; _ b i n d ( $ t h i s , t r a n s f o ) ; _ t a r g e t C s s ( $ t h i s , t r a n s f o ) ; _ s t o p _ a n i m a t i o n ( $ t h i s [ 0 ] ) ; } 
 f u n c t i o n   _ o v e r w r i t e O p t i o n s ( $ t h i s , t r a n s f o , s e t t i n g s ) { t r a n s f o . s e t t i n g s = $ . e x t e n d ( t r a n s f o . s e t t i n g s , s e t t i n g s | | { } ) ; } 
 f u n c t i o n   _ s t o p _ a n i m a t i o n ( t a r g e t ) { t a r g e t . s t y l e . w e b k i t A n i m a t i o n P l a y S t a t e = " p a u s e d " ; t a r g e t . s t y l e . a n i m a t i o n P l a y S t a t e = " p a u s e d " ; t a r g e t . s t y l e . w e b k i t T r a n s i t i o n = " n o n e " ; t a r g e t . s t y l e . t r a n s i t i o n = " n o n e " ; } 
 f u n c t i o n   _ s e t O p t i o n s ( $ t h i s , t r a n s f o ) { v a r   s t y l e = $ t h i s . a t t r ( " s t y l e " ) | | " " ; v a r   t r a n s f o r m = s t y l e . m a t c h ( / t r a n s f o r m \ s * : ( [ ^ ; ] + ) / ) ? s t y l e . m a t c h ( / t r a n s f o r m \ s * : ( [ ^ ; ] + ) / ) [ 1 ] : " " ; t r a n s f o . s e t t i n g s = { } ; t r a n s f o . s e t t i n g s . a n g l e = t r a n s f o r m . i n d e x O f ( ' r o t a t e ' ) ! = - 1 ? p a r s e F l o a t ( t r a n s f o r m . m a t c h ( / r o t a t e \ ( ( [ ^ ) ] + ) d e g \ ) / ) [ 1 ] ) : 0 ; t r a n s f o . s e t t i n g s . s c a l e x = t r a n s f o r m . i n d e x O f ( ' s c a l e X ' ) ! = - 1 ? p a r s e F l o a t ( t r a n s f o r m . m a t c h ( / s c a l e X \ ( ( [ ^ ) ] + ) \ ) / ) [ 1 ] ) : 1 ; t r a n s f o . s e t t i n g s . s c a l e y = t r a n s f o r m . i n d e x O f ( ' s c a l e Y ' ) ! = - 1 ? p a r s e F l o a t ( t r a n s f o r m . m a t c h ( / s c a l e Y \ ( ( [ ^ ) ] + ) \ ) / ) [ 1 ] ) : 1 ; t r a n s f o . s e t t i n g s . s t y l e = s t y l e . r e p l a c e ( / [ ^ ; ] * t r a n s f o r m [ ^ ; ] + / g , ' ' ) . r e p l a c e ( / ; + / g , ' ; ' ) ; $ t h i s . a t t r ( " s t y l e " , t r a n s f o . s e t t i n g s . s t y l e ) ; _ s t o p _ a n i m a t i o n ( $ t h i s [ 0 ] ) ; t r a n s f o . s e t t i n g s . p o s = $ t h i s . o f f s e t ( ) ; t r a n s f o . s e t t i n g s . h e i g h t = $ t h i s . i n n e r H e i g h t ( ) ; t r a n s f o . s e t t i n g s . w i d t h = $ t h i s . i n n e r W i d t h ( ) ; v a r   t r a n s l a t e x = t r a n s f o r m . m a t c h ( / t r a n s l a t e X \ ( ( [ 0 - 9 . - ] + ) ( % | p x ) \ ) / ) ; v a r   t r a n s l a t e y = t r a n s f o r m . m a t c h ( / t r a n s l a t e Y \ ( ( [ 0 - 9 . - ] + ) ( % | p x ) \ ) / ) ; t r a n s f o . s e t t i n g s . t r a n s l a t e = " % " ; i f ( t r a n s l a t e x & & t r a n s l a t e x [ 2 ] = = = " % " ) { t r a n s f o . s e t t i n g s . t r a n s l a t e x p = p a r s e F l o a t ( t r a n s l a t e x [ 1 ] ) ; t r a n s f o . s e t t i n g s . t r a n s l a t e x = t r a n s f o . s e t t i n g s . t r a n s l a t e x p / 1 0 0 * t r a n s f o . s e t t i n g s . w i d t h ; } e l s e { t r a n s f o . s e t t i n g s . t r a n s l a t e x = t r a n s l a t e x ? p a r s e F l o a t ( t r a n s l a t e x [ 1 ] ) : 0 ; } 
 i f ( t r a n s l a t e y & & t r a n s l a t e y [ 2 ] = = = " % " ) { t r a n s f o . s e t t i n g s . t r a n s l a t e y p = p a r s e F l o a t ( t r a n s l a t e y [ 1 ] ) ; t r a n s f o . s e t t i n g s . t r a n s l a t e y = t r a n s f o . s e t t i n g s . t r a n s l a t e y p / 1 0 0 * t r a n s f o . s e t t i n g s . h e i g h t ; } e l s e { t r a n s f o . s e t t i n g s . t r a n s l a t e y = t r a n s l a t e y ? p a r s e F l o a t ( t r a n s l a t e y [ 1 ] ) : 0 ; } 
 t r a n s f o . s e t t i n g s . c s s = w i n d o w . g e t C o m p u t e d S t y l e ( $ t h i s [ 0 ] , n u l l ) ; t r a n s f o . s e t t i n g s . r o t a t i o n S t e p = 5 ; t r a n s f o . s e t t i n g s . h i d e = f a l s e ; t r a n s f o . s e t t i n g s . c a l l b a c k = f u n c t i o n ( ) { } ; } 
 f u n c t i o n   _ b i n d ( $ t h i s , t r a n s f o ) { f u n c t i o n   m o u s e d o w n ( e v e n t ) { _ m o u s e D o w n ( $ t h i s , t h i s , t r a n s f o , e v e n t ) ; $ ( d o c u m e n t ) . o n ( " m o u s e m o v e " , m o u s e m o v e ) . o n ( " m o u s e u p " , m o u s e u p ) ; } 
 f u n c t i o n   m o u s e m o v e ( e v e n t ) { _ m o u s e M o v e ( $ t h i s , t h i s , t r a n s f o , e v e n t ) ; } 
 f u n c t i o n   m o u s e u p ( e v e n t ) { _ m o u s e U p ( $ t h i s , t h i s , t r a n s f o , e v e n t ) ; $ ( d o c u m e n t ) . o f f ( " m o u s e m o v e " , m o u s e m o v e ) . o f f ( " m o u s e u p " , m o u s e u p ) ; } 
 t r a n s f o . $ m a r k u p . o f f ( ) . o n ( " m o u s e d o w n " , m o u s e d o w n ) ; t r a n s f o . $ m a r k u p . f i n d ( " . t r a n s f o - c o n t r o l s   > : n o t ( . t r a n s f o - s c a l e r - m c ) " ) . o f f ( ) . o n ( " m o u s e d o w n " , m o u s e d o w n ) ; } 
 f u n c t i o n   _ m o u s e D o w n ( $ t h i s , d i v , t r a n s f o , e v e n t ) { e v e n t . p r e v e n t D e f a u l t ( ) ; i f ( t r a n s f o . a c t i v e | | e v e n t . w h i c h ! = = 1 ) r e t u r n ; v a r   t y p e = " p o s i t i o n " , $ e = $ ( d i v ) ; i f ( $ e . h a s C l a s s ( " t r a n s f o - r o t a t o r " ) ) t y p e = " r o t a t o r " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - t l " ) ) t y p e = " t l " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - t r " ) ) t y p e = " t r " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - b r " ) ) t y p e = " b r " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - b l " ) ) t y p e = " b l " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - t c " ) ) t y p e = " t c " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - b c " ) ) t y p e = " b c " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - m l " ) ) t y p e = " m l " ; e l s e   i f ( $ e . h a s C l a s s ( " t r a n s f o - s c a l e r - m r " ) ) t y p e = " m r " ; t r a n s f o . a c t i v e = { " t y p e " : t y p e , " s c a l e x " : t r a n s f o . s e t t i n g s . s c a l e x , " s c a l e y " : t r a n s f o . s e t t i n g s . s c a l e y , " p a g e X " : e v e n t . p a g e X , " p a g e Y " : e v e n t . p a g e Y , " c e n t e r " : t r a n s f o . $ c e n t e r . o f f s e t ( ) , } ; } 
 f u n c t i o n   _ m o u s e U p ( $ t h i s , d i v , t r a n s f o , e v e n t ) { t r a n s f o . a c t i v e = n u l l ; } 
 f u n c t i o n   _ m o u s e M o v e ( $ t h i s , d i v , t r a n s f o , e v e n t ) { e v e n t . p r e v e n t D e f a u l t ( ) ; i f ( ! t r a n s f o . a c t i v e ) r e t u r n ; v a r   s e t t i n g s = t r a n s f o . s e t t i n g s ; v a r   c e n t e r = t r a n s f o . a c t i v e . c e n t e r ; v a r   c d x = c e n t e r . l e f t - e v e n t . p a g e X ; v a r   c d y = c e n t e r . t o p - e v e n t . p a g e Y ; i f ( t r a n s f o . a c t i v e . t y p e = = " r o t a t o r " ) { v a r   a n g , d a n g = M a t h . a t a n ( ( s e t t i n g s . w i d t h * s e t t i n g s . s c a l e x ) / ( s e t t i n g s . h e i g h t * s e t t i n g s . s c a l e y ) ) / r a d ; i f ( c d y ) a n g = M a t h . a t a n ( - c d x / c d y ) / r a d ; e l s e   a n g = 0 ; i f ( e v e n t . p a g e Y > = c e n t e r . t o p & & e v e n t . p a g e X > = c e n t e r . l e f t ) a n g + = 1 8 0 ; e l s e   i f ( e v e n t . p a g e Y > = c e n t e r . t o p & & e v e n t . p a g e X < c e n t e r . l e f t ) a n g + = 1 8 0 ; e l s e   i f ( e v e n t . p a g e Y < c e n t e r . t o p & & e v e n t . p a g e X < c e n t e r . l e f t ) a n g + = 3 6 0 ; a n g - = d a n g ; i f ( s e t t i n g s . s c a l e y < 0 & & s e t t i n g s . s c a l e x < 0 ) a n g + = 1 8 0 ; i f ( ! e v e n t . c t r l K e y ) { s e t t i n g s . a n g l e = M a t h . r o u n d ( a n g / t r a n s f o . s e t t i n g s . r o t a t i o n S t e p ) * t r a n s f o . s e t t i n g s . r o t a t i o n S t e p ; } e l s e { s e t t i n g s . a n g l e = a n g ; } 
 _ t a r g e t C s s ( $ t h i s , t r a n s f o ) ; v a r   n e w _ c e n t e r = t r a n s f o . $ c e n t e r . o f f s e t ( ) ; v a r   x = c e n t e r . l e f t - n e w _ c e n t e r . l e f t ; v a r   y = c e n t e r . t o p - n e w _ c e n t e r . t o p ; v a r   a n g l e = a n g * r a d ; s e t t i n g s . t r a n s l a t e x + = x * M a t h . c o s ( a n g l e ) - y * M a t h . s i n ( - a n g l e ) ; s e t t i n g s . t r a n s l a t e y + = - x * M a t h . s i n ( a n g l e ) + y * M a t h . c o s ( - a n g l e ) ; } 
 e l s e   i f ( t r a n s f o . a c t i v e . t y p e = = " p o s i t i o n " ) { v a r   a n g l e = s e t t i n g s . a n g l e * r a d ; v a r   x = e v e n t . p a g e X - t r a n s f o . a c t i v e . p a g e X ; v a r   y = e v e n t . p a g e Y - t r a n s f o . a c t i v e . p a g e Y ; t r a n s f o . a c t i v e . p a g e X = e v e n t . p a g e X ; t r a n s f o . a c t i v e . p a g e Y = e v e n t . p a g e Y ; v a r   d x = x * M a t h . c o s ( a n g l e ) - y * M a t h . s i n ( - a n g l e ) ; v a r   d y = - x * M a t h . s i n ( a n g l e ) + y * M a t h . c o s ( - a n g l e ) ; s e t t i n g s . t r a n s l a t e x + = d x ; s e t t i n g s . t r a n s l a t e y + = d y ; } 
 e l s e   i f ( t r a n s f o . a c t i v e . t y p e . l e n g t h = = = 2 ) { v a r   a n g l e = s e t t i n g s . a n g l e * r a d ; v a r   d x = c d x * M a t h . c o s ( a n g l e ) - c d y * M a t h . s i n ( - a n g l e ) ; v a r   d y = - c d x * M a t h . s i n ( a n g l e ) + c d y * M a t h . c o s ( - a n g l e ) ; i f ( t r a n s f o . a c t i v e . t y p e . i n d e x O f ( " t " ) ! = - 1 ) { s e t t i n g s . s c a l e y = d y / ( s e t t i n g s . h e i g h t / 2 ) ; } 
 i f ( t r a n s f o . a c t i v e . t y p e . i n d e x O f ( " b " ) ! = - 1 ) { s e t t i n g s . s c a l e y = - d y / ( s e t t i n g s . h e i g h t / 2 ) ; } 
 i f ( t r a n s f o . a c t i v e . t y p e . i n d e x O f ( " l " ) ! = - 1 ) { s e t t i n g s . s c a l e x = d x / ( s e t t i n g s . w i d t h / 2 ) ; } 
 i f ( t r a n s f o . a c t i v e . t y p e . i n d e x O f ( " r " ) ! = - 1 ) { s e t t i n g s . s c a l e x = - d x / ( s e t t i n g s . w i d t h / 2 ) ; } 
 i f ( s e t t i n g s . s c a l e y > 0 & & s e t t i n g s . s c a l e y < 0 . 0 5 ) s e t t i n g s . s c a l e y = 0 . 0 5 ; i f ( s e t t i n g s . s c a l e x > 0 & & s e t t i n g s . s c a l e x < 0 . 0 5 ) s e t t i n g s . s c a l e x = 0 . 0 5 ; i f ( s e t t i n g s . s c a l e y < 0 & & s e t t i n g s . s c a l e y > - 0 . 0 5 ) s e t t i n g s . s c a l e y = - 0 . 0 5 ; i f ( s e t t i n g s . s c a l e x < 0 & & s e t t i n g s . s c a l e x > - 0 . 0 5 ) s e t t i n g s . s c a l e x = - 0 . 0 5 ; i f ( e v e n t . s h i f t K e y & & ( t r a n s f o . a c t i v e . t y p e = = = " t l " | | t r a n s f o . a c t i v e . t y p e = = = " b l " | | t r a n s f o . a c t i v e . t y p e = = = " t r " | | t r a n s f o . a c t i v e . t y p e = = = " b r " ) ) { s e t t i n g s . s c a l e y = s e t t i n g s . s c a l e x ; } } 
 s e t t i n g s . a n g l e = M a t h . r o u n d ( s e t t i n g s . a n g l e ) ; s e t t i n g s . t r a n s l a t e x = M a t h . r o u n d ( s e t t i n g s . t r a n s l a t e x ) ; s e t t i n g s . t r a n s l a t e y = M a t h . r o u n d ( s e t t i n g s . t r a n s l a t e y ) ; s e t t i n g s . s c a l e x = M a t h . r o u n d ( s e t t i n g s . s c a l e x * 1 0 0 ) / 1 0 0 ; s e t t i n g s . s c a l e y = M a t h . r o u n d ( s e t t i n g s . s c a l e y * 1 0 0 ) / 1 0 0 ; _ t a r g e t C s s ( $ t h i s , t r a n s f o ) ; _ s t o p _ a n i m a t i o n ( $ t h i s [ 0 ] ) ; r e t u r n   f a l s e ; } 
 f u n c t i o n   _ s e t C s s ( $ t h i s , c s s , s e t t i n g s ) { v a r   t r a n s f o r m = " " ; v a r   t r a n s = f a l s e ; i f ( s e t t i n g s . a n g l e ! = = 0 ) { t r a n s = t r u e ; t r a n s f o r m + = "   r o t a t e ( " + s e t t i n g s . a n g l e + " d e g )   " ; } 
 i f ( s e t t i n g s . t r a n s l a t e x ) { t r a n s = t r u e ; t r a n s f o r m + = "   t r a n s l a t e X ( " + ( s e t t i n g s . t r a n s l a t e = = = " % " ? s e t t i n g s . t r a n s l a t e x p + " % " : s e t t i n g s . t r a n s l a t e x + " p x " ) + " )   " ; } 
 i f ( s e t t i n g s . t r a n s l a t e y ) { t r a n s = t r u e ; t r a n s f o r m + = "   t r a n s l a t e Y ( " + ( s e t t i n g s . t r a n s l a t e = = = " % " ? s e t t i n g s . t r a n s l a t e y p + " % " : s e t t i n g s . t r a n s l a t e y + " p x " ) + " )   " ; } 
 i f ( s e t t i n g s . s c a l e x ! = 1 ) { t r a n s = t r u e ; t r a n s f o r m + = "   s c a l e X ( " + s e t t i n g s . s c a l e x + " )   " ; } 
 i f ( s e t t i n g s . s c a l e y ! = 1 ) { t r a n s = t r u e ; t r a n s f o r m + = "   s c a l e Y ( " + s e t t i n g s . s c a l e y + " )   " ; } 
 i f ( t r a n s ) { c s s + = " ; " 
 c s s + = " - w e b k i t - t r a n s f o r m : " + t r a n s f o r m + " ; " 
 + " - m o z - t r a n s f o r m : " + t r a n s f o r m + " ; " 
 + " - m s - t r a n s f o r m : " + t r a n s f o r m + " ; " 
 + " - o - t r a n s f o r m : " + t r a n s f o r m + " ; " 
 + " t r a n s f o r m : " + t r a n s f o r m + " ; " ; } 
 c s s = c s s . r e p l a c e ( / ( \ s * ; ) + / g , ' ; ' ) . r e p l a c e ( / ^ \ s * ; | ; \ s * $ / g , ' ' ) ; $ t h i s . a t t r ( " s t y l e " , c s s ) ; } 
 f u n c t i o n   _ t a r g e t C s s ( $ t h i s , t r a n s f o ) { v a r   s e t t i n g s = t r a n s f o . s e t t i n g s ; v a r   w i d t h = p a r s e F l o a t ( s e t t i n g s . c s s . w i d t h ) ; v a r   h e i g h t = p a r s e F l o a t ( s e t t i n g s . c s s . h e i g h t ) ; s e t t i n g s . t r a n s l a t e x p = M a t h . r o u n d ( s e t t i n g s . t r a n s l a t e x / w i d t h * 1 0 0 0 ) / 1 0 ; s e t t i n g s . t r a n s l a t e y p = M a t h . r o u n d ( s e t t i n g s . t r a n s l a t e y / h e i g h t * 1 0 0 0 ) / 1 0 ; _ s e t C s s ( $ t h i s , s e t t i n g s . s t y l e , s e t t i n g s ) ; t r a n s f o . $ m a r k u p . c s s ( { " p o s i t i o n " : " a b s o l u t e " , " w i d t h " : w i d t h + " p x " , " h e i g h t " : h e i g h t + " p x " , " t o p " : s e t t i n g s . p o s . t o p + " p x " , " l e f t " : s e t t i n g s . p o s . l e f t + " p x " } ) ; v a r   $ c o n t r o l s = t r a n s f o . $ m a r k u p . f i n d ( ' . t r a n s f o - c o n t r o l s ' ) ; _ s e t C s s ( $ c o n t r o l s , " w i d t h : " + w i d t h + " p x ; " + " h e i g h t : " + h e i g h t + " p x ; " + " c u r s o r :   m o v e ; " , s e t t i n g s ) ; $ c o n t r o l s . c h i l d r e n ( ) . c s s ( " t r a n s f o r m " , " s c a l e X ( " + ( 1 / s e t t i n g s . s c a l e x ) + " )   s c a l e Y ( " + ( 1 / s e t t i n g s . s c a l e y ) + " ) " ) ; _ s h o w H i d e ( $ t h i s , t r a n s f o ) ; t r a n s f o . s e t t i n g s . c a l l b a c k . c a l l ( $ t h i s [ 0 ] , $ t h i s ) ; } 
 f u n c t i o n   _ s h o w H i d e ( $ t h i s , t r a n s f o ) { t r a n s f o . $ m a r k u p . c s s ( " z - i n d e x " , t r a n s f o . s e t t i n g s . h i d e ? - 1 : 1 0 0 0 ) ; i f ( t r a n s f o . s e t t i n g s . h i d e ) { t r a n s f o . $ m a r k u p . f i n d ( " . t r a n s f o - c o n t r o l s   >   * " ) . h i d e ( ) ; t r a n s f o . $ m a r k u p . f i n d ( " . t r a n s f o - s c a l e r - m c " ) . s h o w ( ) ; } e l s e { t r a n s f o . $ m a r k u p . f i n d ( " . t r a n s f o - c o n t r o l s   >   * " ) . s h o w ( ) ; } } 
 f u n c t i o n   _ d e s t r o y ( $ t h i s ) { $ t h i s . d a t a ( ' t r a n s f o ' ) . $ m a r k u p . r e m o v e ( ) ; $ t h i s . r e m o v e D a t a ( ' t r a n s f o ' ) ; } 
 f u n c t i o n   _ r e s e t ( $ t h i s ) { v a r   t r a n s f o = $ t h i s . d a t a ( ' t r a n s f o ' ) ; _ d e s t r o y ( $ t h i s ) ; $ t h i s . t r a n s f o ( t r a n s f o . s e t t i n g s ) ; } } ) ( j Q u e r y ) ; ; 
 
 / *   / w e b / s t a t i c / l i b / n e a r e s t / j q u e r y . n e a r e s t . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ; ( f u n c t i o n ( $ , u n d e f i n e d ) { v a r   r P e r c = / ^ ( [ \ d . ] + ) % $ / ; f u n c t i o n   n e a r e s t ( s e l e c t o r , o p t i o n s , t h i s O b j ) { s e l e c t o r | | ( s e l e c t o r = ' d i v ' ) ; v a r   $ c o n t a i n e r = $ ( o p t i o n s . c o n t a i n e r ) , c o n t a i n e r O f f s e t = $ c o n t a i n e r . o f f s e t ( ) | | { l e f t : 0 , t o p : 0 } , c o n t a i n e r D i m s = [ c o n t a i n e r O f f s e t . l e f t + $ c o n t a i n e r . w i d t h ( ) , c o n t a i n e r O f f s e t . t o p + $ c o n t a i n e r . h e i g h t ( ) ] , p e r c P r o p s = { x : 0 , y : 1 , w : 0 , h : 1 } , p r o p , m a t c h ; f o r ( p r o p   i n   p e r c P r o p s ) i f ( p e r c P r o p s . h a s O w n P r o p e r t y ( p r o p ) ) { m a t c h = r P e r c . e x e c ( o p t i o n s [ p r o p ] ) ; i f ( m a t c h ) { o p t i o n s [ p r o p ] = c o n t a i n e r D i m s [ p e r c P r o p s [ p r o p ] ] * m a t c h [ 1 ] / 1 0 0 ; } } 
 v a r   $ a l l = $ ( s e l e c t o r ) , c a c h e = [ ] , f u r t h e s t = ! ! o p t i o n s . f u r t h e s t , c h e c k X = ! ! o p t i o n s . c h e c k H o r i z , c h e c k Y = ! ! o p t i o n s . c h e c k V e r t , c o m p D i s t = f u r t h e s t ? 0 : I n f i n i t y , p o i n t 1 x = p a r s e F l o a t ( o p t i o n s . x ) | | 0 , p o i n t 1 y = p a r s e F l o a t ( o p t i o n s . y ) | | 0 , p o i n t 2 x = p a r s e F l o a t ( p o i n t 1 x + o p t i o n s . w ) | | p o i n t 1 x , p o i n t 2 y = p a r s e F l o a t ( p o i n t 1 y + o p t i o n s . h ) | | p o i n t 1 y , t o l e r a n c e = o p t i o n s . t o l e r a n c e | | 0 , h a s E a c h 2 = ! ! $ . f n . e a c h 2 , m i n = M a t h . m i n , m a x = M a t h . m a x ; i f ( ! o p t i o n s . i n c l u d e S e l f & & t h i s O b j ) { $ a l l = $ a l l . n o t ( t h i s O b j ) ; } 
 i f ( t o l e r a n c e < 0 ) { t o l e r a n c e = 0 ; } 
 $ a l l [ h a s E a c h 2 ? ' e a c h 2 ' : ' e a c h ' ] ( f u n c t i o n ( i , e l e m ) { v a r   $ t h i s = h a s E a c h 2 ? e l e m : $ ( t h i s ) , o f f = $ t h i s . o f f s e t ( ) , x = o f f . l e f t , y = o f f . t o p , w = $ t h i s . o u t e r W i d t h ( ) , h = $ t h i s . o u t e r H e i g h t ( ) , x 2 = x + w , y 2 = y + h , m a x X 1 = m a x ( x , p o i n t 1 x ) , m i n X 2 = m i n ( x 2 , p o i n t 2 x ) , m a x Y 1 = m a x ( y , p o i n t 1 y ) , m i n Y 2 = m i n ( y 2 , p o i n t 2 y ) , i n t e r s e c t X = m i n X 2 > = m a x X 1 , i n t e r s e c t Y = m i n Y 2 > = m a x Y 1 , d i s t X , d i s t Y , d i s t T , i s V a l i d ; i f ( ( c h e c k X & & c h e c k Y ) | | ( ! c h e c k X & & ! c h e c k Y & & i n t e r s e c t X & & i n t e r s e c t Y ) | | ( c h e c k X & & i n t e r s e c t Y ) | | ( c h e c k Y & & i n t e r s e c t X ) ) { d i s t X = i n t e r s e c t X ? 0 : m a x X 1 - m i n X 2 ; d i s t Y = i n t e r s e c t Y ? 0 : m a x Y 1 - m i n Y 2 ; d i s t T = i n t e r s e c t X | | i n t e r s e c t Y ? m a x ( d i s t X , d i s t Y ) : M a t h . s q r t ( d i s t X * d i s t X + d i s t Y * d i s t Y ) ; i s V a l i d = f u r t h e s t ? d i s t T > = c o m p D i s t - t o l e r a n c e : d i s t T < = c o m p D i s t + t o l e r a n c e ; i f ( i s V a l i d ) { c o m p D i s t = f u r t h e s t ? m a x ( c o m p D i s t , d i s t T ) : m i n ( c o m p D i s t , d i s t T ) ; c a c h e . p u s h ( { n o d e : t h i s , d i s t : d i s t T } ) ; } } } ) ; v a r   l e n = c a c h e . l e n g t h , f i l t e r e d = [ ] , c o m p M i n , c o m p M a x , i , i t e m ; i f ( l e n ) { i f ( f u r t h e s t ) { c o m p M i n = c o m p D i s t - t o l e r a n c e ; c o m p M a x = c o m p D i s t ; } e l s e { c o m p M i n = c o m p D i s t ; c o m p M a x = c o m p D i s t + t o l e r a n c e ; } 
 f o r ( i = 0 ; i < l e n ; i + + ) { i t e m = c a c h e [ i ] ; i f ( i t e m . d i s t > = c o m p M i n & & i t e m . d i s t < = c o m p M a x ) { f i l t e r e d . p u s h ( i t e m . n o d e ) ; } } } 
 r e t u r n   f i l t e r e d ; } 
 $ . e a c h ( [ ' n e a r e s t ' , ' f u r t h e s t ' , ' t o u c h i n g ' ] , f u n c t i o n ( i , n a m e ) { v a r   d e f a u l t s = { x : 0 , y : 0 , w : 0 , h : 0 , t o l e r a n c e : 1 , c o n t a i n e r : d o c u m e n t , f u r t h e s t : n a m e = = ' f u r t h e s t ' , i n c l u d e S e l f : f a l s e , c h e c k H o r i z : n a m e ! = ' t o u c h i n g ' , c h e c k V e r t : n a m e ! = ' t o u c h i n g ' } ; $ [ n a m e ] = f u n c t i o n ( p o i n t , s e l e c t o r , o p t i o n s ) { i f ( ! p o i n t | | p o i n t . x = = = u n d e f i n e d | | p o i n t . y = = = u n d e f i n e d ) { r e t u r n   $ ( [ ] ) ; } 
 v a r   o p t s = $ . e x t e n d ( { } , d e f a u l t s , p o i n t , o p t i o n s | | { } ) ; r e t u r n   $ ( n e a r e s t ( s e l e c t o r , o p t s ) ) ; } ; $ . f n [ n a m e ] = f u n c t i o n ( s e l e c t o r , o p t i o n s ) { v a r   o p t s ; i f ( s e l e c t o r & & $ . i s P l a i n O b j e c t ( s e l e c t o r ) ) { o p t s = $ . e x t e n d ( { } , d e f a u l t s , s e l e c t o r , o p t i o n s | | { } ) ; r e t u r n   t h i s . p u s h S t a c k ( n e a r e s t ( t h i s , o p t s ) ) ; } 
 v a r   o f f s e t = t h i s . o f f s e t ( ) , d i m e n s i o n s = { x : o f f s e t . l e f t , y : o f f s e t . t o p , w : t h i s . o u t e r W i d t h ( ) , h : t h i s . o u t e r H e i g h t ( ) } ; o p t s = $ . e x t e n d ( { } , d e f a u l t s , d i m e n s i o n s , o p t i o n s | | { } ) ; r e t u r n   t h i s . p u s h S t a c k ( n e a r e s t ( s e l e c t o r , o p t s , t h i s ) ) ; } ; } ) ; } ) ( j Q u e r y ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / l i b / w e b g l - i m a g e - f i l t e r / w e b g l - i m a g e - f i l t e r . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ( f u n c t i o n ( w i n d o w ) { v a r   W e b G L P r o g r a m = f u n c t i o n ( g l , v e r t e x S o u r c e , f r a g m e n t S o u r c e ) { v a r   _ c o l l e c t = f u n c t i o n ( s o u r c e , p r e f i x , c o l l e c t i o n ) { v a r   r = n e w   R e g E x p ( ' \ \ b ' + p r e f i x + '   \ \ w +   ( \ \ w + ) ' , ' i g ' ) ; s o u r c e . r e p l a c e ( r , f u n c t i o n ( m a t c h , n a m e ) { c o l l e c t i o n [ n a m e ] = 0 ; r e t u r n   m a t c h ; } ) ; } ; v a r   _ c o m p i l e = f u n c t i o n ( g l , s o u r c e , t y p e ) { v a r   s h a d e r = g l . c r e a t e S h a d e r ( t y p e ) ; g l . s h a d e r S o u r c e ( s h a d e r , s o u r c e ) ; g l . c o m p i l e S h a d e r ( s h a d e r ) ; i f ( ! g l . g e t S h a d e r P a r a m e t e r ( s h a d e r , g l . C O M P I L E _ S T A T U S ) ) { c o n s o l e . l o g ( g l . g e t S h a d e r I n f o L o g ( s h a d e r ) ) ; r e t u r n   n u l l ; } 
 r e t u r n   s h a d e r ; } ; t h i s . u n i f o r m = { } ; t h i s . a t t r i b u t e = { } ; v a r   _ v s h = _ c o m p i l e ( g l , v e r t e x S o u r c e , g l . V E R T E X _ S H A D E R ) ; v a r   _ f s h = _ c o m p i l e ( g l , f r a g m e n t S o u r c e , g l . F R A G M E N T _ S H A D E R ) ; t h i s . i d = g l . c r e a t e P r o g r a m ( ) ; g l . a t t a c h S h a d e r ( t h i s . i d , _ v s h ) ; g l . a t t a c h S h a d e r ( t h i s . i d , _ f s h ) ; g l . l i n k P r o g r a m ( t h i s . i d ) ; i f ( ! g l . g e t P r o g r a m P a r a m e t e r ( t h i s . i d , g l . L I N K _ S T A T U S ) ) { c o n s o l e . l o g ( g l . g e t P r o g r a m I n f o L o g ( t h i s . i d ) ) ; } 
 g l . u s e P r o g r a m ( t h i s . i d ) ; _ c o l l e c t ( v e r t e x S o u r c e , ' a t t r i b u t e ' , t h i s . a t t r i b u t e ) ; f o r ( v a r   a   i n   t h i s . a t t r i b u t e ) { t h i s . a t t r i b u t e [ a ] = g l . g e t A t t r i b L o c a t i o n ( t h i s . i d , a ) ; } 
 _ c o l l e c t ( v e r t e x S o u r c e , ' u n i f o r m ' , t h i s . u n i f o r m ) ; _ c o l l e c t ( f r a g m e n t S o u r c e , ' u n i f o r m ' , t h i s . u n i f o r m ) ; f o r ( v a r   u   i n   t h i s . u n i f o r m ) { t h i s . u n i f o r m [ u ] = g l . g e t U n i f o r m L o c a t i o n ( t h i s . i d , u ) ; } } ; c o n s t   i d e n t i t y M a t r i x = [ 1 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , ] ; c o n s t   w e i g h t e d A v g = ( a , b , w ) = > a * w + b * ( 1 - w ) ; v a r   W e b G L I m a g e F i l t e r = w i n d o w . W e b G L I m a g e F i l t e r = f u n c t i o n ( p a r a m s ) { i f ( ! p a r a m s ) 
 p a r a m s = { } ; v a r 
 g l = n u l l , _ d r a w C o u n t = 0 , _ s o u r c e T e x t u r e = n u l l , _ l a s t I n C h a i n = f a l s e , _ c u r r e n t F r a m e b u f f e r I n d e x = - 1 , _ t e m p F r a m e b u f f e r s = [ n u l l , n u l l ] , _ f i l t e r C h a i n = [ ] , _ w i d t h = - 1 , _ h e i g h t = - 1 , _ v e r t e x B u f f e r = n u l l , _ c u r r e n t P r o g r a m = n u l l , _ c a n v a s = p a r a m s . c a n v a s | | d o c u m e n t . c r e a t e E l e m e n t ( ' c a n v a s ' ) ; v a r   _ s h a d e r P r o g r a m C a c h e = { } ; v a r   g l = _ c a n v a s . g e t C o n t e x t ( " w e b g l " ) | | _ c a n v a s . g e t C o n t e x t ( " e x p e r i m e n t a l - w e b g l " ) ; i f ( ! g l ) { t h r o w " C o u l d n ' t   g e t   W e b G L   c o n t e x t " ; } 
 t h i s . a d d F i l t e r = f u n c t i o n ( n a m e ) { v a r   a r g s = A r r a y . p r o t o t y p e . s l i c e . c a l l ( a r g u m e n t s , 1 ) ; v a r   f i l t e r = _ f i l t e r [ n a m e ] ; _ f i l t e r C h a i n . p u s h ( { f u n c : f i l t e r , a r g s : a r g s } ) ; } ; t h i s . r e s e t = f u n c t i o n ( ) { _ f i l t e r C h a i n = [ ] ; } ; t h i s . a p p l y = f u n c t i o n ( i m a g e ) { _ r e s i z e ( i m a g e . w i d t h , i m a g e . h e i g h t ) ; _ d r a w C o u n t = 0 ; i f ( ! _ s o u r c e T e x t u r e ) 
 _ s o u r c e T e x t u r e = g l . c r e a t e T e x t u r e ( ) ; g l . b i n d T e x t u r e ( g l . T E X T U R E _ 2 D , _ s o u r c e T e x t u r e ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ W R A P _ S , g l . C L A M P _ T O _ E D G E ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ W R A P _ T , g l . C L A M P _ T O _ E D G E ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ M I N _ F I L T E R , g l . N E A R E S T ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ M A G _ F I L T E R , g l . N E A R E S T ) ; g l . t e x I m a g e 2 D ( g l . T E X T U R E _ 2 D , 0 , g l . R G B A , g l . R G B A , g l . U N S I G N E D _ B Y T E , i m a g e ) ; i f ( _ f i l t e r C h a i n . l e n g t h = = 0 ) { v a r   p r o g r a m = _ c o m p i l e S h a d e r ( S H A D E R . F R A G M E N T _ I D E N T I T Y ) ; _ d r a w ( ) ; r e t u r n   _ c a n v a s ; } 
 f o r ( v a r   i = 0 ; i < _ f i l t e r C h a i n . l e n g t h ; i + + ) { _ l a s t I n C h a i n = ( i = = _ f i l t e r C h a i n . l e n g t h - 1 ) ; v a r   f = _ f i l t e r C h a i n [ i ] ; f . f u n c . a p p l y ( t h i s , f . a r g s | | [ ] ) ; } 
 r e t u r n   _ c a n v a s ; } ; v a r   _ r e s i z e = f u n c t i o n ( w i d t h , h e i g h t ) { i f ( w i d t h = = _ w i d t h & & h e i g h t = = _ h e i g h t ) { r e t u r n ; } 
 _ c a n v a s . w i d t h = _ w i d t h = w i d t h ; _ c a n v a s . h e i g h t = _ h e i g h t = h e i g h t ; i f ( ! _ v e r t e x B u f f e r ) { v a r   v e r t i c e s = n e w   F l o a t 3 2 A r r a y ( [ - 1 , - 1 , 0 , 1 , 1 , - 1 , 1 , 1 , - 1 , 1 , 0 , 0 , - 1 , 1 , 0 , 0 , 1 , - 1 , 1 , 1 , 1 , 1 , 1 , 0 ] ) ; _ v e r t e x B u f f e r = g l . c r e a t e B u f f e r ( ) , g l . b i n d B u f f e r ( g l . A R R A Y _ B U F F E R , _ v e r t e x B u f f e r ) ; g l . b u f f e r D a t a ( g l . A R R A Y _ B U F F E R , v e r t i c e s , g l . S T A T I C _ D R A W ) ; g l . p i x e l S t o r e i ( g l . U N P A C K _ P R E M U L T I P L Y _ A L P H A _ W E B G L , t r u e ) ; } 
 g l . v i e w p o r t ( 0 , 0 , _ w i d t h , _ h e i g h t ) ; _ t e m p F r a m e b u f f e r s = [ n u l l , n u l l ] ; } ; v a r   _ g e t T e m p F r a m e b u f f e r = f u n c t i o n ( i n d e x ) { _ t e m p F r a m e b u f f e r s [ i n d e x ] = _ t e m p F r a m e b u f f e r s [ i n d e x ] | | _ c r e a t e F r a m e b u f f e r T e x t u r e ( _ w i d t h , _ h e i g h t ) ; r e t u r n   _ t e m p F r a m e b u f f e r s [ i n d e x ] ; } ; v a r   _ c r e a t e F r a m e b u f f e r T e x t u r e = f u n c t i o n ( w i d t h , h e i g h t ) { v a r   f b o = g l . c r e a t e F r a m e b u f f e r ( ) ; g l . b i n d F r a m e b u f f e r ( g l . F R A M E B U F F E R , f b o ) ; v a r   r e n d e r b u f f e r = g l . c r e a t e R e n d e r b u f f e r ( ) ; g l . b i n d R e n d e r b u f f e r ( g l . R E N D E R B U F F E R , r e n d e r b u f f e r ) ; v a r   t e x t u r e = g l . c r e a t e T e x t u r e ( ) ; g l . b i n d T e x t u r e ( g l . T E X T U R E _ 2 D , t e x t u r e ) ; g l . t e x I m a g e 2 D ( g l . T E X T U R E _ 2 D , 0 , g l . R G B A , w i d t h , h e i g h t , 0 , g l . R G B A , g l . U N S I G N E D _ B Y T E , n u l l ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ M A G _ F I L T E R , g l . L I N E A R ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ M I N _ F I L T E R , g l . L I N E A R ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ W R A P _ S , g l . C L A M P _ T O _ E D G E ) ; g l . t e x P a r a m e t e r i ( g l . T E X T U R E _ 2 D , g l . T E X T U R E _ W R A P _ T , g l . C L A M P _ T O _ E D G E ) ; g l . f r a m e b u f f e r T e x t u r e 2 D ( g l . F R A M E B U F F E R , g l . C O L O R _ A T T A C H M E N T 0 , g l . T E X T U R E _ 2 D , t e x t u r e , 0 ) ; g l . b i n d T e x t u r e ( g l . T E X T U R E _ 2 D , n u l l ) ; g l . b i n d F r a m e b u f f e r ( g l . F R A M E B U F F E R , n u l l ) ; r e t u r n { f b o : f b o , t e x t u r e : t e x t u r e } ; } ; v a r   _ d r a w = f u n c t i o n ( f l a g s ) { v a r   s o u r c e = n u l l , t a r g e t = n u l l , f l i p Y = f a l s e ; i f ( _ d r a w C o u n t = = 0 ) { s o u r c e = _ s o u r c e T e x t u r e ; } 
 e l s e { s o u r c e = _ g e t T e m p F r a m e b u f f e r ( _ c u r r e n t F r a m e b u f f e r I n d e x ) . t e x t u r e ; } 
 _ d r a w C o u n t + + ; i f ( _ l a s t I n C h a i n & & ! ( f l a g s & D R A W . I N T E R M E D I A T E ) ) { t a r g e t = n u l l ; f l i p Y = _ d r a w C o u n t % 2 = = 0 ; } 
 e l s e { _ c u r r e n t F r a m e b u f f e r I n d e x = ( _ c u r r e n t F r a m e b u f f e r I n d e x + 1 ) % 2 ; t a r g e t = _ g e t T e m p F r a m e b u f f e r ( _ c u r r e n t F r a m e b u f f e r I n d e x ) . f b o ; } 
 g l . b i n d T e x t u r e ( g l . T E X T U R E _ 2 D , s o u r c e ) ; g l . b i n d F r a m e b u f f e r ( g l . F R A M E B U F F E R , t a r g e t ) ; g l . u n i f o r m 1 f ( _ c u r r e n t P r o g r a m . u n i f o r m . f l i p Y , ( f l i p Y ? - 1 : 1 ) ) ; g l . d r a w A r r a y s ( g l . T R I A N G L E S , 0 , 6 ) ; } ; v a r   _ c o m p i l e S h a d e r = f u n c t i o n ( f r a g m e n t S o u r c e ) { i f ( _ s h a d e r P r o g r a m C a c h e [ f r a g m e n t S o u r c e ] ) { _ c u r r e n t P r o g r a m = _ s h a d e r P r o g r a m C a c h e [ f r a g m e n t S o u r c e ] ; g l . u s e P r o g r a m ( _ c u r r e n t P r o g r a m . i d ) ; r e t u r n   _ c u r r e n t P r o g r a m ; } 
 _ c u r r e n t P r o g r a m = n e w   W e b G L P r o g r a m ( g l , S H A D E R . V E R T E X _ I D E N T I T Y , f r a g m e n t S o u r c e ) ; v a r   f l o a t S i z e = F l o a t 3 2 A r r a y . B Y T E S _ P E R _ E L E M E N T ; v a r   v e r t S i z e = 4 * f l o a t S i z e ; g l . e n a b l e V e r t e x A t t r i b A r r a y ( _ c u r r e n t P r o g r a m . a t t r i b u t e . p o s ) ; g l . v e r t e x A t t r i b P o i n t e r ( _ c u r r e n t P r o g r a m . a t t r i b u t e . p o s , 2 , g l . F L O A T , f a l s e , v e r t S i z e , 0 * f l o a t S i z e ) ; g l . e n a b l e V e r t e x A t t r i b A r r a y ( _ c u r r e n t P r o g r a m . a t t r i b u t e . u v ) ; g l . v e r t e x A t t r i b P o i n t e r ( _ c u r r e n t P r o g r a m . a t t r i b u t e . u v , 2 , g l . F L O A T , f a l s e , v e r t S i z e , 2 * f l o a t S i z e ) ; _ s h a d e r P r o g r a m C a c h e [ f r a g m e n t S o u r c e ] = _ c u r r e n t P r o g r a m ; r e t u r n   _ c u r r e n t P r o g r a m ; } ; v a r   D R A W = { I N T E R M E D I A T E : 1 } ; v a r   S H A D E R = { } ; S H A D E R . V E R T E X _ I D E N T I T Y = [ ' p r e c i s i o n   h i g h p   f l o a t ; ' , ' a t t r i b u t e   v e c 2   p o s ; ' , ' a t t r i b u t e   v e c 2   u v ; ' , ' v a r y i n g   v e c 2   v U v ; ' , ' u n i f o r m   f l o a t   f l i p Y ; ' , ' v o i d   m a i n ( v o i d )   { ' , ' v U v   =   u v ; ' , ' g l _ P o s i t i o n   =   v e c 4 ( p o s . x ,   p o s . y * f l i p Y ,   0 . 0 ,   1 . ) ; ' , ' } ' ] . j o i n ( ' \ n ' ) ; S H A D E R . F R A G M E N T _ I D E N T I T Y = [ ' p r e c i s i o n   h i g h p   f l o a t ; ' , ' v a r y i n g   v e c 2   v U v ; ' , ' u n i f o r m   s a m p l e r 2 D   t e x t u r e ; ' , ' v o i d   m a i n ( v o i d )   { ' , ' g l _ F r a g C o l o r   =   t e x t u r e 2 D ( t e x t u r e ,   v U v ) ; ' , ' } ' , ] . j o i n ( ' \ n ' ) ; v a r   _ f i l t e r = { } ; _ f i l t e r . c o l o r M a t r i x = f u n c t i o n ( m a t r i x , a m o u n t = 1 ) { m a t r i x = m a t r i x . m a p ( ( c o e f , i n d e x ) = > w e i g h t e d A v g ( c o e f , i d e n t i t y M a t r i x [ i n d e x ] , a m o u n t ) ) ; v a r   m = n e w   F l o a t 3 2 A r r a y ( m a t r i x ) ; m [ 4 ] / = 2 5 5 ; m [ 9 ] / = 2 5 5 ; m [ 1 4 ] / = 2 5 5 ; m [ 1 9 ] / = 2 5 5 ; v a r   s h a d e r = ( 1 = = m [ 1 8 ] & & 0 = = m [ 3 ] & & 0 = = m [ 8 ] & & 0 = = m [ 1 3 ] & & 0 = = m [ 1 5 ] & & 0 = = m [ 1 6 ] & & 0 = = m [ 1 7 ] & & 0 = = m [ 1 9 ] ) ? _ f i l t e r . c o l o r M a t r i x . S H A D E R . W I T H O U T _ A L P H A : _ f i l t e r . c o l o r M a t r i x . S H A D E R . W I T H _ A L P H A ; v a r   p r o g r a m = _ c o m p i l e S h a d e r ( s h a d e r ) ; g l . u n i f o r m 1 f v ( p r o g r a m . u n i f o r m . m , m ) ; _ d r a w ( ) ; } ; _ f i l t e r . c o l o r M a t r i x . S H A D E R = { } ; _ f i l t e r . c o l o r M a t r i x . S H A D E R . W I T H _ A L P H A = [ ' p r e c i s i o n   h i g h p   f l o a t ; ' , ' v a r y i n g   v e c 2   v U v ; ' , ' u n i f o r m   s a m p l e r 2 D   t e x t u r e ; ' , ' u n i f o r m   f l o a t   m [ 2 0 ] ; ' , ' v o i d   m a i n ( v o i d )   { ' , ' v e c 4   c   =   t e x t u r e 2 D ( t e x t u r e ,   v U v ) ; ' , ' g l _ F r a g C o l o r . r   =   m [ 0 ]   *   c . r   +   m [ 1 ]   *   c . g   +   m [ 2 ]   *   c . b   +   m [ 3 ]   *   c . a   +   m [ 4 ] ; ' , ' g l _ F r a g C o l o r . g   =   m [ 5 ]   *   c . r   +   m [ 6 ]   *   c . g   +   m [ 7 ]   *   c . b   +   m [ 8 ]   *   c . a   +   m [ 9 ] ; ' , ' g l _ F r a g C o l o r . b   =   m [ 1 0 ]   *   c . r   +   m [ 1 1 ]   *   c . g   +   m [ 1 2 ]   *   c . b   +   m [ 1 3 ]   *   c . a   +   m [ 1 4 ] ; ' , ' g l _ F r a g C o l o r . a   =   m [ 1 5 ]   *   c . r   +   m [ 1 6 ]   *   c . g   +   m [ 1 7 ]   *   c . b   +   m [ 1 8 ]   *   c . a   +   m [ 1 9 ] ; ' , ' } ' , ] . j o i n ( ' \ n ' ) ; _ f i l t e r . c o l o r M a t r i x . S H A D E R . W I T H O U T _ A L P H A = [ ' p r e c i s i o n   h i g h p   f l o a t ; ' , ' v a r y i n g   v e c 2   v U v ; ' , ' u n i f o r m   s a m p l e r 2 D   t e x t u r e ; ' , ' u n i f o r m   f l o a t   m [ 2 0 ] ; ' , ' v o i d   m a i n ( v o i d )   { ' , ' v e c 4   c   =   t e x t u r e 2 D ( t e x t u r e ,   v U v ) ; ' , ' g l _ F r a g C o l o r . r   =   m [ 0 ]   *   c . r   +   m [ 1 ]   *   c . g   +   m [ 2 ]   *   c . b   +   m [ 4 ] ; ' , ' g l _ F r a g C o l o r . g   =   m [ 5 ]   *   c . r   +   m [ 6 ]   *   c . g   +   m [ 7 ]   *   c . b   +   m [ 9 ] ; ' , ' g l _ F r a g C o l o r . b   =   m [ 1 0 ]   *   c . r   +   m [ 1 1 ]   *   c . g   +   m [ 1 2 ]   *   c . b   +   m [ 1 4 ] ; ' , ' g l _ F r a g C o l o r . a   =   c . a ; ' , ' } ' , ] . j o i n ( ' \ n ' ) ; _ f i l t e r . b r i g h t n e s s = f u n c t i o n ( b r i g h t n e s s ) { v a r   b = ( b r i g h t n e s s | | 0 ) + 1 ; _ f i l t e r . c o l o r M a t r i x ( [ b , 0 , 0 , 0 , 0 , 0 , b , 0 , 0 , 0 , 0 , 0 , b , 0 , 0 , 0 , 0 , 0 , 1 , 0 ] ) ; } ; _ f i l t e r . s a t u r a t i o n = f u n c t i o n ( a m o u n t ) { v a r   x = ( a m o u n t | | 0 ) * 2 / 3 + 1 ; v a r   y = ( ( x - 1 ) * - 0 . 5 ) ; _ f i l t e r . c o l o r M a t r i x ( [ x , y , y , 0 , 0 , y , x , y , 0 , 0 , y , y , x , 0 , 0 , 0 , 0 , 0 , 1 , 0 ] ) ; } ; _ f i l t e r . d e s a t u r a t e = f u n c t i o n ( ) { _ f i l t e r . s a t u r a t i o n ( - 1 ) ; } ; _ f i l t e r . c o n t r a s t = f u n c t i o n ( a m o u n t ) { v a r   v = ( a m o u n t | | 0 ) + 1 ; v a r   o = - 1 2 8 * ( v - 1 ) ; _ f i l t e r . c o l o r M a t r i x ( [ v , 0 , 0 , 0 , o , 0 , v , 0 , 0 , o , 0 , 0 , v , 0 , o , 0 , 0 , 0 , 1 , 0 ] ) ; } ; _ f i l t e r . n e g a t i v e = f u n c t i o n ( ) { _ f i l t e r . c o n t r a s t ( - 2 ) ; } ; _ f i l t e r . h u e = f u n c t i o n ( r o t a t i o n ) { r o t a t i o n = ( r o t a t i o n | | 0 ) / 1 8 0 * M a t h . P I ; v a r   c o s = M a t h . c o s ( r o t a t i o n ) , s i n = M a t h . s i n ( r o t a t i o n ) , l u m R = 0 . 2 1 3 , l u m G = 0 . 7 1 5 , l u m B = 0 . 0 7 2 ; _ f i l t e r . c o l o r M a t r i x ( [ l u m R + c o s * ( 1 - l u m R ) + s i n * ( - l u m R ) , l u m G + c o s * ( - l u m G ) + s i n * ( - l u m G ) , l u m B + c o s * ( - l u m B ) + s i n * ( 1 - l u m B ) , 0 , 0 , l u m R + c o s * ( - l u m R ) + s i n * ( 0 . 1 4 3 ) , l u m G + c o s * ( 1 - l u m G ) + s i n * ( 0 . 1 4 0 ) , l u m B + c o s * ( - l u m B ) + s i n * ( - 0 . 2 8 3 ) , 0 , 0 , l u m R + c o s * ( - l u m R ) + s i n * ( - ( 1 - l u m R ) ) , l u m G + c o s * ( - l u m G ) + s i n * ( l u m G ) , l u m B + c o s * ( 1 - l u m B ) + s i n * ( l u m B ) , 0 , 0 , 0 , 0 , 0 , 1 , 0 ] ) ; } ; _ f i l t e r . d e s a t u r a t e L u m i n a n c e = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 0 . 2 7 6 4 7 2 3 , 0 . 9 2 9 7 0 8 0 , 0 . 0 9 3 8 1 9 7 , 0 , - 3 7 . 1 , 0 . 2 7 6 4 7 2 3 , 0 . 9 2 9 7 0 8 0 , 0 . 0 9 3 8 1 9 7 , 0 , - 3 7 . 1 , 0 . 2 7 6 4 7 2 3 , 0 . 9 2 9 7 0 8 0 , 0 . 0 9 3 8 1 9 7 , 0 , - 3 7 . 1 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . s e p i a = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 0 . 3 9 3 , 0 . 7 6 8 9 9 9 9 , 0 . 1 8 8 9 9 9 9 9 , 0 , 0 , 0 . 3 4 9 , 0 . 6 8 5 9 9 9 9 , 0 . 1 6 7 9 9 9 9 9 , 0 , 0 , 0 . 2 7 2 , 0 . 5 3 3 9 9 9 9 , 0 . 1 3 0 9 9 9 9 9 , 0 , 0 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . b r o w n i e = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 0 . 5 9 9 7 0 2 3 4 9 8 1 5 9 7 1 5 , 0 . 3 4 5 5 3 2 4 3 0 4 8 3 9 1 2 6 3 , - 0 . 2 7 0 8 2 9 8 6 7 4 5 3 8 0 4 2 , 0 , 4 7 . 4 3 1 9 2 8 5 5 6 0 0 8 7 3 , - 0 . 0 3 7 7 0 3 2 4 9 8 3 7 7 8 3 1 5 7 , 0 . 8 6 0 9 5 7 7 5 8 7 9 9 2 6 4 1 , 0 . 1 5 0 5 9 5 5 2 3 8 8 4 5 9 9 1 3 , 0 , - 3 6 . 9 6 8 4 1 4 9 8 3 1 9 1 2 7 , 0 . 2 4 1 1 3 6 3 5 1 2 8 1 5 3 3 3 5 , - 0 . 0 7 4 4 1 0 3 7 9 0 8 4 2 2 4 9 2 , 0 . 4 4 9 7 2 1 8 2 0 6 4 8 7 7 1 5 3 , 0 , - 7 . 5 6 2 0 7 5 2 7 7 5 9 1 2 8 3 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . v i n t a g e P i n h o l e = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 0 . 6 2 7 9 3 4 5 6 3 5 6 0 5 9 9 4 , 0 . 3 2 0 2 1 8 3 4 2 0 8 1 9 3 6 7 , - 0 . 0 3 9 6 5 4 0 8 2 1 1 3 1 2 4 5 3 , 0 , 9 . 6 5 1 2 8 5 8 3 5 2 9 4 1 2 3 , 0 . 0 2 5 7 8 3 9 7 7 0 4 8 0 8 8 6 8 , 0 . 6 4 4 1 1 8 8 6 4 4 3 7 4 7 7 1 , 0 . 0 3 2 5 9 1 2 7 6 1 6 1 4 9 2 9 4 , 0 , 7 . 4 6 2 8 2 9 1 7 6 4 7 0 5 9 1 , 0 . 0 4 6 6 0 5 5 5 5 6 7 8 2 7 1 9 , - 0 . 0 8 5 1 2 3 2 9 8 7 2 4 7 8 9 1 , 0 . 5 2 4 1 6 4 8 0 1 8 7 0 0 4 6 5 , 0 , 5 . 1 5 9 1 9 0 5 8 8 2 3 5 2 9 6 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . k o d a c h r o m e = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 1 . 1 2 8 5 5 8 2 3 9 6 5 9 3 5 2 5 , - 0 . 3 9 6 7 3 8 2 2 8 3 6 0 1 3 4 8 , - 0 . 0 3 9 9 2 5 5 9 1 7 2 9 2 1 7 9 3 , 0 , 6 3 . 7 2 9 5 8 7 6 2 1 9 6 5 0 2 , - 0 . 1 6 4 0 4 3 3 9 9 6 2 2 4 4 6 1 6 , 1 . 0 8 3 5 2 5 1 5 6 6 2 9 1 3 0 4 , - 0 . 0 5 4 9 8 8 0 5 1 1 5 6 3 3 1 3 2 , 0 , 2 4 . 7 3 2 4 0 7 8 9 6 7 0 6 2 0 3 , - 0 . 1 6 7 8 6 0 1 0 7 0 6 1 5 5 7 6 3 , - 0 . 5 6 0 3 4 1 6 2 7 7 6 9 5 2 4 8 , 1 . 6 0 1 4 8 5 0 7 6 1 9 6 4 9 4 3 , 0 , 3 5 . 6 2 9 8 2 8 0 7 4 6 0 9 4 6 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . t e c h n i c o l o r = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 1 . 9 1 2 5 2 7 7 8 9 1 4 5 6 0 8 3 , - 0 . 8 5 4 5 3 4 4 9 7 6 9 5 1 6 4 5 , - 0 . 0 9 1 5 5 5 0 8 4 8 2 7 5 5 5 8 5 , 0 , 1 1 . 7 9 3 6 0 3 4 3 4 3 7 7 3 3 7 , - 0 . 3 0 8 7 8 3 3 3 8 5 9 2 8 0 9 7 , 1 . 7 6 5 8 9 0 8 5 5 5 4 5 8 4 2 8 , - 0 . 1 0 6 0 1 7 4 3 0 7 4 7 2 2 2 4 5 , 0 , - 7 0 . 3 5 2 0 5 1 6 1 4 6 1 3 9 8 , - 0 . 2 3 1 1 0 3 3 7 7 5 4 8 6 1 6 , - 0 . 7 5 0 1 8 9 9 1 9 7 4 4 0 2 1 2 , 1 . 8 4 7 5 9 7 8 1 6 1 0 8 1 8 9 , 0 , 3 0 . 9 5 0 9 4 0 8 6 9 4 9 1 1 3 8 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . p o l a r o i d = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 1 . 4 3 8 , - 0 . 0 6 2 , - 0 . 0 6 2 , 0 , 0 , - 0 . 1 2 2 , 1 . 3 7 8 , - 0 . 1 2 2 , 0 , 0 , - 0 . 0 1 6 , - 0 . 0 1 6 , 1 . 4 8 3 , 0 , 0 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . s h i f t T o B G R = f u n c t i o n ( a m o u n t ) { _ f i l t e r . c o l o r M a t r i x ( [ 0 , 0 , 1 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 ] , a m o u n t ) ; } ; _ f i l t e r . c o n v o l u t i o n = f u n c t i o n ( m a t r i x ) { v a r   m = n e w   F l o a t 3 2 A r r a y ( m a t r i x ) ; v a r   p i x e l S i z e X = 1 / _ w i d t h ; v a r   p i x e l S i z e Y = 1 / _ h e i g h t ; v a r   p r o g r a m = _ c o m p i l e S h a d e r ( _ f i l t e r . c o n v o l u t i o n . S H A D E R ) ; g l . u n i f o r m 1 f v ( p r o g r a m . u n i f o r m . m , m ) ; g l . u n i f o r m 2 f ( p r o g r a m . u n i f o r m . p x , p i x e l S i z e X , p i x e l S i z e Y ) ; _ d r a w ( ) ; } ; _ f i l t e r . c o n v o l u t i o n . S H A D E R = [ ' p r e c i s i o n   h i g h p   f l o a t ; ' , ' v a r y i n g   v e c 2   v U v ; ' , ' u n i f o r m   s a m p l e r 2 D   t e x t u r e ; ' , ' u n i f o r m   v e c 2   p x ; ' , ' u n i f o r m   f l o a t   m [ 9 ] ; ' , ' v o i d   m a i n ( v o i d )   { ' , ' v e c 4   c 1 1   =   t e x t u r e 2 D ( t e x t u r e ,   v U v   -   p x ) ; ' , ' v e c 4   c 1 2   =   t e x t u r e 2 D ( t e x t u r e ,   v e c 2 ( v U v . x ,   v U v . y   -   p x . y ) ) ; ' , ' v e c 4   c 1 3   =   t e x t u r e 2 D ( t e x t u r e ,   v e c 2 ( v U v . x   +   p x . x ,   v U v . y   -   p x . y ) ) ; ' , ' v e c 4   c 2 1   =   t e x t u r e 2 D ( t e x t u r e ,   v e c 2 ( v U v . x   -   p x . x ,   v U v . y )   ) ; ' , ' v e c 4   c 2 2   =   t e x t u r e 2 D ( t e x t u r e ,   v U v ) ; ' , ' v e c 4   c 2 3   =   t e x t u r e 2 D ( t e x t u r e ,   v e c 2 ( v U v . x   +   p x . x ,   v U v . y )   ) ; ' , ' v e c 4   c 3 1   =   t e x t u r e 2 D ( t e x t u r e ,   v e c 2 ( v U v . x   -   p x . x ,   v U v . y   +   p x . y )   ) ; ' , ' v e c 4   c 3 2   =   t e x t u r e 2 D ( t e x t u r e ,   v e c 2 ( v U v . x ,   v U v . y   +   p x . y )   ) ; ' , ' v e c 4   c 3 3   =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   p x   ) ; ' , ' g l _ F r a g C o l o r   =   ' , ' c 1 1   *   m [ 0 ]   +   c 1 2   *   m [ 1 ]   +   c 2 2   *   m [ 2 ]   + ' , ' c 2 1   *   m [ 3 ]   +   c 2 2   *   m [ 4 ]   +   c 2 3   *   m [ 5 ]   + ' , ' c 3 1   *   m [ 6 ]   +   c 3 2   *   m [ 7 ]   +   c 3 3   *   m [ 8 ] ; ' , ' g l _ F r a g C o l o r . a   =   c 2 2 . a ; ' , ' } ' , ] . j o i n ( ' \ n ' ) ; _ f i l t e r . d e t e c t E d g e s = f u n c t i o n ( ) { _ f i l t e r . c o n v o l u t i o n . c a l l ( t h i s , [ 0 , 1 , 0 , 1 , - 4 , 1 , 0 , 1 , 0 ] ) ; } ; _ f i l t e r . s o b e l X = f u n c t i o n ( ) { _ f i l t e r . c o n v o l u t i o n . c a l l ( t h i s , [ - 1 , 0 , 1 , - 2 , 0 , 2 , - 1 , 0 , 1 ] ) ; } ; _ f i l t e r . s o b e l Y = f u n c t i o n ( ) { _ f i l t e r . c o n v o l u t i o n . c a l l ( t h i s , [ - 1 , - 2 , - 1 , 0 , 0 , 0 , 1 , 2 , 1 ] ) ; } ; _ f i l t e r . s h a r p e n = f u n c t i o n ( a m o u n t ) { v a r   a = a m o u n t | | 1 ; _ f i l t e r . c o n v o l u t i o n . c a l l ( t h i s , [ 0 , - 1 * a , 0 , - 1 * a , 1 + 4 * a , - 1 * a , 0 , - 1 * a , 0 ] ) ; } ; _ f i l t e r . e m b o s s = f u n c t i o n ( s i z e ) { v a r   s = s i z e | | 1 ; _ f i l t e r . c o n v o l u t i o n . c a l l ( t h i s , [ - 2 * s , - 1 * s , 0 , - 1 * s , 1 , 1 * s , 0 , 1 * s , 2 * s ] ) ; } ; _ f i l t e r . b l u r = f u n c t i o n ( s i z e ) { v a r   b l u r S i z e X = ( s i z e / 7 ) / _ w i d t h ; v a r   b l u r S i z e Y = ( s i z e / 7 ) / _ h e i g h t ; v a r   p r o g r a m = _ c o m p i l e S h a d e r ( _ f i l t e r . b l u r . S H A D E R ) ; g l . u n i f o r m 2 f ( p r o g r a m . u n i f o r m . p x , 0 , b l u r S i z e Y ) ; _ d r a w ( D R A W . I N T E R M E D I A T E ) ; g l . u n i f o r m 2 f ( p r o g r a m . u n i f o r m . p x , b l u r S i z e X , 0 ) ; _ d r a w ( ) ; } ; _ f i l t e r . b l u r . S H A D E R = [ ' p r e c i s i o n   h i g h p   f l o a t ; ' , ' v a r y i n g   v e c 2   v U v ; ' , ' u n i f o r m   s a m p l e r 2 D   t e x t u r e ; ' , ' u n i f o r m   v e c 2   p x ; ' , ' v o i d   m a i n ( v o i d )   { ' , ' g l _ F r a g C o l o r   =   v e c 4 ( 0 . 0 ) ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 ( - 7 . 0 * p x . x ,   - 7 . 0 * p x . y ) ) * 0 . 0 0 4 4 2 9 9 1 2 1 0 5 5 1 1 3 2 6 5 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 ( - 6 . 0 * p x . x ,   - 6 . 0 * p x . y ) ) * 0 . 0 0 8 9 5 7 8 1 2 1 1 7 9 4 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 ( - 5 . 0 * p x . x ,   - 5 . 0 * p x . y ) ) * 0 . 0 2 1 5 9 6 3 8 6 6 0 5 3 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 ( - 4 . 0 * p x . x ,   - 4 . 0 * p x . y ) ) * 0 . 0 4 4 3 6 8 3 3 3 8 7 1 8 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 ( - 3 . 0 * p x . x ,   - 3 . 0 * p x . y ) ) * 0 . 0 7 7 6 7 4 4 2 1 9 9 3 3 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 ( - 2 . 0 * p x . x ,   - 2 . 0 * p x . y ) ) * 0 . 1 1 5 8 7 6 6 2 1 1 0 5 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 ( - 1 . 0 * p x . x ,   - 1 . 0 * p x . y ) ) * 0 . 1 4 7 3 0 8 0 5 6 1 2 1 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v                                                           ) * 0 . 1 5 9 5 7 6 9 1 2 1 6 1 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 (   1 . 0 * p x . x ,     1 . 0 * p x . y ) ) * 0 . 1 4 7 3 0 8 0 5 6 1 2 1 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 (   2 . 0 * p x . x ,     2 . 0 * p x . y ) ) * 0 . 1 1 5 8 7 6 6 2 1 1 0 5 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 (   3 . 0 * p x . x ,     3 . 0 * p x . y ) ) * 0 . 0 7 7 6 7 4 4 2 1 9 9 3 3 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 (   4 . 0 * p x . x ,     4 . 0 * p x . y ) ) * 0 . 0 4 4 3 6 8 3 3 3 8 7 1 8 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 (   5 . 0 * p x . x ,     5 . 0 * p x . y ) ) * 0 . 0 2 1 5 9 6 3 8 6 6 0 5 3 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 (   6 . 0 * p x . x ,     6 . 0 * p x . y ) ) * 0 . 0 0 8 9 5 7 8 1 2 1 1 7 9 4 ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   v U v   +   v e c 2 (   7 . 0 * p x . x ,     7 . 0 * p x . y ) ) * 0 . 0 0 4 4 2 9 9 1 2 1 0 5 5 1 1 3 2 6 5 ; ' , ' } ' , ] . j o i n ( ' \ n ' ) ; _ f i l t e r . p i x e l a t e = f u n c t i o n ( s i z e ) { v a r   b l u r S i z e X = ( s i z e ) / _ w i d t h ; v a r   b l u r S i z e Y = ( s i z e ) / _ h e i g h t ; v a r   p r o g r a m = _ c o m p i l e S h a d e r ( _ f i l t e r . p i x e l a t e . S H A D E R ) ; g l . u n i f o r m 2 f ( p r o g r a m . u n i f o r m . s i z e , b l u r S i z e X , b l u r S i z e Y ) ; _ d r a w ( ) ; } ; _ f i l t e r . p i x e l a t e . S H A D E R = [ ' p r e c i s i o n   h i g h p   f l o a t ; ' , ' v a r y i n g   v e c 2   v U v ; ' , ' u n i f o r m   v e c 2   s i z e ; ' , ' u n i f o r m   s a m p l e r 2 D   t e x t u r e ; ' , ' v e c 2   p i x e l a t e ( v e c 2   c o o r d ,   v e c 2   s i z e )   { ' , ' r e t u r n   f l o o r (   c o o r d   /   s i z e   )   *   s i z e ; ' , ' } ' , ' v o i d   m a i n ( v o i d )   { ' , ' g l _ F r a g C o l o r   =   v e c 4 ( 0 . 0 ) ; ' , ' v e c 2   c o o r d   =   p i x e l a t e ( v U v ,   s i z e ) ; ' , ' g l _ F r a g C o l o r   + =   t e x t u r e 2 D ( t e x t u r e ,   c o o r d ) ; ' , ' } ' , ] . j o i n ( ' \ n ' ) ; } ; } ) ( w i n d o w ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / f o n t s . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . f o n t s ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; r e t u r n { c a c h e C s s S e l e c t o r s : { } , g e t C s s S e l e c t o r s : f u n c t i o n ( f i l t e r ) { i f ( t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] ) { r e t u r n   t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] ; } 
 t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] = [ ] ; v a r   s h e e t s = d o c u m e n t . s t y l e S h e e t s ; f o r ( v a r   i = 0 ; i < s h e e t s . l e n g t h ; i + + ) { v a r   r u l e s ; t r y { r u l e s = s h e e t s [ i ] . r u l e s | | s h e e t s [ i ] . c s s R u l e s ; } c a t c h ( e ) { c o n s o l e . w a r n ( " C a n ' t   r e a d   t h e   c s s   r u l e s   o f :   " + s h e e t s [ i ] . h r e f , e ) ; c o n t i n u e ; } 
 i f ( ! r u l e s ) { c o n t i n u e ; } 
 f o r ( v a r   r = 0 ; r < r u l e s . l e n g t h ; r + + ) { v a r   s e l e c t o r T e x t = r u l e s [ r ] . s e l e c t o r T e x t ; i f ( ! s e l e c t o r T e x t ) { c o n t i n u e ; } 
 v a r   s e l e c t o r s = s e l e c t o r T e x t . s p l i t ( / \ s * , \ s * / ) ; v a r   d a t a = n u l l ; f o r ( v a r   s = 0 ; s < s e l e c t o r s . l e n g t h ; s + + ) { v a r   m a t c h = s e l e c t o r s [ s ] . t r i m ( ) . m a t c h ( f i l t e r ) ; i f ( ! m a t c h ) { c o n t i n u e ; } 
 i f ( ! d a t a ) { d a t a = { s e l e c t o r : m a t c h [ 0 ] , c s s : r u l e s [ r ] . c s s T e x t . r e p l a c e ( / ( ^ . * \ { \ s * ) | ( \ s * \ } \ s * $ ) / g , ' ' ) , n a m e s : [ m a t c h [ 1 ] ] } ; } e l s e { d a t a . s e l e c t o r + = ( ' ,   ' + m a t c h [ 0 ] ) ; d a t a . n a m e s . p u s h ( m a t c h [ 1 ] ) ; } } 
 i f ( d a t a ) { t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] . p u s h ( d a t a ) ; } } } 
 r e t u r n   t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] ; } , f o n t I c o n s : [ { b a s e : ' f a ' , p a r s e r : / \ . ( f a - ( ? : \ w | - ) + ) : : ? b e f o r e / i } ] , c o m p u t e F o n t s : _ . o n c e ( f u n c t i o n ( ) { v a r   s e l f = t h i s ; _ . e a c h ( t h i s . f o n t I c o n s , f u n c t i o n ( d a t a ) { d a t a . c s s D a t a = s e l f . g e t C s s S e l e c t o r s ( d a t a . p a r s e r ) ; d a t a . a l i a s = _ . f l a t t e n ( _ . m a p ( d a t a . c s s D a t a , _ . p r o p e r t y ( ' n a m e s ' ) ) ) ; } ) ; } ) , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / b a s e . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . b a s e ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   a j a x = r e q u i r e ( ' w e b . a j a x ' ) ; v a r   s e s s i o n = r e q u i r e ( ' w e b . s e s s i o n ' ) ; v a r   d o m R e a d y = n e w   P r o m i s e ( f u n c t i o n ( r e s o l v e ) { $ ( r e s o l v e ) ; } ) ; r e t u r n { c a c h e C s s S e l e c t o r s : { } , g e t C s s S e l e c t o r s : f u n c t i o n ( f i l t e r ) { i f ( t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] ) { r e t u r n   t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] ; } 
 t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] = [ ] ; v a r   s h e e t s = d o c u m e n t . s t y l e S h e e t s ; f o r ( v a r   i = 0 ; i < s h e e t s . l e n g t h ; i + + ) { v a r   r u l e s ; t r y { r u l e s = s h e e t s [ i ] . r u l e s | | s h e e t s [ i ] . c s s R u l e s ; } c a t c h ( e ) { c o n s o l e . w a r n ( " C a n ' t   r e a d   t h e   c s s   r u l e s   o f :   " + s h e e t s [ i ] . h r e f , e ) ; c o n t i n u e ; } 
 i f ( ! r u l e s ) { c o n t i n u e ; } 
 f o r ( v a r   r = 0 ; r < r u l e s . l e n g t h ; r + + ) { v a r   s e l e c t o r T e x t = r u l e s [ r ] . s e l e c t o r T e x t ; i f ( ! s e l e c t o r T e x t ) { c o n t i n u e ; } 
 v a r   s e l e c t o r s = s e l e c t o r T e x t . s p l i t ( / \ s * , \ s * / ) ; v a r   d a t a = n u l l ; f o r ( v a r   s = 0 ; s < s e l e c t o r s . l e n g t h ; s + + ) { v a r   m a t c h = s e l e c t o r s [ s ] . t r i m ( ) . m a t c h ( f i l t e r ) ; i f ( ! m a t c h ) { c o n t i n u e ; } 
 i f ( ! d a t a ) { d a t a = { s e l e c t o r : m a t c h [ 0 ] , c s s : r u l e s [ r ] . c s s T e x t . r e p l a c e ( / ( ^ . * \ { \ s * ) | ( \ s * \ } \ s * $ ) / g , ' ' ) , n a m e s : [ m a t c h [ 1 ] ] } ; } e l s e { d a t a . s e l e c t o r + = ( ' ,   ' + m a t c h [ 0 ] ) ; d a t a . n a m e s . p u s h ( m a t c h [ 1 ] ) ; } } 
 i f ( d a t a ) { t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] . p u s h ( d a t a ) ; } } } 
 r e t u r n   t h i s . c a c h e C s s S e l e c t o r s [ f i l t e r ] ; } , f o n t I c o n s : [ { b a s e : ' f a ' , p a r s e r : / \ . ( f a - ( ? : \ w | - ) + ) : : ? b e f o r e / i } ] , c o m p u t e F o n t s : _ . o n c e ( f u n c t i o n ( ) { v a r   s e l f = t h i s ; _ . e a c h ( t h i s . f o n t I c o n s , f u n c t i o n ( d a t a ) { d a t a . c s s D a t a = s e l f . g e t C s s S e l e c t o r s ( d a t a . p a r s e r ) ; d a t a . a l i a s = _ . f l a t t e n ( _ . m a p ( d a t a . c s s D a t a , _ . p r o p e r t y ( ' n a m e s ' ) ) ) ; } ) ; } ) , r e a d y : f u n c t i o n ( ) { r e t u r n   P r o m i s e . a l l ( [ d o m R e a d y , s e s s i o n . i s _ b o u n d , a j a x . l o a d X M L ( ) ] ) ; } , } ; } ) ; o d o o . d e f i n e ( ' w e b _ e d i t o r . c o n t e x t ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; f u n c t i o n   g e t C o n t e x t ( c o n t e x t ) { v a r   h t m l = d o c u m e n t . d o c u m e n t E l e m e n t ; r e t u r n   _ . e x t e n d ( { l a n g : ( h t m l . g e t A t t r i b u t e ( ' l a n g ' ) | | ' e n _ U S ' ) . r e p l a c e ( ' - ' , ' _ ' ) , ' w e b s i t e _ i d ' : h t m l . g e t A t t r i b u t e ( ' d a t a - w e b s i t e - i d ' ) | 0 , } , c o n t e x t | | { } ) ; } 
 f u n c t i o n   g e t E x t r a C o n t e x t ( c o n t e x t ) { v a r   h t m l = d o c u m e n t . d o c u m e n t E l e m e n t ; r e t u r n   _ . e x t e n d ( g e t C o n t e x t ( ) , { e d i t a b l e : ! ! ( h t m l . d a t a s e t . e d i t a b l e | | $ ( ' [ d a t a - o e - m o d e l ] ' ) . l e n g t h ) , t r a n s l a t a b l e : ! ! h t m l . d a t a s e t . t r a n s l a t a b l e , e d i t _ t r a n s l a t i o n s : ! ! h t m l . d a t a s e t . e d i t _ t r a n s l a t i o n s , } , c o n t e x t | | { } ) ; } 
 r e t u r n { g e t : g e t C o n t e x t , g e t E x t r a : g e t E x t r a C o n t e x t , } ; } ) ; o d o o . d e f i n e ( ' w e b _ e d i t o r . r e a d y ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   b a s e = r e q u i r e ( ' w e b _ e d i t o r . b a s e ' ) ; r e t u r n   b a s e . r e a d y ( ) ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / e d i t o r / e d i t o r . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . e d i t o r ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   D i a l o g = r e q u i r e ( ' w e b . D i a l o g ' ) ; v a r   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   r t e = r e q u i r e ( ' w e b _ e d i t o r . r t e ' ) ; v a r   s n i p p e t s E d i t o r = r e q u i r e ( ' w e b _ e d i t o r . s n i p p e t . e d i t o r ' ) ; v a r   s u m m e r n o t e C u s t o m C o l o r s = r e q u i r e ( ' w e b _ e d i t o r . r t e . s u m m e r n o t e _ c u s t o m _ c o l o r s ' ) ; v a r   _ t = c o r e . _ t ; v a r   E d i t o r M e n u B a r = W i d g e t . e x t e n d ( { t e m p l a t e : ' w e b _ e d i t o r . e d i t o r b a r ' , x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / e d i t o r . x m l ' ] , e v e n t s : { ' c l i c k   b u t t o n [ d a t a - a c t i o n = s a v e ] ' : ' _ o n S a v e C l i c k ' , ' c l i c k   b u t t o n [ d a t a - a c t i o n = c a n c e l ] ' : ' _ o n C a n c e l C l i c k ' , } , c u s t o m _ e v e n t s : { r e q u e s t _ e d i t a b l e : ' _ o n R e q u e s t E d i t a b l e ' , r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d : ' _ o n H i s t o r y U n d o R e c o r d R e q u e s t ' , r e q u e s t _ s a v e : ' _ o n S a v e R e q u e s t ' , } , i n i t : f u n c t i o n ( p a r e n t , o p t i o n s ) { v a r   s e l f = t h i s ; v a r   r e s = t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; v a r   E d i t o r = o p t i o n s . E d i t o r | | r t e . C l a s s ; t h i s . r t e = n e w   E d i t o r ( t h i s , { g e t C o n f i g : f u n c t i o n ( $ e d i t a b l e ) { v a r   p a r a m = s e l f . _ g e t D e f a u l t C o n f i g ( $ e d i t a b l e ) ; i f ( o p t i o n s . g e n e r a t e O p t i o n s ) { p a r a m = o p t i o n s . g e n e r a t e O p t i o n s ( p a r a m ) ; } 
 r e t u r n   p a r a m ; } , s a v e E l e m e n t : o p t i o n s . s a v e E l e m e n t , } ) ; t h i s . r t e . o n ( ' r t e : s t a r t ' , t h i s , f u n c t i o n ( ) { s e l f . t r i g g e r ( ' r t e : s t a r t ' ) ; } ) ; v a r   $ e d i t a b l e = t h i s . r t e . e d i t a b l e ( ) ; w i n d o w . _ _ E d i t o r M e n u B a r _ $ e d i t a b l e = $ e d i t a b l e ; i f ( o p t i o n s . s n i p p e t s ) { t h i s . s n i p p e t s M e n u = n e w   s n i p p e t s E d i t o r . C l a s s ( t h i s , O b j e c t . a s s i g n ( { $ e l : $ e d i t a b l e , s e l e c t o r E d i t a b l e A r e a : ' . o _ e d i t a b l e ' , } , o p t i o n s ) ) ; } 
 r e t u r n   r e s ; } , s t a r t : f u n c t i o n ( ) { v a r   s e l f = t h i s ; v a r   d e f s = [ t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ] ; c o r e . b u s . o n ( ' e d i t o r _ s a v e _ r e q u e s t ' , t h i s , t h i s . s a v e ) ; c o r e . b u s . o n ( ' e d i t o r _ d i s c a r d _ r e q u e s t ' , t h i s , t h i s . c a n c e l ) ; $ ( ' . d r o p d o w n - t o g g l e ' ) . d r o p d o w n ( ) ; $ ( d o c u m e n t ) . o n ( ' k e y u p ' , f u n c t i o n ( e v e n t ) { i f ( ( e v e n t . k e y C o d e = = = 8 | | e v e n t . k e y C o d e = = = 4 6 ) ) { v a r   $ t a r g e t = $ ( e v e n t . t a r g e t ) . c l o s e s t ( ' . o _ e d i t a b l e ' ) ; i f ( ! $ t a r g e t . i s ( ' : h a s ( * : n o t ( p ) : n o t ( b r ) ) ' ) & & ! $ t a r g e t . t e x t ( ) . m a t c h ( / \ S / ) ) { $ t a r g e t . e m p t y ( ) ; } } } ) ; $ ( d o c u m e n t ) . o n ( ' c l i c k ' , ' . n o t e - e d i t a b l e ' , f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; } ) ; $ ( d o c u m e n t ) . o n ( ' s u b m i t ' , ' . n o t e - e d i t a b l e   f o r m   . b t n ' , f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; } ) ; $ ( d o c u m e n t ) . o n ( ' h i d e . b s . d r o p d o w n ' , ' . d r o p d o w n ' , f u n c t i o n ( e v ) { i f ( e v . o r i g i n a l E v e n t & & $ ( e v . t a r g e t ) . h a s ( e v . o r i g i n a l E v e n t . t a r g e t ) . l e n g t h & & $ ( e v . o r i g i n a l E v e n t . t a r g e t ) . i s ( ' [ c o n t e n t e d i t a b l e ] ' ) ) { e v . p r e v e n t D e f a u l t ( ) ; } } ) ; t h i s . r t e . s t a r t ( ) ; v a r   f l a g = f a l s e ; w i n d o w . o n b e f o r e u n l o a d = f u n c t i o n ( e v e n t ) { i f ( r t e . h i s t o r y . g e t E d i t a b l e H a s U n d o ( ) . l e n g t h & & ! f l a g ) { f l a g = t r u e ; _ . d e f e r ( f u n c t i o n ( ) { f l a g = f a l s e ; } ) ; r e t u r n   _ t ( ' T h i s   d o c u m e n t   i s   n o t   s a v e d ! ' ) ; } } ; i f ( s e l f . s n i p p e t s M e n u ) { d e f s . p u s h ( t h i s . s n i p p e t s M e n u . i n s e r t A f t e r ( t h i s . $ e l ) ) ; } 
 t h i s . r t e . e d i t a b l e ( ) . f i n d ( ' * ' ) . o f f ( ' m o u s e d o w n   m o u s e u p   c l i c k ' ) ; r e t u r n   P r o m i s e . a l l ( d e f s ) . t h e n ( f u n c t i o n ( ) { s e l f . t r i g g e r _ u p ( ' e d i t _ m o d e ' ) ; } ) ; } , d e s t r o y : f u n c t i o n ( ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; c o r e . b u s . o f f ( ' e d i t o r _ s a v e _ r e q u e s t ' , t h i s , t h i s . _ o n S a v e R e q u e s t ) ; c o r e . b u s . o f f ( ' e d i t o r _ d i s c a r d _ r e q u e s t ' , t h i s , t h i s . _ o n D i s c a r d R e q u e s t ) ; } , c a n c e l : f u n c t i o n ( r e l o a d ) { v a r   s e l f = t h i s ; r e t u r n   n e w   P r o m i s e ( f u n c t i o n ( r e s o l v e , r e j e c t ) { i f ( ! r t e . h i s t o r y . g e t E d i t a b l e H a s U n d o ( ) . l e n g t h ) { r e s o l v e ( ) ; } e l s e { v a r   c o n f i r m = D i a l o g . c o n f i r m ( t h i s , _ t ( " I f   y o u   d i s c a r d   t h e   c u r r e n t   e d i t s ,   a l l   u n s a v e d   c h a n g e s   w i l l   b e   l o s t .   Y o u   c a n   c a n c e l   t o   r e t u r n   t o   e d i t   m o d e . " ) , { c o n f i r m _ c a l l b a c k : r e s o l v e , } ) ; c o n f i r m . o n ( ' c l o s e d ' , s e l f , r e j e c t ) ; } } ) . t h e n ( f u n c t i o n ( ) { i f ( r e l o a d ! = = f a l s e ) { w i n d o w . o n b e f o r e u n l o a d = n u l l ; r e t u r n   s e l f . _ r e l o a d ( ) ; } } ) ; } , s a v e : a s y n c   f u n c t i o n ( r e l o a d ) { v a r   d e f s = [ ] ; t h i s . t r i g g e r _ u p ( ' r e a d y _ t o _ s a v e ' , { d e f s : d e f s } ) ; a w a i t   P r o m i s e . a l l ( d e f s ) ; i f ( t h i s . s n i p p e t s M e n u ) { a w a i t   t h i s . s n i p p e t s M e n u . c l e a n F o r S a v e ( ) ; } 
 a w a i t   t h i s . g e t P a r e n t ( ) . s a v e M o d i f i e d I m a g e s ( t h i s . r t e . e d i t a b l e ( ) ) ; a w a i t   t h i s . r t e . s a v e ( ) ; i f ( r e l o a d ! = = f a l s e ) { r e t u r n   t h i s . _ r e l o a d ( ) ; } } , _ g e t D e f a u l t C o n f i g : f u n c t i o n ( $ e d i t a b l e ) { r e t u r n { ' a i r M o d e ' : t r u e , ' f o c u s ' : f a l s e , ' a i r P o p o v e r ' : [ [ ' s t y l e ' , [ ' s t y l e ' ] ] , [ ' f o n t ' , [ ' b o l d ' , ' i t a l i c ' , ' u n d e r l i n e ' , ' c l e a r ' ] ] , [ ' f o n t s i z e ' , [ ' f o n t s i z e ' ] ] , [ ' c o l o r ' , [ ' c o l o r ' ] ] , [ ' p a r a ' , [ ' u l ' , ' o l ' , ' p a r a g r a p h ' ] ] , [ ' t a b l e ' , [ ' t a b l e ' ] ] , [ ' i n s e r t ' , [ ' l i n k ' , ' p i c t u r e ' ] ] , [ ' h i s t o r y ' , [ ' u n d o ' , ' r e d o ' ] ] , ] , ' s t y l e W i t h S p a n ' : f a l s e , ' i n l i n e m e d i a ' : [ ' p ' ] , ' l a n g ' : ' o d o o ' , ' o n C h a n g e ' : f u n c t i o n ( h t m l , $ e d i t a b l e ) { $ e d i t a b l e . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } , ' c o l o r s ' : s u m m e r n o t e C u s t o m C o l o r s , } ; } , _ r e l o a d : f u n c t i o n ( ) { w i n d o w . l o c a t i o n . h a s h = ' s c r o l l T o p = ' + w i n d o w . d o c u m e n t . b o d y . s c r o l l T o p ; i f ( w i n d o w . l o c a t i o n . s e a r c h . i n d e x O f ( ' e n a b l e _ e d i t o r ' ) > = 0 ) { w i n d o w . l o c a t i o n . h r e f = w i n d o w . l o c a t i o n . h r e f . r e p l a c e ( / & ? e n a b l e _ e d i t o r ( = [ ^ & ] * ) ? / g , ' ' ) ; } e l s e { w i n d o w . l o c a t i o n . r e l o a d ( t r u e ) ; } 
 r e t u r n   n e w   P r o m i s e ( f u n c t i o n ( ) { } ) ; } , _ o n C a n c e l C l i c k : f u n c t i o n ( ) { t h i s . c a n c e l ( ) ; } , _ o n H i s t o r y U n d o R e c o r d R e q u e s t : f u n c t i o n ( e v ) { t h i s . r t e . h i s t o r y R e c o r d U n d o ( e v . d a t a . $ t a r g e t , e v . d a t a . e v e n t ) ; } , _ o n S a v e C l i c k : f u n c t i o n ( ) { t h i s . s a v e ( ) ; } , _ o n D i s c a r d R e q u e s t : f u n c t i o n ( e v ) { t h i s . c a n c e l ( e v . d a t a . r e l o a d ) . t h e n ( e v . d a t a . o n S u c c e s s , e v . d a t a . o n F a i l u r e ) ; } , _ o n S a v e R e q u e s t : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; t h i s . s a v e ( e v . d a t a . r e l o a d ) . t h e n ( e v . d a t a . o n S u c c e s s , e v . d a t a . o n F a i l u r e ) ; } , _ o n R e q u e s t E d i t a b l e : f u n c t i o n ( e v ) { e v . d a t a . c a l l b a c k ( t h i s . r t e . e d i t a b l e ( ) ) ; } , } ) ; r e t u r n { C l a s s : E d i t o r M e n u B a r , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / e d i t o r / r t e . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . r t e ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   f o n t s = r e q u i r e ( ' w y s i w y g . f o n t s ' ) ; v a r   c o n c u r r e n c y = r e q u i r e ( ' w e b . c o n c u r r e n c y ' ) ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; v a r   w e C o n t e x t = r e q u i r e ( ' w e b _ e d i t o r . c o n t e x t ' ) ; v a r   s u m m e r n o t e = r e q u i r e ( ' w e b _ e d i t o r . s u m m e r n o t e ' ) ; v a r   s u m m e r n o t e C u s t o m C o l o r s = r e q u i r e ( ' w e b _ e d i t o r . r t e . s u m m e r n o t e _ c u s t o m _ c o l o r s ' ) ; v a r   _ t = c o r e . _ t ; v a r   d o m = s u m m e r n o t e . c o r e . d o m ; v a r   r a n g e = s u m m e r n o t e . c o r e . r a n g e ; v a r   H i s t o r y = f u n c t i o n   H i s t o r y ( $ e d i t a b l e ) { v a r   a U n d o = [ ] ; v a r   p o s = 0 ; v a r   t o S n a p ; t h i s . m a k e S n a p = f u n c t i o n ( e v e n t , r n g ) { r n g = r n g | | r a n g e . c r e a t e ( ) ; v a r   e l E d i t a b l e = $ ( r n g & & r n g . s c ) . c l o s e s t ( ' . o _ e d i t a b l e ' ) [ 0 ] ; i f ( ! e l E d i t a b l e ) { r e t u r n   f a l s e ; } 
 r e t u r n { e v e n t : e v e n t , e d i t a b l e : e l E d i t a b l e , c o n t e n t s : e l E d i t a b l e . i n n e r H T M L , b o o k m a r k : r n g & & r n g . b o o k m a r k ( e l E d i t a b l e ) , s c r o l l T o p : $ ( e l E d i t a b l e ) . s c r o l l T o p ( ) } ; } ; t h i s . a p p l y S n a p = f u n c t i o n ( o S n a p ) { v a r   $ e d i t a b l e = $ ( o S n a p . e d i t a b l e ) ; i f ( d o c u m e n t . d o c u m e n t M o d e ) { $ e d i t a b l e . r e m o v e A t t r ( ' c o n t e n t E d i t a b l e ' ) . r e m o v e P r o p ( ' c o n t e n t E d i t a b l e ' ) ; } 
 $ e d i t a b l e . t r i g g e r ( ' c o n t e n t _ w i l l _ b e _ d e s t r o y e d ' ) ; v a r   $ t e m p D i v = $ ( ' < d i v / > ' , { h t m l : o S n a p . c o n t e n t s } ) ; _ . e a c h ( $ t e m p D i v . f i n d ( ' . o _ t e m p _ a u t o _ e l e m e n t ' ) , f u n c t i o n ( e l ) { v a r   $ e l = $ ( e l ) ; v a r   o r i g i n a l C o n t e n t = $ e l . a t t r ( ' d a t a - t e m p - a u t o - e l e m e n t - o r i g i n a l - c o n t e n t ' ) ; i f ( o r i g i n a l C o n t e n t ) { $ e l . a f t e r ( o r i g i n a l C o n t e n t ) ; } 
 $ e l . r e m o v e ( ) ; } ) ; $ e d i t a b l e . h t m l ( $ t e m p D i v . h t m l ( ) ) . s c r o l l T o p ( o S n a p . s c r o l l T o p ) ; $ e d i t a b l e . t r i g g e r ( ' c o n t e n t _ w a s _ r e c r e a t e d ' ) ; $ ( ' . o e _ o v e r l a y ' ) . r e m o v e ( ) ; $ ( ' . n o t e - c o n t r o l - s e l e c t i o n ' ) . h i d e ( ) ; $ e d i t a b l e . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; t r y { v a r   r = o S n a p . e d i t a b l e . i n n e r H T M L = = = ' ' ? r a n g e . c r e a t e ( o S n a p . e d i t a b l e , 0 ) : r a n g e . c r e a t e F r o m B o o k m a r k ( o S n a p . e d i t a b l e , o S n a p . b o o k m a r k ) ; r . s e l e c t ( ) ; } c a t c h ( e ) { c o n s o l e . e r r o r ( e ) ; r e t u r n ; } 
 $ ( d o c u m e n t ) . t r i g g e r ( ' c l i c k ' ) ; $ ( ' . o _ e d i t a b l e   * ' ) . f i l t e r ( f u n c t i o n ( ) { v a r   $ e l = $ ( t h i s ) ; i f ( $ e l . d a t a ( ' s n i p p e t - e d i t o r ' ) ) { $ e l . r e m o v e D a t a ( ) ; } } ) ; _ . d e f e r ( f u n c t i o n ( ) { v a r   t a r g e t = d o m . i s B R ( r . s c ) ? r . s c . p a r e n t N o d e : d o m . n o d e ( r . s c ) ; i f ( ! t a r g e t ) { r e t u r n ; } 
 $ e d i t a b l e . t r i g g e r ( ' a p p l y S n a p ' ) ; v a r   e v t = d o c u m e n t . c r e a t e E v e n t ( ' M o u s e E v e n t s ' ) ; e v t . i n i t M o u s e E v e n t ( ' c l i c k ' , t r u e , t r u e , w i n d o w , 0 , 0 , 0 , 0 , 0 , f a l s e , f a l s e , f a l s e , f a l s e , 0 , t a r g e t ) ; t a r g e t . d i s p a t c h E v e n t ( e v t ) ; $ e d i t a b l e . t r i g g e r ( ' k e y u p ' ) ; } ) ; } ; t h i s . u n d o = f u n c t i o n ( ) { i f ( ! p o s ) { r e t u r n ; } 
 v a r   _ t o S n a p = t o S n a p ; i f ( _ t o S n a p ) { t h i s . s a v e S n a p ( ) ; } 
 i f ( ! a U n d o [ p o s ] & & ( ! a U n d o [ p o s ] | | a U n d o [ p o s ] . e v e n t ! = = ' u n d o ' ) ) { v a r   t e m p = t h i s . m a k e S n a p ( ' u n d o ' ) ; i f ( t e m p & & ( ! p o s | | t e m p . c o n t e n t s ! = = a U n d o [ p o s - 1 ] . c o n t e n t s ) ) { a U n d o [ p o s ] = t e m p ; } e l s e { p o s - - ; } } e l s e   i f ( _ t o S n a p ) { p o s - - ; } 
 t h i s . a p p l y S n a p ( a U n d o [ M a t h . m a x ( - - p o s , 0 ) ] ) ; w h i l e ( p o s & & ( a U n d o [ p o s ] . e v e n t = = = ' b l u r ' | | ( a U n d o [ p o s + 1 ] . e d i t a b l e = = = a U n d o [ p o s ] . e d i t a b l e & & a U n d o [ p o s + 1 ] . c o n t e n t s = = = a U n d o [ p o s ] . c o n t e n t s ) ) ) { t h i s . a p p l y S n a p ( a U n d o [ - - p o s ] ) ; } } ; t h i s . h a s U n d o = f u n c t i o n ( ) { r e t u r n ( t o S n a p & & ( t o S n a p . e v e n t ! = = ' b l u r ' & & t o S n a p . e v e n t ! = = ' a c t i v a t e ' & & t o S n a p . e v e n t ! = = ' u n d o ' ) ) | | ! ! _ . f i n d ( a U n d o . s l i c e ( 0 , p o s + 1 ) , f u n c t i o n ( u n d o ) { r e t u r n   u n d o . e v e n t ! = = ' b l u r ' & & u n d o . e v e n t ! = = ' a c t i v a t e ' & & u n d o . e v e n t ! = = ' u n d o ' ; } ) ; } ; t h i s . g e t E d i t a b l e H a s U n d o = f u n c t i o n ( ) { v a r   e d i t a b l e = [ ] ; i f ( ( t o S n a p & & ( t o S n a p . e v e n t ! = = ' b l u r ' & & t o S n a p . e v e n t ! = = ' a c t i v a t e ' & & t o S n a p . e v e n t ! = = ' u n d o ' ) ) ) { e d i t a b l e . p u s h ( t o S n a p . e d i t a b l e ) ; } 
 _ . e a c h ( a U n d o . s l i c e ( 0 , p o s + 1 ) , f u n c t i o n ( u n d o ) { i f ( u n d o . e v e n t ! = = ' b l u r ' & & u n d o . e v e n t ! = = ' a c t i v a t e ' & & u n d o . e v e n t ! = = ' u n d o ' ) { e d i t a b l e . p u s h ( u n d o . e d i t a b l e ) ; } } ) ; r e t u r n   _ . u n i q ( e d i t a b l e ) ; } ; t h i s . r e d o = f u n c t i o n ( ) { i f ( ! a U n d o [ p o s + 1 ] ) { r e t u r n ; } 
 t h i s . a p p l y S n a p ( a U n d o [ + + p o s ] ) ; w h i l e ( a U n d o [ p o s + 1 ] & & a U n d o [ p o s ] . e v e n t = = = ' a c t i v e ' ) { t h i s . a p p l y S n a p ( a U n d o [ p o s + + ] ) ; } } ; t h i s . h a s R e d o = f u n c t i o n ( ) { r e t u r n   a U n d o . l e n g t h > p o s + 1 ; } ; t h i s . r e c o r d U n d o = f u n c t i o n ( $ e d i t a b l e , e v e n t , i n t e r n a l _ h i s t o r y ) { v a r   s e l f = t h i s ; i f ( ! $ e d i t a b l e ) { v a r   r n g = r a n g e . c r e a t e ( ) ; i f ( ! r n g ) r e t u r n ; $ e d i t a b l e = $ ( r n g . s c ) . c l o s e s t ( ' . o _ e d i t a b l e ' ) ; } 
 i f ( a U n d o [ p o s ] & & ( e v e n t = = = ' a p p l y S n a p ' | | e v e n t = = = ' a c t i v a t e ' ) ) { r e t u r n ; } 
 i f ( ! i n t e r n a l _ h i s t o r y ) { i f ( ! e v e n t | | ! t o S n a p | | ! a U n d o [ p o s - 1 ] | | t o S n a p . e v e n t = = = ' a c t i v a t e ' ) { s e t T i m e o u t ( f u n c t i o n ( ) { $ e d i t a b l e . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } , 0 ) ; } } 
 i f ( a U n d o [ p o s ] ) { p o s = M a t h . m i n ( p o s , a U n d o . l e n g t h ) ; a U n d o . s p l i c e ( p o s , a U n d o . l e n g t h ) ; } 
 i f ( t o S n a p & & ( t o S n a p . s p l i t | | ! e v e n t | | t o S n a p . e v e n t ! = = e v e n t | | t o S n a p . e d i t a b l e ! = = $ e d i t a b l e [ 0 ] ) ) { t h i s . s a v e S n a p ( ) ; } 
 i f ( p o s & & a U n d o [ p o s - 1 ] . e d i t a b l e ! = = $ e d i t a b l e [ 0 ] ) { v a r   s n a p = t h i s . m a k e S n a p ( ' b l u r ' , r a n g e . c r e a t e ( a U n d o [ p o s - 1 ] . e d i t a b l e , 0 ) ) ; p o s + + ; a U n d o . p u s h ( s n a p ) ; } 
 i f ( r a n g e . c r e a t e ( ) ) { t o S n a p = s e l f . m a k e S n a p ( e v e n t ) ; } e l s e { t o S n a p = f a l s e ; } } ; t h i s . s p l i t N e x t = f u n c t i o n ( ) { i f ( t o S n a p ) { t o S n a p . s p l i t = t r u e ; } } ; t h i s . s a v e S n a p = f u n c t i o n ( ) { i f ( t o S n a p ) { i f ( ! a U n d o [ p o s ] ) { p o s + + ; } 
 a U n d o . p u s h ( t o S n a p ) ; d e l e t e   t o S n a p . s p l i t ; t o S n a p = n u l l ; } } ; } ; v a r   h i s t o r y = n e w   H i s t o r y ( ) ; $ . e x t e n d ( $ . e x p r [ ' : ' ] , { o _ e d i t a b l e : f u n c t i o n ( n o d e , i , m ) { w h i l e ( n o d e ) { i f ( n o d e . c l a s s N a m e & & _ . i s S t r i n g ( n o d e . c l a s s N a m e ) ) { i f ( n o d e . c l a s s N a m e . i n d e x O f ( ' o _ n o t _ e d i t a b l e ' ) ! = = - 1 ) { r e t u r n   f a l s e ; } 
 i f ( n o d e . c l a s s N a m e . i n d e x O f ( ' o _ e d i t a b l e ' ) ! = = - 1 ) { r e t u r n   t r u e ; } } 
 n o d e = n o d e . p a r e n t N o d e ; } 
 r e t u r n   f a l s e ; } , } ) ; $ . f n . e x t e n d ( { f o c u s I n : f u n c t i o n ( ) { i f ( t h i s . l e n g t h ) { r a n g e . c r e a t e ( d o m . f i r s t C h i l d ( t h i s [ 0 ] ) , 0 ) . s e l e c t ( ) ; } 
 r e t u r n   t h i s ; } , f o c u s I n E n d : f u n c t i o n ( ) { i f ( t h i s . l e n g t h ) { v a r   l a s t = d o m . l a s t C h i l d ( t h i s [ 0 ] ) ; r a n g e . c r e a t e ( l a s t , d o m . n o d e L e n g t h ( l a s t ) ) . s e l e c t ( ) ; } 
 r e t u r n   t h i s ; } , s e l e c t C o n t e n t : f u n c t i o n ( ) { i f ( t h i s . l e n g t h ) { v a r   n e x t = d o m . l a s t C h i l d ( t h i s [ 0 ] ) ; r a n g e . c r e a t e ( d o m . f i r s t C h i l d ( t h i s [ 0 ] ) , 0 , n e x t , n e x t . t e x t C o n t e n t . l e n g t h ) . s e l e c t ( ) ; } 
 r e t u r n   t h i s ; } , } ) ; v a r   R T E W i d g e t = W i d g e t . e x t e n d ( { i n i t : f u n c t i o n ( p a r e n t , p a r a m s ) { v a r   s e l f = t h i s ; t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . i n i t _ b o o t s t r a p _ c a r o u s e l = $ . f n . c a r o u s e l ; t h i s . e d i t _ b o o t s t r a p _ c a r o u s e l = f u n c t i o n ( ) { v a r   r e s = s e l f . i n i t _ b o o t s t r a p _ c a r o u s e l . a p p l y ( t h i s , a r g u m e n t s ) ; $ ( t h i s ) . o f f ( ' k e y d o w n . b s . c a r o u s e l ' ) ; r e t u r n   r e s ; } ; t h i s . _ g e t C o n f i g = p a r a m s & & p a r a m s . g e t C o n f i g | | t h i s . _ g e t D e f a u l t C o n f i g ; t h i s . _ s a v e E l e m e n t = p a r a m s & & p a r a m s . s a v e E l e m e n t | | t h i s . _ s a v e E l e m e n t ; f o n t s . c o m p u t e F o n t s ( ) ; } , s t a r t : f u n c t i o n ( ) { v a r   s e l f = t h i s ; t h i s . s a v i n g _ m u t e x = n e w   c o n c u r r e n c y . M u t e x ( ) ; $ . f n . c a r o u s e l = t h i s . e d i t _ b o o t s t r a p _ c a r o u s e l ; $ ( d o c u m e n t ) . o n ( ' c l i c k . r t e   k e y u p . r t e ' , f u n c t i o n ( ) { v a r   c u r r e n t _ r a n g e = { } ; t r y { c u r r e n t _ r a n g e = r a n g e . c r e a t e ( ) | | { } ; } c a t c h ( e ) { } 
 v a r   $ p o p o v e r = $ ( c u r r e n t _ r a n g e . s c ) . c l o s e s t ( ' [ c o n t e n t e d i t a b l e ] ' ) ; v a r   p o p o v e r _ h i s t o r y = ( $ p o p o v e r . d a t a ( ) | | { } ) . N o t e H i s t o r y ; i f ( ! p o p o v e r _ h i s t o r y | | p o p o v e r _ h i s t o r y = = = h i s t o r y ) r e t u r n ; v a r   e d i t o r = $ p o p o v e r . p a r e n t ( ' . n o t e - e d i t o r ' ) ; $ ( ' b u t t o n [ d a t a - e v e n t = " u n d o " ] ' , e d i t o r ) . a t t r ( ' d i s a b l e d ' , ! p o p o v e r _ h i s t o r y . h a s U n d o ( ) ) ; $ ( ' b u t t o n [ d a t a - e v e n t = " r e d o " ] ' , e d i t o r ) . a t t r ( ' d i s a b l e d ' , ! p o p o v e r _ h i s t o r y . h a s R e d o ( ) ) ; } ) ; $ ( d o c u m e n t ) . o n ( ' m o u s e d o w n . r t e   a c t i v a t e . r t e ' , t h i s , t h i s . _ o n M o u s e d o w n . b i n d ( t h i s ) ) ; $ ( d o c u m e n t ) . o n ( ' m o u s e u p . r t e ' , t h i s , t h i s . _ o n M o u s e u p . b i n d ( t h i s ) ) ; $ ( ' . o _ n o t _ e d i t a b l e ' ) . a t t r ( ' c o n t e n t E d i t a b l e ' , f a l s e ) ; v a r   $ e d i t a b l e = t h i s . e d i t a b l e ( ) ; $ e d i t a b l e . o n ( ' c o n t e n t _ w i l l _ b e _ d e s t r o y e d ' , f u n c t i o n ( e v ) { s e l f . t r i g g e r _ u p ( ' c o n t e n t _ w i l l _ b e _ d e s t r o y e d ' , { $ t a r g e t : $ ( e v . c u r r e n t T a r g e t ) , } ) ; } ) ; $ e d i t a b l e . o n ( ' c o n t e n t _ w a s _ r e c r e a t e d ' , f u n c t i o n ( e v ) { s e l f . t r i g g e r _ u p ( ' c o n t e n t _ w a s _ r e c r e a t e d ' , { $ t a r g e t : $ ( e v . c u r r e n t T a r g e t ) , } ) ; } ) ; $ e d i t a b l e . a d d C l a s s ( ' o _ e d i t a b l e ' ) . d a t a ( ' r t e ' , t h i s ) . e a c h ( f u n c t i o n ( ) { v a r   $ n o d e = $ ( t h i s ) ; v a r   c o m p u t e d S t y l e s = w i n d o w . g e t C o m p u t e d S t y l e ( t h i s ) | | w i n d o w . p a r e n t . g e t C o m p u t e d S t y l e ( t h i s ) ; i f ( c o m p u t e d S t y l e s . d i s p l a y = = = ' i n l i n e ' & & $ n o d e . d a t a ( ' o e - t y p e ' ) ! = = ' i m a g e ' ) { $ n o d e . a d d C l a s s ( ' o _ i s _ i n l i n e _ e d i t a b l e ' ) ; } } ) ; $ ( d o c u m e n t ) . o n ( ' c o n t e n t _ c h a n g e d ' , f u n c t i o n ( e v ) { s e l f . t r i g g e r _ u p ( ' r t e _ c h a n g e ' , { t a r g e t : e v . t a r g e t } ) ; i f ( ! e v . _ _ i s D i r t y H a n d l e d ) { e v . _ _ i s D i r t y H a n d l e d = t r u e ; v a r   e l = e v . t a r g e t ; v a r   d i r t y = e l . c l o s e s t ( ' . o _ e d i t a b l e ' ) | | e l ; d i r t y . c l a s s L i s t . a d d ( ' o _ d i r t y ' ) ; } } ) ; $ ( ' # w r a p w r a p ,   . o _ e d i t a b l e ' ) . o n ( ' c l i c k . r t e ' , ' * ' , t h i s , t h i s . _ o n C l i c k . b i n d ( t h i s ) ) ; $ ( ' b o d y ' ) . a d d C l a s s ( ' e d i t o r _ e n a b l e ' ) ; $ ( d o c u m e n t . b o d y ) . t o o l t i p ( { s e l e c t o r : ' [ d a t a - o e - r e a d o n l y ] ' , c o n t a i n e r : ' b o d y ' , t r i g g e r : ' h o v e r ' , d e l a y : { ' s h o w ' : 1 0 0 0 , ' h i d e ' : 1 0 0 } , p l a c e m e n t : ' b o t t o m ' , t i t l e : _ t ( " R e a d o n l y   f i e l d " ) } ) . o n ( ' c l i c k ' , f u n c t i o n ( ) { $ ( t h i s ) . t o o l t i p ( ' h i d e ' ) ; } ) ; $ ( d o c u m e n t ) . t r i g g e r ( ' m o u s e d o w n ' ) ; t h i s . t r i g g e r ( ' r t e : s t a r t ' ) ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , d e s t r o y : f u n c t i o n ( ) { t h i s . c a n c e l ( ) ; t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , c a n c e l : f u n c t i o n ( ) { i f ( t h i s . $ l a s t ) { t h i s . $ l a s t . d e s t r o y ( ) ; t h i s . $ l a s t = n u l l ; } 
 $ . f n . c a r o u s e l = t h i s . i n i t _ b o o t s t r a p _ c a r o u s e l ; $ ( d o c u m e n t ) . o f f ( ' . r t e ' ) ; $ ( ' # w r a p w r a p ,   . o _ e d i t a b l e ' ) . o f f ( ' . r t e ' ) ; $ ( ' . o _ n o t _ e d i t a b l e ' ) . r e m o v e A t t r ( ' c o n t e n t E d i t a b l e ' ) ; $ ( d o c u m e n t ) . o f f ( ' c l i c k . r t e   k e y u p . r t e   m o u s e d o w n . r t e   a c t i v a t e . r t e   m o u s e u p . r t e ' ) ; $ ( d o c u m e n t ) . o f f ( ' c o n t e n t _ c h a n g e d ' ) . r e m o v e C l a s s ( ' o _ i s _ i n l i n e _ e d i t a b l e ' ) . r e m o v e D a t a ( ' r t e ' ) ; $ ( d o c u m e n t ) . t o o l t i p ( ' d i s p o s e ' ) ; $ ( ' b o d y ' ) . r e m o v e C l a s s ( ' e d i t o r _ e n a b l e ' ) ; t h i s . t r i g g e r ( ' r t e : s t o p ' ) ; } , e d i t a b l e : f u n c t i o n ( ) { r e t u r n   $ ( ' # w r a p w r a p   [ d a t a - o e - m o d e l ] ' ) . n o t ( ' . o _ n o t _ e d i t a b l e ' ) . f i l t e r ( f u n c t i o n ( ) { r e t u r n ! $ ( t h i s ) . c l o s e s t ( ' . o _ n o t _ e d i t a b l e ' ) . l e n g t h ; } ) . n o t ( ' l i n k ,   s c r i p t ' ) . n o t ( ' [ d a t a - o e - r e a d o n l y ] ' ) . n o t ( ' i m g [ d a t a - o e - f i e l d = " a r c h " ] ,   b r [ d a t a - o e - f i e l d = " a r c h " ] ,   i n p u t [ d a t a - o e - f i e l d = " a r c h " ] ' ) . n o t ( ' . o e _ s n i p p e t _ e d i t o r ' ) . a d d ( ' . o _ e d i t a b l e ' ) ; } , h i s t o r y R e c o r d U n d o : f u n c t i o n ( $ t a r g e t , e v e n t , i n t e r n a l _ h i s t o r y ) { c o n s t   i n i t i a l A c t i v e E l e m e n t = d o c u m e n t . a c t i v e E l e m e n t ; c o n s t   i n i t i a l S e l e c t i o n S t a r t = i n i t i a l A c t i v e E l e m e n t & & i n i t i a l A c t i v e E l e m e n t . s e l e c t i o n S t a r t ; c o n s t   i n i t i a l S e l e c t i o n E n d = i n i t i a l A c t i v e E l e m e n t & & i n i t i a l A c t i v e E l e m e n t . s e l e c t i o n E n d ; $ t a r g e t = $ ( $ t a r g e t ) ; v a r   r n g = r a n g e . c r e a t e ( ) ; v a r   $ e d i t a b l e = $ ( r n g & & r n g . s c ) . c l o s e s t ( ' . o _ e d i t a b l e ' ) ; i f ( ! r n g | | ! $ e d i t a b l e . l e n g t h ) { $ e d i t a b l e = $ t a r g e t . c l o s e s t ( ' . o _ e d i t a b l e ' ) ; r n g = r a n g e . c r e a t e ( $ t a r g e t . c l o s e s t ( ' * ' ) [ 0 ] , 0 ) ; } e l s e { r n g = $ e d i t a b l e . d a t a ( ' r a n g e ' ) | | r n g ; } 
 t r y { r n g . s e l e c t ( ) ; } c a t c h ( e ) { c o n s o l e . l o g ( ' e r r o r ' , e ) ; } 
 h i s t o r y . r e c o r d U n d o ( $ e d i t a b l e , e v e n t , i n t e r n a l _ h i s t o r y ) ; i f ( i n i t i a l A c t i v e E l e m e n t & & i n i t i a l A c t i v e E l e m e n t ! = = d o c u m e n t . a c t i v e E l e m e n t ) { i n i t i a l A c t i v e E l e m e n t . f o c u s ( ) ; i f ( i n i t i a l A c t i v e E l e m e n t . m a t c h e s ( ' i n p u t [ t y p e = r a n g e ] ' ) ) { r e t u r n ; } 
 t r y { i n i t i a l A c t i v e E l e m e n t . s e l e c t i o n S t a r t = i n i t i a l S e l e c t i o n S t a r t ; i n i t i a l A c t i v e E l e m e n t . s e l e c t i o n E n d = i n i t i a l S e l e c t i o n E n d ; } c a t c h ( e ) { c o n s o l e . l o g ( ' e r r o r ' , e ) ; } } } , s a v e : f u n c t i o n ( c o n t e x t ) { v a r   s e l f = t h i s ; $ ( ' . o _ e d i t a b l e ' ) . d e s t r o y ( ) . r e m o v e C l a s s ( ' o _ e d i t a b l e   o _ i s _ i n l i n e _ e d i t a b l e   o _ e d i t a b l e _ d a t e _ f i e l d _ l i n k e d   o _ e d i t a b l e _ d a t e _ f i e l d _ f o r m a t _ c h a n g e d ' ) ; v a r   $ d i r t y = $ ( ' . o _ d i r t y ' ) ; $ d i r t y . r e m o v e A t t r ( ' c o n t e n t E d i t a b l e ' ) . r e m o v e C l a s s ( ' o _ d i r t y   o e _ c a r l o s _ d a n g e r   o _ i s _ i n l i n e _ e d i t a b l e ' ) ; v a r   d e f s = _ . m a p ( $ d i r t y , f u n c t i o n ( e l ) { v a r   $ e l = $ ( e l ) ; $ e l . f i n d ( ' [ c l a s s ] ' ) . f i l t e r ( f u n c t i o n ( ) { i f ( ! t h i s . g e t A t t r i b u t e ( ' c l a s s ' ) . m a t c h ( / \ S / ) ) { t h i s . r e m o v e A t t r i b u t e ( ' c l a s s ' ) ; } } ) ; r e t u r n   s e l f . s a v i n g _ m u t e x . e x e c ( f u n c t i o n ( ) { r e t u r n   s e l f . _ s a v e E l e m e n t ( $ e l , c o n t e x t | | w e C o n t e x t . g e t ( ) ) . t h e n ( f u n c t i o n ( ) { $ e l . r e m o v e C l a s s ( ' o _ d i r t y ' ) ; } ) . g u a r d e d C a t c h ( f u n c t i o n ( r e s p o n s e ) { v a r   i d = _ . u n i q u e I d ( ' c a r l o s _ d a n g e r _ ' ) ; $ e l . a d d C l a s s ( ' o _ d i r t y   o e _ c a r l o s _ d a n g e r   ' + i d ) ; $ ( ' . o _ e d i t a b l e . ' + i d ) . r e m o v e C l a s s ( i d ) . p o p o v e r ( { t r i g g e r : ' h o v e r ' , c o n t e n t : r e s p o n s e . m e s s a g e . d a t a . m e s s a g e | | ' ' , p l a c e m e n t : ' a u t o   t o p ' , } ) . p o p o v e r ( ' s h o w ' ) ; } ) ; } ) ; } ) ; r e t u r n   P r o m i s e . a l l ( d e f s ) . t h e n ( f u n c t i o n ( ) { w i n d o w . o n b e f o r e u n l o a d = n u l l ; } ) . g u a r d e d C a t c h ( f u n c t i o n ( f a i l e d ) { s e l f . c a n c e l ( ) ; s e l f . s t a r t ( ) ; } ) ; } , _ e n a b l e E d i t a b l e A r e a : f u n c t i o n ( $ e d i t a b l e ) { i f ( $ e d i t a b l e . d a t a ( ' o e - t y p e ' ) = = = " d a t e t i m e " | | $ e d i t a b l e . d a t a ( ' o e - t y p e ' ) = = = " d a t e " ) { v a r   s e l e c t o r = ' [ d a t a - o e - i d = " ' + $ e d i t a b l e . d a t a ( ' o e - i d ' ) + ' " ] ' ; s e l e c t o r + = ' [ d a t a - o e - f i e l d = " ' + $ e d i t a b l e . d a t a ( ' o e - f i e l d ' ) + ' " ] ' ; s e l e c t o r + = ' [ d a t a - o e - m o d e l = " ' + $ e d i t a b l e . d a t a ( ' o e - m o d e l ' ) + ' " ] ' ; v a r   $ l i n k e d F i e l d N o d e s = t h i s . e d i t a b l e ( ) . f i n d ( s e l e c t o r ) . a d d B a c k ( s e l e c t o r ) ; $ l i n k e d F i e l d N o d e s . n o t ( $ e d i t a b l e ) . a d d C l a s s ( ' o _ e d i t a b l e _ d a t e _ f i e l d _ l i n k e d ' ) ; i f ( ! $ e d i t a b l e . h a s C l a s s ( ' o _ e d i t a b l e _ d a t e _ f i e l d _ f o r m a t _ c h a n g e d ' ) ) { $ l i n k e d F i e l d N o d e s . h t m l ( $ e d i t a b l e . d a t a ( ' o e - o r i g i n a l - w i t h - f o r m a t ' ) ) ; $ l i n k e d F i e l d N o d e s . a d d C l a s s ( ' o _ e d i t a b l e _ d a t e _ f i e l d _ f o r m a t _ c h a n g e d ' ) ; } } 
 i f ( $ e d i t a b l e . d a t a ( ' o e - t y p e ' ) = = = " m o n e t a r y " ) { $ e d i t a b l e . a t t r ( ' c o n t e n t e d i t a b l e ' , f a l s e ) ; $ e d i t a b l e . f i n d ( ' . o e _ c u r r e n c y _ v a l u e ' ) . a t t r ( ' c o n t e n t e d i t a b l e ' , t r u e ) ; } 
 i f ( $ e d i t a b l e . i s ( ' [ d a t a - o e - m o d e l ] ' ) & & ! $ e d i t a b l e . i s ( ' [ d a t a - o e - m o d e l = " i r . u i . v i e w " ] ' ) & & ! $ e d i t a b l e . i s ( ' [ d a t a - o e - t y p e = " h t m l " ] ' ) ) { $ e d i t a b l e . d a t a ( ' l a y o u t I n f o ' ) . p o p o v e r ( ) . f i n d ( ' . b t n - g r o u p : n o t ( . n o t e - h i s t o r y ) ' ) . r e m o v e ( ) ; } } , _ g e t D e f a u l t C o n f i g : f u n c t i o n ( $ e d i t a b l e ) { r e t u r n { ' a i r M o d e ' : t r u e , ' f o c u s ' : f a l s e , ' a i r P o p o v e r ' : [ [ ' s t y l e ' , [ ' s t y l e ' ] ] , [ ' f o n t ' , [ ' b o l d ' , ' i t a l i c ' , ' u n d e r l i n e ' , ' c l e a r ' ] ] , [ ' f o n t s i z e ' , [ ' f o n t s i z e ' ] ] , [ ' c o l o r ' , [ ' c o l o r ' ] ] , [ ' p a r a ' , [ ' u l ' , ' o l ' , ' p a r a g r a p h ' ] ] , [ ' t a b l e ' , [ ' t a b l e ' ] ] , [ ' i n s e r t ' , [ ' l i n k ' , ' p i c t u r e ' ] ] , [ ' h i s t o r y ' , [ ' u n d o ' , ' r e d o ' ] ] , ] , ' s t y l e W i t h S p a n ' : f a l s e , ' i n l i n e m e d i a ' : [ ' p ' ] , ' l a n g ' : ' o d o o ' , ' o n C h a n g e ' : f u n c t i o n ( h t m l , $ e d i t a b l e ) { $ e d i t a b l e . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } , ' c o l o r s ' : s u m m e r n o t e C u s t o m C o l o r s , } ; } , _ g e t E s c a p e d E l e m e n t : f u n c t i o n ( $ e l ) { v a r   e s c a p e d _ e l = $ e l . c l o n e ( ) ; v a r   t o _ e s c a p e = e s c a p e d _ e l . f i n d ( ' * ' ) . a d d B a c k ( ) ; t o _ e s c a p e = t o _ e s c a p e . n o t ( t o _ e s c a p e . f i l t e r ( ' o b j e c t , i f r a m e , s c r i p t , s t y l e , [ d a t a - o e - m o d e l ] [ d a t a - o e - m o d e l ! = " i r . u i . v i e w " ] ' ) . f i n d ( ' * ' ) . a d d B a c k ( ) ) ; t o _ e s c a p e . c o n t e n t s ( ) . e a c h ( f u n c t i o n ( ) { i f ( t h i s . n o d e T y p e = = = 3 ) { t h i s . n o d e V a l u e = $ ( ' < d i v   / > ' ) . t e x t ( t h i s . n o d e V a l u e ) . h t m l ( ) ; } } ) ; r e t u r n   e s c a p e d _ e l ; } , _ s a v e E l e m e n t : f u n c t i o n ( $ e l , c o n t e x t , w i t h L a n g ) { v a r   v i e w I D = $ e l . d a t a ( ' o e - i d ' ) ; i f ( ! v i e w I D ) { r e t u r n   P r o m i s e . r e s o l v e ( ) ; } 
 r e t u r n   t h i s . _ r p c ( { m o d e l : ' i r . u i . v i e w ' , m e t h o d : ' s a v e ' , a r g s : [ v i e w I D , t h i s . _ g e t E s c a p e d E l e m e n t ( $ e l ) . p r o p ( ' o u t e r H T M L ' ) , $ e l . d a t a ( ' o e - x p a t h ' ) | | n u l l , ] , c o n t e x t : c o n t e x t , } , w i t h L a n g ? u n d e f i n e d : { n o C o n t e x t K e y s : ' l a n g ' , } ) ; } , _ o n C l i c k : f u n c t i o n ( e ) { e . p r e v e n t D e f a u l t ( ) ; } , _ o n M o u s e d o w n : f u n c t i o n ( e v ) { v a r   $ t a r g e t = $ ( e v . t a r g e t ) ; v a r   $ e d i t a b l e = $ t a r g e t . c l o s e s t ( ' . o _ e d i t a b l e ' ) ; v a r   i s L i n k = $ t a r g e t . i s ( ' a ' ) ; i f ( t h i s & & t h i s . $ l a s t & & t h i s . $ l a s t . l e n g t h & & t h i s . $ l a s t [ 0 ] ! = = $ t a r g e t [ 0 ] ) { $ ( ' . o _ e d i t a b l e _ d a t e _ f i e l d _ l i n k e d ' ) . r e m o v e C l a s s ( ' o _ e d i t a b l e _ d a t e _ f i e l d _ l i n k e d ' ) ; } 
 i f ( ! $ e d i t a b l e . l e n g t h | | ( ! i s L i n k & & $ . s u m m e r n o t e . c o r e . d o m . i s C o n t e n t E d i t a b l e F a l s e ( $ t a r g e t ) ) ) { r e t u r n ; } 
 _ . d e f e r ( f u n c t i o n ( ) { $ e d i t a b l e . f i n d ( ' [ _ m o z _ a b s p o s ] ' ) . r e m o v e A t t r ( ' _ m o z _ a b s p o s ' ) ; } ) ; i f ( i s L i n k ) { l e t   h a s C o n t e n t E d i t a b l e = $ t a r g e t . a t t r ( ' c o n t e n t e d i t a b l e ' ) ; $ t a r g e t . a t t r ( ' c o n t e n t e d i t a b l e ' , t r u e ) ; _ . d e f e r ( f u n c t i o n ( ) { $ e d i t a b l e . n o t ( $ t a r g e t ) . a t t r ( ' c o n t e n t e d i t a b l e ' , f a l s e ) ; $ t a r g e t . f o c u s ( ) ; } ) ; $ ( d o c u m e n t ) . o n ( ' m o u s e d o w n . r e a c t i v a t e _ c o n t e n t e d i t a b l e ' , f u n c t i o n ( e ) { i f ( $ t a r g e t . i s ( e . t a r g e t ) ) r e t u r n ; i f ( ! h a s C o n t e n t E d i t a b l e ) { $ t a r g e t . r e m o v e A t t r ( ' c o n t e n t e d i t a b l e ' ) ; } 
 $ e d i t a b l e . a t t r ( ' c o n t e n t e d i t a b l e ' , t r u e ) ; $ ( d o c u m e n t ) . o f f ( ' m o u s e d o w n . r e a c t i v a t e _ c o n t e n t e d i t a b l e ' ) ; } ) ; } 
 i f ( t h i s & & t h i s . $ l a s t & & ( ! $ e d i t a b l e . l e n g t h | | t h i s . $ l a s t [ 0 ] ! = = $ e d i t a b l e [ 0 ] ) ) { v a r   $ d e s t r o y = t h i s . $ l a s t ; h i s t o r y . s p l i t N e x t ( ) ; v a r   l a s t T i m e r I d = _ . d e l a y ( f u n c t i o n ( ) { v a r   i d = $ d e s t r o y . d a t a ( ' n o t e - i d ' ) ; $ d e s t r o y . d e s t r o y ( ) . r e m o v e D a t a ( ' n o t e - i d ' ) . r e m o v e A t t r ( ' d a t a - n o t e - i d ' ) ; $ ( ' # n o t e - p o p o v e r - ' + i d + ' ,   # n o t e - h a n d l e - ' + i d + ' ,   # n o t e - d i a l o g - ' + i d + ' ' ) . r e m o v e ( ) ; } , 1 5 0 ) ; t h i s . $ l a s t = n u l l ; i f ( $ d e s t r o y . h a s C l a s s ( ' m o d a l - b o d y ' ) ) { c l e a r T i m e o u t ( l a s t T i m e r I d ) ; } } 
 i f ( $ e d i t a b l e . l e n g t h & & ( ! t h i s . $ l a s t | | t h i s . $ l a s t [ 0 ] ! = = $ e d i t a b l e [ 0 ] ) ) { $ e d i t a b l e . s u m m e r n o t e ( t h i s . _ g e t C o n f i g ( $ e d i t a b l e ) ) ; $ e d i t a b l e . d a t a ( ' N o t e H i s t o r y ' , h i s t o r y ) ; t h i s . $ l a s t = $ e d i t a b l e ; t r y { d o c u m e n t . e x e c C o m m a n d ( ' e n a b l e O b j e c t R e s i z i n g ' , f a l s e , f a l s e ) ; d o c u m e n t . e x e c C o m m a n d ( ' e n a b l e I n l i n e T a b l e E d i t i n g ' , f a l s e , f a l s e ) ; d o c u m e n t . e x e c C o m m a n d ( ' 2 D - p o s i t i o n ' , f a l s e , f a l s e ) ; } c a t c h ( e ) { } 
 d o c u m e n t . b o d y . a d d E v e n t L i s t e n e r ( ' r e s i z e s t a r t ' , f u n c t i o n ( e v t ) { e v t . p r e v e n t D e f a u l t ( ) ; r e t u r n   f a l s e ; } ) ; d o c u m e n t . b o d y . a d d E v e n t L i s t e n e r ( ' m o v e s t a r t ' , f u n c t i o n ( e v t ) { e v t . p r e v e n t D e f a u l t ( ) ; r e t u r n   f a l s e ; } ) ; d o c u m e n t . b o d y . a d d E v e n t L i s t e n e r ( ' d r a g s t a r t ' , f u n c t i o n ( e v t ) { e v t . p r e v e n t D e f a u l t ( ) ; r e t u r n   f a l s e ; } ) ; i f ( ! r a n g e . c r e a t e ( ) ) { $ e d i t a b l e . f o c u s I n ( ) ; } 
 i f ( d o m . i s I m g ( $ t a r g e t [ 0 ] ) ) { $ t a r g e t . t r i g g e r ( ' m o u s e d o w n ' ) ; } 
 t h i s . _ e n a b l e E d i t a b l e A r e a ( $ e d i t a b l e ) ; } } , _ o n M o u s e u p : f u n c t i o n ( e v ) { v a r   $ t a r g e t = $ ( e v . t a r g e t ) ; v a r   $ e d i t a b l e = $ t a r g e t . c l o s e s t ( ' . o _ e d i t a b l e ' ) ; i f ( ! $ e d i t a b l e . l e n g t h ) { r e t u r n ; } 
 v a r   s e l f = t h i s ; _ . d e f e r ( f u n c t i o n ( ) { s e l f . h i s t o r y R e c o r d U n d o ( $ t a r g e t , ' a c t i v a t e ' , t r u e ) ; } ) ; i f ( e v . o r i g i n a l E v e n t & & e v . o r i g i n a l E v e n t . d e t a i l = = = 3 ) { r a n g e . c r e a t e ( e v . t a r g e t , 0 , e v . t a r g e t , e v . t a r g e t . c h i l d N o d e s . l e n g t h ) . s e l e c t ( ) ; } } , } ) ; r e t u r n { C l a s s : R T E W i d g e t , h i s t o r y : h i s t o r y , } ; } ) ; o d o o . d e f i n e ( ' w e b _ e d i t o r . r t e . s u m m e r n o t e _ c u s t o m _ c o l o r s ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; r e t u r n [ [ ' # 0 0 0 0 0 0 ' , ' # 4 2 4 2 4 2 ' , ' # 6 3 6 3 6 3 ' , ' # 9 C 9 C 9 4 ' , ' # C E C 6 C E ' , ' # E F E F E F ' , ' # F 7 F 7 F 7 ' , ' # F F F F F F ' ] , [ ' # F F 0 0 0 0 ' , ' # F F 9 C 0 0 ' , ' # F F F F 0 0 ' , ' # 0 0 F F 0 0 ' , ' # 0 0 F F F F ' , ' # 0 0 0 0 F F ' , ' # 9 C 0 0 F F ' , ' # F F 0 0 F F ' ] , [ ' # F 7 C 6 C E ' , ' # F F E 7 C E ' , ' # F F E F C 6 ' , ' # D 6 E F D 6 ' , ' # C E D E E 7 ' , ' # C E E 7 F 7 ' , ' # D 6 D 6 E 7 ' , ' # E 7 D 6 D E ' ] , [ ' # E 7 9 C 9 C ' , ' # F F C 6 9 C ' , ' # F F E 7 9 C ' , ' # B 5 D 6 A 5 ' , ' # A 5 C 6 C E ' , ' # 9 C C 6 E F ' , ' # B 5 A 5 D 6 ' , ' # D 6 A 5 B D ' ] , [ ' # E 7 6 3 6 3 ' , ' # F 7 A D 6 B ' , ' # F F D 6 6 3 ' , ' # 9 4 B D 7 B ' , ' # 7 3 A 5 A D ' , ' # 6 B A D D E ' , ' # 8 C 7 B C 6 ' , ' # C 6 7 B A 5 ' ] , [ ' # C E 0 0 0 0 ' , ' # E 7 9 4 3 9 ' , ' # E F C 6 3 1 ' , ' # 6 B A 5 4 A ' , ' # 4 A 7 B 8 C ' , ' # 3 9 8 4 C 6 ' , ' # 6 3 4 A A 5 ' , ' # A 5 4 A 7 B ' ] , [ ' # 9 C 0 0 0 0 ' , ' # B 5 6 3 0 8 ' , ' # B D 9 4 0 0 ' , ' # 3 9 7 B 2 1 ' , ' # 1 0 4 A 5 A ' , ' # 0 8 5 2 9 4 ' , ' # 3 1 1 8 7 3 ' , ' # 7 3 1 8 4 2 ' ] , [ ' # 6 3 0 0 0 0 ' , ' # 7 B 3 9 0 0 ' , ' # 8 4 6 3 0 0 ' , ' # 2 9 5 2 1 8 ' , ' # 0 8 3 1 3 9 ' , ' # 0 0 3 1 6 3 ' , ' # 2 1 1 0 4 A ' , ' # 4 A 1 0 3 1 ' ] ] ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / e d i t o r / r t e . s u m m e r n o t e . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . r t e . s u m m e r n o t e ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   C l a s s = r e q u i r e ( ' w e b . C l a s s ' ) ; c o n s t   c o n c u r r e n c y = r e q u i r e ( ' w e b . c o n c u r r e n c y ' ) ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; c o n s t   t o p B u s = w i n d o w . t o p . o d o o . _ _ D E B U G _ _ . s e r v i c e s [ ' w e b . c o r e ' ] . b u s ; c o n s t { C o l o r p i c k e r W i d g e t } = r e q u i r e ( ' w e b . C o l o r p i c k e r ' ) ; v a r   C o l o r P a l e t t e W i d g e t = r e q u i r e ( ' w e b _ e d i t o r . C o l o r P a l e t t e ' ) . C o l o r P a l e t t e W i d g e t ; v a r   m i x i n s = r e q u i r e ( ' w e b . m i x i n s ' ) ; v a r   f o n t s = r e q u i r e ( ' w y s i w y g . f o n t s ' ) ; v a r   r t e = r e q u i r e ( ' w e b _ e d i t o r . r t e ' ) ; v a r   S e r v i c e s M i x i n = r e q u i r e ( ' w e b . S e r v i c e s M i x i n ' ) ; v a r   w e W i d g e t s = r e q u i r e ( ' w y s i w y g . w i d g e t s ' ) ; v a r   _ t = c o r e . _ t ; v a r   d o m = $ . s u m m e r n o t e . c o r e . d o m ; v a r   r a n g e = $ . s u m m e r n o t e . c o r e . r a n g e ; v a r   e v e n t H a n d l e r = $ . s u m m e r n o t e . e v e n t H a n d l e r ; v a r   r e n d e r e r = $ . s u m m e r n o t e . r e n d e r e r ; v a r   t p l B u t t o n = r e n d e r e r . g e t T e m p l a t e ( ) . b u t t o n ; v a r   t p l I c o n B u t t o n = r e n d e r e r . g e t T e m p l a t e ( ) . i c o n B u t t o n ; v a r   t p l D r o p d o w n = r e n d e r e r . g e t T e m p l a t e ( ) . d r o p d o w n ; c o n s t   p r o c e s s A n d A p p l y C o l o r = f u n c t i o n ( t a r g e t , e v e n t N a m e , c o l o r , p r e v i e w ) { i f ( ! c o l o r ) { c o l o r = ' i n h e r i t ' ; } e l s e   i f ( ! C o l o r p i c k e r W i d g e t . i s C S S C o l o r ( c o l o r ) ) { c o l o r = ( e v e n t N a m e = = = " f o r e C o l o r " ? ' t e x t - ' : ' b g - ' ) + c o l o r ; } 
 v a r   l a y o u t I n f o = d o m . m a k e L a y o u t I n f o ( t a r g e t ) ; $ . s u m m e r n o t e . p l u g i n E v e n t s [ e v e n t N a m e ] ( u n d e f i n e d , e v e n t H a n d l e r . m o d u l e s . e d i t o r , l a y o u t I n f o , c o l o r , p r e v i e w ) ; } ; r e n d e r e r . c r e a t e P a l e t t e = f u n c t i o n ( $ c o n t a i n e r , o p t i o n s ) { c o n s t   $ d r o p d o w n C o n t e n t = $ c o n t a i n e r . f i n d ( " . c o l o r P a l e t t e " ) ; c o n s t   p a r e n t = o d o o . _ _ D E B U G _ _ . s e r v i c e s [ ' r o o t . w i d g e t ' ] ; _ . e a c h ( $ d r o p d o w n C o n t e n t , e l e m = > { c o n s t   e v e n t N a m e = e l e m . d a t a s e t . e v e n t N a m e ; l e t   c o l o r p i c k e r = n u l l ; c o n s t   m u t e x = n e w   c o n c u r r e n c y . M u t e x e d D r o p P r e v i o u s ( ) ; c o n s t   $ d r o p d o w n = $ ( e l e m ) . c l o s e s t ( ' . b t n - g r o u p ,   . d r o p d o w n ' ) ; l e t   m a n u a l O p e n i n g = f a l s e ; $ d r o p d o w n . o n ( ' h i d e . b s . d r o p d o w n ' , e v = > { r e t u r n ! ( e v . c l i c k E v e n t & & e v . c l i c k E v e n t . o r i g i n a l E v e n t & & e v . c l i c k E v e n t . o r i g i n a l E v e n t . _ _ i s C o l o r p i c k e r C l i c k ) ; } ) ; $ d r o p d o w n . o n ( ' s h o w . b s . d r o p d o w n ' , ( ) = > { i f ( m a n u a l O p e n i n g ) { r e t u r n   t r u e ; } 
 m u t e x . e x e c ( ( ) = > { c o n s t   o l d C o l o r p i c k e r = c o l o r p i c k e r ; c o n s t   h o o k E l = o l d C o l o r p i c k e r ? o l d C o l o r p i c k e r . e l : e l e m ; c o n s t   r = r a n g e . c r e a t e ( ) ; c o n s t   t a r g e t N o d e = r . s c ; c o n s t   t a r g e t E l e m e n t = t a r g e t N o d e . n o d e T y p e = = = N o d e . E L E M E N T _ N O D E ? t a r g e t N o d e : t a r g e t N o d e . p a r e n t N o d e ; c o l o r p i c k e r = n e w   C o l o r P a l e t t e W i d g e t ( p a r e n t , { e x c l u d e d : [ ' t r a n s p a r e n t _ g r a y s c a l e ' ] , $ e d i t a b l e : r t e . C l a s s . p r o t o t y p e . e d i t a b l e ( ) , s e l e c t e d C o l o r : $ ( t a r g e t E l e m e n t ) . c s s ( e v e n t N a m e = = = " f o r e C o l o r " ? ' c o l o r ' : ' b a c k g r o u n d C o l o r ' ) , } ) ; c o l o r p i c k e r . o n ( ' c u s t o m _ c o l o r _ p i c k e d   c o l o r _ p i c k e d ' , n u l l , e v = > { p r o c e s s A n d A p p l y C o l o r ( e v . d a t a . t a r g e t , e v e n t N a m e , e v . d a t a . c o l o r ) ; } ) ; c o l o r p i c k e r . o n ( ' c o l o r _ h o v e r   c o l o r _ l e a v e ' , n u l l , e v = > { p r o c e s s A n d A p p l y C o l o r ( e v . d a t a . t a r g e t , e v e n t N a m e , e v . d a t a . c o l o r , t r u e ) ; } ) ; c o l o r p i c k e r . o n ( ' e n t e r _ k e y _ c o l o r _ c o l o r p i c k e r ' , n u l l , ( ) = > { $ d r o p d o w n . c h i l d r e n ( ' . d r o p d o w n - t o g g l e ' ) . d r o p d o w n ( ' h i d e ' ) ; } ) ; r e t u r n   c o l o r p i c k e r . r e p l a c e ( h o o k E l ) . t h e n ( ( ) = > { i f ( o l d C o l o r p i c k e r ) { o l d C o l o r p i c k e r . d e s t r o y ( ) ; } 
 m a n u a l O p e n i n g = t r u e ; $ d r o p d o w n . c h i l d r e n ( ' . d r o p d o w n - t o g g l e ' ) . d r o p d o w n ( ' s h o w ' ) ; m a n u a l O p e n i n g = f a l s e ; } ) ; } ) ; r e t u r n   f a l s e ; } ) ; } ) ; } ; v a r   f n _ t p l P o p o v e r s = r e n d e r e r . t p l P o p o v e r s ; r e n d e r e r . t p l P o p o v e r s = f u n c t i o n ( l a n g , o p t i o n s ) { v a r   $ p o p o v e r = $ ( f n _ t p l P o p o v e r s . c a l l ( t h i s , l a n g , o p t i o n s ) ) ; v a r   $ i m a g e P o p o v e r = $ p o p o v e r . f i n d ( ' . n o t e - i m a g e - p o p o v e r ' ) ; v a r   $ l i n k P o p o v e r = $ p o p o v e r . f i n d ( ' . n o t e - l i n k - p o p o v e r ' ) ; v a r   $ a i r P o p o v e r = $ p o p o v e r . f i n d ( ' . n o t e - a i r - p o p o v e r ' ) ; $ ( t p l I c o n B u t t o n ( ' f a   f a - a l i g n - c e n t e r ' , { t i t l e : _ t ( ' C e n t e r ' ) , e v e n t : ' f l o a t M e ' , v a l u e : ' c e n t e r ' } ) ) . i n s e r t A f t e r ( $ i m a g e P o p o v e r . f i n d ( ' [ d a t a - e v e n t = " f l o a t M e " ] [ d a t a - v a l u e = " l e f t " ] ' ) ) ; $ i m a g e P o p o v e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e m o v e M e d i a " ] ' ) . p a r e n t ( ) . r e m o v e ( ) ; $ i m a g e P o p o v e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " f l o a t M e " ] [ d a t a - v a l u e = " n o n e " ] ' ) . r e m o v e ( ) ; v a r   $ p a d d i n g = $ ( ' < d i v   c l a s s = " b t n - g r o u p " / > ' ) ; $ p a d d i n g . i n s e r t B e f o r e ( $ i m a g e P o p o v e r . f i n d ( ' . b t n - g r o u p : f i r s t ' ) ) ; v a r   d r o p d o w n _ c o n t e n t = [ ' < l i > < a   c l a s s = " d r o p d o w n - i t e m "   d a t a - e v e n t = " p a d d i n g "   h r e f = " # "   d a t a - v a l u e = " " > ' + _ t ( ' N o n e ' ) + ' < / a > < / l i > ' , ' < l i > < a   c l a s s = " d r o p d o w n - i t e m "   d a t a - e v e n t = " p a d d i n g "   h r e f = " # "   d a t a - v a l u e = " s m a l l " > ' + _ t ( ' S m a l l ' ) + ' < / a > < / l i > ' , ' < l i > < a   c l a s s = " d r o p d o w n - i t e m "   d a t a - e v e n t = " p a d d i n g "   h r e f = " # "   d a t a - v a l u e = " m e d i u m " > ' + _ t ( ' M e d i u m ' ) + ' < / a > < / l i > ' , ' < l i > < a   c l a s s = " d r o p d o w n - i t e m "   d a t a - e v e n t = " p a d d i n g "   h r e f = " # "   d a t a - v a l u e = " l a r g e " > ' + _ t ( ' L a r g e ' ) + ' < / a > < / l i > ' , ' < l i > < a   c l a s s = " d r o p d o w n - i t e m "   d a t a - e v e n t = " p a d d i n g "   h r e f = " # "   d a t a - v a l u e = " x l " > ' + _ t ( ' X l ' ) + ' < / a > < / l i > ' , ] ; $ ( t p l I c o n B u t t o n ( ' f a   f a - p l u s - s q u a r e - o ' , { t i t l e : _ t ( ' P a d d i n g ' ) , d r o p d o w n : t p l D r o p d o w n ( d r o p d o w n _ c o n t e n t ) } ) ) . a p p e n d T o ( $ p a d d i n g ) ; $ i m a g e P o p o v e r . f i n d ( ' [ d a t a - e v e n t = " i m a g e S h a p e " ] : n o t ( [ d a t a - v a l u e ] ) ' ) . r e m o v e ( ) ; v a r   $ b u t t o n = $ ( t p l I c o n B u t t o n ( ' f a   f a - s u n - o ' , { t i t l e : _ t ( ' S h a d o w ' ) , e v e n t : ' i m a g e S h a p e ' , v a l u e : ' s h a d o w ' } ) ) . i n s e r t A f t e r ( $ i m a g e P o p o v e r . f i n d ( ' [ d a t a - e v e n t = " i m a g e S h a p e " ] [ d a t a - v a l u e = " r o u n d e d - c i r c l e " ] ' ) ) ; v a r   $ s p i n = $ ( ' < d i v   c l a s s = " b t n - g r o u p   d - n o n e   o n l y _ f a " / > ' ) . i n s e r t A f t e r ( $ b u t t o n . p a r e n t ( ) ) ; $ ( t p l I c o n B u t t o n ( ' f a   f a - r e f r e s h ' , { t i t l e : _ t ( ' S p i n ' ) , e v e n t : ' i m a g e S h a p e ' , v a l u e : ' f a - s p i n ' } ) ) . a p p e n d T o ( $ s p i n ) ; v a r   $ r e s i z e f a = $ ( ' < d i v   c l a s s = " b t n - g r o u p   d - n o n e   o n l y _ f a " / > ' ) . i n s e r t A f t e r ( $ i m a g e P o p o v e r . f i n d ( ' . b t n - g r o u p : h a s ( [ d a t a - e v e n t = " r e s i z e " ] ) ' ) ) ; f o r ( v a r   s i z e = 1 ; s i z e < = 5 ; s i z e + + ) { $ ( t p l B u t t o n ( ' < s p a n   c l a s s = " n o t e - f o n t s i z e - 1 0 " > ' + s i z e + ' x < / s p a n > ' , { t i t l e : s i z e + " x " , e v e n t : ' r e s i z e f a ' , v a l u e : s i z e + ' ' } ) ) . a p p e n d T o ( $ r e s i z e f a ) ; } 
 v a r   $ c o l o r f a = $ a i r P o p o v e r . f i n d ( ' . n o t e - c o l o r ' ) . c l o n e ( ) ; $ c o l o r f a . f i n d ( " . d r o p d o w n - m e n u " ) . c s s ( ' m i n - w i d t h ' , ' 1 7 2 p x ' ) ; $ r e s i z e f a . a f t e r ( $ c o l o r f a ) ; v a r   $ i m a g e p r o p = $ ( ' < d i v   c l a s s = " b t n - g r o u p " / > ' ) ; $ i m a g e p r o p . a p p e n d T o ( $ i m a g e P o p o v e r . f i n d ( ' . p o p o v e r - b o d y ' ) ) ; $ ( t p l I c o n B u t t o n ( ' f a   f a - f i l e - i m a g e - o ' , { t i t l e : _ t ( ' E d i t ' ) , e v e n t : ' s h o w I m a g e D i a l o g ' } ) ) . a p p e n d T o ( $ i m a g e p r o p ) ; $ ( t p l I c o n B u t t o n ( ' f a   f a - t r a s h - o ' , { t i t l e : _ t ( ' R e m o v e ' ) , e v e n t : ' d e l e t e ' } ) ) . a p p e n d T o ( $ i m a g e p r o p ) ; $ ( t p l I c o n B u t t o n ( ' f a   f a - c r o p ' , { t i t l e : _ t ( ' C r o p   I m a g e ' ) , e v e n t : ' c r o p I m a g e ' , } ) ) . i n s e r t A f t e r ( $ i m a g e P o p o v e r . f i n d ( ' [ d a t a - e v e n t = " i m a g e S h a p e " ] [ d a t a - v a l u e = " i m g - t h u m b n a i l " ] ' ) ) ; $ i m a g e P o p o v e r . f i n d ( ' . p o p o v e r - b o d y ' ) . a p p e n d ( $ a i r P o p o v e r . f i n d ( " . n o t e - h i s t o r y " ) . c l o n e ( ) ) ; $ i m a g e P o p o v e r . f i n d ( ' [ d a t a - e v e n t = " s h o w I m a g e D i a l o g " ] ' ) . b e f o r e ( $ a i r P o p o v e r . f i n d ( ' [ d a t a - e v e n t = " s h o w L i n k D i a l o g " ] ' ) . c l o n e ( ) ) ; v a r   $ a l t = $ ( ' < d i v   c l a s s = " b t n - g r o u p " / > ' ) ; $ a l t . a p p e n d T o ( $ i m a g e P o p o v e r . f i n d ( ' . p o p o v e r - b o d y ' ) ) ; $ a l t . a p p e n d ( ' < b u t t o n   c l a s s = " b t n   b t n - s e c o n d a r y "   d a t a - e v e n t = " a l t " > < s t r o n g > ' + _ t ( ' D e s c r i p t i o n ' ) + ' :   < / s t r o n g > < s p a n   c l a s s = " o _ i m a g e _ a l t " / > < / b u t t o n > ' ) ; $ l i n k P o p o v e r . f i n d ( ' . p o p o v e r - b o d y ' ) . a p p e n d ( $ a i r P o p o v e r . f i n d ( " . n o t e - h i s t o r y " ) . c l o n e ( ) ) ; $ l i n k P o p o v e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " s h o w L i n k D i a l o g " ]   i ' ) . a t t r ( " c l a s s " , " f a   f a - l i n k " ) ; $ l i n k P o p o v e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " u n l i n k " ] ' ) . b e f o r e ( $ a i r P o p o v e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " s h o w I m a g e D i a l o g " ] ' ) . c l o n e ( ) ) ; $ a i r P o p o v e r . f i n d ( ' . n o t e - s t y l e   . d r o p d o w n - t o g g l e ' ) . o n ( ' m o u s e d o w n ' , f u n c t i o n ( ) { v a r   $ f o r m a t = $ a i r P o p o v e r . f i n d ( ' [ d a t a - e v e n t = " f o r m a t B l o c k " ] ' ) ; v a r   n o d e = r a n g e . c r e a t e ( ) . s c ; v a r   f o r m a t s = $ f o r m a t . m a p ( f u n c t i o n ( ) { r e t u r n   $ ( t h i s ) . d a t a ( " v a l u e " ) ; } ) . g e t ( ) ; w h i l e ( n o d e & & ( ! n o d e . t a g N a m e | | ( ! n o d e . t a g N a m e | | f o r m a t s . i n d e x O f ( n o d e . t a g N a m e . t o L o w e r C a s e ( ) ) = = = - 1 ) ) ) { n o d e = n o d e . p a r e n t N o d e ; } 
 $ f o r m a t . r e m o v e C l a s s ( ' a c t i v e ' ) ; $ f o r m a t . f i l t e r ( ' [ d a t a - v a l u e = " ' + ( n o d e ? n o d e . t a g N a m e . t o L o w e r C a s e ( ) : " p " ) + ' " ] ' ) . a d d C l a s s ( " a c t i v e " ) ; } ) ; s e t T i m e o u t ( f u n c t i o n ( ) { $ a i r P o p o v e r . a d d ( $ l i n k P o p o v e r ) . a d d ( $ i m a g e P o p o v e r ) . f i n d ( " b u t t o n " ) . t o o l t i p ( ' d i s p o s e ' ) . t o o l t i p ( { c o n t a i n e r : ' b o d y ' , t r i g g e r : ' h o v e r ' , p l a c e m e n t : ' b o t t o m ' } ) . o n ( ' c l i c k ' , f u n c t i o n ( ) { $ ( t h i s ) . t o o l t i p ( ' h i d e ' ) ; } ) ; } ) ; r e t u r n   $ p o p o v e r ; } ; v a r   f n _ b o u t t o n _ u p d a t e = e v e n t H a n d l e r . m o d u l e s . p o p o v e r . b u t t o n . u p d a t e ; e v e n t H a n d l e r . m o d u l e s . p o p o v e r . b u t t o n . u p d a t e = f u n c t i o n ( $ c o n t a i n e r , o S t y l e ) { v a r   p r e v i o u s = $ ( " . n o t e - c o n t r o l - s e l e c t i o n " ) . d a t a ( ' t a r g e t ' ) ; i f ( p r e v i o u s ) { v a r   $ p r e v i o u s = $ ( p r e v i o u s ) ; $ p r e v i o u s . c s s ( { " - w e b k i t - a n i m a t i o n - p l a y - s t a t e " : " " , " a n i m a t i o n - p l a y - s t a t e " : " " , " - w e b k i t - t r a n s i t i o n " : " " , " t r a n s i t i o n " : " " , " - w e b k i t - a n i m a t i o n " : " " , " a n i m a t i o n " : " " } ) ; $ p r e v i o u s . f i n d ( ' . o _ w e _ s e l e c t e d _ i m a g e ' ) . a d d B a c k ( ' . o _ w e _ s e l e c t e d _ i m a g e ' ) . r e m o v e C l a s s ( ' o _ w e _ s e l e c t e d _ i m a g e ' ) ; } 
 f n _ b o u t t o n _ u p d a t e . c a l l ( t h i s , $ c o n t a i n e r , o S t y l e ) ; $ c o n t a i n e r . f i n d ( ' . n o t e - c o l o r ' ) . r e m o v e C l a s s ( ' d - n o n e ' ) ; i f ( o S t y l e . i m a g e ) { $ c o n t a i n e r . f i n d ( ' [ d a t a - e v e n t ] ' ) . r e m o v e C l a s s ( " a c t i v e " ) ; $ c o n t a i n e r . f i n d ( ' a [ d a t a - e v e n t = " p a d d i n g " ] [ d a t a - v a l u e = " s m a l l " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " p a d d i n g - s m a l l " ) ) ; $ c o n t a i n e r . f i n d ( ' a [ d a t a - e v e n t = " p a d d i n g " ] [ d a t a - v a l u e = " m e d i u m " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " p a d d i n g - m e d i u m " ) ) ; $ c o n t a i n e r . f i n d ( ' a [ d a t a - e v e n t = " p a d d i n g " ] [ d a t a - v a l u e = " l a r g e " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " p a d d i n g - l a r g e " ) ) ; $ c o n t a i n e r . f i n d ( ' a [ d a t a - e v e n t = " p a d d i n g " ] [ d a t a - v a l u e = " x l " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " p a d d i n g - x l " ) ) ; $ c o n t a i n e r . f i n d ( ' a [ d a t a - e v e n t = " p a d d i n g " ] [ d a t a - v a l u e = " " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , ! $ c o n t a i n e r . f i n d ( ' l i   a . a c t i v e [ d a t a - e v e n t = " p a d d i n g " ] ' ) . l e n g t h ) ; $ ( o S t y l e . i m a g e ) . a d d C l a s s ( ' o _ w e _ s e l e c t e d _ i m a g e ' ) ; i f ( d o m . i s I m g F o n t ( o S t y l e . i m a g e ) ) { $ c o n t a i n e r . f i n d ( ' . n o t e - f o r e - c o l o r - p r e v i e w   >   b u t t o n   >   . c a r e t ' ) . c s s ( ' b o r d e r - b o t t o m - c o l o r ' , $ ( o S t y l e . i m a g e ) . c s s ( ' c o l o r ' ) ) ; $ c o n t a i n e r . f i n d ( ' . n o t e - b a c k - c o l o r - p r e v i e w   >   b u t t o n   >   . c a r e t ' ) . c s s ( ' b o r d e r - b o t t o m - c o l o r ' , $ ( o S t y l e . i m a g e ) . c s s ( ' b a c k g r o u n d - c o l o r ' ) ) ; $ c o n t a i n e r . f i n d ( ' . b t n - g r o u p : n o t ( . o n l y _ f a ) : h a s ( b u t t o n [ d a t a - e v e n t = " r e s i z e " ] , b u t t o n [ d a t a - v a l u e = " i m g - t h u m b n a i l " ] ) ' ) . a d d C l a s s ( ' d - n o n e ' ) ; $ c o n t a i n e r . f i n d ( ' . o n l y _ f a ' ) . r e m o v e C l a s s ( ' d - n o n e ' ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e f a " ] [ d a t a - v a l u e = " 2 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " f a - 2 x " ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e f a " ] [ d a t a - v a l u e = " 3 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " f a - 3 x " ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e f a " ] [ d a t a - v a l u e = " 4 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " f a - 4 x " ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e f a " ] [ d a t a - v a l u e = " 5 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " f a - 5 x " ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e f a " ] [ d a t a - v a l u e = " 1 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , ! $ c o n t a i n e r . f i n d ( ' . a c t i v e [ d a t a - e v e n t = " r e s i z e f a " ] ' ) . l e n g t h ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " i m a g e S h a p e " ] [ d a t a - v a l u e = " f a - s p i n " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " f a - s p i n " ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " i m a g e S h a p e " ] [ d a t a - v a l u e = " s h a d o w " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " s h a d o w " ) ) ; $ c o n t a i n e r . f i n d ( ' . b t n - g r o u p : h a s ( b u t t o n [ d a t a - e v e n t = " i m a g e S h a p e " ] ) ' ) . r e m o v e C l a s s ( " d - n o n e " ) ; } e l s e { $ c o n t a i n e r . f i n d ( ' . d - n o n e : n o t ( . o n l y _ f a ,   . n o t e - r e c e n t - c o l o r ) ' ) . r e m o v e C l a s s ( ' d - n o n e ' ) ; $ c o n t a i n e r . f i n d ( ' . o n l y _ f a ' ) . a d d C l a s s ( ' d - n o n e ' ) ; v a r   w i d t h = ( $ ( o S t y l e . i m a g e ) . a t t r ( ' s t y l e ' ) | | ' ' ) . m a t c h ( / ( ^ | ; | \ s ) w i d t h : \ s * ( [ 0 - 9 ] + % ) / ) ; i f ( w i d t h ) { w i d t h = w i d t h [ 2 ] ; } 
 $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e " ] [ d a t a - v a l u e = " a u t o " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , w i d t h ! = = " 1 0 0 % " & & w i d t h ! = = " 5 0 % " & & w i d t h ! = = " 2 5 % " ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e " ] [ d a t a - v a l u e = " 1 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , w i d t h = = = " 1 0 0 % " ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e " ] [ d a t a - v a l u e = " 0 . 5 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , w i d t h = = = " 5 0 % " ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " r e s i z e " ] [ d a t a - v a l u e = " 0 . 2 5 " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , w i d t h = = = " 2 5 % " ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " i m a g e S h a p e " ] [ d a t a - v a l u e = " s h a d o w " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " s h a d o w " ) ) ; i f ( ! $ ( o S t y l e . i m a g e ) . i s ( " i m g " ) ) { $ c o n t a i n e r . f i n d ( ' . b t n - g r o u p : h a s ( b u t t o n [ d a t a - e v e n t = " i m a g e S h a p e " ] ) ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } 
 $ c o n t a i n e r . f i n d ( ' . n o t e - c o l o r ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } 
 $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " f l o a t M e " ] [ d a t a - v a l u e = " l e f t " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " f l o a t - l e f t " ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " f l o a t M e " ] [ d a t a - v a l u e = " c e n t e r " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " d - b l o c k   m x - a u t o " ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " f l o a t M e " ] [ d a t a - v a l u e = " r i g h t " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . i m a g e ) . h a s C l a s s ( " f l o a t - r i g h t " ) ) ; $ ( o S t y l e . i m a g e ) . t r i g g e r ( ' a t t r i b u t e s _ c h a n g e ' ) ; } e l s e { $ c o n t a i n e r . f i n d ( ' . n o t e - f o r e - c o l o r - p r e v i e w   >   b u t t o n   >   . c a r e t ' ) . c s s ( ' b o r d e r - b o t t o m - c o l o r ' , o S t y l e . c o l o r ) ; $ c o n t a i n e r . f i n d ( ' . n o t e - b a c k - c o l o r - p r e v i e w   >   b u t t o n   >   . c a r e t ' ) . c s s ( ' b o r d e r - b o t t o m - c o l o r ' , o S t y l e [ ' b a c k g r o u n d - c o l o r ' ] ) ; } } ; v a r   f n _ t o o l b a r _ b o u t t o n _ u p d a t e = e v e n t H a n d l e r . m o d u l e s . t o o l b a r . b u t t o n . u p d a t e ; e v e n t H a n d l e r . m o d u l e s . t o o l b a r . b u t t o n . u p d a t e = f u n c t i o n ( $ c o n t a i n e r , o S t y l e ) { f n _ t o o l b a r _ b o u t t o n _ u p d a t e . c a l l ( t h i s , $ c o n t a i n e r , o S t y l e ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " i n s e r t U n o r d e r e d L i s t " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . a n c e s t o r s ) . i s ( ' u l : n o t ( . o _ c h e c k l i s t ) ' ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " i n s e r t O r d e r e d L i s t " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . a n c e s t o r s ) . i s ( ' o l ' ) ) ; $ c o n t a i n e r . f i n d ( ' b u t t o n [ d a t a - e v e n t = " i n s e r t C h e c k L i s t " ] ' ) . t o g g l e C l a s s ( " a c t i v e " , $ ( o S t y l e . a n c e s t o r s ) . i s ( ' u l . o _ c h e c k l i s t ' ) ) ; } ; v a r   f n _ p o p o v e r _ u p d a t e = e v e n t H a n d l e r . m o d u l e s . p o p o v e r . u p d a t e ; e v e n t H a n d l e r . m o d u l e s . p o p o v e r . u p d a t e = f u n c t i o n ( $ p o p o v e r , o S t y l e , i s A i r M o d e ) { v a r   $ i m a g e P o p o v e r = $ p o p o v e r . f i n d ( ' . n o t e - i m a g e - p o p o v e r ' ) ; v a r   $ l i n k P o p o v e r = $ p o p o v e r . f i n d ( ' . n o t e - l i n k - p o p o v e r ' ) ; v a r   $ a i r P o p o v e r = $ p o p o v e r . f i n d ( ' . n o t e - a i r - p o p o v e r ' ) ; f n _ p o p o v e r _ u p d a t e . c a l l ( t h i s , $ p o p o v e r , o S t y l e , i s A i r M o d e ) ; i f ( o S t y l e . i m a g e ) { i f ( o S t y l e . i m a g e . p a r e n t N o d e . c l a s s N a m e . m a t c h ( / ( ^ | \ s ) m e d i a _ i f r a m e _ v i d e o ( \ s | $ ) / i ) ) { o S t y l e . i m a g e = o S t y l e . i m a g e . p a r e n t N o d e ; } 
 v a r   a l t = $ ( o S t y l e . i m a g e ) . a t t r ( " a l t " ) ; $ i m a g e P o p o v e r . f i n d ( ' . o _ i m a g e _ a l t ' ) . t e x t ( ( a l t | | " " ) . r e p l a c e ( / & q u o t ; / g , ' " ' ) ) . p a r e n t ( ) . t o g g l e ( o S t y l e . i m a g e . t a g N a m e = = = " I M G " ) ; $ i m a g e P o p o v e r . s h o w ( ) ; v a r   t a r g e t _ n o d e = o S t y l e . i m a g e ; i f ( ! o S t y l e . i m a g e . c l a s s N a m e . m a t c h ( / ( ^ | \ s ) m e d i a _ i f r a m e _ v i d e o ( \ s | $ ) / i ) ) { t a r g e t _ n o d e = d o m . f i r s t C h i l d ( t a r g e t _ n o d e ) ; } 
 r a n g e . c r e a t e F r o m N o d e ( t a r g e t _ n o d e ) . s e l e c t ( ) ; e v e n t H a n d l e r . m o d u l e s . e d i t o r . s a v e R a n g e ( d o m . m a k e L a y o u t I n f o ( t a r g e t _ n o d e ) . e d i t a b l e ( ) ) ; } e l s e { $ ( " . n o t e - c o n t r o l - s e l e c t i o n " ) . h i d e ( ) ; } 
 i f ( o S t y l e . i m a g e | | ( o S t y l e . r a n g e & & ( ! o S t y l e . r a n g e . i s C o l l a p s e d ( ) | | ( o S t y l e . r a n g e . s c . t a g N a m e & & ! d o m . i s A n c h o r ( o S t y l e . r a n g e . s c ) ) ) ) | | ( o S t y l e . i m a g e & & ! $ ( o S t y l e . i m a g e ) . c l o s e s t ( ' a ' ) . l e n g t h ) ) { $ l i n k P o p o v e r . h i d e ( ) ; o S t y l e . a n c h o r = f a l s e ; } 
 i f ( o S t y l e . i m a g e | | o S t y l e . a n c h o r | | ( o S t y l e . r a n g e & & ! $ ( o S t y l e . r a n g e . s c ) . c l o s e s t ( ' . n o t e - e d i t a b l e ' ) . l e n g t h ) ) { $ a i r P o p o v e r . h i d e ( ) ; } e l s e { $ a i r P o p o v e r . s h o w ( ) ; } 
 c o n s t   $ e x t e r n a l H i s t o r y B u t t o n s = $ ( ' . o _ w e _ e x t e r n a l _ h i s t o r y _ b u t t o n s ' ) ; i f ( $ e x t e r n a l H i s t o r y B u t t o n s . l e n g t h ) { c o n s t   $ n o t e H i s t o r y = $ ( ' . n o t e - h i s t o r y ' ) ; $ n o t e H i s t o r y . a d d C l a s s ( ' d - n o n e ' ) ; $ e x t e r n a l H i s t o r y B u t t o n s . f i n d ( ' : f i r s t - c h i l d ' ) . p r o p ( ' d i s a b l e d ' , $ n o t e H i s t o r y . f i n d ( ' [ d a t a - e v e n t = u n d o ] ' ) . p r o p ( ' d i s a b l e d ' ) ) ; $ e x t e r n a l H i s t o r y B u t t o n s . f i n d ( ' : l a s t - c h i l d ' ) . p r o p ( ' d i s a b l e d ' , $ n o t e H i s t o r y . f i n d ( ' [ d a t a - e v e n t = r e d o ] ' ) . p r o p ( ' d i s a b l e d ' ) ) ; } 
 $ p o p o v e r . t r i g g e r ( ' s u m m e r n o t e _ p o p o v e r _ u p d a t e _ c a l l ' ) ; } ; v a r   f n _ h a n d l e _ u p d a t e = e v e n t H a n d l e r . m o d u l e s . h a n d l e . u p d a t e ; e v e n t H a n d l e r . m o d u l e s . h a n d l e . u p d a t e = f u n c t i o n ( $ h a n d l e , o S t y l e , i s A i r M o d e ) { f n _ h a n d l e _ u p d a t e . c a l l ( t h i s , $ h a n d l e , o S t y l e , i s A i r M o d e ) ; i f ( o S t y l e . i m a g e ) { $ h a n d l e . f i n d ( ' . n o t e - c o n t r o l - s e l e c t i o n ' ) . h i d e ( ) ; } } ; f u n c t i o n   g e t I m g T a r g e t ( $ e d i t a b l e ) { v a r   $ h a n d l e = $ e d i t a b l e ? d o m . m a k e L a y o u t I n f o ( $ e d i t a b l e ) . h a n d l e ( ) : u n d e f i n e d ; r e t u r n   $ ( " . n o t e - c o n t r o l - s e l e c t i o n " , $ h a n d l e ) . d a t a ( ' t a r g e t ' ) ; } 
 e v e n t H a n d l e r . m o d u l e s . e d i t o r . p a d d i n g = f u n c t i o n ( $ e d i t a b l e , s V a l u e ) { v a r   $ t a r g e t = $ ( g e t I m g T a r g e t ( $ e d i t a b l e ) ) ; v a r   p a d d i n g s = " s m a l l   m e d i u m   l a r g e   x l " . s p l i t ( / \ s + / ) ; $ e d i t a b l e . d a t a ( ' N o t e H i s t o r y ' ) . r e c o r d U n d o ( ) ; i f ( s V a l u e . l e n g t h ) { p a d d i n g s . s p l i c e ( p a d d i n g s . i n d e x O f ( s V a l u e ) , 1 ) ; $ t a r g e t . t o g g l e C l a s s ( ' p a d d i n g - ' + s V a l u e ) ; } 
 $ t a r g e t . r e m o v e C l a s s ( " p a d d i n g - " + p a d d i n g s . j o i n ( "   p a d d i n g - " ) ) ; } ; e v e n t H a n d l e r . m o d u l e s . e d i t o r . r e s i z e = f u n c t i o n ( $ e d i t a b l e , s V a l u e ) { v a r   $ t a r g e t = $ ( g e t I m g T a r g e t ( $ e d i t a b l e ) ) ; $ e d i t a b l e . d a t a ( ' N o t e H i s t o r y ' ) . r e c o r d U n d o ( ) ; v a r   w i d t h = ( $ t a r g e t . a t t r ( ' s t y l e ' ) | | ' ' ) . m a t c h ( / ( ^ | ; | \ s ) w i d t h : \ s * ( [ 0 - 9 ] + ) % / ) ; i f ( w i d t h ) { w i d t h = w i d t h [ 2 ] / 1 0 0 ; } 
 $ t a r g e t . c s s ( ' w i d t h ' , ( w i d t h ! = = s V a l u e & & s V a l u e ! = = " a u t o " ) ? ( s V a l u e * 1 0 0 ) + ' % ' : ' ' ) ; } ; e v e n t H a n d l e r . m o d u l e s . e d i t o r . r e s i z e f a = f u n c t i o n ( $ e d i t a b l e , s V a l u e ) { v a r   $ t a r g e t = $ ( g e t I m g T a r g e t ( $ e d i t a b l e ) ) ; $ e d i t a b l e . d a t a ( ' N o t e H i s t o r y ' ) . r e c o r d U n d o ( ) ; $ t a r g e t . a t t r ( ' c l a s s ' , $ t a r g e t . a t t r ( ' c l a s s ' ) . r e p l a c e ( / \ s * f a - [ 0 - 9 ] + x / g , ' ' ) ) ; i f ( + s V a l u e > 1 ) { $ t a r g e t . a d d C l a s s ( ' f a - ' + s V a l u e + ' x ' ) ; } } ; e v e n t H a n d l e r . m o d u l e s . e d i t o r . f l o a t M e = f u n c t i o n ( $ e d i t a b l e , s V a l u e ) { v a r   $ t a r g e t = $ ( g e t I m g T a r g e t ( $ e d i t a b l e ) ) ; $ e d i t a b l e . d a t a ( ' N o t e H i s t o r y ' ) . r e c o r d U n d o ( ) ; s w i t c h ( s V a l u e ) { c a s e ' c e n t e r ' : $ t a r g e t . t o g g l e C l a s s ( ' d - b l o c k   m x - a u t o ' ) . r e m o v e C l a s s ( ' f l o a t - r i g h t   f l o a t - l e f t ' ) ; b r e a k ; c a s e ' l e f t ' : $ t a r g e t . t o g g l e C l a s s ( ' f l o a t - l e f t ' ) . r e m o v e C l a s s ( ' f l o a t - r i g h t   d - b l o c k   m x - a u t o ' ) ; b r e a k ; c a s e ' r i g h t ' : $ t a r g e t . t o g g l e C l a s s ( ' f l o a t - r i g h t ' ) . r e m o v e C l a s s ( ' f l o a t - l e f t   d - b l o c k   m x - a u t o ' ) ; b r e a k ; } } ; e v e n t H a n d l e r . m o d u l e s . e d i t o r . i m a g e S h a p e = f u n c t i o n ( $ e d i t a b l e , s V a l u e ) { v a r   $ t a r g e t = $ ( g e t I m g T a r g e t ( $ e d i t a b l e ) ) ; $ e d i t a b l e . d a t a ( ' N o t e H i s t o r y ' ) . r e c o r d U n d o ( ) ; $ t a r g e t . t o g g l e C l a s s ( s V a l u e ) ; } ; e v e n t H a n d l e r . m o d u l e s . l i n k D i a l o g . s h o w L i n k D i a l o g = f u n c t i o n ( $ e d i t a b l e , $ d i a l o g , l i n k I n f o ) { $ e d i t a b l e . d a t a ( ' r a n g e ' ) . s e l e c t ( ) ; $ e d i t a b l e . d a t a ( ' N o t e H i s t o r y ' ) . r e c o r d U n d o ( ) ; v a r   c o m m o n A n c e s t o r = l i n k I n f o . r a n g e . c o m m o n A n c e s t o r ( ) ; i f ( c o m m o n A n c e s t o r & & c o m m o n A n c e s t o r . c l o s e s t ) { v a r   l i n k = c o m m o n A n c e s t o r . c l o s e s t ( ' a ' ) ; l i n k I n f o . c l a s s N a m e = l i n k & & l i n k . c l a s s N a m e ; } 
 v a r   d e f = n e w   $ . D e f e r r e d ( ) ; t o p B u s . t r i g g e r ( ' l i n k _ d i a l o g _ d e m a n d ' , { $ e d i t a b l e : $ e d i t a b l e , l i n k I n f o : l i n k I n f o , o n S a v e : f u n c t i o n ( l i n k I n f o ) { l i n k I n f o . r a n g e . s e l e c t ( ) ; $ e d i t a b l e . d a t a ( ' r a n g e ' , l i n k I n f o . r a n g e ) ; d e f . r e s o l v e ( l i n k I n f o ) ; $ e d i t a b l e . t r i g g e r ( ' k e y u p ' ) ; $ ( ' . n o t e - p o p o v e r   . n o t e - l i n k - p o p o v e r ' ) . s h o w ( ) ; } , o n C a n c e l : d e f . r e j e c t . b i n d ( d e f ) , } ) ; r e t u r n   d e f ; } ; e v e n t H a n d l e r . m o d u l e s . i m a g e D i a l o g . s h o w I m a g e D i a l o g = f u n c t i o n ( $ e d i t a b l e ) { v a r   r = $ e d i t a b l e . d a t a ( ' r a n g e ' ) ; i f ( r . s c . t a g N a m e & & r . s c . c h i l d N o d e s . l e n g t h ) { r . s c = r . s c . c h i l d N o d e s [ r . s o ] ; } 
 v a r   m e d i a = $ ( r . s c ) . p a r e n t s ( ) . a d d B a c k ( ) . f i l t e r ( f u n c t i o n ( i , e l ) { r e t u r n   d o m . i s I m g ( e l ) ; } ) [ 0 ] ; v a r   o p t i o n s = $ e d i t a b l e . c l o s e s t ( ' . o _ e d i t a b l e ,   . n o t e - e d i t o r ' ) . d a t a ( ' o p t i o n s ' ) ; t o p B u s . t r i g g e r ( ' m e d i a _ d i a l o g _ d e m a n d ' , { $ e d i t a b l e : $ e d i t a b l e , m e d i a : m e d i a , o p t i o n s : { o n U p l o a d : $ e d i t a b l e . d a t a ( ' c a l l b a c k s ' ) . o n U p l o a d , n o V i d e o s : o p t i o n s & & o p t i o n s . n o V i d e o s , } , o n S a v e : f u n c t i o n ( m e d i a ) { i f ( m e d i a & & ! d o c u m e n t . b o d y . c o n t a i n s ( m e d i a ) ) { r . i n s e r t N o d e ( m e d i a ) ; } ; } , } ) ; r e t u r n   n e w   $ . D e f e r r e d ( ) . r e j e c t ( ) ; } ; $ . s u m m e r n o t e . p l u g i n E v e n t s . a l t = f u n c t i o n ( e v e n t , e d i t o r , l a y o u t I n f o , s o r t e d ) { v a r   $ e d i t a b l e = l a y o u t I n f o . e d i t a b l e ( ) ; v a r   $ s e l e c t i o n = l a y o u t I n f o . h a n d l e ( ) . f i n d ( ' . n o t e - c o n t r o l - s e l e c t i o n ' ) ; t o p B u s . t r i g g e r ( ' a l t _ d i a l o g _ d e m a n d ' , { $ e d i t a b l e : $ e d i t a b l e , m e d i a : $ s e l e c t i o n . d a t a ( ' t a r g e t ' ) , } ) ; } ; $ . s u m m e r n o t e . p l u g i n E v e n t s . c r o p I m a g e = f u n c t i o n ( e v e n t , e d i t o r , l a y o u t I n f o , s o r t e d ) { v a r   $ e d i t a b l e = l a y o u t I n f o . e d i t a b l e ( ) ; v a r   $ s e l e c t i o n = l a y o u t I n f o . h a n d l e ( ) . f i n d ( ' . n o t e - c o n t r o l - s e l e c t i o n ' ) ; t o p B u s . t r i g g e r ( ' c r o p _ i m a g e _ d e m a n d ' , { $ e d i t a b l e : $ e d i t a b l e , m e d i a : $ s e l e c t i o n . d a t a ( ' t a r g e t ' ) , } ) ; } ; v a r   f n _ i s _ v o i d = d o m . i s V o i d | | f u n c t i o n ( ) { } ; d o m . i s V o i d = f u n c t i o n ( n o d e ) { r e t u r n   f n _ i s _ v o i d ( n o d e ) | | d o m . i s I m g F o n t ( n o d e ) | | ( n o d e & & n o d e . c l a s s N a m e & & n o d e . c l a s s N a m e . m a t c h ( / ( ^ | \ s ) m e d i a _ i f r a m e _ v i d e o ( \ s | $ ) / i ) ) ; } ; v a r   f n _ i s _ i m g = d o m . i s I m g | | f u n c t i o n ( ) { } ; d o m . i s I m g = f u n c t i o n ( n o d e ) { r e t u r n   f n _ i s _ i m g ( n o d e ) | | d o m . i s I m g F o n t ( n o d e ) | | ( n o d e & & ( n o d e . n o d e N a m e = = = " I M G " | | ( n o d e . c l a s s N a m e & & n o d e . c l a s s N a m e . m a t c h ( / ( ^ | \ s ) ( m e d i a _ i f r a m e _ v i d e o | o _ i m a g e ) ( \ s | $ ) / i ) ) ) ) ; } ; v a r   f n _ i s _ f o r b i d d e n _ n o d e = d o m . i s F o r b i d d e n N o d e | | f u n c t i o n ( ) { } ; d o m . i s F o r b i d d e n N o d e = f u n c t i o n ( n o d e ) { i f ( n o d e . t a g N a m e = = = " B R " ) { r e t u r n   f a l s e ; } 
 r e t u r n   f n _ i s _ f o r b i d d e n _ n o d e ( n o d e ) | | $ ( n o d e ) . i s ( " . m e d i a _ i f r a m e _ v i d e o " ) ; } ; v a r   f n _ i s _ i m g _ f o n t = d o m . i s I m g F o n t | | f u n c t i o n ( ) { } ; d o m . i s I m g F o n t = f u n c t i o n ( n o d e ) { i f ( f n _ i s _ i m g _ f o n t ( n o d e ) ) r e t u r n   t r u e ; v a r   n o d e N a m e = n o d e & & n o d e . n o d e N a m e . t o U p p e r C a s e ( ) ; v a r   c l a s s N a m e = ( n o d e & & n o d e . c l a s s N a m e | | " " ) ; i f ( n o d e & & ( n o d e N a m e = = = " S P A N " | | n o d e N a m e = = = " I " ) & & c l a s s N a m e . l e n g t h ) { v a r   c l a s s N a m e s = c l a s s N a m e . s p l i t ( / \ s + / ) ; f o r ( v a r   k = 0 ; k < f o n t s . f o n t I c o n s . l e n g t h ; k + + ) { i f ( _ . i n t e r s e c t i o n ( f o n t s . f o n t I c o n s [ k ] . a l i a s , c l a s s N a m e s ) . l e n g t h ) { r e t u r n   t r u e ; } } } 
 r e t u r n   f a l s e ; } ; v a r   f n _ i s _ f o n t = d o m . i s F o n t ; d o m . i s F o n t = f u n c t i o n ( n o d e ) { r e t u r n   f n _ i s _ f o n t ( n o d e ) | | d o m . i s I m g F o n t ( n o d e ) ; } ; v a r   f n _ v i s i b l e = $ . s u m m e r n o t e . p l u g i n E v e n t s . v i s i b l e ; $ . s u m m e r n o t e . p l u g i n E v e n t s . v i s i b l e = f u n c t i o n ( e v e n t , e d i t o r , l a y o u t I n f o ) { v a r   r e s = f n _ v i s i b l e . a p p l y ( t h i s , a r g u m e n t s ) ; v a r   r n g = r a n g e . c r e a t e ( ) ; i f ( ! r n g ) r e t u r n   r e s ; v a r   $ n o d e = $ ( d o m . n o d e ( r n g . s c ) ) ; i f ( ( $ n o d e . i s ( ' [ d a t a - o e - t y p e = " h t m l " ] ' ) | | $ n o d e . i s ( ' [ d a t a - o e - f i e l d = " a r c h " ] ' ) ) & & $ n o d e . h a s C l a s s ( " o _ e d i t a b l e " ) & & ! $ n o d e [ 0 ] . c h i l d r e n . l e n g t h & & " h 1   h 2   h 3   h 4   h 5   h 6   p   b   b o l d   i   u   c o d e   s u p   s t r o n g   s m a l l   p r e   t h   t d   s p a n   l a b e l " . t o U p p e r C a s e ( ) . i n d e x O f ( $ n o d e [ 0 ] . n o d e N a m e ) = = = - 1 ) { v a r   p = $ ( ' < p > < b r / > < / p > ' ) [ 0 ] ; $ n o d e . a p p e n d ( p ) ; r a n g e . c r e a t e F r o m N o d e ( p . f i r s t C h i l d ) . s e l e c t ( ) ; } 
 r e t u r n   r e s ; } ; f u n c t i o n   p r e t t i f y _ h t m l ( h t m l ) { h t m l = h t m l . t r i m ( ) ; v a r   r e s u l t = ' ' , l e v e l = 0 , g e t _ s p a c e = f u n c t i o n ( l e v e l ) { v a r   i = l e v e l , s p a c e = ' ' ; w h i l e ( i - - ) s p a c e + = '     ' ; r e t u r n   s p a c e ; } , r e g = / ^ < \ / ? ( a | s p a n | f o n t | u | e m | i | s t r o n g | b ) ( \ s | > ) / i , i n l i n e _ l e v e l = I n f i n i t y , t o k e n s = _ . c o m p a c t ( _ . f l a t t e n ( _ . m a p ( h t m l . s p l i t ( / < / ) , f u n c t i o n ( v a l u e ) { v a l u e = v a l u e . r e p l a c e ( / \ s + / g , '   ' ) . s p l i t ( / > / ) ; v a l u e [ 0 ] = / \ S / . t e s t ( v a l u e [ 0 ] ) ? ' < ' + v a l u e [ 0 ] + ' > ' : ' ' ; r e t u r n   v a l u e ; } ) ) ) ; f o r ( v a r   i = 0 , l = t o k e n s . l e n g t h ; i < l ; i + + ) { v a r   t o k e n = t o k e n s [ i ] ; v a r   i n l i n e _ t a g = r e g . t e s t ( t o k e n ) ; v a r   i n l i n e = i n l i n e _ t a g | | i n l i n e _ l e v e l < = l e v e l ; i f ( t o k e n [ 0 ] = = = ' < ' & & t o k e n [ 1 ] = = = ' / ' ) { i f ( i n l i n e _ t a g & & i n l i n e _ l e v e l = = = l e v e l ) { i n l i n e _ l e v e l = I n f i n i t y ; } 
 l e v e l - - ; } 
 i f ( ! i n l i n e & & ! / \ S / . t e s t ( t o k e n ) ) { c o n t i n u e ; } 
 i f ( ! i n l i n e | | ( t o k e n [ 1 ] ! = = ' / ' & & i n l i n e _ l e v e l > l e v e l ) ) { r e s u l t + = g e t _ s p a c e ( l e v e l ) ; } 
 i f ( t o k e n [ 0 ] = = = ' < ' & & t o k e n [ 1 ] ! = = ' / ' ) { l e v e l + + ; i f ( i n l i n e _ t a g & & i n l i n e _ l e v e l > l e v e l ) { i n l i n e _ l e v e l = l e v e l ; } } 
 i f ( t o k e n . m a t c h ( / ^ < ( i m g | h r | b r ) / ) ) { l e v e l - - ; } 
 i f ( ! i n l i n e ) { t o k e n = t o k e n . t r i m ( ) ; } 
 r e s u l t + = t o k e n . r e p l a c e ( / \ s + / , '   ' ) ; i f ( i n l i n e _ l e v e l > l e v e l ) { r e s u l t + = ' \ n ' ; } } 
 r e t u r n   r e s u l t ; } 
 $ . s u m m e r n o t e . p l u g i n E v e n t s . c o d e v i e w = f u n c t i o n ( e v e n t , e d i t o r , l a y o u t I n f o , e n a b l e ) { i f ( ! l a y o u t I n f o ) { r e t u r n ; } 
 i f ( l a y o u t I n f o . t o o l b a r ) { v a r   i s _ a c t i v a t e d = $ . s u m m e r n o t e . e v e n t H a n d l e r . m o d u l e s . c o d e v i e w . i s A c t i v a t e d ( l a y o u t I n f o ) ; i f ( i s _ a c t i v a t e d = = = e n a b l e ) { r e t u r n ; } 
 r e t u r n   e v e n t H a n d l e r . m o d u l e s . c o d e v i e w . t o g g l e ( l a y o u t I n f o ) ; } e l s e { v a r   $ e d i t o r = l a y o u t I n f o . e d i t o r ( ) ; v a r   $ t e x t a r e a = $ e d i t o r . p r e v ( ' t e x t a r e a ' ) ; i f ( $ t e x t a r e a . i s ( ' t e x t a r e a ' ) = = = e n a b l e ) { r e t u r n ; } 
 i f ( ! $ t e x t a r e a . l e n g t h ) { v a r   h t m l = p r e t t i f y _ h t m l ( $ e d i t o r . p r o p ( " i n n e r H T M L " ) ) ; $ e d i t o r . p a r e n t ( ) . c s s ( { ' p o s i t i o n ' : ' a b s o l u t e ' , ' t o p ' : 0 , ' b o t t o m ' : 0 , ' l e f t ' : 0 , ' r i g h t ' : 0 } ) ; $ t e x t a r e a = $ ( ' < t e x t a r e a / > ' ) . c s s ( { ' m a r g i n ' : ' 0   - 4 p x ' , ' p a d d i n g ' : ' 0   4 p x ' , ' b o r d e r ' : 0 , ' t o p ' : ' 5 1 p x ' , ' l e f t ' : ' 6 2 0 p x ' , ' w i d t h ' : ' 1 0 0 % ' , ' f o n t - f a m i l y ' : ' s a n s - s e r i f ' , ' f o n t - s i z e ' : ' 1 3 p x ' , ' h e i g h t ' : ' 9 8 % ' , ' w h i t e - s p a c e ' : ' p r e ' , ' w o r d - w r a p ' : ' n o r m a l ' } ) . v a l ( h t m l ) . d a t a ( ' i n i t ' , h t m l ) ; $ e d i t o r . b e f o r e ( $ t e x t a r e a ) ; $ e d i t o r . h i d e ( ) ; } e l s e { $ e d i t o r . p r o p ( ' i n n e r H T M L ' , $ t e x t a r e a . v a l ( ) . r e p l a c e ( / \ s * \ n \ s * / g , ' ' ) ) . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; $ t e x t a r e a . r e m o v e ( ) ; $ e d i t o r . s h o w ( ) ; } } } ; v a r   l a s t _ d i v ; v a r   l a s t _ d i v _ c h a n g e ; v a r   l a s t _ e d i t a b l e ; v a r   i n i t i a l _ d a t a = { } ; f u n c t i o n   r e R a n g e S e l e c t K e y ( e v e n t ) { i n i t i a l _ d a t a . r a n g e = n u l l ; i f ( e v e n t . s h i f t K e y & & e v e n t . k e y C o d e > = 3 7 & & e v e n t . k e y C o d e < = 4 0 & & ! $ ( e v e n t . t a r g e t ) . i s ( " i n p u t ,   t e x t a r e a ,   s e l e c t " ) ) { v a r   r = r a n g e . c r e a t e ( ) ; i f ( r ) { v a r   r n g = r . r e R a n g e ( e v e n t . k e y C o d e < = 3 8 ) ; i f ( r ! = = r n g ) { r n g . s e l e c t ( ) ; } } } } 
 f u n c t i o n   r e R a n g e S e l e c t ( e v e n t , d x , d y ) { v a r   r = r a n g e . c r e a t e ( ) ; i f ( ! r | | r . i s C o l l a p s e d ( ) ) r e t u r n ; v a r   d a t a = r . r e R a n g e ( d y < 0 | | ( d y = = = 0 & & d x < 0 ) ) ; i f ( d a t a . s c ! = = r . s c | | d a t a . s o ! = = r . s o | | d a t a . e c ! = = r . e c | | d a t a . e o ! = = r . e o ) { s e t T i m e o u t ( f u n c t i o n ( ) { d a t a . s e l e c t ( ) ; $ ( d a t a . s c . p a r e n t N o d e ) . c l o s e s t ( ' . n o t e - p o p o v e r ' ) ; } , 0 ) ; } 
 $ ( d a t a . s c ) . c l o s e s t ( ' . o _ e d i t a b l e ' ) . d a t a ( ' r a n g e ' , r ) ; r e t u r n   r ; } 
 f u n c t i o n   s u m m e r n o t e _ m o u s e u p ( e v e n t ) { i f ( $ ( e v e n t . t a r g e t ) . c l o s e s t ( " # w e b _ e d i t o r - t o p - n a v b a r ,   . n o t e - p o p o v e r " ) . l e n g t h ) { r e t u r n ; } 
 i f ( i n i t i a l _ d a t a . e v e n t ) { v a r   d x = e v e n t . c l i e n t X - ( e v e n t . s h i f t K e y & & i n i t i a l _ d a t a . r e c t ? i n i t i a l _ d a t a . r e c t . l e f t : i n i t i a l _ d a t a . e v e n t . c l i e n t X ) ; v a r   d y = e v e n t . c l i e n t Y - ( e v e n t . s h i f t K e y & & i n i t i a l _ d a t a . r e c t ? i n i t i a l _ d a t a . r e c t . t o p : i n i t i a l _ d a t a . e v e n t . c l i e n t Y ) ; i f ( 1 0 < M a t h . p o w ( d x , 2 ) + M a t h . p o w ( d y , 2 ) ) { r e R a n g e S e l e c t ( e v e n t , d x , d y ) ; } } 
 i f ( ! $ ( e v e n t . t a r g e t ) . c l o s e s t ( " . o _ e d i t a b l e " ) . l e n g t h ) { r e t u r n ; } 
 i f ( ! i n i t i a l _ d a t a . r a n g e | | ! e v e n t . s h i f t K e y ) { s e t T i m e o u t ( f u n c t i o n ( ) { i n i t i a l _ d a t a . r a n g e = r a n g e . c r e a t e ( ) ; } , 0 ) ; } } 
 v a r   r e m e m b e r _ s e l e c t i o n ; f u n c t i o n   s u m m e r n o t e _ m o u s e d o w n ( e v e n t ) { r t e . h i s t o r y . s p l i t N e x t ( ) ; v a r   $ e d i t a b l e = $ ( e v e n t . t a r g e t ) . c l o s e s t ( " . o _ e d i t a b l e ,   . n o t e - e d i t o r " ) ; v a r   r ; i f ( d o c u m e n t . d o c u m e n t M o d e ) { s u m m e r n o t e _ i e _ f i x ( e v e n t , f u n c t i o n ( n o d e ) { r e t u r n   n o d e . t a g N a m e = = = " D I V " | | n o d e . t a g N a m e = = = " I M G " | | ( n o d e . d a t a s e t & & n o d e . d a t a s e t . o e M o d e l ) ; } ) ; } e l s e   i f ( l a s t _ d i v & & e v e n t . t a r g e t ! = = l a s t _ d i v ) { i f ( l a s t _ d i v . t a g N a m e = = = " A " ) { s u m m e r n o t e _ i e _ f i x ( e v e n t , f u n c t i o n ( n o d e ) { r e t u r n   n o d e . d a t a s e t & & n o d e . d a t a s e t . o e M o d e l ; } ) ; } e l s e   i f ( $ e d i t a b l e . l e n g t h ) { i f ( s u m m e r n o t e _ i e _ f i x ( e v e n t , f u n c t i o n ( n o d e ) { r e t u r n   n o d e . t a g N a m e = = = " A " ; } ) ) { r = r a n g e . c r e a t e ( ) ; r . s e l e c t ( ) ; } } } 
 t r y { r = r a n g e . c r e a t e ( ) ; } c a t c h ( e ) { r e t u r n ; } 
 v a r   e d i t a b l e s = $ ( " . o _ e d i t a b l e [ c o n t e n t e d i t a b l e ] ,   . n o t e - e d i t a b l e [ c o n t e n t e d i t a b l e ] " ) ; v a r   r _ e d i t a b l e = e d i t a b l e s . h a s ( ( r | | { } ) . s c ) . a d d B a c k ( e d i t a b l e s . f i l t e r ( ( r | | { } ) . s c ) ) ; i f ( ! r _ e d i t a b l e . c l o s e s t ( ' . n o t e - e d i t o r ' ) . i s ( $ e d i t a b l e ) & & ! r _ e d i t a b l e . f i l t e r ( ' . o _ e d i t a b l e ' ) . i s ( e d i t a b l e s ) ) { v a r   s a v e d _ e d i t a b l e = e d i t a b l e s . h a s ( ( r e m e m b e r _ s e l e c t i o n | | { } ) . s c ) ; i f ( $ e d i t a b l e . l e n g t h & & ! s a v e d _ e d i t a b l e . c l o s e s t ( ' . o _ e d i t a b l e ,   . n o t e - e d i t o r ' ) . i s ( $ e d i t a b l e ) ) { r e m e m b e r _ s e l e c t i o n = r a n g e . c r e a t e ( d o m . f i r s t C h i l d ( $ e d i t a b l e [ 0 ] ) , 0 ) ; } e l s e   i f ( ! s a v e d _ e d i t a b l e . l e n g t h ) { r e m e m b e r _ s e l e c t i o n = u n d e f i n e d ; } 
 i f ( r e m e m b e r _ s e l e c t i o n ) { t r y { r e m e m b e r _ s e l e c t i o n . s e l e c t ( ) ; } c a t c h ( e ) { c o n s o l e . w a r n ( e ) ; } } } e l s e   i f ( r _ e d i t a b l e . l e n g t h ) { r e m e m b e r _ s e l e c t i o n = r ; } 
 i n i t i a l _ d a t a . e v e n t = e v e n t ; i f ( e v e n t . s h i f t K e y & & $ e d i t a b l e . l e n g t h ) { i f ( i n i t i a l _ d a t a . r a n g e ) { i n i t i a l _ d a t a . r a n g e . s e l e c t ( ) ; } 
 v a r   r e c t = r & & r . g e t C l i e n t R e c t s ( ) ; i n i t i a l _ d a t a . r e c t = r e c t & & r e c t . l e n g t h ? r e c t [ 0 ] : { t o p : 0 , l e f t : 0 } ; } } 
 f u n c t i o n   s u m m e r n o t e _ i e _ f i x ( e v e n t , p r e d ) { v a r   e d i t a b l e ; v a r   d i v ; v a r   n o d e = e v e n t . t a r g e t ; w h i l e ( n o d e . p a r e n t N o d e ) { i f ( ! d i v & & p r e d ( n o d e ) ) { d i v = n o d e ; } 
 i f ( l a s t _ d i v ! = = n o d e & & ( n o d e . g e t A t t r i b u t e ( ' c o n t e n t E d i t a b l e ' ) = = = ' f a l s e ' | | n o d e . c l a s s N a m e & & ( n o d e . c l a s s N a m e . i n d e x O f ( ' o _ n o t _ e d i t a b l e ' ) ! = = - 1 ) ) ) { b r e a k ; } 
 i f ( n o d e . c l a s s N a m e & & n o d e . c l a s s N a m e . i n d e x O f ( ' o _ e d i t a b l e ' ) ! = = - 1 ) { i f ( ! d i v ) { d i v = n o d e ; } 
 e d i t a b l e = n o d e ; b r e a k ; } 
 n o d e = n o d e . p a r e n t N o d e ; } 
 i f ( ! e d i t a b l e ) { $ ( l a s t _ d i v _ c h a n g e ) . r e m o v e A t t r ( " c o n t e n t E d i t a b l e " ) . r e m o v e P r o p ( " c o n t e n t E d i t a b l e " ) ; $ ( l a s t _ e d i t a b l e ) . a t t r ( " c o n t e n t E d i t a b l e " , " t r u e " ) . p r o p ( " c o n t e n t E d i t a b l e " , " t r u e " ) ; l a s t _ d i v _ c h a n g e = n u l l ; l a s t _ e d i t a b l e = n u l l ; r e t u r n ; } 
 i f ( d i v = = = l a s t _ d i v ) { r e t u r n ; } 
 l a s t _ d i v = d i v ; $ ( l a s t _ d i v _ c h a n g e ) . r e m o v e A t t r ( " c o n t e n t E d i t a b l e " ) . r e m o v e P r o p ( " c o n t e n t E d i t a b l e " ) ; i f ( l a s t _ e d i t a b l e ! = = e d i t a b l e ) { i f ( $ ( e d i t a b l e ) . i s ( " [ c o n t e n t E d i t a b l e = ' t r u e ' ] " ) ) { $ ( e d i t a b l e ) . r e m o v e A t t r ( " c o n t e n t E d i t a b l e " ) . r e m o v e P r o p ( " c o n t e n t E d i t a b l e " ) ; l a s t _ e d i t a b l e = e d i t a b l e ; } e l s e { l a s t _ e d i t a b l e = n u l l ; } } 
 i f ( ! $ ( d i v ) . a t t r ( " c o n t e n t E d i t a b l e " ) & & ! $ ( d i v ) . i s ( " [ d a t a - o e - t y p e = ' m a n y 2 o n e ' ] ,   [ d a t a - o e - t y p e = ' c o n t a c t ' ] " ) ) { $ ( d i v ) . a t t r ( " c o n t e n t E d i t a b l e " , " t r u e " ) . p r o p ( " c o n t e n t E d i t a b l e " , " t r u e " ) ; l a s t _ d i v _ c h a n g e = d i v ; } e l s e { l a s t _ d i v _ c h a n g e = n u l l ; } 
 r e t u r n   e d i t a b l e ! = = d i v ? d i v : n u l l ; } 
 v a r   f n _ a t t a c h = e v e n t H a n d l e r . a t t a c h ; e v e n t H a n d l e r . a t t a c h = f u n c t i o n ( o L a y o u t I n f o , o p t i o n s ) { f n _ a t t a c h . c a l l ( t h i s , o L a y o u t I n f o , o p t i o n s ) ; o L a y o u t I n f o . e d i t o r ( ) . o n ( ' d r a g s t a r t ' , ' i m g ' , f u n c t i o n ( e ) { e . p r e v e n t D e f a u l t ( ) ; } ) ; $ ( d o c u m e n t ) . o n ( ' m o u s e d o w n ' , s u m m e r n o t e _ m o u s e d o w n ) . o n ( ' m o u s e u p ' , s u m m e r n o t e _ m o u s e u p ) ; o L a y o u t I n f o . e d i t o r ( ) . o f f ( ' c l i c k ' ) . o n ( ' c l i c k ' , f u n c t i o n ( e ) { e . p r e v e n t D e f a u l t ( ) ; } ) ; c r e a t e _ d b l c l i c k _ f e a t u r e ( " i m g ,   . m e d i a _ i f r a m e _ v i d e o ,   i . f a ,   s p a n . f a ,   a . o _ i m a g e " , f u n c t i o n ( ) { e v e n t H a n d l e r . m o d u l e s . i m a g e D i a l o g . s h o w ( o L a y o u t I n f o ) ; } ) ; c r e a t e _ d b l c l i c k _ f e a t u r e ( " a [ h r e f ] ,   a . b t n ,   b u t t o n . b t n " , f u n c t i o n ( ) { e v e n t H a n d l e r . m o d u l e s . l i n k D i a l o g . s h o w ( o L a y o u t I n f o ) ; } ) ; o L a y o u t I n f o . e d i t a b l e ( ) . o n ( ' m o u s e d o w n ' , f u n c t i o n ( e ) { i f ( d o m . i s I m g ( e . t a r g e t ) & & d o m . i s C o n t e n t E d i t a b l e ( e . t a r g e t ) ) { r a n g e . c r e a t e F r o m N o d e ( e . t a r g e t ) . s e l e c t ( ) ; } } ) ; $ ( d o c u m e n t ) . o n ( " k e y u p " , r e R a n g e S e l e c t K e y ) ; v a r   c l o n e _ d a t a = f a l s e ; i f ( o p t i o n s . m o d e l ) { o L a y o u t I n f o . e d i t a b l e ( ) . d a t a ( { ' o e - m o d e l ' : o p t i o n s . m o d e l , ' o e - i d ' : o p t i o n s . i d } ) ; } 
 i f ( o p t i o n s . g e t M e d i a D o m a i n ) { o L a y o u t I n f o . e d i t a b l e ( ) . d a t a ( ' o e - m e d i a - d o m a i n ' , o p t i o n s . g e t M e d i a D o m a i n ) ; } 
 v a r   $ n o d e = o L a y o u t I n f o . e d i t o r ( ) ; i f ( $ n o d e . d a t a ( ' o e - m o d e l ' ) | | $ n o d e . d a t a ( ' o e - t r a n s l a t i o n - i d ' ) ) { $ n o d e . o n ( ' c o n t e n t _ c h a n g e d ' , f u n c t i o n ( ) { v a r   $ n o d e s = $ ( ' [ d a t a - o e - m o d e l ] ,   [ d a t a - o e - t r a n s l a t i o n - i d ] ' ) . f i l t e r ( f u n c t i o n ( ) { r e t u r n   t h i s ! = = $ n o d e [ 0 ] ; } ) ; i f ( $ n o d e . d a t a ( ' o e - m o d e l ' ) ) { $ n o d e s = $ n o d e s . f i l t e r ( ' [ d a t a - o e - m o d e l = " ' + $ n o d e . d a t a ( ' o e - m o d e l ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - i d = " ' + $ n o d e . d a t a ( ' o e - i d ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - f i e l d = " ' + $ n o d e . d a t a ( ' o e - f i e l d ' ) + ' " ] ' ) ; } 
 i f ( $ n o d e . d a t a ( ' o e - t r a n s l a t i o n - i d ' ) ) $ n o d e s = $ n o d e s . f i l t e r ( ' [ d a t a - o e - t r a n s l a t i o n - i d = " ' + $ n o d e . d a t a ( ' o e - t r a n s l a t i o n - i d ' ) + ' " ] ' ) ; i f ( $ n o d e . d a t a ( ' o e - t y p e ' ) ) $ n o d e s = $ n o d e s . f i l t e r ( ' [ d a t a - o e - t y p e = " ' + $ n o d e . d a t a ( ' o e - t y p e ' ) + ' " ] ' ) ; i f ( $ n o d e . d a t a ( ' o e - e x p r e s s i o n ' ) ) $ n o d e s = $ n o d e s . f i l t e r ( ' [ d a t a - o e - e x p r e s s i o n = " ' + $ n o d e . d a t a ( ' o e - e x p r e s s i o n ' ) + ' " ] ' ) ; i f ( $ n o d e . d a t a ( ' o e - x p a t h ' ) ) $ n o d e s = $ n o d e s . f i l t e r ( ' [ d a t a - o e - x p a t h = " ' + $ n o d e . d a t a ( ' o e - x p a t h ' ) + ' " ] ' ) ; i f ( $ n o d e . d a t a ( ' o e - c o n t a c t - o p t i o n s ' ) ) $ n o d e s = $ n o d e s . f i l t e r ( ' [ d a t a - o e - c o n t a c t - o p t i o n s = " ' + $ n o d e . d a t a ( ' o e - c o n t a c t - o p t i o n s ' ) + ' " ] ' ) ; v a r   n o d e s = $ n o d e . g e t ( ) ; i f ( $ n o d e . d a t a ( ' o e - t y p e ' ) = = = " m a n y 2 o n e " ) { $ n o d e s = $ n o d e s . a d d ( $ ( ' [ d a t a - o e - m o d e l ] ' ) . f i l t e r ( f u n c t i o n ( ) { r e t u r n   t h i s ! = = $ n o d e [ 0 ] & & n o d e s . i n d e x O f ( t h i s ) = = = - 1 ; } ) . f i l t e r ( ' [ d a t a - o e - m a n y 2 o n e - m o d e l = " ' + $ n o d e . d a t a ( ' o e - m a n y 2 o n e - m o d e l ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - m a n y 2 o n e - i d = " ' + $ n o d e . d a t a ( ' o e - m a n y 2 o n e - i d ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - t y p e = " m a n y 2 o n e " ] ' ) ) ; $ n o d e s = $ n o d e s . a d d ( $ ( ' [ d a t a - o e - m o d e l ] ' ) . f i l t e r ( f u n c t i o n ( ) { r e t u r n   t h i s ! = = $ n o d e [ 0 ] & & n o d e s . i n d e x O f ( t h i s ) = = = - 1 ; } ) . f i l t e r ( ' [ d a t a - o e - m o d e l = " ' + $ n o d e . d a t a ( ' o e - m a n y 2 o n e - m o d e l ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - i d = " ' + $ n o d e . d a t a ( ' o e - m a n y 2 o n e - i d ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - f i e l d = " n a m e " ] ' ) ) ; } 
 i f ( ! c l o n e _ d a t a ) { c l o n e _ d a t a = t r u e ; $ n o d e s . h t m l ( t h i s . i n n e r H T M L ) ; c l o n e _ d a t a = f a l s e ; } } ) ; } 
 v a r   c u s t o m _ t o o l b a r = o L a y o u t I n f o . t o o l b a r ? o L a y o u t I n f o . t o o l b a r ( ) : u n d e f i n e d ; v a r   $ t o o l b a r = $ ( o L a y o u t I n f o . p o p o v e r ( ) ) . a d d ( c u s t o m _ t o o l b a r ) ; $ ( ' b u t t o n [ d a t a - e v e n t = " u n d o " ] ,   b u t t o n [ d a t a - e v e n t = " r e d o " ] ' , $ t o o l b a r ) . a t t r ( ' d i s a b l e d ' , t r u e ) ; $ ( o L a y o u t I n f o . e d i t o r ( ) ) . a d d ( o L a y o u t I n f o . h a n d l e ( ) ) . a d d ( o L a y o u t I n f o . p o p o v e r ( ) ) . a d d ( c u s t o m _ t o o l b a r ) . o n ( ' c l i c k   c o n t e n t _ c h a n g e d ' , f u n c t i o n ( ) { $ ( ' b u t t o n [ d a t a - e v e n t = " u n d o " ] ' , $ t o o l b a r ) . a t t r ( ' d i s a b l e d ' , ! o L a y o u t I n f o . e d i t a b l e ( ) . d a t a ( ' N o t e H i s t o r y ' ) . h a s U n d o ( ) ) ; $ ( ' b u t t o n [ d a t a - e v e n t = " r e d o " ] ' , $ t o o l b a r ) . a t t r ( ' d i s a b l e d ' , ! o L a y o u t I n f o . e d i t a b l e ( ) . d a t a ( ' N o t e H i s t o r y ' ) . h a s R e d o ( ) ) ; } ) ; f u n c t i o n   c r e a t e _ d b l c l i c k _ f e a t u r e ( s e l e c t o r , c a l l b a c k ) { v a r   s h o w _ t o o l t i p = t r u e ; o L a y o u t I n f o . e d i t o r ( ) . o n ( " d b l c l i c k " , s e l e c t o r , f u n c t i o n ( e ) { v a r   $ t a r g e t = $ ( e . t a r g e t ) ; i f ( ! d o m . i s C o n t e n t E d i t a b l e ( $ t a r g e t ) ) { r e t u r n ; } 
 s h o w _ t o o l t i p = f a l s e ; c a l l b a c k ( ) ; e . s t o p I m m e d i a t e P r o p a g a t i o n ( ) ; } ) ; o L a y o u t I n f o . e d i t o r ( ) . o n ( " c l i c k " , s e l e c t o r , f u n c t i o n ( e ) { v a r   $ t a r g e t = $ ( e . t a r g e t ) ; i f ( ! d o m . i s C o n t e n t E d i t a b l e ( $ t a r g e t ) ) { r e t u r n ; } 
 s h o w _ t o o l t i p = t r u e ; s e t T i m e o u t ( f u n c t i o n ( ) { i f ( ! s h o w _ t o o l t i p | | $ t a r g e t . a t t r ( ' t i t l e ' ) ! = = u n d e f i n e d ) { r e t u r n ; } 
 $ t a r g e t . t o o l t i p ( { t i t l e : _ t ( ' D o u b l e - c l i c k   t o   e d i t ' ) , t r i g g e r : ' m a n u e l ' , c o n t a i n e r : ' b o d y ' } ) . t o o l t i p ( ' s h o w ' ) ; s e t T i m e o u t ( f u n c t i o n ( ) { $ t a r g e t . t o o l t i p ( ' d i s p o s e ' ) ; } , 8 0 0 ) ; } , 4 0 0 ) ; } ) ; } } ; v a r   f n _ d e t a c h = e v e n t H a n d l e r . d e t a c h ; e v e n t H a n d l e r . d e t a c h = f u n c t i o n ( o L a y o u t I n f o , o p t i o n s ) { f n _ d e t a c h . c a l l ( t h i s , o L a y o u t I n f o , o p t i o n s ) ; o L a y o u t I n f o . e d i t a b l e ( ) . o f f ( ' m o u s e d o w n ' ) ; o L a y o u t I n f o . e d i t o r ( ) . o f f ( " d r a g s t a r t " ) ; o L a y o u t I n f o . e d i t o r ( ) . o f f ( ' c l i c k ' ) ; $ ( d o c u m e n t ) . o f f ( ' m o u s e d o w n ' , s u m m e r n o t e _ m o u s e d o w n ) ; $ ( d o c u m e n t ) . o f f ( ' m o u s e u p ' , s u m m e r n o t e _ m o u s e u p ) ; o L a y o u t I n f o . e d i t o r ( ) . o f f ( " d b l c l i c k " ) ; $ ( d o c u m e n t ) . o f f ( " k e y u p " , r e R a n g e S e l e c t K e y ) ; } ; $ . s u m m e r n o t e . l a n g . o d o o = { f o n t : { b o l d : _ t ( ' B o l d ' ) , i t a l i c : _ t ( ' I t a l i c ' ) , u n d e r l i n e : _ t ( ' U n d e r l i n e ' ) , s t r i k e t h r o u g h : _ t ( ' S t r i k e t h r o u g h ' ) , s u b s c r i p t : _ t ( ' S u b s c r i p t ' ) , s u p e r s c r i p t : _ t ( ' S u p e r s c r i p t ' ) , c l e a r : _ t ( ' R e m o v e   F o n t   S t y l e ' ) , h e i g h t : _ t ( ' L i n e   H e i g h t ' ) , n a m e : _ t ( ' F o n t   F a m i l y ' ) , s i z e : _ t ( ' F o n t   S i z e ' ) } , i m a g e : { i m a g e : _ t ( ' F i l e   /   I m a g e ' ) , i n s e r t : _ t ( ' I n s e r t   I m a g e ' ) , r e s i z e F u l l : _ t ( ' R e s i z e   F u l l ' ) , r e s i z e H a l f : _ t ( ' R e s i z e   H a l f ' ) , r e s i z e Q u a r t e r : _ t ( ' R e s i z e   Q u a r t e r ' ) , f l o a t L e f t : _ t ( ' F l o a t   L e f t ' ) , f l o a t R i g h t : _ t ( ' F l o a t   R i g h t ' ) , f l o a t N o n e : _ t ( ' F l o a t   N o n e ' ) , d r a g I m a g e H e r e : _ t ( ' D r a g   a n   i m a g e   h e r e ' ) , s e l e c t F r o m F i l e s : _ t ( ' S e l e c t   f r o m   f i l e s ' ) , u r l : _ t ( ' I m a g e   U R L ' ) , r e m o v e : _ t ( ' R e m o v e   I m a g e ' ) } , l i n k : { l i n k : _ t ( ' L i n k ' ) , i n s e r t : _ t ( ' I n s e r t   L i n k ' ) , u n l i n k : _ t ( ' U n l i n k ' ) , e d i t : _ t ( ' E d i t ' ) , t e x t T o D i s p l a y : _ t ( ' T e x t   t o   d i s p l a y ' ) , u r l : _ t ( ' T o   w h a t   U R L   s h o u l d   t h i s   l i n k   g o ? ' ) , o p e n I n N e w W i n d o w : _ t ( ' O p e n   i n   n e w   w i n d o w ' ) } , v i d e o : { v i d e o : _ t ( ' V i d e o ' ) , v i d e o L i n k : _ t ( ' V i d e o   L i n k ' ) , i n s e r t : _ t ( ' I n s e r t   V i d e o ' ) , u r l : _ t ( ' V i d e o   U R L ? ' ) , p r o v i d e r s : _ t ( ' ( Y o u T u b e ,   V i m e o ,   V i n e ,   I n s t a g r a m ,   D a i l y M o t i o n   o r   Y o u k u ) ' ) } , t a b l e : { t a b l e : _ t ( ' T a b l e ' ) } , h r : { i n s e r t : _ t ( ' I n s e r t   H o r i z o n t a l   R u l e ' ) } , s t y l e : { s t y l e : _ t ( ' S t y l e ' ) , n o r m a l : _ t ( ' N o r m a l ' ) , b l o c k q u o t e : _ t ( ' Q u o t e ' ) , p r e : _ t ( ' C o d e ' ) , s m a l l : _ t ( ' S m a l l ' ) , h 1 : _ t ( ' H e a d e r   1 ' ) , h 2 : _ t ( ' H e a d e r   2 ' ) , h 3 : _ t ( ' H e a d e r   3 ' ) , h 4 : _ t ( ' H e a d e r   4 ' ) , h 5 : _ t ( ' H e a d e r   5 ' ) , h 6 : _ t ( ' H e a d e r   6 ' ) } , l i s t s : { u n o r d e r e d : _ t ( ' U n o r d e r e d   l i s t ' ) , o r d e r e d : _ t ( ' O r d e r e d   l i s t ' ) } , o p t i o n s : { h e l p : _ t ( ' H e l p ' ) , f u l l s c r e e n : _ t ( ' F u l l   S c r e e n ' ) , c o d e v i e w : _ t ( ' C o d e   V i e w ' ) } , p a r a g r a p h : { p a r a g r a p h : _ t ( ' P a r a g r a p h ' ) , o u t d e n t : _ t ( ' O u t d e n t ' ) , i n d e n t : _ t ( ' I n d e n t ' ) , l e f t : _ t ( ' A l i g n   l e f t ' ) , c e n t e r : _ t ( ' A l i g n   c e n t e r ' ) , r i g h t : _ t ( ' A l i g n   r i g h t ' ) , j u s t i f y : _ t ( ' J u s t i f y   f u l l ' ) } , c o l o r : { c u s t o m : _ t ( ' C u s t o m   C o l o r ' ) , b a c k g r o u n d : _ t ( ' B a c k g r o u n d   C o l o r ' ) , f o r e g r o u n d : _ t ( ' F o n t   C o l o r ' ) , t r a n s p a r e n t : _ t ( ' T r a n s p a r e n t ' ) , s e t T r a n s p a r e n t : _ t ( ' N o n e ' ) , } , s h o r t c u t : { s h o r t c u t s : _ t ( ' K e y b o a r d   s h o r t c u t s ' ) , c l o s e : _ t ( ' C l o s e ' ) , t e x t F o r m a t t i n g : _ t ( ' T e x t   f o r m a t t i n g ' ) , a c t i o n : _ t ( ' A c t i o n ' ) , p a r a g r a p h F o r m a t t i n g : _ t ( ' P a r a g r a p h   f o r m a t t i n g ' ) , d o c u m e n t S t y l e : _ t ( ' D o c u m e n t   S t y l e ' ) } , h i s t o r y : { u n d o : _ t ( ' U n d o ' ) , r e d o : _ t ( ' R e d o ' ) } } ; v a r   S u m m e r n o t e M a n a g e r = C l a s s . e x t e n d ( m i x i n s . E v e n t D i s p a t c h e r M i x i n , S e r v i c e s M i x i n , { i n i t : f u n c t i o n ( p a r e n t ) { m i x i n s . E v e n t D i s p a t c h e r M i x i n . i n i t . c a l l ( t h i s ) ; t h i s . s e t P a r e n t ( p a r e n t ) ; t o p B u s . o n ( ' a l t _ d i a l o g _ d e m a n d ' , t h i s , t h i s . _ o n A l t D i a l o g D e m a n d ) ; t o p B u s . o n ( ' c r o p _ i m a g e _ d e m a n d ' , t h i s , t h i s . _ o n C r o p I m a g e D e m a n d ) ; t o p B u s . o n ( ' l i n k _ d i a l o g _ d e m a n d ' , t h i s , t h i s . _ o n L i n k D i a l o g D e m a n d ) ; t o p B u s . o n ( ' m e d i a _ d i a l o g _ d e m a n d ' , t h i s , t h i s . _ o n M e d i a D i a l o g D e m a n d ) ; } , d e s t r o y : f u n c t i o n ( ) { m i x i n s . E v e n t D i s p a t c h e r M i x i n . d e s t r o y . c a l l ( t h i s ) ; t o p B u s . o f f ( ' a l t _ d i a l o g _ d e m a n d ' , t h i s , t h i s . _ o n A l t D i a l o g D e m a n d ) ; t o p B u s . o f f ( ' c r o p _ i m a g e _ d e m a n d ' , t h i s , t h i s . _ o n C r o p I m a g e D e m a n d ) ; t o p B u s . o f f ( ' l i n k _ d i a l o g _ d e m a n d ' , t h i s , t h i s . _ o n L i n k D i a l o g D e m a n d ) ; t o p B u s . o f f ( ' m e d i a _ d i a l o g _ d e m a n d ' , t h i s , t h i s . _ o n M e d i a D i a l o g D e m a n d ) ; } , s a v e M o d i f i e d I m a g e s : f u n c t i o n ( $ e d i t a b l e ) { c o n s t   d e f s = _ . m a p ( $ e d i t a b l e , a s y n c   e d i t a b l e E l = > { c o n s t { o e M o d e l : r e s M o d e l , o e I d : r e s I d } = e d i t a b l e E l . d a t a s e t ; c o n s t   p r o m s = [ . . . e d i t a b l e E l . q u e r y S e l e c t o r A l l ( ' . o _ m o d i f i e d _ i m a g e _ t o _ s a v e ' ) ] . m a p ( a s y n c   e l = > { c o n s t   i s B a c k g r o u n d = ! e l . m a t c h e s ( ' i m g ' ) ; e l . c l a s s L i s t . r e m o v e ( ' o _ m o d i f i e d _ i m a g e _ t o _ s a v e ' ) ; c o n s t   n e w A t t a c h m e n t S r c = a w a i t   t h i s . _ r p c ( { r o u t e : ` / w e b _ e d i t o r / m o d i f y _ i m a g e / $ { e l . d a t a s e t . o r i g i n a l I d } ` , p a r a m s : { r e s _ m o d e l : r e s M o d e l , r e s _ i d : p a r s e I n t ( r e s I d ) , d a t a : ( i s B a c k g r o u n d ? e l . d a t a s e t . b g S r c : e l . g e t A t t r i b u t e ( ' s r c ' ) ) . s p l i t ( ' , ' ) [ 1 ] , } , } ) ; i f ( i s B a c k g r o u n d ) { $ ( e l ) . c s s ( ' b a c k g r o u n d - i m a g e ' , ` u r l ( ' $ { n e w A t t a c h m e n t S r c } ' ) ` ) ; d e l e t e   e l . d a t a s e t . b g S r c ; } e l s e { e l . s e t A t t r i b u t e ( ' s r c ' , n e w A t t a c h m e n t S r c ) ; } } ) ; r e t u r n   P r o m i s e . a l l ( p r o m s ) ; } ) ; r e t u r n   P r o m i s e . a l l ( d e f s ) ; } , _ o n A l t D i a l o g D e m a n d : f u n c t i o n ( d a t a ) { i f ( d a t a . _ _ a l r e a d y D o n e ) { r e t u r n ; } 
 d a t a . _ _ a l r e a d y D o n e = t r u e ; v a r   a l t D i a l o g = n e w   w e W i d g e t s . A l t D i a l o g ( t h i s , d a t a . o p t i o n s | | { } , d a t a . m e d i a ) ; i f ( d a t a . o n S a v e ) { a l t D i a l o g . o n ( ' s a v e ' , t h i s , d a t a . o n S a v e ) ; } 
 i f ( d a t a . o n C a n c e l ) { a l t D i a l o g . o n ( ' c a n c e l ' , t h i s , d a t a . o n C a n c e l ) ; } 
 a l t D i a l o g . o p e n ( ) ; } , _ o n C r o p I m a g e D e m a n d : f u n c t i o n ( d a t a ) { i f ( d a t a . _ _ a l r e a d y D o n e ) { r e t u r n ; } 
 d a t a . _ _ a l r e a d y D o n e = t r u e ; n e w   w e W i d g e t s . I m a g e C r o p W i d g e t ( t h i s , d a t a . m e d i a ) . a p p e n d T o ( d a t a . $ e d i t a b l e ) ; } , _ o n L i n k D i a l o g D e m a n d : f u n c t i o n ( d a t a ) { i f ( d a t a . _ _ a l r e a d y D o n e ) { r e t u r n ; } 
 d a t a . _ _ a l r e a d y D o n e = t r u e ; v a r   l i n k D i a l o g = n e w   w e W i d g e t s . L i n k D i a l o g ( t h i s , d a t a . o p t i o n s | | { } , d a t a . $ e d i t a b l e , d a t a . l i n k I n f o ) ; i f ( d a t a . o n S a v e ) { l i n k D i a l o g . o n ( ' s a v e ' , t h i s , d a t a . o n S a v e ) ; } 
 i f ( d a t a . o n C a n c e l ) { l i n k D i a l o g . o n ( ' c a n c e l ' , t h i s , d a t a . o n C a n c e l ) ; } 
 l i n k D i a l o g . o p e n ( ) ; } , _ o n M e d i a D i a l o g D e m a n d : f u n c t i o n ( d a t a ) { i f ( d a t a . _ _ a l r e a d y D o n e ) { r e t u r n ; } 
 d a t a . _ _ a l r e a d y D o n e = t r u e ; v a r   m e d i a D i a l o g = n e w   w e W i d g e t s . M e d i a D i a l o g ( t h i s , _ . e x t e n d ( { r e s _ m o d e l : d a t a . $ e d i t a b l e . d a t a ( ' o e - m o d e l ' ) , r e s _ i d : d a t a . $ e d i t a b l e . d a t a ( ' o e - i d ' ) , d o m a i n : d a t a . $ e d i t a b l e . d a t a ( ' o e - m e d i a - d o m a i n ' ) , } , d a t a . o p t i o n s ) , d a t a . m e d i a ) ; i f ( d a t a . o n S a v e ) { m e d i a D i a l o g . o n ( ' s a v e ' , t h i s , d a t a . o n S a v e ) ; } 
 i f ( d a t a . o n C a n c e l ) { m e d i a D i a l o g . o n ( ' c a n c e l ' , t h i s , d a t a . o n C a n c e l ) ; } 
 m e d i a D i a l o g . o p e n ( ) ; } , } ) ; r e t u r n   S u m m e r n o t e M a n a g e r ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / e d i t o r / i m a g e _ p r o c e s s i n g . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . i m a g e _ p r o c e s s i n g ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; c o n s t   c r o p p e r D a t a F i e l d s = [ ' x ' , ' y ' , ' w i d t h ' , ' h e i g h t ' , ' r o t a t e ' , ' s c a l e X ' , ' s c a l e Y ' ] ; c o n s t   m o d i f i e r F i e l d s = [ ' f i l t e r ' , ' q u a l i t y ' , ' m i m e t y p e ' , ' g l F i l t e r ' , ' o r i g i n a l I d ' , ' o r i g i n a l S r c ' , ' r e s i z e W i d t h ' , ' a s p e c t R a t i o ' , ] ; c o n s t   _ a p p l y A l l = ( r e s u l t , f i l t e r , f i l t e r s ) = > { f i l t e r s . f o r E a c h ( f = > { i f ( f [ 0 ] = = = ' b l e n d ' ) { c o n s t   c v = f [ 1 ] ; c o n s t   c t x = r e s u l t . g e t C o n t e x t ( ' 2 d ' ) ; c t x . g l o b a l C o m p o s i t e O p e r a t i o n = f [ 2 ] ; c t x . g l o b a l A l p h a = f [ 3 ] ; c t x . d r a w I m a g e ( c v , 0 , 0 ) ; c t x . g l o b a l C o m p o s i t e O p e r a t i o n = ' s o u r c e - o v e r ' ; c t x . g l o b a l A l p h a = 1 . 0 ; } e l s e { f i l t e r . a d d F i l t e r ( . . . f ) ; } } ) ; } ; l e t   a p p l y A l l ; c o n s t   g l F i l t e r s = { b l u r : f i l t e r = > f i l t e r . a d d F i l t e r ( ' b l u r ' , 1 0 ) , ' 1 9 7 7 ' : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c t x . f i l l S t y l e = ' r g b ( 2 4 3 ,   1 0 6 ,   1 8 8 ) ' ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' s c r e e n ' , . 3 ] , [ ' b r i g h t n e s s ' , . 1 ] , [ ' c o n t r a s t ' , . 1 ] , [ ' s a t u r a t i o n ' , . 3 ] , ] ) ; } , a d e n : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c t x . f i l l S t y l e = ' r g b ( 6 6 ,   1 0 ,   1 4 ) ' ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' d a r k e n ' , . 2 ] , [ ' b r i g h t n e s s ' , . 2 ] , [ ' c o n t r a s t ' , - . 1 ] , [ ' s a t u r a t i o n ' , - . 1 5 ] , [ ' h u e ' , 2 0 ] , ] ) ; } , b r a n n a n : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c t x . f i l l S t y l e = ' r g b ( 1 6 1 ,   4 4 ,   1 9 1 ) ' ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' l i g h t e n ' , . 3 1 ] , [ ' s e p i a ' , . 5 ] , [ ' c o n t r a s t ' , . 4 ] , ] ) ; } , e a r l y b i r d : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c o n s t   g r a d i e n t = c t x . c r e a t e R a d i a l G r a d i e n t ( c v . w i d t h / 2 , c v . h e i g h t / 2 , 0 , c v . w i d t h / 2 , c v . h e i g h t / 2 , M a t h . h y p o t ( c v . w i d t h , c v . h e i g h t ) / 2 ) ; g r a d i e n t . a d d C o l o r S t o p ( . 2 , ' # D 0 B A 8 E ' ) ; g r a d i e n t . a d d C o l o r S t o p ( 1 , ' # 1 D 0 2 1 0 ' ) ; c t x . f i l l S t y l e = g r a d i e n t ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' o v e r l a y ' , . 2 ] , [ ' s e p i a ' , . 2 ] , [ ' c o n t r a s t ' , - . 1 ] , ] ) ; } , i n k w e l l : ( f i l t e r , c v ) = > { a p p l y A l l ( f i l t e r , [ [ ' s e p i a ' , . 3 ] , [ ' b r i g h t n e s s ' , . 1 ] , [ ' c o n t r a s t ' , - . 1 ] , [ ' d e s a t u r a t e L u m i n a n c e ' ] , ] ) ; } , m a v e n : ( f i l t e r , c v ) = > { a p p l y A l l ( f i l t e r , [ [ ' s e p i a ' , . 2 5 ] , [ ' b r i g h t n e s s ' , - . 0 5 ] , [ ' c o n t r a s t ' , - . 0 5 ] , [ ' s a t u r a t i o n ' , . 5 ] , ] ) ; } , t o a s t e r : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c o n s t   g r a d i e n t = c t x . c r e a t e R a d i a l G r a d i e n t ( c v . w i d t h / 2 , c v . h e i g h t / 2 , 0 , c v . w i d t h / 2 , c v . h e i g h t / 2 , M a t h . h y p o t ( c v . w i d t h , c v . h e i g h t ) / 2 ) ; g r a d i e n t . a d d C o l o r S t o p ( 0 , ' # 0 F 4 E 8 0 ' ) ; g r a d i e n t . a d d C o l o r S t o p ( 1 , ' # 3 B 0 0 3 B ' ) ; c t x . f i l l S t y l e = g r a d i e n t ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' s c r e e n ' , . 5 ] , [ ' b r i g h t n e s s ' , - . 1 ] , [ ' c o n t r a s t ' , . 5 ] , ] ) ; } , w a l d e n : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c t x . f i l l S t y l e = ' # C C 4 4 0 0 ' ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' s c r e e n ' , . 3 ] , [ ' s e p i a ' , . 3 ] , [ ' b r i g h t n e s s ' , . 1 ] , [ ' s a t u r a t i o n ' , . 6 ] , [ ' h u e ' , 3 5 0 ] , ] ) ; } , v a l e n c i a : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c t x . f i l l S t y l e = ' # 3 A 0 3 3 9 ' ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' e x c l u s i o n ' , . 5 ] , [ ' s e p i a ' , . 0 8 ] , [ ' b r i g h t n e s s ' , . 0 8 ] , [ ' c o n t r a s t ' , . 0 8 ] , ] ) ; } , x p r o : ( f i l t e r , c v ) = > { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c o n s t   g r a d i e n t = c t x . c r e a t e R a d i a l G r a d i e n t ( c v . w i d t h / 2 , c v . h e i g h t / 2 , 0 , c v . w i d t h / 2 , c v . h e i g h t / 2 , M a t h . h y p o t ( c v . w i d t h , c v . h e i g h t ) / 2 ) ; g r a d i e n t . a d d C o l o r S t o p ( . 4 , ' # E 0 E 7 E 6 ' ) ; g r a d i e n t . a d d C o l o r S t o p ( 1 , ' # 2 B 2 A A 1 ' ) ; c t x . f i l l S t y l e = g r a d i e n t ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; a p p l y A l l ( f i l t e r , [ [ ' b l e n d ' , c v , ' c o l o r - b u r n ' , . 7 ] , [ ' s e p i a ' , . 3 ] , ] ) ; } , c u s t o m : ( f i l t e r , c v , f i l t e r O p t i o n s ) = > { c o n s t   o p t i o n s = O b j e c t . a s s i g n ( { b l e n d : ' n o r m a l ' , f i l t e r C o l o r : ' ' , b l u r : ' 0 ' , d e s a t u r a t e L u m i n a n c e : ' 0 ' , s a t u r a t i o n : ' 0 ' , c o n t r a s t : ' 0 ' , b r i g h t n e s s : ' 0 ' , s e p i a : ' 0 ' , } , J S O N . p a r s e ( f i l t e r O p t i o n s | | " { } " ) ) ; c o n s t   f i l t e r s = [ ] ; i f ( o p t i o n s . f i l t e r C o l o r ) { c o n s t   c t x = c v . g e t C o n t e x t ( ' 2 d ' ) ; c t x . f i l l S t y l e = o p t i o n s . f i l t e r C o l o r ; c t x . f i l l R e c t ( 0 , 0 , c v . w i d t h , c v . h e i g h t ) ; f i l t e r s . p u s h ( [ ' b l e n d ' , c v , o p t i o n s . b l e n d , 1 ] ) ; } 
 d e l e t e   o p t i o n s . b l e n d ; d e l e t e   o p t i o n s . f i l t e r C o l o r ; f i l t e r s . p u s h ( . . . O b j e c t . e n t r i e s ( o p t i o n s ) . m a p ( ( [ f i l t e r , a m o u n t ] ) = > [ f i l t e r , p a r s e I n t ( a m o u n t ) / 1 0 0 ] ) ) ; a p p l y A l l ( f i l t e r , f i l t e r s ) ; } , } ; a s y n c   f u n c t i o n   a p p l y M o d i f i c a t i o n s ( i m g ) { c o n s t   d a t a = O b j e c t . a s s i g n ( { g l F i l t e r : ' ' , f i l t e r : ' # 0 0 0 0 ' , q u a l i t y : ' 7 5 ' , } , i m g . d a t a s e t ) ; l e t { w i d t h , h e i g h t , r e s i z e W i d t h , q u a l i t y , f i l t e r , m i m e t y p e , o r i g i n a l S r c , g l F i l t e r , f i l t e r O p t i o n s , } = d a t a ; [ w i d t h , h e i g h t , r e s i z e W i d t h ] = [ w i d t h , h e i g h t , r e s i z e W i d t h ] . m a p ( s = > p a r s e F l o a t ( s ) ) ; q u a l i t y = p a r s e I n t ( q u a l i t y ) ; c o n s t   c o n t a i n e r = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; c o n s t   o r i g i n a l = a w a i t   l o a d I m a g e ( o r i g i n a l S r c ) ; c o n t a i n e r . a p p e n d C h i l d ( o r i g i n a l ) ; a w a i t   a c t i v a t e C r o p p e r ( o r i g i n a l , 0 , d a t a ) ; c o n s t   c r o p p e d I m g = $ ( o r i g i n a l ) . c r o p p e r ( ' g e t C r o p p e d C a n v a s ' , { w i d t h , h e i g h t } ) ; $ ( o r i g i n a l ) . c r o p p e r ( ' d e s t r o y ' ) ; c o n s t   r e s u l t = d o c u m e n t . c r e a t e E l e m e n t ( ' c a n v a s ' ) ; r e s u l t . w i d t h = r e s i z e W i d t h | | c r o p p e d I m g . w i d t h ; r e s u l t . h e i g h t = c r o p p e d I m g . h e i g h t * r e s u l t . w i d t h / c r o p p e d I m g . w i d t h ; c o n s t   c t x = r e s u l t . g e t C o n t e x t ( ' 2 d ' ) ; c t x . d r a w I m a g e ( c r o p p e d I m g , 0 , 0 , c r o p p e d I m g . w i d t h , c r o p p e d I m g . h e i g h t , 0 , 0 , r e s u l t . w i d t h , r e s u l t . h e i g h t ) ; i f ( g l F i l t e r ) { c o n s t   g l f = n e w   w i n d o w . W e b G L I m a g e F i l t e r ( ) ; c o n s t   c v = d o c u m e n t . c r e a t e E l e m e n t ( ' c a n v a s ' ) ; c v . w i d t h = r e s u l t . w i d t h ; c v . h e i g h t = r e s u l t . h e i g h t ; a p p l y A l l = _ a p p l y A l l . b i n d ( n u l l , r e s u l t ) ; g l F i l t e r s [ g l F i l t e r ] ( g l f , c v , f i l t e r O p t i o n s ) ; c o n s t   f i l t e r e d = g l f . a p p l y ( r e s u l t ) ; c t x . d r a w I m a g e ( f i l t e r e d , 0 , 0 , f i l t e r e d . w i d t h , f i l t e r e d . h e i g h t , 0 , 0 , r e s u l t . w i d t h , r e s u l t . h e i g h t ) ; } 
 c t x . f i l l S t y l e = f i l t e r | | ' # 0 0 0 0 ' ; c t x . f i l l R e c t ( 0 , 0 , r e s u l t . w i d t h , r e s u l t . h e i g h t ) ; r e t u r n   r e s u l t . t o D a t a U R L ( m i m e t y p e , q u a l i t y / 1 0 0 ) ; } 
 f u n c t i o n   l o a d I m a g e ( s r c , i m g = n e w   I m a g e ( ) ) { r e t u r n   n e w   P r o m i s e ( ( r e s o l v e , r e j e c t ) = > { i m g . a d d E v e n t L i s t e n e r ( ' l o a d ' , ( ) = > r e s o l v e ( i m g ) , { o n c e : t r u e } ) ; i m g . a d d E v e n t L i s t e n e r ( ' e r r o r ' , r e j e c t , { o n c e : t r u e } ) ; i m g . s r c = s r c ; } ) ; } 
 c o n s t   i m a g e C a c h e = n e w   M a p ( ) ; a s y n c   f u n c t i o n   a c t i v a t e C r o p p e r ( i m a g e , a s p e c t R a t i o , d a t a s e t ) { c o n s t   s r c = i m a g e . g e t A t t r i b u t e ( ' s r c ' ) ; i f ( ! i m a g e C a c h e . h a s ( s r c ) ) { c o n s t   r e s = a w a i t   f e t c h ( s r c ) ; i m a g e C a c h e . s e t ( s r c , U R L . c r e a t e O b j e c t U R L ( a w a i t   r e s . b l o b ( ) ) ) ; } 
 i m a g e . s r c = i m a g e C a c h e . g e t ( s r c ) ; $ ( i m a g e ) . c r o p p e r ( { v i e w M o d e : 2 , d r a g M o d e : ' m o v e ' , a u t o C r o p A r e a : 1 . 0 , a s p e c t R a t i o : a s p e c t R a t i o , d a t a : _ . m a p O b j e c t ( _ . p i c k ( d a t a s e t , . . . c r o p p e r D a t a F i e l d s ) , v a l u e = > p a r s e F l o a t ( v a l u e ) ) , m i n C o n t a i n e r W i d t h : 1 , m i n C o n t a i n e r H e i g h t : 1 , } ) ; r e t u r n   n e w   P r o m i s e ( r e s o l v e = > i m a g e . a d d E v e n t L i s t e n e r ( ' r e a d y ' , r e s o l v e , { o n c e : t r u e } ) ) ; } 
 a s y n c   f u n c t i o n   l o a d I m a g e I n f o ( i m g , r p c ) { i f ( i m g . d a t a s e t . o r i g i n a l S r c ) { r e t u r n ; } 
 c o n s t { o r i g i n a l } = a w a i t   r p c ( { r o u t e : ' / w e b _ e d i t o r / g e t _ i m a g e _ i n f o ' , p a r a m s : { s r c : i m g . g e t A t t r i b u t e ( ' s r c ' ) . s p l i t ( / [ ? # ] / ) [ 0 ] } , } ) ; i f ( o r i g i n a l & & n e w   U R L ( o r i g i n a l . i m a g e _ s r c , w i n d o w . l o c a t i o n . o r i g i n ) . o r i g i n = = = w i n d o w . l o c a t i o n . o r i g i n ) { i m g . d a t a s e t . o r i g i n a l I d = o r i g i n a l . i d ; i m g . d a t a s e t . o r i g i n a l S r c = o r i g i n a l . i m a g e _ s r c ; i m g . d a t a s e t . m i m e t y p e = o r i g i n a l . m i m e t y p e ; } } 
 r e t u r n { a p p l y M o d i f i c a t i o n s , c r o p p e r D a t a F i e l d s , a c t i v a t e C r o p p e r , l o a d I m a g e I n f o , l o a d I m a g e , r e m o v e O n I m a g e C h a n g e A t t r s : [ . . . c r o p p e r D a t a F i e l d s , . . . m o d i f i e r F i e l d s , ' a s p e c t R a t i o ' ] , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / e d i t o r / c u s t o m _ c o l o r s . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / m e d i a . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . w i d g e t s . m e d i a ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o n c u r r e n c y = r e q u i r e ( ' w e b . c o n c u r r e n c y ' ) ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   D i a l o g = r e q u i r e ( ' w e b . D i a l o g ' ) ; v a r   d o m = r e q u i r e ( ' w e b . d o m ' ) ; v a r   f o n t s = r e q u i r e ( ' w y s i w y g . f o n t s ' ) ; v a r   u t i l s = r e q u i r e ( ' w e b . u t i l s ' ) ; v a r   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; v a r   s e s s i o n = r e q u i r e ( ' w e b . s e s s i o n ' ) ; c o n s t { r e m o v e O n I m a g e C h a n g e A t t r s } = r e q u i r e ( ' w e b _ e d i t o r . i m a g e _ p r o c e s s i n g ' ) ; c o n s t { g e t C S S V a r i a b l e V a l u e , D E F A U L T _ P A L E T T E } = r e q u i r e ( ' w e b _ e d i t o r . u t i l s ' ) ; v a r   Q W e b = c o r e . q w e b ; v a r   _ t = c o r e . _ t ; v a r   M e d i a W i d g e t = W i d g e t . e x t e n d ( { x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / w y s i w y g . x m l ' ] , i n i t : f u n c t i o n ( p a r e n t , m e d i a , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . m e d i a = m e d i a ; t h i s . $ m e d i a = $ ( m e d i a ) ; } , c l e a r : f u n c t i o n ( ) { i f ( ! t h i s . m e d i a ) { r e t u r n ; } 
 t h i s . _ c l e a r ( ) ; } , s a v e : f u n c t i o n ( ) { } , _ c l e a r : f u n c t i o n ( ) { } , } ) ; v a r   S e a r c h a b l e M e d i a W i d g e t = M e d i a W i d g e t . e x t e n d ( { e v e n t s : _ . e x t e n d ( { } , M e d i a W i d g e t . p r o t o t y p e . e v e n t s | | { } , { ' i n p u t   . o _ w e _ s e a r c h ' : ' _ o n S e a r c h I n p u t ' , } ) , i n i t : f u n c t i o n ( ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . _ o n S e a r c h I n p u t = _ . d e b o u n c e ( t h i s . _ o n S e a r c h I n p u t , 5 0 0 ) ; } , s e a r c h : f u n c t i o n ( n e e d l e ) { } , _ r e n d e r T h u m b n a i l s : f u n c t i o n ( ) { } , _ o n S e a r c h I n p u t : f u n c t i o n ( e v ) { t h i s . a t t a c h m e n t s = [ ] ; t h i s . s e a r c h ( $ ( e v . c u r r e n t T a r g e t ) . v a l ( ) | | ' ' ) . t h e n ( ( ) = > t h i s . _ r e n d e r T h u m b n a i l s ( ) ) ; t h i s . h a s S e a r c h e d = t r u e ; } , } ) ; v a r   F i l e W i d g e t = S e a r c h a b l e M e d i a W i d g e t . e x t e n d ( { e v e n t s : _ . e x t e n d ( { } , S e a r c h a b l e M e d i a W i d g e t . p r o t o t y p e . e v e n t s | | { } , { ' c l i c k   . o _ u p l o a d _ m e d i a _ b u t t o n ' : ' _ o n U p l o a d B u t t o n C l i c k ' , ' c h a n g e   . o _ f i l e _ i n p u t ' : ' _ o n F i l e I n p u t C h a n g e ' , ' c l i c k   . o _ u p l o a d _ m e d i a _ u r l _ b u t t o n ' : ' _ o n U p l o a d U R L B u t t o n C l i c k ' , ' i n p u t   . o _ w e _ u r l _ i n p u t ' : ' _ o n U R L I n p u t C h a n g e ' , ' c l i c k   . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l ' : ' _ o n A t t a c h m e n t C l i c k ' , ' c l i c k   . o _ e x i s t i n g _ a t t a c h m e n t _ r e m o v e ' : ' _ o n R e m o v e C l i c k ' , ' c l i c k   . o _ l o a d _ m o r e ' : ' _ o n L o a d M o r e C l i c k ' , } ) , e x i s t i n g A t t a c h m e n t s T e m p l a t e : u n d e f i n e d , I M A G E _ M I M E T Y P E S : [ ' i m a g e / g i f ' , ' i m a g e / j p e ' , ' i m a g e / j p e g ' , ' i m a g e / j p g ' , ' i m a g e / g i f ' , ' i m a g e / p n g ' , ' i m a g e / s v g + x m l ' ] , N U M B E R _ O F _ A T T A C H M E N T S _ T O _ D I S P L A Y : 3 0 , M A X _ D B _ A T T A C H M E N T S : 5 , i n i t : f u n c t i o n ( p a r e n t , m e d i a , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . _ m u t e x = n e w   c o n c u r r e n c y . M u t e x ( ) ; t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y = t h i s . N U M B E R _ O F _ A T T A C H M E N T S _ T O _ D I S P L A Y ; t h i s . o p t i o n s = _ . e x t e n d ( { m e d i a W i d t h : m e d i a & & m e d i a . p a r e n t E l e m e n t & & $ ( m e d i a . p a r e n t E l e m e n t ) . w i d t h ( ) , } , o p t i o n s | | { } ) ; t h i s . a t t a c h m e n t s = [ ] ; t h i s . s e l e c t e d A t t a c h m e n t s = [ ] ; t h i s . l i b r a r y M e d i a = [ ] ; t h i s . s e l e c t e d M e d i a = [ ] ; t h i s . _ o n U p l o a d U R L B u t t o n C l i c k = d o m . m a k e A s y n c H a n d l e r ( t h i s . _ o n U p l o a d U R L B u t t o n C l i c k ) ; } , s t a r t : f u n c t i o n ( ) { v a r   d e f = t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; v a r   s e l f = t h i s ; t h i s . $ u r l I n p u t = t h i s . $ ( ' . o _ w e _ u r l _ i n p u t ' ) ; t h i s . $ f o r m = t h i s . $ ( ' f o r m ' ) ; t h i s . $ f i l e I n p u t = t h i s . $ ( ' . o _ f i l e _ i n p u t ' ) ; t h i s . $ u p l o a d B u t t o n = t h i s . $ ( ' . o _ u p l o a d _ m e d i a _ b u t t o n ' ) ; t h i s . $ a d d U r l B u t t o n = t h i s . $ ( ' . o _ u p l o a d _ m e d i a _ u r l _ b u t t o n ' ) ; t h i s . $ u r l S u c c e s s = t h i s . $ ( ' . o _ w e _ u r l _ s u c c e s s ' ) ; t h i s . $ u r l W a r n i n g = t h i s . $ ( ' . o _ w e _ u r l _ w a r n i n g ' ) ; t h i s . $ u r l E r r o r = t h i s . $ ( ' . o _ w e _ u r l _ e r r o r ' ) ; t h i s . $ e r r o r T e x t = t h i s . $ ( ' . o _ w e _ e r r o r _ t e x t ' ) ; v a r   o = { u r l : n u l l , a l t : n u l l , } ; i f ( t h i s . $ m e d i a . i s ( ' i m g ' ) ) { o . u r l = t h i s . $ m e d i a . a t t r ( ' s r c ' ) ; } e l s e   i f ( t h i s . $ m e d i a . i s ( ' a . o _ i m a g e ' ) ) { o . u r l = t h i s . $ m e d i a . a t t r ( ' h r e f ' ) . r e p l a c e ( / [ ? ] . * / , ' ' ) ; o . i d = + o . u r l . m a t c h ( / \ / w e b \ / c o n t e n t \ / ( \ d + ) / , ' ' ) [ 1 ] ; } 
 r e t u r n   t h i s . s e a r c h ( ' ' ) . t h e n ( a s y n c ( ) = > { a w a i t   t h i s . _ r e n d e r T h u m b n a i l s ( ) ; i f ( o . u r l ) { s e l f . _ s e l e c t A t t a c h e m e n t ( _ . f i n d ( s e l f . a t t a c h m e n t s , f u n c t i o n ( a t t a c h m e n t ) { r e t u r n   o . u r l = = = a t t a c h m e n t . i m a g e _ s r c ; } ) | | o ) ; } 
 r e t u r n   d e f ; } ) ; } , s a v e : f u n c t i o n ( ) { r e t u r n   t h i s . _ m u t e x . e x e c ( t h i s . _ s a v e . b i n d ( t h i s ) ) ; } , s e a r c h : f u n c t i o n ( n e e d l e ) { t h i s . n e e d l e = n e e d l e ; r e t u r n   t h i s . f e t c h A t t a c h m e n t s ( t h i s . N U M B E R _ O F _ A T T A C H M E N T S _ T O _ D I S P L A Y , 0 ) ; } , f e t c h A t t a c h m e n t s : f u n c t i o n ( n u m b e r , o f f s e t ) { r e t u r n   t h i s . _ r p c ( { m o d e l : ' i r . a t t a c h m e n t ' , m e t h o d : ' s e a r c h _ r e a d ' , a r g s : [ ] , k w a r g s : { d o m a i n : t h i s . _ g e t A t t a c h m e n t s D o m a i n ( t h i s . n e e d l e ) , f i e l d s : [ ' n a m e ' , ' m i m e t y p e ' , ' d e s c r i p t i o n ' , ' c h e c k s u m ' , ' u r l ' , ' t y p e ' , ' r e s _ i d ' , ' r e s _ m o d e l ' , ' p u b l i c ' , ' a c c e s s _ t o k e n ' , ' i m a g e _ s r c ' , ' i m a g e _ w i d t h ' , ' i m a g e _ h e i g h t ' , ' o r i g i n a l _ i d ' ] , o r d e r : [ { n a m e : ' i d ' , a s c : f a l s e } ] , c o n t e x t : t h i s . o p t i o n s . c o n t e x t , l i m i t : n u m b e r + 1 , o f f s e t : o f f s e t , } , } ) . t h e n ( a t t a c h m e n t s = > { t h i s . a t t a c h m e n t s = t h i s . a t t a c h m e n t s . s l i c e ( ) ; A r r a y . p r o t o t y p e . s p l i c e . a p p l y ( t h i s . a t t a c h m e n t s , [ o f f s e t , a t t a c h m e n t s . l e n g t h ] . c o n c a t ( a t t a c h m e n t s ) ) ; } ) ; } , h a s C o n t e n t ( ) { r e t u r n   t h i s . a t t a c h m e n t s . l e n g t h ; } , _ c l e a r : f u n c t i o n ( ) { i f ( t h i s . $ m e d i a . i s ( ' i m g ' ) ) { r e t u r n ; } 
 v a r   a l l I m g C l a s s e s = / ( ^ | \ s + ) ( ( i m g ( \ s | $ ) | i m g - ( ? ! c i r c l e | r o u n d e d | t h u m b n a i l ) ) [ ^ \ s ] * ) / g ; v a r   a l l I m g C l a s s M o d i f i e r s = / ( ^ | \ s + ) ( r o u n d e d - c i r c l e | s h a d o w | r o u n d e d | i m g - t h u m b n a i l | m x - a u t o ) ( [ ^ \ s ] * ) / g ; t h i s . m e d i a . c l a s s N a m e = t h i s . m e d i a . c l a s s N a m e & & t h i s . m e d i a . c l a s s N a m e . r e p l a c e ( ' o _ w e _ c u s t o m _ i m a g e ' , ' ' ) . r e p l a c e ( a l l I m g C l a s s e s , '   ' ) . r e p l a c e ( a l l I m g C l a s s M o d i f i e r s , '   ' ) ; } , _ g e t A t t a c h m e n t s D o m a i n : f u n c t i o n ( n e e d l e ) { v a r   d o m a i n = t h i s . o p t i o n s . a t t a c h m e n t I D s & & t h i s . o p t i o n s . a t t a c h m e n t I D s . l e n g t h ? [ ' | ' , [ ' i d ' , ' i n ' , t h i s . o p t i o n s . a t t a c h m e n t I D s ] ] : [ ] ; v a r   a t t a c h e d D o c u m e n t D o m a i n = [ ' & ' , [ ' r e s _ m o d e l ' , ' = ' , t h i s . o p t i o n s . r e s _ m o d e l ] , [ ' r e s _ i d ' , ' = ' , t h i s . o p t i o n s . r e s _ i d | 0 ] ] ; i f ( ! t h i s . o p t i o n s . r e s _ i d ) { a t t a c h e d D o c u m e n t D o m a i n . u n s h i f t ( ' & ' ) ; a t t a c h e d D o c u m e n t D o m a i n . p u s h ( [ ' c r e a t e _ u i d ' , ' = ' , t h i s . o p t i o n s . u s e r _ i d ] ) ; } 
 i f ( t h i s . o p t i o n s . d a t a _ r e s _ m o d e l ) { v a r   r e l a t e d D o m a i n = [ ' & ' , [ ' r e s _ m o d e l ' , ' = ' , t h i s . o p t i o n s . d a t a _ r e s _ m o d e l ] , [ ' r e s _ i d ' , ' = ' , t h i s . o p t i o n s . d a t a _ r e s _ i d | 0 ] ] ; i f ( ! t h i s . o p t i o n s . d a t a _ r e s _ i d ) { r e l a t e d D o m a i n . u n s h i f t ( ' & ' ) ; r e l a t e d D o m a i n . p u s h ( [ ' c r e a t e _ u i d ' , ' = ' , s e s s i o n . u i d ] ) ; } 
 d o m a i n = d o m a i n . c o n c a t ( [ ' | ' ] , a t t a c h e d D o c u m e n t D o m a i n , r e l a t e d D o m a i n ) ; } e l s e { d o m a i n = d o m a i n . c o n c a t ( a t t a c h e d D o c u m e n t D o m a i n ) ; } 
 d o m a i n = [ ' | ' , [ ' p u b l i c ' , ' = ' , t r u e ] ] . c o n c a t ( d o m a i n ) ; d o m a i n = d o m a i n . c o n c a t ( t h i s . o p t i o n s . m i m e t y p e D o m a i n ) ; i f ( n e e d l e & & n e e d l e . l e n g t h ) { d o m a i n . p u s h ( [ ' n a m e ' , ' i l i k e ' , n e e d l e ] ) ; } 
 d o m a i n . p u s h ( ' ! ' , [ ' n a m e ' , ' = l i k e ' , ' % . c r o p ' ] ) ; d o m a i n . p u s h ( ' | ' , [ ' t y p e ' , ' = ' , ' b i n a r y ' ] , ' ! ' , [ ' u r l ' , ' = l i k e ' , ' / % / s t a t i c / % ' ] ) ; r e t u r n   d o m a i n ; } , _ h i g h l i g h t S e l e c t e d : f u n c t i o n ( ) { v a r   s e l f = t h i s ; t h i s . $ ( ' . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l . o _ w e _ a t t a c h m e n t _ s e l e c t e d ' ) . r e m o v e C l a s s ( " o _ w e _ a t t a c h m e n t _ s e l e c t e d " ) ; _ . e a c h ( t h i s . s e l e c t e d A t t a c h m e n t s , f u n c t i o n ( a t t a c h m e n t ) { s e l f . $ ( ' . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l [ d a t a - i d = ' + a t t a c h m e n t . i d + ' ] ' ) . a d d C l a s s ( " o _ w e _ a t t a c h m e n t _ s e l e c t e d " ) . c s s ( ' d i s p l a y ' , ' ' ) ; } ) ; } , _ h a n d l e N e w A t t a c h m e n t : f u n c t i o n ( a t t a c h m e n t ) { t h i s . a t t a c h m e n t s = t h i s . a t t a c h m e n t s . f i l t e r ( a t t = > a t t . i d ! = = a t t a c h m e n t . i d ) ; t h i s . a t t a c h m e n t s . u n s h i f t ( a t t a c h m e n t ) ; t h i s . _ r e n d e r T h u m b n a i l s ( ) ; t h i s . _ s e l e c t A t t a c h e m e n t ( a t t a c h m e n t ) ; } , _ l o a d M o r e I m a g e s : f u n c t i o n ( f o r c e S e a r c h ) { r e t u r n   t h i s . f e t c h A t t a c h m e n t s ( 1 0 , t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y ) . t h e n ( ( ) = > { t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y + = 1 0 ; i f ( ! f o r c e S e a r c h ) { t h i s . _ r e n d e r T h u m b n a i l s ( ) ; r e t u r n   P r o m i s e . r e s o l v e ( ) ; } e l s e { r e t u r n   t h i s . s e a r c h ( t h i s . $ ( ' . o _ w e _ s e a r c h ' ) . v a l ( ) | | ' ' ) ; } } ) ; } , _ r e n d e r E x i s t i n g : f u n c t i o n ( a t t a c h m e n t s ) { r e t u r n   Q W e b . r e n d e r ( t h i s . e x i s t i n g A t t a c h m e n t s T e m p l a t e , { a t t a c h m e n t s : a t t a c h m e n t s , w i d g e t : t h i s , } ) ; } , _ r e n d e r T h u m b n a i l s : f u n c t i o n ( ) { v a r   a t t a c h m e n t s = t h i s . a t t a c h m e n t s . s l i c e ( 0 , t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y ) ; t h i s . $ ( ' . o _ w e _ e x i s t i n g _ a t t a c h m e n t s ' ) . r e p l a c e W i t h ( t h i s . _ r e n d e r E x i s t i n g ( a t t a c h m e n t s ) ) ; t h i s . _ h i g h l i g h t S e l e c t e d ( ) ; t h i s . $ ( ' . o _ w e _ l o a d _ m o r e ' ) . t o g g l e C l a s s ( ' d - n o n e ' , ! t h i s . h a s C o n t e n t ( ) ) ; v a r   n o L o a d M o r e B u t t o n = t h i s . N U M B E R _ O F _ A T T A C H M E N T S _ T O _ D I S P L A Y > = t h i s . a t t a c h m e n t s . l e n g t h ; v a r   n o M o r e I m g T o L o a d = t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y > = t h i s . a t t a c h m e n t s . l e n g t h ; t h i s . $ ( ' . o _ l o a d _ d o n e _ m s g ' ) . t o g g l e C l a s s ( ' d - n o n e ' , n o L o a d M o r e B u t t o n | | ! n o M o r e I m g T o L o a d ) ; t h i s . $ ( ' . o _ l o a d _ m o r e ' ) . t o g g l e C l a s s ( ' d - n o n e ' , n o M o r e I m g T o L o a d ) ; } , _ s a v e : a s y n c   f u n c t i o n ( ) { c o n s t   t o S a v e = O b j e c t . f r o m E n t r i e s ( t h i s . s e l e c t e d M e d i a . m a p ( m e d i a = > [ m e d i a . i d , { q u e r y : m e d i a . q u e r y | | ' ' , i s _ d y n a m i c _ s v g : ! ! m e d i a . i s D y n a m i c S V G , } ] ) ) ; l e t   m e d i a A t t a c h m e n t s = [ ] ; i f ( O b j e c t . k e y s ( t o S a v e ) . l e n g t h ! = = 0 ) { m e d i a A t t a c h m e n t s = a w a i t   t h i s . _ r p c ( { r o u t e : ' / w e b _ e d i t o r / s a v e _ l i b r a r y _ m e d i a ' , p a r a m s : { m e d i a : t o S a v e , } , } ) ; } 
 c o n s t   s e l e c t e d = t h i s . s e l e c t e d A t t a c h m e n t s . c o n c a t ( m e d i a A t t a c h m e n t s ) . m a p ( a t t a c h m e n t = > { i f ( a t t a c h m e n t . i m a g e _ s r c & & a t t a c h m e n t . i m a g e _ s r c . s t a r t s W i t h ( ' / w e b _ e d i t o r / s h a p e / ' ) ) { c o n s t   c o l o r C u s t o m i z e d U R L = n e w   U R L ( a t t a c h m e n t . i m a g e _ s r c , w i n d o w . l o c a t i o n . o r i g i n ) ; c o l o r C u s t o m i z e d U R L . s e a r c h P a r a m s . s e t ( ' c 1 ' , g e t C S S V a r i a b l e V a l u e ( ' o - c o l o r - 1 ' ) ) ; a t t a c h m e n t . i m a g e _ s r c = c o l o r C u s t o m i z e d U R L . p a t h n a m e + c o l o r C u s t o m i z e d U R L . s e a r c h ; } 
 r e t u r n   a t t a c h m e n t ; } ) ; i f ( t h i s . o p t i o n s . m u l t i I m a g e s ) { r e t u r n   s e l e c t e d ; } 
 c o n s t   i m g = s e l e c t e d [ 0 ] ; i f ( ! i m g | | ! i m g . i d ) { r e t u r n   t h i s . m e d i a ; } 
 i f ( ! i m g . p u b l i c & & ! i m g . a c c e s s _ t o k e n ) { a w a i t   t h i s . _ r p c ( { m o d e l : ' i r . a t t a c h m e n t ' , m e t h o d : ' g e n e r a t e _ a c c e s s _ t o k e n ' , a r g s : [ [ i m g . i d ] ] } ) . t h e n ( f u n c t i o n ( a c c e s s _ t o k e n ) { i m g . a c c e s s _ t o k e n = a c c e s s _ t o k e n [ 0 ] ; } ) ; } 
 i f ( i m g . i m a g e _ s r c ) { v a r   s r c = i m g . i m a g e _ s r c ; i f ( ! i m g . p u b l i c & & i m g . a c c e s s _ t o k e n ) { s r c + = _ . s t r . s p r i n t f ( ' ? a c c e s s _ t o k e n = % s ' , i m g . a c c e s s _ t o k e n ) ; } 
 i f ( ! t h i s . $ m e d i a . i s ( ' i m g ' ) ) { t h i s . $ m e d i a = $ ( ' < i m g / > ' , { c l a s s : ' i m g - f l u i d   o _ w e _ c u s t o m _ i m a g e ' } ) ; t h i s . m e d i a = t h i s . $ m e d i a [ 0 ] ; } 
 t h i s . $ m e d i a . a t t r ( ' s r c ' , s r c ) ; } e l s e { i f ( ! t h i s . $ m e d i a . i s ( ' a ' ) ) { $ ( ' . n o t e - c o n t r o l - s e l e c t i o n ' ) . h i d e ( ) ; t h i s . $ m e d i a = $ ( ' < a / > ' ) ; t h i s . m e d i a = t h i s . $ m e d i a [ 0 ] ; } 
 v a r   h r e f = ' / w e b / c o n t e n t / ' + i m g . i d + ' ? ' ; i f ( ! i m g . p u b l i c & & i m g . a c c e s s _ t o k e n ) { h r e f + = _ . s t r . s p r i n t f ( ' a c c e s s _ t o k e n = % s & ' , i m g . a c c e s s _ t o k e n ) ; } 
 h r e f + = ' u n i q u e = ' + i m g . c h e c k s u m + ' & d o w n l o a d = t r u e ' ; t h i s . $ m e d i a . a t t r ( ' h r e f ' , h r e f ) ; t h i s . $ m e d i a . a d d C l a s s ( ' o _ i m a g e ' ) . a t t r ( ' t i t l e ' , i m g . n a m e ) . a t t r ( ' d a t a - m i m e t y p e ' , i m g . m i m e t y p e ) ; } 
 t h i s . $ m e d i a . a t t r ( ' a l t ' , i m g . a l t | | i m g . d e s c r i p t i o n | | ' ' ) ; v a r   s t y l e = t h i s . s t y l e ; i f ( s t y l e ) { t h i s . $ m e d i a . c s s ( s t y l e ) ; } 
 r e m o v e O n I m a g e C h a n g e A t t r s . f o r E a c h ( a t t r = > { d e l e t e   t h i s . m e d i a . d a t a s e t [ a t t r ] ; } ) ; t h i s . m e d i a . c l a s s L i s t . r e m o v e ( ' o _ m o d i f i e d _ i m a g e _ t o _ s a v e ' ) ; t h i s . $ m e d i a . t r i g g e r ( ' i m a g e _ c h a n g e d ' ) ; r e t u r n   t h i s . m e d i a ; } , _ s e l e c t A t t a c h e m e n t : f u n c t i o n ( a t t a c h m e n t , s a v e , { t y p e = ' a t t a c h m e n t ' } = { } ) { c o n s t   p o s s i b l e P r o p s = { ' a t t a c h m e n t ' : ' s e l e c t e d A t t a c h m e n t s ' , ' m e d i a ' : ' s e l e c t e d M e d i a ' } ; c o n s t   p r o p = p o s s i b l e P r o p s [ t y p e ] ; i f ( t h i s . o p t i o n s . m u l t i I m a g e s ) { c o n s t   i n d e x = t h i s [ p r o p ] . i n d e x O f ( a t t a c h m e n t ) ; i f ( i n d e x ! = = - 1 ) { i f ( ! s a v e ) { t h i s [ p r o p ] . s p l i c e ( i n d e x , 1 ) ; } } e l s e { t h i s [ p r o p ] . p u s h ( a t t a c h m e n t ) ; } } e l s e { O b j e c t . v a l u e s ( p o s s i b l e P r o p s ) . f o r E a c h ( p r o p = > { t h i s [ p r o p ] = [ ] ; } ) ; t h i s [ p r o p ] = [ a t t a c h m e n t ] ; } 
 t h i s . _ h i g h l i g h t S e l e c t e d ( ) ; i f ( s a v e ) { t h i s . t r i g g e r _ u p ( ' s a v e _ r e q u e s t ' ) ; } } , _ u p d a t e A d d U r l U i : f u n c t i o n ( e m p t y V a l u e , i s U R L , i s I m a g e ) { t h i s . $ a d d U r l B u t t o n . t o g g l e C l a s s ( ' b t n - s e c o n d a r y ' , e m p t y V a l u e ) . t o g g l e C l a s s ( ' b t n - p r i m a r y ' , ! e m p t y V a l u e ) . p r o p ( ' d i s a b l e d ' , ! i s U R L ) ; t h i s . $ u r l S u c c e s s . t o g g l e C l a s s ( ' d - n o n e ' , ! i s U R L ) ; t h i s . $ u r l E r r o r . t o g g l e C l a s s ( ' d - n o n e ' , e m p t y V a l u e | | i s U R L ) ; } , _ o n A t t a c h m e n t C l i c k : f u n c t i o n ( e v ) { c o n s t   a t t a c h m e n t = e v . c u r r e n t T a r g e t ; c o n s t { i d : a t t a c h m e n t I D , m e d i a I d } = a t t a c h m e n t . d a t a s e t ; i f ( a t t a c h m e n t I D ) { c o n s t   a t t a c h m e n t = t h i s . a t t a c h m e n t s . f i n d ( a t t a c h m e n t = > a t t a c h m e n t . i d = = = p a r s e I n t ( a t t a c h m e n t I D ) ) ; t h i s . _ s e l e c t A t t a c h e m e n t ( a t t a c h m e n t , ! t h i s . o p t i o n s . m u l t i I m a g e s ) ; } e l s e   i f ( m e d i a I d ) { c o n s t   m e d i a = t h i s . l i b r a r y M e d i a . f i n d ( m e d i a = > m e d i a . i d = = = p a r s e I n t ( m e d i a I d ) ) ; t h i s . _ s e l e c t A t t a c h e m e n t ( m e d i a , ! t h i s . o p t i o n s . m u l t i I m a g e s , { t y p e : ' m e d i a ' } ) ; } } , _ o n F i l e I n p u t C h a n g e : f u n c t i o n ( ) { r e t u r n   t h i s . _ m u t e x . e x e c ( t h i s . _ a d d D a t a . b i n d ( t h i s ) ) ; } , _ a d d D a t a : f u n c t i o n ( ) { v a r   s e l f = t h i s ; v a r   u p l o a d M u t e x = n e w   c o n c u r r e n c y . M u t e x ( ) ; v a r   f i l e s = _ . s o r t B y ( t h i s . $ f i l e I n p u t [ 0 ] . f i l e s , ' s i z e ' ) ; _ . e a c h ( f i l e s , f u n c t i o n ( f i l e ) { u p l o a d M u t e x . e x e c ( f u n c t i o n ( ) { r e t u r n   u t i l s . g e t D a t a U R L F r o m F i l e ( f i l e ) . t h e n ( f u n c t i o n ( r e s u l t ) { r e t u r n   s e l f . _ r p c ( { r o u t e : ' / w e b _ e d i t o r / a t t a c h m e n t / a d d _ d a t a ' , p a r a m s : { ' n a m e ' : f i l e . n a m e , ' d a t a ' : r e s u l t . s p l i t ( ' , ' ) [ 1 ] , ' r e s _ i d ' : s e l f . o p t i o n s . r e s _ i d , ' r e s _ m o d e l ' : s e l f . o p t i o n s . r e s _ m o d e l , ' w i d t h ' : 0 , ' q u a l i t y ' : 0 , } , } ) . t h e n ( f u n c t i o n ( a t t a c h m e n t ) { s e l f . _ h a n d l e N e w A t t a c h m e n t ( a t t a c h m e n t ) ; } ) ; } ) ; } ) ; } ) ; r e t u r n   u p l o a d M u t e x . g e t U n l o c k e d D e f ( ) . t h e n ( f u n c t i o n ( ) { i f ( ! s e l f . o p t i o n s . m u l t i I m a g e s & & ! s e l f . n o S a v e ) { s e l f . t r i g g e r _ u p ( ' s a v e _ r e q u e s t ' ) ; } 
 s e l f . n o S a v e = f a l s e ; } ) ; } , _ o n R e m o v e C l i c k : f u n c t i o n ( e v ) { v a r   s e l f = t h i s ; e v . s t o p P r o p a g a t i o n ( ) ; D i a l o g . c o n f i r m ( t h i s , _ t ( " A r e   y o u   s u r e   y o u   w a n t   t o   d e l e t e   t h i s   f i l e   ? " ) , { c o n f i r m _ c a l l b a c k : f u n c t i o n ( ) { v a r   $ a = $ ( e v . c u r r e n t T a r g e t ) . c l o s e s t ( ' . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l ' ) ; v a r   i d = p a r s e I n t ( $ a . d a t a ( ' i d ' ) , 1 0 ) ; v a r   a t t a c h m e n t = _ . f i n d W h e r e ( s e l f . a t t a c h m e n t s , { i d : i d } ) ; r e t u r n   s e l f . _ r p c ( { r o u t e : ' / w e b _ e d i t o r / a t t a c h m e n t / r e m o v e ' , p a r a m s : { i d s : [ i d ] , } , } ) . t h e n ( f u n c t i o n ( p r e v e n t e d ) { i f ( _ . i s E m p t y ( p r e v e n t e d ) ) { s e l f . a t t a c h m e n t s = _ . w i t h o u t ( s e l f . a t t a c h m e n t s , a t t a c h m e n t ) ; s e l f . a t t a c h m e n t s . f i l t e r ( a t = > a t . o r i g i n a l _ i d [ 0 ] = = = a t t a c h m e n t . i d ) . f o r E a c h ( a t = > d e l e t e   a t . o r i g i n a l _ i d ) ; i f ( ! s e l f . a t t a c h m e n t s . l e n g t h ) { s e l f . _ r e n d e r T h u m b n a i l s ( ) ; } e l s e { $ a . c l o s e s t ( ' . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l ' ) . r e m o v e ( ) ; } 
 r e t u r n ; } 
 s e l f . $ e r r o r T e x t . r e p l a c e W i t h ( Q W e b . r e n d e r ( ' w y s i w y g . w i d g e t s . i m a g e . e x i s t i n g . e r r o r ' , { v i e w s : p r e v e n t e d [ i d ] , w i d g e t : s e l f , } ) ) ; } ) ; } } ) ; } , _ o n U R L I n p u t C h a n g e : f u n c t i o n ( ) { v a r   i n p u t V a l u e = t h i s . $ u r l I n p u t . v a l ( ) ; v a r   e m p t y V a l u e = ( i n p u t V a l u e = = = ' ' ) ; v a r   i s U R L = / ^ . + \ . . + $ / . t e s t ( i n p u t V a l u e ) ; v a r   i s I m a g e = _ . a n y ( [ ' . g i f ' , ' . j p e g ' , ' . j p e ' , ' . j p g ' , ' . p n g ' ] , f u n c t i o n ( f o r m a t ) { r e t u r n   i n p u t V a l u e . e n d s W i t h ( f o r m a t ) ; } ) ; t h i s . _ u p d a t e A d d U r l U i ( e m p t y V a l u e , i s U R L , i s I m a g e ) ; } , _ o n U p l o a d B u t t o n C l i c k : f u n c t i o n ( ) { t h i s . $ f i l e I n p u t . c l i c k ( ) ; } , _ o n U p l o a d U R L B u t t o n C l i c k : f u n c t i o n ( ) { i f ( t h i s . $ u r l I n p u t . i s ( ' . o _ w e _ h o r i z o n t a l _ c o l l a p s e ' ) ) { t h i s . $ u r l I n p u t . r e m o v e C l a s s ( ' o _ w e _ h o r i z o n t a l _ c o l l a p s e ' ) ; t h i s . $ a d d U r l B u t t o n . a t t r ( ' d i s a b l e d ' , ' d i s a b l e d ' ) ; r e t u r n ; } 
 r e t u r n   t h i s . _ m u t e x . e x e c ( t h i s . _ a d d U r l . b i n d ( t h i s ) ) ; } , _ a d d U r l : f u n c t i o n ( ) { v a r   s e l f = t h i s ; r e t u r n   t h i s . _ r p c ( { r o u t e : ' / w e b _ e d i t o r / a t t a c h m e n t / a d d _ u r l ' , p a r a m s : { ' u r l ' : t h i s . $ u r l I n p u t . v a l ( ) , ' r e s _ i d ' : t h i s . o p t i o n s . r e s _ i d , ' r e s _ m o d e l ' : t h i s . o p t i o n s . r e s _ m o d e l , } , } ) . t h e n ( f u n c t i o n ( a t t a c h m e n t ) { s e l f . $ u r l I n p u t . v a l ( ' ' ) ; s e l f . _ o n U R L I n p u t C h a n g e ( ) ; s e l f . _ h a n d l e N e w A t t a c h m e n t ( a t t a c h m e n t ) ; i f ( ! s e l f . o p t i o n s . m u l t i I m a g e s ) { s e l f . t r i g g e r _ u p ( ' s a v e _ r e q u e s t ' ) ; } } ) ; } , _ o n L o a d M o r e C l i c k : f u n c t i o n ( ) { t h i s . _ l o a d M o r e I m a g e s ( ) ; } , _ o n S e a r c h I n p u t : f u n c t i o n ( ) { t h i s . a t t a c h m e n t s = [ ] ; t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y = t h i s . N U M B E R _ O F _ A T T A C H M E N T S _ T O _ D I S P L A Y ; t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , } ) ; v a r   I m a g e W i d g e t = F i l e W i d g e t . e x t e n d ( { t e m p l a t e : ' w y s i w y g . w i d g e t s . i m a g e ' , e x i s t i n g A t t a c h m e n t s T e m p l a t e : ' w y s i w y g . w i d g e t s . i m a g e . e x i s t i n g . a t t a c h m e n t s ' , e v e n t s : O b j e c t . a s s i g n ( { } , F i l e W i d g e t . p r o t o t y p e . e v e n t s , { ' c h a n g e   i n p u t . o _ w e _ s h o w _ o p t i m i z e d ' : ' _ o n S h o w O p t i m i z e d C h a n g e ' , ' c h a n g e   . o _ w e _ s e a r c h _ s e l e c t ' : ' _ o n S e a r c h S e l e c t ' , } ) , M I N _ R O W _ H E I G H T : 1 2 8 , i n i t : f u n c t i o n ( p a r e n t , m e d i a , o p t i o n s ) { t h i s . s e a r c h S e r v i c e = ' a l l ' ; o p t i o n s = _ . e x t e n d ( { a c c e p t : ' i m a g e / * ' , m i m e t y p e D o m a i n : [ [ ' m i m e t y p e ' , ' i n ' , t h i s . I M A G E _ M I M E T Y P E S ] ] , } , o p t i o n s | | { } ) ; t h i s . _ o n A t t a c h m e n t I m a g e L o a d = t h i s . _ o n A t t a c h m e n t I m a g e L o a d . b i n d ( t h i s ) ; t h i s . _ s u p e r ( p a r e n t , m e d i a , o p t i o n s ) ; } , s t a r t : a s y n c   f u n c t i o n ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . e l . a d d E v e n t L i s t e n e r ( ' l o a d ' , t h i s . _ o n A t t a c h m e n t I m a g e L o a d , t r u e ) ; } , d e s t r o y : f u n c t i o n ( ) { t h i s . e l . r e m o v e E v e n t L i s t e n e r ( ' l o a d ' , t h i s . _ o n A t t a c h m e n t I m a g e L o a d , t r u e ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , a s y n c   f e t c h A t t a c h m e n t s ( n u m b e r , o f f s e t ) { i f ( t h i s . n e e d l e & & t h i s . s e a r c h S e r v i c e ! = = ' d a t a b a s e ' ) { n u m b e r = t h i s . M A X _ D B _ A T T A C H M E N T S ; o f f s e t = 0 ; } 
 c o n s t   r e s u l t = a w a i t   t h i s . _ s u p e r ( n u m b e r , o f f s e t ) ; c o n s t   p r i m a r y C o l o r = g e t C S S V a r i a b l e V a l u e ( ' o - c o l o r - 1 ' ) ; t h i s . a t t a c h m e n t s . f o r E a c h ( a t t a c h m e n t = > { i f ( a t t a c h m e n t . i m a g e _ s r c . s t a r t s W i t h ( ' / ' ) ) { c o n s t   n e w U R L = n e w   U R L ( a t t a c h m e n t . i m a g e _ s r c , w i n d o w . l o c a t i o n . o r i g i n ) ; i f ( a t t a c h m e n t . i m a g e _ s r c . s t a r t s W i t h ( ' / w e b _ e d i t o r / s h a p e / ' ) ) { n e w U R L . s e a r c h P a r a m s . s e t ( ' c 1 ' , p r i m a r y C o l o r ) ; } e l s e { n e w U R L . s e a r c h P a r a m s . s e t ( ' h e i g h t ' , 2 * t h i s . M I N _ R O W _ H E I G H T ) ; } 
 a t t a c h m e n t . t h u m b n a i l _ s r c = n e w U R L . p a t h n a m e + n e w U R L . s e a r c h ; } } ) ; i f ( t h i s . n e e d l e ) { t r y { c o n s t   r e s p o n s e = a w a i t   t h i s . _ r p c ( { r o u t e : ' / w e b _ e d i t o r / m e d i a _ l i b r a r y _ s e a r c h ' , p a r a m s : { ' q u e r y ' : t h i s . n e e d l e , ' o f f s e t ' : t h i s . l i b r a r y M e d i a . l e n g t h , } , } ) ; c o n s t   n e w M e d i a = r e s p o n s e . m e d i a ; t h i s . n b M e d i a R e s u l t s = r e s p o n s e . r e s u l t s ; t h i s . l i b r a r y M e d i a . p u s h ( . . . n e w M e d i a ) ; } c a t c h ( e ) { c o n s o l e . e r r o r ( ` C o u l d n ' t   r e a c h   A P I   e n d p o i n t . ` ) ; } } 
 r e t u r n   r e s u l t ; } , h a s C o n t e n t ( ) { i f ( t h i s . s e a r c h S e r v i c e = = = ' a l l ' ) { r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) | | t h i s . l i b r a r y M e d i a . l e n g t h ; } e l s e   i f ( t h i s . s e a r c h S e r v i c e = = = ' m e d i a - l i b r a r y ' ) { r e t u r n ! ! t h i s . l i b r a r y M e d i a . l e n g t h ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ u p d a t e A d d U r l U i : f u n c t i o n ( e m p t y V a l u e , i s U R L , i s I m a g e ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . $ a d d U r l B u t t o n . t e x t ( ( i s U R L & & ! i s I m a g e ) ? _ t ( " A d d   a s   d o c u m e n t " ) : _ t ( " A d d   i m a g e " ) ) ; c o n s t   w a r n i n g = i s U R L & & ! i s I m a g e ; t h i s . $ u r l W a r n i n g . t o g g l e C l a s s ( ' d - n o n e ' , ! w a r n i n g ) ; i f ( w a r n i n g ) { t h i s . $ u r l S u c c e s s . a d d C l a s s ( ' d - n o n e ' ) ; } } , _ r e n d e r T h u m b n a i l s : f u n c t i o n ( ) { c o n s t   a l r e a d y L o a d e d = t h i s . $ ( ' . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l [ d a t a - l o a d e d = " t r u e " ] ' ) ; t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . $ ( ' . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l ' ) . a d d C l a s s ( ' d - n o n e ' ) ; a l r e a d y L o a d e d . e a c h ( ( i n d e x , e l ) = > { c o n s t   t o R e p l a c e = t h i s . $ ( ` . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l [ d a t a - i d = " $ { e l . d a t a s e t . i d } " ] ,   . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l [ d a t a - m e d i a - i d = " $ { e l . d a t a s e t . m e d i a I d } " ] ` ) ; i f ( t o R e p l a c e . l e n g t h ) { t o R e p l a c e . r e p l a c e W i t h ( e l ) ; } } ) ; t h i s . _ t o g g l e O p t i m i z e d ( t h i s . $ ( ' i n p u t . o _ w e _ s h o w _ o p t i m i z e d ' ) [ 0 ] . c h e c k e d ) ; c o n s t   p l a c e h o l d e r W i d t h = 3 / 2 * t h i s . M I N _ R O W _ H E I G H T ; t h i s . $ ( ' . o _ w e _ a t t a c h m e n t _ p l a c e h o l d e r ' ) . c s s ( { f l e x G r o w : p l a c e h o l d e r W i d t h , f l e x B a s i s : p l a c e h o l d e r W i d t h , } ) ; i f ( t h i s . n e e d l e & & [ ' m e d i a - l i b r a r y ' , ' a l l ' ] . i n c l u d e s ( t h i s . s e a r c h S e r v i c e ) ) { c o n s t   n o M o r e I m g T o L o a d = t h i s . l i b r a r y M e d i a . l e n g t h = = = t h i s . n b M e d i a R e s u l t s ; c o n s t   n o L o a d M o r e B u t t o n = n o M o r e I m g T o L o a d & & t h i s . l i b r a r y M e d i a . l e n g t h < = 1 5 ; t h i s . $ ( ' . o _ l o a d _ d o n e _ m s g ' ) . t o g g l e C l a s s ( ' d - n o n e ' , n o L o a d M o r e B u t t o n | | ! n o M o r e I m g T o L o a d ) ; t h i s . $ ( ' . o _ l o a d _ m o r e ' ) . t o g g l e C l a s s ( ' d - n o n e ' , n o M o r e I m g T o L o a d ) ; } } , _ r e n d e r E x i s t i n g : f u n c t i o n ( a t t a c h m e n t s ) { i f ( t h i s . n e e d l e & & t h i s . s e a r c h S e r v i c e ! = = ' d a t a b a s e ' ) { a t t a c h m e n t s = a t t a c h m e n t s . s l i c e ( 0 , t h i s . M A X _ D B _ A T T A C H M E N T S ) ; } 
 r e t u r n   Q W e b . r e n d e r ( t h i s . e x i s t i n g A t t a c h m e n t s T e m p l a t e , { a t t a c h m e n t s : a t t a c h m e n t s , l i b r a r y M e d i a : t h i s . l i b r a r y M e d i a , w i d g e t : t h i s , } ) ; } , _ t o g g l e O p t i m i z e d : f u n c t i o n ( v a l u e ) { t h i s . $ ( ' . o _ w e _ a t t a c h m e n t _ o p t i m i z e d ' ) . e a c h ( ( i , c e l l ) = > c e l l . s t y l e . s e t P r o p e r t y ( ' d i s p l a y ' , v a l u e ? n u l l : ' n o n e ' , ' i m p o r t a n t ' ) ) ; } , _ h i g h l i g h t S e l e c t e d : f u n c t i o n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . s e l e c t e d M e d i a . f o r E a c h ( m e d i a = > { t h i s . $ ( ` . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l [ d a t a - m e d i a - i d = $ { m e d i a . i d } ] ` ) . a d d C l a s s ( " o _ w e _ a t t a c h m e n t _ s e l e c t e d " ) ; } ) ; } , _ o n A t t a c h m e n t I m a g e L o a d : a s y n c   f u n c t i o n ( e v ) { c o n s t   i m g = e v . t a r g e t ; c o n s t   c e l l = i m g . c l o s e s t ( ' . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l ' ) ; i f ( ! c e l l ) { r e t u r n ; } 
 i f ( c e l l . d a t a s e t . m e d i a I d & & ! i m g . s r c . s t a r t s W i t h ( ' b l o b ' ) ) { c o n s t   m e d i a U r l = i m g . s r c ; t r y { c o n s t   r e s p o n s e = a w a i t   f e t c h ( m e d i a U r l ) ; i f ( r e s p o n s e . h e a d e r s . g e t ( ' c o n t e n t - t y p e ' ) = = = ' i m a g e / s v g + x m l ' ) { c o n s t   s v g = a w a i t   r e s p o n s e . t e x t ( ) ; c o n s t   c o l o r R e g e x = n e w   R e g E x p ( D E F A U L T _ P A L E T T E [ ' 1 ' ] , ' g i ' ) ; i f ( c o l o r R e g e x . t e s t ( s v g ) ) { c o n s t   f i l e N a m e = m e d i a U r l . s p l i t ( ' / ' ) . p o p ( ) ; c o n s t   f i l e = n e w   F i l e ( [ s v g . r e p l a c e ( c o l o r R e g e x , g e t C S S V a r i a b l e V a l u e ( ' o - c o l o r - 1 ' ) ) ] , f i l e N a m e , { t y p e : " i m a g e / s v g + x m l " , } ) ; i m g . s r c = U R L . c r e a t e O b j e c t U R L ( f i l e ) ; c o n s t   m e d i a = t h i s . l i b r a r y M e d i a . f i n d ( m e d i a = > m e d i a . i d = = = p a r s e I n t ( c e l l . d a t a s e t . m e d i a I d ) ) ; i f ( m e d i a ) { m e d i a . i s D y n a m i c S V G = t r u e ; } 
 r e t u r n ; } } } c a t c h ( e ) { c o n s o l e . e r r o r ( ' C O R S   i s   m i s c o n f i g u r e d   o n   t h e   A P I   s e r v e r ,   i m a g e   w i l l   b e   t r e a t e d   a s   n o n - d y n a m i c . ' ) ; } } 
 l e t   a s p e c t R a t i o = i m g . n a t u r a l W i d t h / i m g . n a t u r a l H e i g h t ; i f ( i m g . n a t u r a l H e i g h t = = = 0 ) { i m g . w i d t h = 1 0 0 0 ; i m g . s t y l e . p o s i t i o n = ' f i x e d ' ; i m g . s t y l e . o p a c i t y = ' 0 ' ; c o n s t   o r i g i n a l P a r e n t = i m g . p a r e n t E l e m e n t ; d o c u m e n t . b o d y . a p p e n d C h i l d ( i m g ) ; a s p e c t R a t i o = i m g . w i d t h / i m g . h e i g h t ; o r i g i n a l P a r e n t . a p p e n d C h i l d ( i m g ) ; i m g . r e m o v e A t t r i b u t e ( ' w i d t h ' ) ; i m g . s t y l e . r e m o v e P r o p e r t y ( ' p o s i t i o n ' ) ; i m g . s t y l e . r e m o v e P r o p e r t y ( ' o p a c i t y ' ) ; } 
 c o n s t   w i d t h = a s p e c t R a t i o * t h i s . M I N _ R O W _ H E I G H T ; c e l l . s t y l e . f l e x G r o w = w i d t h ; c e l l . s t y l e . f l e x B a s i s = ` $ { w i d t h } p x ` ; c e l l . c l a s s L i s t . r e m o v e ( ' d - n o n e ' ) ; c e l l . c l a s s L i s t . a d d ( ' d - f l e x ' ) ; c e l l . d a t a s e t . l o a d e d = ' t r u e ' ; } , _ o n S h o w O p t i m i z e d C h a n g e : f u n c t i o n ( e v ) { t h i s . _ t o g g l e O p t i m i z e d ( e v . t a r g e t . c h e c k e d ) ; } , _ o n S e a r c h S e l e c t : f u n c t i o n ( e v ) { c o n s t { v a l u e } = e v . t a r g e t ; t h i s . s e a r c h S e r v i c e = v a l u e ; t h i s . $ ( ' . o _ w e _ s e a r c h ' ) . t r i g g e r ( ' i n p u t ' ) ; } , _ o n S e a r c h I n p u t : f u n c t i o n ( e v ) { t h i s . l i b r a r y M e d i a = [ ] ; t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , } ) ; v a r   D o c u m e n t W i d g e t = F i l e W i d g e t . e x t e n d ( { t e m p l a t e : ' w y s i w y g . w i d g e t s . d o c u m e n t ' , e x i s t i n g A t t a c h m e n t s T e m p l a t e : ' w y s i w y g . w i d g e t s . d o c u m e n t . e x i s t i n g . a t t a c h m e n t s ' , i n i t : f u n c t i o n ( p a r e n t , m e d i a , o p t i o n s ) { o p t i o n s = _ . e x t e n d ( { a c c e p t : ' * / * ' , m i m e t y p e D o m a i n : [ [ ' m i m e t y p e ' , ' n o t   i n ' , t h i s . I M A G E _ M I M E T Y P E S ] ] , } , o p t i o n s | | { } ) ; t h i s . _ s u p e r ( p a r e n t , m e d i a , o p t i o n s ) ; } , _ u p d a t e A d d U r l U i : f u n c t i o n ( e m p t y V a l u e , i s U R L , i s I m a g e ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . $ a d d U r l B u t t o n . t e x t ( ( i s U R L & & i s I m a g e ) ? _ t ( " A d d   a s   i m a g e " ) : _ t ( " A d d   d o c u m e n t " ) ) ; c o n s t   w a r n i n g = i s U R L & & i s I m a g e ; t h i s . $ u r l W a r n i n g . t o g g l e C l a s s ( ' d - n o n e ' , ! w a r n i n g ) ; i f ( w a r n i n g ) { t h i s . $ u r l S u c c e s s . a d d C l a s s ( ' d - n o n e ' ) ; } } , _ g e t A t t a c h m e n t s D o m a i n : f u n c t i o n ( n e e d l e ) { v a r   d o m a i n = t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; r e t u r n   d o m a i n . c o n c a t ( ' ! ' , u t i l s . a s s e t s D o m a i n ( ) ) ; } , } ) ; v a r   I c o n W i d g e t = S e a r c h a b l e M e d i a W i d g e t . e x t e n d ( { t e m p l a t e : ' w y s i w y g . w i d g e t s . f o n t - i c o n s ' , e v e n t s : _ . e x t e n d ( { } , S e a r c h a b l e M e d i a W i d g e t . p r o t o t y p e . e v e n t s | | { } , { ' c l i c k   . f o n t - i c o n s - i c o n ' : ' _ o n I c o n C l i c k ' , } ) , i n i t : f u n c t i o n ( p a r e n t , m e d i a ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; f o n t s . c o m p u t e F o n t s ( ) ; t h i s . i c o n s P a r s e r = f o n t s . f o n t I c o n s ; t h i s . a l i a s = _ . f l a t t e n ( _ . m a p ( t h i s . i c o n s P a r s e r , f u n c t i o n ( d a t a ) { r e t u r n   d a t a . a l i a s ; } ) ) ; } , s t a r t : f u n c t i o n ( ) { t h i s . $ i c o n s = t h i s . $ ( ' . f o n t - i c o n s - i c o n ' ) ; v a r   c l a s s e s = ( t h i s . m e d i a & & t h i s . m e d i a . c l a s s N a m e | | ' ' ) . s p l i t ( / \ s + / ) ; f o r ( v a r   i = 0 ; i < c l a s s e s . l e n g t h ; i + + ) { v a r   c l s = c l a s s e s [ i ] ; i f ( _ . c o n t a i n s ( t h i s . a l i a s , c l s ) ) { t h i s . s e l e c t e d I c o n = c l s ; t h i s . _ h i g h l i g h t S e l e c t e d I c o n ( ) ; } } 
 t h i s . n o n I c o n C l a s s e s = _ . w i t h o u t ( c l a s s e s , ' m e d i a _ i f r a m e _ v i d e o ' , t h i s . s e l e c t e d I c o n ) ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , s a v e : f u n c t i o n ( ) { v a r   s t y l e = t h i s . $ m e d i a . a t t r ( ' s t y l e ' ) | | ' ' ; v a r   i c o n F o n t = t h i s . _ g e t F o n t ( t h i s . s e l e c t e d I c o n ) | | { b a s e : ' f a ' , f o n t : ' ' } ; v a r   f i n a l C l a s s e s = _ . u n i q ( t h i s . n o n I c o n C l a s s e s . c o n c a t ( [ i c o n F o n t . b a s e , i c o n F o n t . f o n t ] ) ) ; i f ( ! t h i s . $ m e d i a . i s ( ' s p a n ,   i ' ) ) { v a r   $ s p a n = $ ( ' < s p a n / > ' ) ; $ s p a n . d a t a ( t h i s . $ m e d i a . d a t a ( ) ) ; t h i s . $ m e d i a = $ s p a n ; t h i s . m e d i a = t h i s . $ m e d i a [ 0 ] ; s t y l e = s t y l e . r e p l a c e ( / \ s * w i d t h : [ ^ ; ] + / , ' ' ) ; } 
 t h i s . $ m e d i a . a t t r ( { c l a s s : _ . c o m p a c t ( f i n a l C l a s s e s ) . j o i n ( '   ' ) , s t y l e : s t y l e | | n u l l , } ) ; r e t u r n   P r o m i s e . r e s o l v e ( t h i s . m e d i a ) ; } , s e a r c h : f u n c t i o n ( n e e d l e ) { v a r   i c o n s P a r s e r = t h i s . i c o n s P a r s e r ; i f ( n e e d l e & & n e e d l e . l e n g t h ) { i c o n s P a r s e r = [ ] ; _ . f i l t e r ( t h i s . i c o n s P a r s e r , f u n c t i o n ( d a t a ) { v a r   c s s D a t a = _ . f i l t e r ( d a t a . c s s D a t a , f u n c t i o n ( c s s D a t a ) { r e t u r n   _ . f i n d ( c s s D a t a . n a m e s , f u n c t i o n ( a l i a s ) { r e t u r n   a l i a s . i n d e x O f ( n e e d l e ) > = 0 ; } ) ; } ) ; i f ( c s s D a t a . l e n g t h ) { i c o n s P a r s e r . p u s h ( { b a s e : d a t a . b a s e , c s s D a t a : c s s D a t a , } ) ; } } ) ; } 
 t h i s . $ ( ' d i v . f o n t - i c o n s - i c o n s ' ) . h t m l ( Q W e b . r e n d e r ( ' w y s i w y g . w i d g e t s . f o n t - i c o n s . i c o n s ' , { i c o n s P a r s e r : i c o n s P a r s e r , w i d g e t : t h i s } ) ) ; r e t u r n   P r o m i s e . r e s o l v e ( ) ; } , _ c l e a r : f u n c t i o n ( ) { v a r   a l l F a C l a s s e s = / ( ^ | \ s ) ( f a ( \ s | $ ) | f a - [ ^ \ s ] * ) / g ; t h i s . m e d i a . c l a s s N a m e = t h i s . m e d i a . c l a s s N a m e & & t h i s . m e d i a . c l a s s N a m e . r e p l a c e ( a l l F a C l a s s e s , '   ' ) ; } , _ g e t F o n t : f u n c t i o n ( c l a s s N a m e s ) { i f ( ! ( c l a s s N a m e s   i n s t a n c e o f   A r r a y ) ) { c l a s s N a m e s = ( c l a s s N a m e s | | " " ) . s p l i t ( / \ s + / ) ; } 
 v a r   f o n t I c o n , c s s D a t a ; f o r ( v a r   k = 0 ; k < t h i s . i c o n s P a r s e r . l e n g t h ; k + + ) { f o n t I c o n = t h i s . i c o n s P a r s e r [ k ] ; f o r ( v a r   s = 0 ; s < f o n t I c o n . c s s D a t a . l e n g t h ; s + + ) { c s s D a t a = f o n t I c o n . c s s D a t a [ s ] ; i f ( _ . i n t e r s e c t i o n ( c l a s s N a m e s , c s s D a t a . n a m e s ) . l e n g t h ) { r e t u r n { b a s e : f o n t I c o n . b a s e , p a r s e r : f o n t I c o n . p a r s e r , f o n t : c s s D a t a . n a m e s [ 0 ] , } ; } } } 
 r e t u r n   n u l l ; } , _ h i g h l i g h t S e l e c t e d I c o n : f u n c t i o n ( ) { v a r   s e l f = t h i s ; t h i s . $ i c o n s . r e m o v e C l a s s ( ' o _ w e _ a t t a c h m e n t _ s e l e c t e d ' ) ; t h i s . $ i c o n s . f i l t e r ( f u n c t i o n ( i , e l ) { r e t u r n   _ . c o n t a i n s ( $ ( e l ) . d a t a ( ' a l i a s ' ) . s p l i t ( ' , ' ) , s e l f . s e l e c t e d I c o n ) ; } ) . a d d C l a s s ( ' o _ w e _ a t t a c h m e n t _ s e l e c t e d ' ) ; } , _ o n I c o n C l i c k : f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; e v . s t o p P r o p a g a t i o n ( ) ; t h i s . s e l e c t e d I c o n = $ ( e v . c u r r e n t T a r g e t ) . d a t a ( ' i d ' ) ; t h i s . _ h i g h l i g h t S e l e c t e d I c o n ( ) ; t h i s . t r i g g e r _ u p ( ' s a v e _ r e q u e s t ' ) ; } , } ) ; v a r   V i d e o W i d g e t = M e d i a W i d g e t . e x t e n d ( { t e m p l a t e : ' w y s i w y g . w i d g e t s . v i d e o ' , e v e n t s : _ . e x t e n d ( { } , M e d i a W i d g e t . p r o t o t y p e . e v e n t s | | { } , { ' c h a n g e   . o _ v i d e o _ d i a l o g _ o p t i o n s   i n p u t ' : ' _ o n U p d a t e V i d e o O p t i o n ' , ' i n p u t   t e x t a r e a # o _ v i d e o _ t e x t ' : ' _ o n V i d e o C o d e I n p u t ' , ' c h a n g e   t e x t a r e a # o _ v i d e o _ t e x t ' : ' _ o n V i d e o C o d e C h a n g e ' , } ) , i n i t : f u n c t i o n ( p a r e n t , m e d i a , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . i s F o r B g V i d e o = ! ! o p t i o n s . i s F o r B g V i d e o ; t h i s . _ o n V i d e o C o d e I n p u t = _ . d e b o u n c e ( t h i s . _ o n V i d e o C o d e I n p u t , 1 0 0 0 ) ; } , s t a r t : f u n c t i o n ( ) { t h i s . $ c o n t e n t = t h i s . $ ( ' . o _ v i d e o _ d i a l o g _ i f r a m e ' ) ; i f ( t h i s . m e d i a ) { v a r   $ m e d i a = $ ( t h i s . m e d i a ) ; v a r   s r c = $ m e d i a . d a t a ( ' o e - e x p r e s s i o n ' ) | | $ m e d i a . d a t a ( ' s r c ' ) | | ( $ m e d i a . i s ( ' i f r a m e ' ) ? $ m e d i a . a t t r ( ' s r c ' ) : ' ' ) | | ' ' ; t h i s . $ ( ' t e x t a r e a # o _ v i d e o _ t e x t ' ) . v a l ( s r c ) ; t h i s . $ ( ' i n p u t # o _ v i d e o _ a u t o p l a y ' ) . p r o p ( ' c h e c k e d ' , s r c . i n d e x O f ( ' a u t o p l a y = 1 ' ) > = 0 ) ; t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ c o n t r o l s ' ) . p r o p ( ' c h e c k e d ' , s r c . i n d e x O f ( ' c o n t r o l s = 0 ' ) > = 0 ) ; t h i s . $ ( ' i n p u t # o _ v i d e o _ l o o p ' ) . p r o p ( ' c h e c k e d ' , s r c . i n d e x O f ( ' l o o p = 1 ' ) > = 0 ) ; t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ f u l l s c r e e n ' ) . p r o p ( ' c h e c k e d ' , s r c . i n d e x O f ( ' f s = 0 ' ) > = 0 ) ; t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ y t _ l o g o ' ) . p r o p ( ' c h e c k e d ' , s r c . i n d e x O f ( ' m o d e s t b r a n d i n g = 1 ' ) > = 0 ) ; t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ d m _ l o g o ' ) . p r o p ( ' c h e c k e d ' , s r c . i n d e x O f ( ' u i - l o g o = 0 ' ) > = 0 ) ; t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ d m _ s h a r e ' ) . p r o p ( ' c h e c k e d ' , s r c . i n d e x O f ( ' s h a r i n g - e n a b l e = 0 ' ) > = 0 ) ; t h i s . _ u p d a t e V i d e o ( ) ; } 
 r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , s a v e : f u n c t i o n ( ) { t h i s . _ u p d a t e V i d e o ( ) ; i f ( t h i s . i s F o r B g V i d e o ) { r e t u r n   P r o m i s e . r e s o l v e ( { b g V i d e o S r c : t h i s . $ c o n t e n t . a t t r ( ' s r c ' ) } ) ; } 
 i f ( t h i s . $ ( ' . o _ v i d e o _ d i a l o g _ i f r a m e ' ) . i s ( ' i f r a m e ' ) ) { t h i s . $ m e d i a = $ ( ' < d i v   c l a s s = " m e d i a _ i f r a m e _ v i d e o "   d a t a - o e - e x p r e s s i o n = " ' + t h i s . $ c o n t e n t . a t t r ( ' s r c ' ) + ' " > ' + ' < d i v   c l a s s = " c s s _ e d i t a b l e _ m o d e _ d i s p l a y " > & n b s p ; < / d i v > ' + ' < d i v   c l a s s = " m e d i a _ i f r a m e _ v i d e o _ s i z e "   c o n t e n t e d i t a b l e = " f a l s e " > & n b s p ; < / d i v > ' + ' < i f r a m e   s r c = " ' + t h i s . $ c o n t e n t . a t t r ( ' s r c ' ) + ' "   f r a m e b o r d e r = " 0 "   c o n t e n t e d i t a b l e = " f a l s e "   a l l o w f u l l s c r e e n = " a l l o w f u l l s c r e e n " > < / i f r a m e > ' + ' < / d i v > ' ) ; t h i s . m e d i a = t h i s . $ m e d i a [ 0 ] ; } 
 r e t u r n   P r o m i s e . r e s o l v e ( t h i s . m e d i a ) ; } , _ c l e a r : f u n c t i o n ( ) { i f ( t h i s . m e d i a . d a t a s e t . s r c ) { t r y { d e l e t e   t h i s . m e d i a . d a t a s e t . s r c ; } c a t c h ( e ) { t h i s . m e d i a . d a t a s e t . s r c = u n d e f i n e d ; } } 
 v a r   a l l V i d e o C l a s s e s = / ( ^ | \ s ) m e d i a _ i f r a m e _ v i d e o ( \ s | $ ) / g ; v a r   i s V i d e o = t h i s . m e d i a . c l a s s N a m e & & t h i s . m e d i a . c l a s s N a m e . m a t c h ( a l l V i d e o C l a s s e s ) ; i f ( i s V i d e o ) { t h i s . m e d i a . c l a s s N a m e = t h i s . m e d i a . c l a s s N a m e . r e p l a c e ( a l l V i d e o C l a s s e s , '   ' ) ; t h i s . m e d i a . i n n e r H T M L = ' ' ; } } , _ c r e a t e V i d e o N o d e : f u n c t i o n ( u r l , o p t i o n s ) { o p t i o n s = o p t i o n s | | { } ; c o n s t   v i d e o D a t a = t h i s . _ g e t V i d e o U R L D a t a ( u r l , o p t i o n s ) ; i f ( v i d e o D a t a . e r r o r ) { r e t u r n { e r r o r C o d e : 0 } ; } 
 i f ( ! v i d e o D a t a . t y p e ) { r e t u r n { e r r o r C o d e : 1 } ; } 
 c o n s t   $ v i d e o = $ ( ' < i f r a m e > ' ) . w i d t h ( 1 2 8 0 ) . h e i g h t ( 7 2 0 ) . a t t r ( ' f r a m e b o r d e r ' , 0 ) . a t t r ( ' s r c ' , v i d e o D a t a . e m b e d U R L ) . a d d C l a s s ( ' o _ v i d e o _ d i a l o g _ i f r a m e ' ) ; r e t u r n { $ v i d e o : $ v i d e o , t y p e : v i d e o D a t a . t y p e } ; } , _ u p d a t e V i d e o : f u n c t i o n ( ) { t h i s . $ c o n t e n t . e m p t y ( ) ; t h i s . $ ( ' # o _ v i d e o _ f o r m _ g r o u p ' ) . r e m o v e C l a s s ( ' o _ h a s _ e r r o r   o _ h a s _ s u c c e s s ' ) . f i n d ( ' . f o r m - c o n t r o l ,   . c u s t o m - s e l e c t ' ) . r e m o v e C l a s s ( ' i s - i n v a l i d   i s - v a l i d ' ) ; t h i s . $ ( ' . o _ v i d e o _ d i a l o g _ o p t i o n s   d i v ' ) . a d d C l a s s ( ' d - n o n e ' ) ; v a r   $ t e x t a r e a = t h i s . $ ( ' t e x t a r e a # o _ v i d e o _ t e x t ' ) ; v a r   c o d e = $ t e x t a r e a . v a l ( ) . t r i m ( ) ; i f ( ! c o d e ) { r e t u r n ; } 
 v a r   e m b e d M a t c h = c o d e . m a t c h ( / ( s r c | h r e f ) = [ " ' ] ? ( [ ^ " ' ] + ) ? / ) ; i f ( e m b e d M a t c h & & e m b e d M a t c h [ 2 ] . l e n g t h > 0 & & e m b e d M a t c h [ 2 ] . i n d e x O f ( ' i n s t a g r a m ' ) ) { e m b e d M a t c h [ 1 ] = e m b e d M a t c h [ 2 ] ; } 
 v a r   u r l = e m b e d M a t c h ? e m b e d M a t c h [ 1 ] : c o d e ; v a r   q u e r y = t h i s . _ c r e a t e V i d e o N o d e ( u r l , { ' a u t o p l a y ' : t h i s . i s F o r B g V i d e o | | t h i s . $ ( ' i n p u t # o _ v i d e o _ a u t o p l a y ' ) . i s ( ' : c h e c k e d ' ) , ' h i d e _ c o n t r o l s ' : t h i s . i s F o r B g V i d e o | | t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ c o n t r o l s ' ) . i s ( ' : c h e c k e d ' ) , ' l o o p ' : t h i s . i s F o r B g V i d e o | | t h i s . $ ( ' i n p u t # o _ v i d e o _ l o o p ' ) . i s ( ' : c h e c k e d ' ) , ' h i d e _ f u l l s c r e e n ' : t h i s . i s F o r B g V i d e o | | t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ f u l l s c r e e n ' ) . i s ( ' : c h e c k e d ' ) , ' h i d e _ y t _ l o g o ' : t h i s . i s F o r B g V i d e o | | t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ y t _ l o g o ' ) . i s ( ' : c h e c k e d ' ) , ' h i d e _ d m _ l o g o ' : t h i s . i s F o r B g V i d e o | | t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ d m _ l o g o ' ) . i s ( ' : c h e c k e d ' ) , ' h i d e _ d m _ s h a r e ' : t h i s . i s F o r B g V i d e o | | t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ d m _ s h a r e ' ) . i s ( ' : c h e c k e d ' ) , } ) ; v a r   $ o p t B o x = t h i s . $ ( ' . o _ v i d e o _ d i a l o g _ o p t i o n s ' ) ; t h i s . $ e l . f i n d ( ' . o _ v i d e o _ d i a l o g _ p r e v i e w _ t e x t ,   . m e d i a _ i f r a m e _ v i d e o _ s i z e ' ) . a d d ( $ o p t B o x ) . t o g g l e C l a s s ( ' d - n o n e ' , ! q u e r y . $ v i d e o ) ; t h i s . $ e l . f i n d ( ' # o _ v i d e o _ f o r m _ g r o u p ' ) . t o g g l e C l a s s ( ' o _ h a s _ e r r o r ' , ! q u e r y . $ v i d e o ) . f i n d ( ' . f o r m - c o n t r o l ,   . c u s t o m - s e l e c t ' ) . t o g g l e C l a s s ( ' i s - i n v a l i d ' , ! q u e r y . $ v i d e o ) . e n d ( ) . t o g g l e C l a s s ( ' o _ h a s _ s u c c e s s ' , ! ! q u e r y . $ v i d e o ) . f i n d ( ' . f o r m - c o n t r o l ,   . c u s t o m - s e l e c t ' ) . t o g g l e C l a s s ( ' i s - v a l i d ' , ! ! q u e r y . $ v i d e o ) ; $ o p t B o x . f i n d ( ' d i v . o _ ' + q u e r y . t y p e + ' _ o p t i o n ' ) . r e m o v e C l a s s ( ' d - n o n e ' ) ; $ o p t B o x . t o g g l e C l a s s ( ' d - n o n e ' , t h i s . i s F o r B g V i d e o | | $ o p t B o x . f i n d ( ' d i v : n o t ( . d - n o n e ) ' ) . l e n g t h = = = 0 ) ; i f ( q u e r y . t y p e = = = ' y o u t u b e ' ) { t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ f u l l s c r e e n ,   i n p u t # o _ v i d e o _ h i d e _ y t _ l o g o ' ) . c l o s e s t ( ' d i v ' ) . t o g g l e C l a s s ( ' d - n o n e ' , t h i s . $ ( ' i n p u t # o _ v i d e o _ h i d e _ c o n t r o l s ' ) . i s ( ' : c h e c k e d ' ) ) ; } 
 v a r   $ c o n t e n t = q u e r y . $ v i d e o ; i f ( ! $ c o n t e n t ) { s w i t c h ( q u e r y . e r r o r C o d e ) { c a s e   0 : $ c o n t e n t = $ ( ' < d i v / > ' , { c l a s s : ' a l e r t   a l e r t - d a n g e r   o _ v i d e o _ d i a l o g _ i f r a m e   m b - 2   m t - 2 ' , t e x t : _ t ( " T h e   p r o v i d e d   u r l   i s   n o t   v a l i d " ) , } ) ; b r e a k ; c a s e   1 : $ c o n t e n t = $ ( ' < d i v / > ' , { c l a s s : ' a l e r t   a l e r t - w a r n i n g   o _ v i d e o _ d i a l o g _ i f r a m e   m b - 2   m t - 2 ' , t e x t : _ t ( " T h e   p r o v i d e d   u r l   d o e s   n o t   r e f e r e n c e   a n y   s u p p o r t e d   v i d e o " ) , } ) ; b r e a k ; } } 
 t h i s . $ c o n t e n t . r e p l a c e W i t h ( $ c o n t e n t ) ; t h i s . $ c o n t e n t = $ c o n t e n t ; } , _ o n U p d a t e V i d e o O p t i o n : f u n c t i o n ( ) { t h i s . _ u p d a t e V i d e o ( ) ; } , _ o n V i d e o C o d e C h a n g e : f u n c t i o n ( ) { t h i s . _ u p d a t e V i d e o ( ) ; } , _ o n V i d e o C o d e I n p u t : f u n c t i o n ( ) { t h i s . _ u p d a t e V i d e o ( ) ; } , _ g e t V i d e o U R L D a t a : f u n c t i o n ( u r l , o p t i o n s ) { i f ( ! u r l . m a t c h ( / ^ ( h t t p : \ / \ / | h t t p s : \ / \ / | \ / \ / ) [ a - z 0 - 9 ] + ( [ - . ] { 1 } [ a - z 0 - 9 ] + ) * \ . [ a - z ] { 2 , 5 } ( : [ 0 - 9 ] { 1 , 5 } ) ? ( \ / . * ) ? $ / i ) ) { r e t u r n { e r r o r : t r u e , m e s s a g e : ' T h e   p r o v i d e d   u r l   i s   i n v a l i d ' , } ; } 
 c o n s t   r e g e x e s = { y o u t u b e : / ^ ( ? : ( ? : h t t p s ? : ) ? \ / \ / ) ? ( ? : w w w \ . ) ? ( ? : y o u t u \ . b e \ / | y o u t u b e ( - n o c o o k i e ) ? \ . c o m \ / ( ? : e m b e d \ / | v \ / | w a t c h \ ? v = | w a t c h \ ? . + & v = ) ) ( ( ? : \ w | - ) { 1 1 } ) ( ? : \ S + ) ? $ / , i n s t a g r a m : / ( . * ) i n s t a g r a m . c o m \ / p \ / ( . [ a - z A - Z 0 - 9 ] * ) / , v i n e : / \ / \ / v i n e . c o \ / v \ / ( . [ a - z A - Z 0 - 9 ] * ) / , v i m e o : / \ / \ / ( p l a y e r . ) ? v i m e o . c o m \ / ( [ a - z ] * \ / ) * ( [ 0 - 9 ] { 6 , 1 1 } ) [ ? ] ? . * / , d a i l y m o t i o n : / . + d a i l y m o t i o n . c o m \ / ( v i d e o | h u b | e m b e d ) \ / ( [ ^ _ ? ] + ) [ ^ # ] * ( # v i d e o = ( [ ^ _ & ] + ) ) ? / , y o u k u : / ( . * ) . y o u k u \ . c o m \ / ( v _ s h o w \ / i d _ | e m b e d \ / ) ( . + ) / , } ; c o n s t   m a t c h e s = _ . m a p O b j e c t ( r e g e x e s , r e g e x = > u r l . m a t c h ( r e g e x ) ) ; c o n s t   a u t o p l a y = o p t i o n s . a u t o p l a y ? ' ? a u t o p l a y = 1 & m u t e = 1 ' : ' ? a u t o p l a y = 0 ' ; c o n s t   c o n t r o l s = o p t i o n s . h i d e _ c o n t r o l s ? ' & c o n t r o l s = 0 ' : ' ' ; c o n s t   l o o p = o p t i o n s . l o o p ? ' & l o o p = 1 ' : ' ' ; l e t   e m b e d U R L ; l e t   t y p e ; i f ( m a t c h e s . y o u t u b e & & m a t c h e s . y o u t u b e [ 2 ] . l e n g t h = = = 1 1 ) { c o n s t   f u l l s c r e e n = o p t i o n s . h i d e _ f u l l s c r e e n ? ' & f s = 0 ' : ' ' ; c o n s t   y t L o o p = l o o p ? l o o p + ` & p l a y l i s t = $ { m a t c h e s . y o u t u b e [ 2 ] } ` : ' ' ; c o n s t   l o g o = o p t i o n s . h i d e _ y t _ l o g o ? ' & m o d e s t b r a n d i n g = 1 ' : ' ' ; e m b e d U R L = ` / / w w w . y o u t u b e $ { m a t c h e s . y o u t u b e [ 1 ]   | |   ' ' } . c o m / e m b e d / $ { m a t c h e s . y o u t u b e [ 2 ] } $ { a u t o p l a y } & r e l = 0 $ { y t L o o p } $ { c o n t r o l s } $ { f u l l s c r e e n } $ { l o g o } ` ; t y p e = ' y o u t u b e ' ; } e l s e   i f ( m a t c h e s . i n s t a g r a m & & m a t c h e s . i n s t a g r a m [ 2 ] . l e n g t h ) { e m b e d U R L = ` / / w w w . i n s t a g r a m . c o m / p / $ { m a t c h e s . i n s t a g r a m [ 2 ] } / e m b e d / ` ; t y p e = ' i n s t a g r a m ' ; } e l s e   i f ( m a t c h e s . v i n e & & m a t c h e s . v i n e [ 0 ] . l e n g t h ) { e m b e d U R L = ` $ { m a t c h e s . v i n e [ 0 ] } / e m b e d / s i m p l e ` ; t y p e = ' v i n e ' ; } e l s e   i f ( m a t c h e s . v i m e o & & m a t c h e s . v i m e o [ 3 ] . l e n g t h ) { c o n s t   v i m e o A u t o p l a y = a u t o p l a y . r e p l a c e ( ' m u t e ' , ' m u t e d ' ) ; e m b e d U R L = ` / / p l a y e r . v i m e o . c o m / v i d e o / $ { m a t c h e s . v i m e o [ 3 ] } $ { v i m e o A u t o p l a y } $ { l o o p } ` ; t y p e = ' v i m e o ' ; } e l s e   i f ( m a t c h e s . d a i l y m o t i o n & & m a t c h e s . d a i l y m o t i o n [ 2 ] . l e n g t h ) { c o n s t   v i d e o I d = m a t c h e s . d a i l y m o t i o n [ 2 ] . r e p l a c e ( ' v i d e o / ' , ' ' ) ; c o n s t   l o g o = o p t i o n s . h i d e _ d m _ l o g o ? ' & u i - l o g o = 0 ' : ' ' ; c o n s t   s h a r e = o p t i o n s . h i d e _ d m _ s h a r e ? ' & s h a r i n g - e n a b l e = 0 ' : ' ' ; e m b e d U R L = ` / / w w w . d a i l y m o t i o n . c o m / e m b e d / v i d e o / $ { v i d e o I d } $ { a u t o p l a y } $ { c o n t r o l s } $ { l o g o } $ { s h a r e } ` ; t y p e = ' d a i l y m o t i o n ' ; } e l s e   i f ( m a t c h e s . y o u k u & & m a t c h e s . y o u k u [ 3 ] . l e n g t h ) { c o n s t   v i d e o I d = m a t c h e s . y o u k u [ 3 ] . i n d e x O f ( ' . h t m l ? ' ) > = 0 ? m a t c h e s . y o u k u [ 3 ] . s u b s t r i n g ( 0 , m a t c h e s . y o u k u [ 3 ] . i n d e x O f ( ' . h t m l ? ' ) ) : m a t c h e s . y o u k u [ 3 ] ; e m b e d U R L = ` / / p l a y e r . y o u k u . c o m / e m b e d / $ { v i d e o I d } ` ; t y p e = ' y o u k u ' ; } 
 r e t u r n { t y p e : t y p e , e m b e d U R L : e m b e d U R L } ; } , } ) ; r e t u r n { M e d i a W i d g e t : M e d i a W i d g e t , S e a r c h a b l e M e d i a W i d g e t : S e a r c h a b l e M e d i a W i d g e t , F i l e W i d g e t : F i l e W i d g e t , I m a g e W i d g e t : I m a g e W i d g e t , D o c u m e n t W i d g e t : D o c u m e n t W i d g e t , I c o n W i d g e t : I c o n W i d g e t , V i d e o W i d g e t : V i d e o W i d g e t , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / d i a l o g . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . w i d g e t s . D i a l o g ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o n f i g = r e q u i r e ( ' w e b . c o n f i g ' ) ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   D i a l o g = r e q u i r e ( ' w e b . D i a l o g ' ) ; v a r   _ t = c o r e . _ t ; v a r   S u m m e r n o t e D i a l o g = D i a l o g . e x t e n d ( { i n i t : f u n c t i o n ( p a r e n t , o p t i o n s ) { t h i s . o p t i o n s = o p t i o n s | | { } ; i f ( c o n f i g . d e v i c e . i s M o b i l e ) { o p t i o n s . f u l l s c r e e n = t r u e ; } 
 t h i s . _ s u p e r ( p a r e n t , _ . e x t e n d ( { } , { b u t t o n s : [ { t e x t : t h i s . o p t i o n s . s a v e _ t e x t | | _ t ( " S a v e " ) , c l a s s e s : ' b t n - p r i m a r y ' , c l i c k : t h i s . s a v e , } , { t e x t : _ t ( " D i s c a r d " ) , c l o s e : t r u e , } ] } , t h i s . o p t i o n s ) ) ; t h i s . d e s t r o y A c t i o n = ' c a n c e l ' ; v a r   s e l f = t h i s ; t h i s . o p e n e d ( f u n c t i o n ( ) { s e l f . $ ( ' i n p u t : v i s i b l e : f i r s t ' ) . f o c u s ( ) ; s e l f . $ e l . c l o s e s t ( ' . m o d a l ' ) . a d d C l a s s ( ' o _ w e b _ e d i t o r _ d i a l o g ' ) ; s e l f . $ e l . c l o s e s t ( ' . m o d a l ' ) . o n ( ' h i d d e n . b s . m o d a l ' , s e l f . o p t i o n s . o n C l o s e ) ; } ) ; t h i s . o n ( ' c l o s e d ' , t h i s , f u n c t i o n ( ) { s e l f . _ t o g g l e F u l l S c r e e n ( ) ; t h i s . t r i g g e r ( t h i s . d e s t r o y A c t i o n , t h i s . f i n a l _ d a t a | | n u l l ) ; } ) ; } , _ t o g g l e F u l l S c r e e n : f u n c t i o n ( ) { i f ( c o n f i g . d e v i c e . i s M o b i l e & & ! t h i s . h a s F u l l S c r e e n ) { $ ( ' # i f r a m e _ t a r g e t [ i s M o b i l e = " t r u e " ]   # w e b _ e d i t o r - t o p - e d i t   . o _ f u l l s c r e e n ' ) . c l i c k ( ) ; } } , s a v e : f u n c t i o n ( ) { t h i s . d e s t r o y A c t i o n = " s a v e " ; t h i s . c l o s e ( ) ; } , o p e n : f u n c t i o n ( ) { t h i s . h a s F u l l S c r e e n = $ ( w i n d o w . t o p . d o c u m e n t . b o d y ) . h a s C l a s s ( ' o _ f i e l d _ w i d g e t T e x t H t m l _ f u l l s c r e e n ' ) ; t h i s . _ t o g g l e F u l l S c r e e n ( ) ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , } ) ; r e t u r n   S u m m e r n o t e D i a l o g ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / a l t _ d i a l o g . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . w i d g e t s . A l t D i a l o g ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   D i a l o g = r e q u i r e ( ' w y s i w y g . w i d g e t s . D i a l o g ' ) ; v a r   _ t = c o r e . _ t ; v a r   A l t D i a l o g = D i a l o g . e x t e n d ( { t e m p l a t e : ' w y s i w y g . w i d g e t s . a l t ' , x m l D e p e n d e n c i e s : D i a l o g . p r o t o t y p e . x m l D e p e n d e n c i e s . c o n c a t ( [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / w y s i w y g . x m l ' ] ) , i n i t : f u n c t i o n ( p a r e n t , o p t i o n s , m e d i a ) { o p t i o n s = o p t i o n s | | { } ; t h i s . _ s u p e r ( p a r e n t , _ . e x t e n d ( { } , { t i t l e : _ t ( " C h a n g e   m e d i a   d e s c r i p t i o n   a n d   t o o l t i p " ) } , o p t i o n s ) ) ; t h i s . t r i g g e r _ u p ( ' g e t R e c o r d I n f o ' , { r e c o r d I n f o : o p t i o n s , c a l l b a c k : f u n c t i o n ( r e c o r d I n f o ) { _ . d e f a u l t s ( o p t i o n s , r e c o r d I n f o ) ; } , } ) ; t h i s . m e d i a = m e d i a ; v a r   a l l E s c Q u o t s = / & q u o t ; / g ; t h i s . a l t = ( $ ( t h i s . m e d i a ) . a t t r ( ' a l t ' ) | | " " ) . r e p l a c e ( a l l E s c Q u o t s , ' " ' ) ; v a r   t i t l e = $ ( t h i s . m e d i a ) . a t t r ( ' t i t l e ' ) | | $ ( t h i s . m e d i a ) . d a t a ( ' o r i g i n a l - t i t l e ' ) | | " " ; t h i s . t a g _ t i t l e = ( t i t l e ) . r e p l a c e ( a l l E s c Q u o t s , ' " ' ) ; } , s a v e : f u n c t i o n ( ) { v a r   a l t = t h i s . $ ( ' # a l t ' ) . v a l ( ) ; v a r   t i t l e = t h i s . $ ( ' # t i t l e ' ) . v a l ( ) ; v a r   a l l N o n E s c Q u o t s = / " / g ; $ ( t h i s . m e d i a ) . a t t r ( ' a l t ' , a l t ? a l t . r e p l a c e ( a l l N o n E s c Q u o t s , " & q u o t ; " ) : n u l l ) . a t t r ( ' t i t l e ' , t i t l e ? t i t l e . r e p l a c e ( a l l N o n E s c Q u o t s , " & q u o t ; " ) : n u l l ) ; $ ( t h i s . m e d i a ) . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; t h i s . f i n a l _ d a t a = t h i s . m e d i a ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , } ) ; r e t u r n   A l t D i a l o g ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / c o l o r _ p a l e t t e . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . C o l o r P a l e t t e ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; c o n s t   a j a x = r e q u i r e ( ' w e b . a j a x ' ) ; c o n s t   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; c o n s t   s e s s i o n = r e q u i r e ( ' w e b . s e s s i o n ' ) ; c o n s t { C o l o r p i c k e r W i d g e t } = r e q u i r e ( ' w e b . C o l o r p i c k e r ' ) ; c o n s t   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; c o n s t   s u m m e r n o t e C u s t o m C o l o r s = r e q u i r e ( ' w e b _ e d i t o r . r t e . s u m m e r n o t e _ c u s t o m _ c o l o r s ' ) ; c o n s t   w e U t i l s = r e q u i r e ( ' w e b _ e d i t o r . u t i l s ' ) ; c o n s t   q w e b = c o r e . q w e b ; c o n s t   C o l o r P a l e t t e W i d g e t = W i d g e t . e x t e n d ( { t e m p l a t e : ' w e b _ e d i t o r . s n i p p e t . o p t i o n . c o l o r p i c k e r ' , e v e n t s : { ' c l i c k   . o _ w e _ c o l o r _ b t n ' : ' _ o n C o l o r B u t t o n C l i c k ' , ' m o u s e e n t e r   . o _ w e _ c o l o r _ b t n ' : ' _ o n C o l o r B u t t o n E n t e r ' , ' m o u s e l e a v e   . o _ w e _ c o l o r _ b t n ' : ' _ o n C o l o r B u t t o n L e a v e ' , ' c l i c k   . o _ w e _ c o l o r p i c k e r _ s w i t c h _ p a n e _ b t n ' : ' _ o n S w i t c h P a n e B u t t o n C l i c k ' , } , c u s t o m _ e v e n t s : { ' c o l o r p i c k e r _ s e l e c t ' : ' _ o n C o l o r P i c k e r S e l e c t ' , ' c o l o r p i c k e r _ p r e v i e w ' : ' _ o n C o l o r P i c k e r P r e v i e w ' , } , i n i t : f u n c t i o n ( p a r e n t , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . s u m m e r n o t e C u s t o m C o l o r s A r r a y = [ ] . c o n c a t ( . . . s u m m e r n o t e C u s t o m C o l o r s ) ; t h i s . s t y l e = w i n d o w . g e t C o m p u t e d S t y l e ( d o c u m e n t . d o c u m e n t E l e m e n t ) ; t h i s . o p t i o n s = _ . e x t e n d ( { s e l e c t e d C o l o r : f a l s e , r e s e t B u t t o n : t r u e , e x c l u d e d : [ ] , e x c l u d e S e c t i o n O f : n u l l , $ e d i t a b l e : $ ( ) , w i t h C o m b i n a t i o n s : f a l s e , } , o p t i o n s | | { } ) ; t h i s . s e l e c t e d C o l o r = ' ' ; t h i s . r e s e t B u t t o n = t h i s . o p t i o n s . r e s e t B u t t o n ; t h i s . w i t h C o m b i n a t i o n s = t h i s . o p t i o n s . w i t h C o m b i n a t i o n s ; t h i s . t r i g g e r _ u p ( ' r e q u e s t _ e d i t a b l e ' , { c a l l b a c k : v a l = > t h i s . o p t i o n s . $ e d i t a b l e = v a l } ) ; } , w i l l S t a r t : a s y n c   f u n c t i o n ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; a w a i t   C o l o r P a l e t t e W i d g e t . l o a d D e p e n d e n c i e s ( t h i s ) ; } , s t a r t : a s y n c   f u n c t i o n ( ) { c o n s t   r e s = t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; c o n s t   $ c o l o r S e c t i o n = t h i s . $ ( ' . o _ c o l o r p i c k e r _ s e c t i o n s [ d a t a - c o l o r - t a b = " t h e m e - c o l o r s " ] ' ) ; c o n s t   $ c l p i c k e r = q w e b . h a s _ t e m p l a t e ( ' w e b _ e d i t o r . c o l o r p i c k e r ' ) ? $ ( q w e b . r e n d e r ( ' w e b _ e d i t o r . c o l o r p i c k e r ' ) ) : $ ( ` < c o l o r p i c k e r > < d i v   c l a s s = " o _ c o l o r p i c k e r _ s e c t i o n "   d a t a - n a m e = " c o m m o n " > < / d i v > < / c o l o r p i c k e r > ` ) ; $ c l p i c k e r . f i n d ( ' b u t t o n ' ) . a d d C l a s s ( ' o _ w e _ c o l o r _ b t n ' ) ; $ c l p i c k e r . a p p e n d T o ( $ c o l o r S e c t i o n ) ; _ . e a c h ( t h i s . o p t i o n s . e x c l u d e d , e x c = > { t h i s . $ ( ' [ d a t a - n a m e = " ' + e x c + ' " ] ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } ) ; i f ( t h i s . o p t i o n s . e x c l u d e S e c t i o n O f ) { t h i s . $ ( ' [ d a t a - n a m e ] : h a s ( [ d a t a - c o l o r = " ' + t h i s . o p t i o n s . e x c l u d e S e c t i o n O f + ' " ] ) ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } 
 t h i s . e l . q u e r y S e l e c t o r A l l ( ' . o _ c o l o r p i c k e r _ s e c t i o n ' ) . f o r E a c h ( e l e m = > { $ ( e l e m ) . p r e p e n d ( ' < d i v > ' + ( e l e m . d a t a s e t . d i s p l a y | | ' ' ) + ' < / d i v > ' ) ; } ) ; i f ( ! t h i s . o p t i o n s . e x c l u d e d . i n c l u d e s ( ' c o m m o n ' ) ) { c o n s t   $ c o m m o n C o l o r S e c t i o n = t h i s . $ ( ' [ d a t a - n a m e = " c o m m o n " ] ' ) ; s u m m e r n o t e C u s t o m C o l o r s . f o r E a c h ( ( c o l o r R o w , i ) = > { i f ( i = = = 0 ) { r e t u r n ; } 
 c o n s t   $ d i v = $ ( ' < d i v / > ' , { c l a s s : ' c l e a r f i x ' } ) . a p p e n d T o ( $ c o m m o n C o l o r S e c t i o n ) ; c o l o r R o w . f o r E a c h ( c o l o r = > { $ d i v . a p p e n d ( t h i s . _ c r e a t e C o l o r B u t t o n ( c o l o r , [ ' o _ c o m m o n _ c o l o r ' ] ) ) ; } ) ; } ) ; } 
 c o n s t   c o m p a t i b i l i t y C o l o r N a m e s = [ ' p r i m a r y ' , ' s e c o n d a r y ' , ' a l p h a ' , ' b e t a ' , ' g a m m a ' , ' d e l t a ' , ' e p s i l o n ' , ' s u c c e s s ' , ' i n f o ' , ' w a r n i n g ' , ' d a n g e r ' ] ; t h i s . c o l o r N a m e s = [ . . . c o m p a t i b i l i t y C o l o r N a m e s ] ; t h i s . c o l o r T o C o l o r N a m e s = { } ; t h i s . e l . q u e r y S e l e c t o r A l l ( ' b u t t o n [ d a t a - c o l o r ] ' ) . f o r E a c h ( e l e m = > { c o n s t   c o l o r N a m e = e l e m . d a t a s e t . c o l o r ; c o n s t   $ c o l o r = $ ( e l e m ) ; c o n s t   i s C C N a m e = w e U t i l s . i s C o l o r C o m b i n a t i o n N a m e ( c o l o r N a m e ) ; i f ( i s C C N a m e ) { $ c o l o r . f i n d ( ' . o _ w e _ c c _ p r e v i e w _ w r a p p e r ' ) . a d d C l a s s ( ` o _ c c   o _ c c $ { c o l o r N a m e } ` ) ; } e l s e { $ c o l o r . a d d C l a s s ( ` b g - $ { c o l o r N a m e } ` ) ; } 
 t h i s . c o l o r N a m e s . p u s h ( c o l o r N a m e ) ; i f ( ! i s C C N a m e & & ! e l e m . c l a s s L i s t . c o n t a i n s ( ' d - n o n e ' ) ) { c o n s t   c o l o r = w e U t i l s . g e t C S S V a r i a b l e V a l u e ( c o l o r N a m e , t h i s . s t y l e ) ; t h i s . c o l o r T o C o l o r N a m e s [ c o l o r ] = c o l o r N a m e ; } } ) ; i f ( t h i s . o p t i o n s . s e l e c t e d C o l o r ) { l e t   s e l e c t e d C o l o r = t h i s . o p t i o n s . s e l e c t e d C o l o r ; i f ( c o m p a t i b i l i t y C o l o r N a m e s . i n c l u d e s ( s e l e c t e d C o l o r ) ) { s e l e c t e d C o l o r = w e U t i l s . g e t C S S V a r i a b l e V a l u e ( s e l e c t e d C o l o r , t h i s . s t y l e ) | | s e l e c t e d C o l o r ; } 
 s e l e c t e d C o l o r = C o l o r p i c k e r W i d g e t . n o r m a l i z e C S S C o l o r ( s e l e c t e d C o l o r ) ; i f ( s e l e c t e d C o l o r ! = = ' r g b a ( 0 ,   0 ,   0 ,   0 ) ' ) { t h i s . s e l e c t e d C o l o r = t h i s . c o l o r T o C o l o r N a m e s [ s e l e c t e d C o l o r ] | | s e l e c t e d C o l o r ; } } 
 t h i s . _ b u i l d C u s t o m C o l o r s ( ) ; t h i s . _ m a r k S e l e c t e d C o l o r ( ) ; l e t   d e f a u l t C o l o r = t h i s . s e l e c t e d C o l o r ; i f ( d e f a u l t C o l o r & & ! C o l o r p i c k e r W i d g e t . i s C S S C o l o r ( d e f a u l t C o l o r ) ) { d e f a u l t C o l o r = w e U t i l s . g e t C S S V a r i a b l e V a l u e ( d e f a u l t C o l o r , t h i s . s t y l e ) ; } 
 t h i s . c o l o r P i c k e r = n e w   C o l o r p i c k e r W i d g e t ( t h i s , { d e f a u l t C o l o r : d e f a u l t C o l o r , } ) ; a w a i t   t h i s . c o l o r P i c k e r . p r e p e n d T o ( $ c o l o r S e c t i o n ) ; r e t u r n   r e s ; } , g e t C o l o r N a m e s : f u n c t i o n ( ) { r e t u r n   t h i s . c o l o r N a m e s ; } , _ b u i l d C u s t o m C o l o r s : f u n c t i o n ( ) { i f ( t h i s . o p t i o n s . e x c l u d e d . i n c l u d e s ( ' c u s t o m ' ) ) { r e t u r n ; } 
 t h i s . e l . q u e r y S e l e c t o r A l l ( ' . o _ c u s t o m _ c o l o r ' ) . f o r E a c h ( e l = > e l . r e m o v e ( ) ) ; c o n s t   e x i s t i n g C o l o r s = n e w   S e t ( t h i s . s u m m e r n o t e C u s t o m C o l o r s A r r a y . c o n c a t ( O b j e c t . k e y s ( t h i s . c o l o r T o C o l o r N a m e s ) ) ) ; t h i s . t r i g g e r _ u p ( ' g e t _ c u s t o m _ c o l o r s ' , { o n S u c c e s s : ( c o l o r s ) = > { c o l o r s . f o r E a c h ( c o l o r = > { t h i s . _ a d d C u s t o m C o l o r ( e x i s t i n g C o l o r s , c o l o r ) ; } ) ; } , } ) ; w e U t i l s . g e t C S S V a r i a b l e V a l u e ( ' c u s t o m - c o l o r s ' , t h i s . s t y l e ) . s p l i t ( '   ' ) . f o r E a c h ( v = > { c o n s t   c o l o r = w e U t i l s . g e t C S S V a r i a b l e V a l u e ( v . s u b s t r i n g ( 1 , v . l e n g t h - 1 ) , t h i s . s t y l e ) ; i f ( C o l o r p i c k e r W i d g e t . i s C S S C o l o r ( c o l o r ) ) { t h i s . _ a d d C u s t o m C o l o r ( e x i s t i n g C o l o r s , c o l o r ) ; } } ) ; _ . e a c h ( t h i s . o p t i o n s . $ e d i t a b l e . f i n d ( ' [ s t y l e * = " c o l o r " ] ' ) , e l = > { f o r ( c o n s t   c o l o r P r o p   o f [ ' c o l o r ' , ' b a c k g r o u n d C o l o r ' ] ) { t h i s . _ a d d C u s t o m C o l o r ( e x i s t i n g C o l o r s , e l . s t y l e [ c o l o r P r o p ] ) ; } } ) ; i f ( t h i s . s e l e c t e d C o l o r ) { t h i s . _ a d d C u s t o m C o l o r ( e x i s t i n g C o l o r s , t h i s . s e l e c t e d C o l o r ) ; } } , _ a d d C u s t o m C o l o r : f u n c t i o n ( e x i s t i n g C o l o r s , c o l o r ) { i f ( ! c o l o r ) { r e t u r n ; } 
 i f ( ! C o l o r p i c k e r W i d g e t . i s C S S C o l o r ( c o l o r ) ) { c o l o r = w e U t i l s . g e t C S S V a r i a b l e V a l u e ( c o l o r , t h i s . s t y l e ) ; } 
 c o n s t   n o r m C o l o r = C o l o r p i c k e r W i d g e t . n o r m a l i z e C S S C o l o r ( c o l o r ) ; i f ( ! e x i s t i n g C o l o r s . h a s ( n o r m C o l o r ) ) { t h i s . _ a d d C u s t o m C o l o r B u t t o n ( n o r m C o l o r ) ; e x i s t i n g C o l o r s . a d d ( n o r m C o l o r ) ; } } , _ a d d C u s t o m C o l o r B u t t o n : f u n c t i o n ( c o l o r , c l a s s e s = [ ] ) { c l a s s e s . p u s h ( ' o _ c u s t o m _ c o l o r ' ) ; c o n s t   $ t h e m e S e c t i o n = t h i s . $ ( ' . o _ c o l o r p i c k e r _ s e c t i o n [ d a t a - n a m e = " t h e m e " ] ' ) ; c o n s t   $ b u t t o n = t h i s . _ c r e a t e C o l o r B u t t o n ( c o l o r , c l a s s e s ) ; r e t u r n   $ b u t t o n . a p p e n d T o ( $ t h e m e S e c t i o n ) ; } , _ c r e a t e C o l o r B u t t o n : f u n c t i o n ( c o l o r , c l a s s e s ) { r e t u r n   $ ( ' < b u t t o n / > ' , { c l a s s : ' o _ w e _ c o l o r _ b t n   ' + c l a s s e s . j o i n ( '   ' ) , s t y l e : ' b a c k g r o u n d - c o l o r : ' + c o l o r + ' ; ' , } ) ; } , _ g e t B u t t o n I n f o : f u n c t i o n ( b u t t o n E l ) { c o n s t   b g C o l o r = b u t t o n E l . s t y l e . b a c k g r o u n d C o l o r ; r e t u r n { c o l o r : b g C o l o r ? C o l o r p i c k e r W i d g e t . n o r m a l i z e C S S C o l o r ( b g C o l o r ) : b u t t o n E l . d a t a s e t . c o l o r | | ' ' , t a r g e t : b u t t o n E l , } ; } , _ s e l e c t C o l o r : f u n c t i o n ( c o l o r I n f o , e v e n t N a m e ) { t h i s . s e l e c t e d C o l o r = c o l o r I n f o . c o l o r = t h i s . c o l o r T o C o l o r N a m e s [ c o l o r I n f o . c o l o r ] | | c o l o r I n f o . c o l o r ; t h i s . t r i g g e r _ u p ( e v e n t N a m e , c o l o r I n f o ) ; t h i s . _ b u i l d C u s t o m C o l o r s ( ) ; t h i s . _ m a r k S e l e c t e d C o l o r ( ) ; } , _ m a r k S e l e c t e d C o l o r : f u n c t i o n ( ) { t h i s . e l . q u e r y S e l e c t o r A l l ( ' b u t t o n . s e l e c t e d ' ) . f o r E a c h ( e l = > e l . c l a s s L i s t . r e m o v e ( ' s e l e c t e d ' ) ) ; c o n s t   s e l e c t e d B u t t o n = t h i s . e l . q u e r y S e l e c t o r ( ` b u t t o n [ d a t a - c o l o r = " $ { t h i s . s e l e c t e d C o l o r } " ] ,   b u t t o n [ s t y l e * = " b a c k g r o u n d - c o l o r : $ { t h i s . s e l e c t e d C o l o r } ; " ] ` ) ; i f ( s e l e c t e d B u t t o n ) { s e l e c t e d B u t t o n . c l a s s L i s t . a d d ( ' s e l e c t e d ' ) ; } } , _ o n C o l o r B u t t o n C l i c k : f u n c t i o n ( e v ) { c o n s t   b u t t o n E l = e v . c u r r e n t T a r g e t ; c o n s t   c o l o r I n f o = t h i s . _ g e t B u t t o n I n f o ( b u t t o n E l ) ; t h i s . _ s e l e c t C o l o r ( c o l o r I n f o , ' c o l o r _ p i c k e d ' ) ; } , _ o n C o l o r B u t t o n E n t e r : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; t h i s . t r i g g e r _ u p ( ' c o l o r _ h o v e r ' , t h i s . _ g e t B u t t o n I n f o ( e v . c u r r e n t T a r g e t ) ) ; } , _ o n C o l o r B u t t o n L e a v e : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; t h i s . t r i g g e r _ u p ( ' c o l o r _ l e a v e ' , { c o l o r : t h i s . s e l e c t e d C o l o r , t a r g e t : e v . t a r g e t , } ) ; } , _ o n C o l o r P i c k e r P r e v i e w : f u n c t i o n ( e v ) { t h i s . t r i g g e r _ u p ( ' c o l o r _ h o v e r ' , { c o l o r : e v . d a t a . c s s C o l o r , t a r g e t : t h i s . c o l o r P i c k e r . e l , } ) ; } , _ o n C o l o r P i c k e r S e l e c t : f u n c t i o n ( e v ) { t h i s . _ s e l e c t C o l o r ( { c o l o r : e v . d a t a . c s s C o l o r , t a r g e t : t h i s . c o l o r P i c k e r . e l , } , ' c u s t o m _ c o l o r _ p i c k e d ' ) ; } , _ o n S w i t c h P a n e B u t t o n C l i c k ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; t h i s . e l . q u e r y S e l e c t o r A l l ( ' . o _ w e _ c o l o r p i c k e r _ s w i t c h _ p a n e _ b t n ' ) . f o r E a c h ( e l = > { e l . c l a s s L i s t . r e m o v e ( ' a c t i v e ' ) ; } ) ; e v . c u r r e n t T a r g e t . c l a s s L i s t . a d d ( ' a c t i v e ' ) ; t h i s . e l . q u e r y S e l e c t o r A l l ( ' . o _ c o l o r p i c k e r _ s e c t i o n s ' ) . f o r E a c h ( e l = > { e l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , e l . d a t a s e t . c o l o r T a b ! = = e v . c u r r e n t T a r g e t . d a t a s e t . t a r g e t ) ; } ) ; } , } ) ; l e t   c o l o r p i c k e r T e m p l a t e P r o m ; C o l o r P a l e t t e W i d g e t . l o a d D e p e n d e n c i e s = a s y n c   f u n c t i o n ( r p c C a p a b l e O b j ) { c o n s t   p r o m s = [ a j a x . l o a d X M L ( ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / s n i p p e t s . x m l ' , q w e b ) ] ; i f ( ! s e s s i o n . i s _ w e b s i t e _ u s e r ) { i f ( ! c o l o r p i c k e r T e m p l a t e P r o m & & ! q w e b . h a s _ t e m p l a t e ( ' w e b _ e d i t o r . c o l o r p i c k e r ' ) ) { c o l o r p i c k e r T e m p l a t e P r o m = r p c C a p a b l e O b j . _ r p c ( { m o d e l : ' i r . u i . v i e w ' , m e t h o d : ' r e a d _ t e m p l a t e ' , a r g s : [ ' w e b _ e d i t o r . c o l o r p i c k e r ' ] , } ) . t h e n ( t e m p l a t e = > { r e t u r n   q w e b . a d d _ t e m p l a t e ( ' < t e m p l a t e s > ' + t e m p l a t e + ' < / t e m p l a t e s > ' ) ; } ) ; } 
 p r o m s . p u s h ( c o l o r p i c k e r T e m p l a t e P r o m ) ; } 
 r e t u r n   P r o m i s e . a l l ( p r o m s ) ; } ; r e t u r n { C o l o r P a l e t t e W i d g e t : C o l o r P a l e t t e W i d g e t , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / i m a g e _ c r o p _ w i d g e t . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . w i d g e t s . I m a g e C r o p W i d g e t ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; c o n s t   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; c o n s t   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; c o n s t { a p p l y M o d i f i c a t i o n s , c r o p p e r D a t a F i e l d s , a c t i v a t e C r o p p e r , l o a d I m a g e , l o a d I m a g e I n f o } = r e q u i r e ( ' w e b _ e d i t o r . i m a g e _ p r o c e s s i n g ' ) ; c o n s t   _ t = c o r e . _ t ; c o n s t   I m a g e C r o p W i d g e t = W i d g e t . e x t e n d ( { t e m p l a t e : [ ' w y s i w y g . w i d g e t s . c r o p ' ] , x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / w y s i w y g . x m l ' ] , e v e n t s : { ' c l i c k . c r o p _ o p t i o n s   [ d a t a - a c t i o n ] ' : ' _ o n C r o p O p t i o n C l i c k ' , ' z o o m ' : ' _ o n C r o p Z o o m ' , } , i n i t ( p a r e n t , m e d i a ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . m e d i a = m e d i a ; t h i s . $ m e d i a = $ ( m e d i a ) ; t h i s . d o c u m e n t = m e d i a . o w n e r D o c u m e n t ; t h i s . a s p e c t R a t i o s = { " 0 / 0 " : { l a b e l : _ t ( " F r e e " ) , v a l u e : 0 } , " 1 6 / 9 " : { l a b e l : " 1 6 : 9 " , v a l u e : 1 6 / 9 } , " 4 / 3 " : { l a b e l : " 4 : 3 " , v a l u e : 4 / 3 } , " 1 / 1 " : { l a b e l : " 1 : 1 " , v a l u e : 1 } , " 2 / 3 " : { l a b e l : " 2 : 3 " , v a l u e : 2 / 3 } , } ; c o n s t   s r c = t h i s . m e d i a . g e t A t t r i b u t e ( ' s r c ' ) ; c o n s t   d a t a = O b j e c t . a s s i g n ( { } , m e d i a . d a t a s e t ) ; t h i s . i n i t i a l S r c = s r c ; t h i s . a s p e c t R a t i o = d a t a . a s p e c t R a t i o | | " 0 / 0 " ; t h i s . m i m e t y p e = d a t a . m i m e t y p e | | s r c . e n d s W i t h ( ' . p n g ' ) ? ' i m a g e / p n g ' : ' i m a g e / j p e g ' ; } , a s y n c   w i l l S t a r t ( ) { a w a i t   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; a w a i t   l o a d I m a g e I n f o ( t h i s . m e d i a , t h i s . _ r p c . b i n d ( t h i s ) ) ; i f ( t h i s . m e d i a . d a t a s e t . o r i g i n a l S r c ) { t h i s . o r i g i n a l S r c = t h i s . m e d i a . d a t a s e t . o r i g i n a l S r c ; t h i s . o r i g i n a l I d = t h i s . m e d i a . d a t a s e t . o r i g i n a l I d ; r e t u r n ; } 
 t h i s . u n c r o p p a b l e = t r u e ; } , a s y n c   s t a r t ( ) { i f ( t h i s . u n c r o p p a b l e ) { t h i s . d i s p l a y N o t i f i c a t i o n ( { t y p e : ' w a r n i n g ' , t i t l e : _ t ( " T h i s   i m a g e   i s   a n   e x t e r n a l   i m a g e " ) , m e s s a g e : _ t ( " T h i s   t y p e   o f   i m a g e   i s   n o t   s u p p o r t e d   f o r   c r o p p i n g . < b r / > I f   y o u   w a n t   t o   c r o p   i t ,   p l e a s e   f i r s t   d o w n l o a d   i t   f r o m   t h e   o r i g i n a l   s o u r c e   a n d   u p l o a d   i t   i n   O d o o . " ) , } ) ; r e t u r n   t h i s . d e s t r o y ( ) ; } 
 c o n s t   _ s u p e r = t h i s . _ s u p e r . b i n d ( t h i s ) ; c o n s t   $ c r o p p e r W r a p p e r = t h i s . $ ( ' . o _ w e _ c r o p p e r _ w r a p p e r ' ) ; a w a i t   l o a d I m a g e ( t h i s . o r i g i n a l S r c , t h i s . m e d i a ) ; t h i s . $ c r o p p e r I m a g e = t h i s . $ ( ' . o _ w e _ c r o p p e r _ i m g ' ) ; c o n s t   c r o p p e r I m a g e = t h i s . $ c r o p p e r I m a g e [ 0 ] ; [ c r o p p e r I m a g e . s t y l e . w i d t h , c r o p p e r I m a g e . s t y l e . h e i g h t ] = [ t h i s . $ m e d i a . w i d t h ( ) + ' p x ' , t h i s . $ m e d i a . h e i g h t ( ) + ' p x ' ] ; c o n s t   o f f s e t = t h i s . $ m e d i a . o f f s e t ( ) ; o f f s e t . l e f t + = p a r s e I n t ( t h i s . $ m e d i a . c s s ( ' p a d d i n g - l e f t ' ) ) ; o f f s e t . t o p + = p a r s e I n t ( t h i s . $ m e d i a . c s s ( ' p a d d i n g - r i g h t ' ) ) ; $ c r o p p e r W r a p p e r . o f f s e t ( o f f s e t ) ; a w a i t   l o a d I m a g e ( t h i s . o r i g i n a l S r c , c r o p p e r I m a g e ) ; a w a i t   a c t i v a t e C r o p p e r ( c r o p p e r I m a g e , t h i s . a s p e c t R a t i o s [ t h i s . a s p e c t R a t i o ] . v a l u e , t h i s . m e d i a . d a t a s e t ) ; c o r e . b u s . t r i g g e r ( ' d e a c t i v a t e _ s n i p p e t ' ) ; t h i s . _ o n D o c u m e n t M o u s e d o w n = t h i s . _ o n D o c u m e n t M o u s e d o w n . b i n d ( t h i s ) ; t h i s . d o c u m e n t . a d d E v e n t L i s t e n e r ( ' m o u s e d o w n ' , t h i s . _ o n D o c u m e n t M o u s e d o w n , { c a p t u r e : t r u e } ) ; r e t u r n   _ s u p e r ( . . . a r g u m e n t s ) ; } , d e s t r o y ( ) { i f ( t h i s . $ c r o p p e r I m a g e ) { t h i s . $ c r o p p e r I m a g e . c r o p p e r ( ' d e s t r o y ' ) ; t h i s . d o c u m e n t . r e m o v e E v e n t L i s t e n e r ( ' m o u s e d o w n ' , t h i s . _ o n D o c u m e n t M o u s e d o w n , { c a p t u r e : t r u e } ) ; } 
 t h i s . m e d i a . s e t A t t r i b u t e ( ' s r c ' , t h i s . i n i t i a l S r c ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , a s y n c   _ s a v e ( ) { t h i s . m e d i a . c l a s s L i s t . a d d ( ' o _ m o d i f i e d _ i m a g e _ t o _ s a v e ' ) ; [ . . . c r o p p e r D a t a F i e l d s , ' a s p e c t R a t i o ' ] . f o r E a c h ( a t t r = > { d e l e t e   t h i s . m e d i a . d a t a s e t [ a t t r ] ; c o n s t   v a l u e = t h i s . _ g e t A t t r i b u t e V a l u e ( a t t r ) ; i f ( v a l u e ) { t h i s . m e d i a . d a t a s e t [ a t t r ] = v a l u e ; } } ) ; d e l e t e   t h i s . m e d i a . d a t a s e t . r e s i z e W i d t h ; t h i s . i n i t i a l S r c = a w a i t   a p p l y M o d i f i c a t i o n s ( t h i s . m e d i a ) ; t h i s . $ m e d i a . t r i g g e r ( ' i m a g e _ c r o p p e d ' ) ; t h i s . d e s t r o y ( ) ; } , _ g e t A t t r i b u t e V a l u e ( a t t r ) { i f ( c r o p p e r D a t a F i e l d s . i n c l u d e s ( a t t r ) ) { r e t u r n   t h i s . $ c r o p p e r I m a g e . c r o p p e r ( ' g e t D a t a ' ) [ a t t r ] ; } 
 r e t u r n   t h i s [ a t t r ] ; } , _ r e s e t C r o p B o x ( ) { t h i s . $ c r o p p e r I m a g e . c r o p p e r ( ' c l e a r ' ) ; t h i s . $ c r o p p e r I m a g e . c r o p p e r ( ' c r o p ' ) ; } , _ o n C r o p O p t i o n C l i c k ( e v ) { c o n s t { a c t i o n , v a l u e , s c a l e D i r e c t i o n } = e v . c u r r e n t T a r g e t . d a t a s e t ; s w i t c h ( a c t i o n ) { c a s e ' r a t i o ' : t h i s . $ c r o p p e r I m a g e . c r o p p e r ( ' r e s e t ' ) ; t h i s . a s p e c t R a t i o = v a l u e ; t h i s . $ c r o p p e r I m a g e . c r o p p e r ( ' s e t A s p e c t R a t i o ' , t h i s . a s p e c t R a t i o s [ t h i s . a s p e c t R a t i o ] . v a l u e ) ; b r e a k ; c a s e ' z o o m ' : c a s e ' r e s e t ' : t h i s . $ c r o p p e r I m a g e . c r o p p e r ( a c t i o n , v a l u e ) ; b r e a k ; c a s e ' r o t a t e ' : t h i s . $ c r o p p e r I m a g e . c r o p p e r ( a c t i o n , v a l u e ) ; t h i s . _ r e s e t C r o p B o x ( ) ; b r e a k ; c a s e ' f l i p ' : { c o n s t   a m o u n t = t h i s . $ c r o p p e r I m a g e . c r o p p e r ( ' g e t D a t a ' ) [ s c a l e D i r e c t i o n ] * - 1 ; r e t u r n   t h i s . $ c r o p p e r I m a g e . c r o p p e r ( s c a l e D i r e c t i o n , a m o u n t ) ; } 
 c a s e ' a p p l y ' : r e t u r n   t h i s . _ s a v e ( ) ; c a s e ' d i s c a r d ' : r e t u r n   t h i s . d e s t r o y ( ) ; } } , _ o n D o c u m e n t M o u s e d o w n ( e v ) { i f ( d o c u m e n t . b o d y . c o n t a i n s ( e v . t a r g e t ) & & t h i s . $ ( e v . t a r g e t ) . l e n g t h = = = 0 ) { r e t u r n   t h i s . d e s t r o y ( ) ; } } , a s y n c   _ o n C r o p Z o o m ( ) { a w a i t   n e w   P r o m i s e ( r e s = > s e t T i m e o u t ( r e s , 0 ) ) ; t h i s . _ r e s e t C r o p B o x ( ) ; } , } ) ; r e t u r n   I m a g e C r o p W i d g e t ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / l i n k _ d i a l o g . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . w i d g e t s . L i n k D i a l o g ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   D i a l o g = r e q u i r e ( ' w y s i w y g . w i d g e t s . D i a l o g ' ) ; v a r   d o m = $ . s u m m e r n o t e . c o r e . d o m ; v a r   r a n g e = $ . s u m m e r n o t e . c o r e . r a n g e ; v a r   _ t = c o r e . _ t ; v a r   L i n k D i a l o g = D i a l o g . e x t e n d ( { t e m p l a t e : ' w y s i w y g . w i d g e t s . l i n k ' , x m l D e p e n d e n c i e s : ( D i a l o g . p r o t o t y p e . x m l D e p e n d e n c i e s | | [ ] ) . c o n c a t ( [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / w y s i w y g . x m l ' ] ) , e v e n t s : _ . e x t e n d ( { } , D i a l o g . p r o t o t y p e . e v e n t s | | { } , { ' i n p u t ' : ' _ o n A n y C h a n g e ' , ' c h a n g e   [ n a m e = " l i n k _ s t y l e _ c o l o r " ] ' : ' _ o n T y p e C h a n g e ' , ' c h a n g e ' : ' _ o n A n y C h a n g e ' , ' i n p u t   i n p u t [ n a m e = " u r l " ] ' : ' _ o n U R L I n p u t ' , } ) , i n i t : f u n c t i o n ( p a r e n t , o p t i o n s , e d i t a b l e , l i n k I n f o ) { t h i s . o p t i o n s = o p t i o n s | | { } ; t h i s . _ s u p e r ( p a r e n t , _ . e x t e n d ( { t i t l e : _ t ( " L i n k   t o " ) , } , t h i s . o p t i o n s ) ) ; t h i s . t r i g g e r _ u p ( ' g e t R e c o r d I n f o ' , { r e c o r d I n f o : t h i s . o p t i o n s , c a l l b a c k : r e c o r d I n f o = > { _ . d e f a u l t s ( t h i s . o p t i o n s , r e c o r d I n f o ) ; } , } ) ; t h i s . c o l o r s D a t a = [ { t y p e : ' ' , l a b e l : _ t ( " L i n k " ) , b t n P r e v i e w : ' l i n k ' } , { t y p e : ' p r i m a r y ' , l a b e l : _ t ( " P r i m a r y " ) , b t n P r e v i e w : ' p r i m a r y ' } , { t y p e : ' s e c o n d a r y ' , l a b e l : _ t ( " S e c o n d a r y " ) , b t n P r e v i e w : ' s e c o n d a r y ' } , ] ; t h i s . e d i t a b l e = e d i t a b l e ; t h i s . d a t a = l i n k I n f o | | { } ; t h i s . d a t a . c l a s s N a m e = " " ; t h i s . d a t a . i n i C l a s s N a m e = " " ; v a r   r = t h i s . d a t a . r a n g e ; t h i s . n e e d L a b e l = ! r | | ( r . s c = = = r . e c & & r . s o = = = r . e o ) ; i f ( t h i s . d a t a . r a n g e ) { c o n s t   $ l i n k = $ ( t h i s . d a t a . r a n g e . s c ) . f i l t e r ( " a " ) ; t h i s . d a t a . i n i C l a s s N a m e = $ l i n k . a t t r ( " c l a s s " ) | | " " ; t h i s . c o l o r C o m b i n a t i o n C l a s s = f a l s e ; l e t   $ n o d e = $ l i n k ; w h i l e ( $ n o d e . l e n g t h & & ! $ n o d e . i s ( ' b o d y ' ) ) { c o n s t   c l a s s N a m e = $ n o d e . a t t r ( ' c l a s s ' ) | | ' ' ; c o n s t   m = c l a s s N a m e . m a t c h ( / \ b ( o _ c c \ d + ) \ b / g ) ; i f ( m ) { t h i s . c o l o r C o m b i n a t i o n C l a s s = m [ 0 ] ; b r e a k ; } 
 $ n o d e = $ n o d e . p a r e n t ( ) ; } 
 t h i s . d a t a . c l a s s N a m e = t h i s . d a t a . i n i C l a s s N a m e . r e p l a c e ( / ( ^ | \ s + ) b t n ( - [ a - z 0 - 9 _ - ] * ) ? / g i , '   ' ) ; v a r   i s _ l i n k = t h i s . d a t a . r a n g e . i s O n A n c h o r ( ) ; v a r   s c = r . s c ; v a r   s o = r . s o ; v a r   e c = r . e c ; v a r   e o = r . e o ; v a r   n o d e s ; i f ( ! i s _ l i n k ) { i f ( s c . t a g N a m e ) { s c = d o m . f i r s t C h i l d ( s o ? s c . c h i l d N o d e s [ s o ] : s c ) ; s o = 0 ; } e l s e   i f ( s o ! = = s c . t e x t C o n t e n t . l e n g t h ) { i f ( s c = = = e c ) { e c = s c = s c . s p l i t T e x t ( s o ) ; e o - = s o ; } e l s e { s c = s c . s p l i t T e x t ( s o ) ; } 
 s o = 0 ; } 
 i f ( e c . t a g N a m e ) { e c = d o m . l a s t C h i l d ( e o ? e c . c h i l d N o d e s [ e o - 1 ] : e c ) ; e o = e c . t e x t C o n t e n t . l e n g t h ; } e l s e   i f ( e o ! = = e c . t e x t C o n t e n t . l e n g t h ) { e c . s p l i t T e x t ( e o ) ; } 
 n o d e s = d o m . l i s t B e t w e e n ( s c , e c ) ; i f ( d o m . i s V o i d ( s c ) | | d o m . i s I m g ( s c ) ) { s o = d o m . l i s t P r e v ( s c ) . l e n g t h - 1 ; s c = s c . p a r e n t N o d e ; } 
 i f ( d o m . i s B R ( e c ) ) { e o = d o m . l i s t P r e v ( e c ) . l e n g t h - 1 ; e c = e c . p a r e n t N o d e ; } e l s e   i f ( d o m . i s V o i d ( e c ) | | d o m . i s I m g ( s c ) ) { e o = d o m . l i s t P r e v ( e c ) . l e n g t h ; e c = e c . p a r e n t N o d e ; } 
 t h i s . d a t a . r a n g e = r a n g e . c r e a t e ( s c , s o , e c , e o ) ; $ ( e d i t a b l e ) . d a t a ( " r a n g e " , t h i s . d a t a . r a n g e ) ; t h i s . d a t a . r a n g e . s e l e c t ( ) ; } e l s e { n o d e s = d o m . a n c e s t o r ( s c , d o m . i s A n c h o r ) . c h i l d N o d e s ; } 
 i f ( d o m . i s I m g ( s c ) & & n o d e s . i n d e x O f ( s c ) = = = - 1 ) { n o d e s . p u s h ( s c ) ; } 
 i f ( n o d e s . l e n g t h > 1 | | d o m . a n c e s t o r ( n o d e s [ 0 ] , d o m . i s I m g ) ) { v a r   t e x t = " " ; t h i s . d a t a . i m a g e s = [ ] ; f o r ( v a r   i = 0 ; i < n o d e s . l e n g t h ; i + + ) { i f ( d o m . a n c e s t o r ( n o d e s [ i ] , d o m . i s I m g ) ) { t h i s . d a t a . i m a g e s . p u s h ( d o m . a n c e s t o r ( n o d e s [ i ] , d o m . i s I m g ) ) ; t e x t + = ' [ I M G ] ' ; } e l s e   i f ( ! i s _ l i n k & & n o d e s [ i ] . n o d e T y p e = = = 1 ) { } e l s e   i f ( ! i s _ l i n k & & i = = = 0 ) { t e x t + = n o d e s [ i ] . t e x t C o n t e n t . s l i c e ( s o , I n f i n i t y ) ; } e l s e   i f ( ! i s _ l i n k & & i = = = n o d e s . l e n g t h - 1 ) { t e x t + = n o d e s [ i ] . t e x t C o n t e n t . s l i c e ( 0 , e o ) ; } e l s e { t e x t + = n o d e s [ i ] . t e x t C o n t e n t ; } } 
 t h i s . d a t a . t e x t = t e x t ; } } 
 t h i s . d a t a . t e x t = t h i s . d a t a . t e x t . r e p l a c e ( / [   \ t \ r \ n ] + / g , '   ' ) ; v a r   a l l B t n C l a s s S u f f i x e s = / ( ^ | \ s + ) b t n ( - [ a - z 0 - 9 _ - ] * ) ? / g i ; v a r   a l l B t n S h a p e s = / \ s * ( r o u n d e d - c i r c l e | f l a t ) \ s * / g i ; t h i s . d a t a . c l a s s N a m e = t h i s . d a t a . i n i C l a s s N a m e . r e p l a c e ( a l l B t n C l a s s S u f f i x e s , '   ' ) . r e p l a c e ( a l l B t n S h a p e s , '   ' ) ; } , s t a r t : f u n c t i o n ( ) { t h i s . b u t t o n O p t s C o l l a p s e E l = t h i s . e l . q u e r y S e l e c t o r ( ' # o _ l i n k _ d i a l o g _ b u t t o n _ o p t s _ c o l l a p s e ' ) ; t h i s . $ s t y l e I n p u t s = t h i s . $ ( ' i n p u t . l i n k - s t y l e ' ) ; t h i s . $ s t y l e I n p u t s . p r o p ( ' c h e c k e d ' , f a l s e ) . f i l t e r ( ' [ v a l u e = " " ] ' ) . p r o p ( ' c h e c k e d ' , t r u e ) ; i f ( t h i s . d a t a . i n i C l a s s N a m e ) { _ . e a c h ( t h i s . $ ( ' i n p u t [ n a m e = " l i n k _ s t y l e _ c o l o r " ] ,   s e l e c t [ n a m e = " l i n k _ s t y l e _ s i z e " ]   >   o p t i o n ,   s e l e c t [ n a m e = " l i n k _ s t y l e _ s h a p e " ]   >   o p t i o n ' ) , e l = > { v a r   $ o p t i o n = $ ( e l ) ; i f ( $ o p t i o n . v a l ( ) & & t h i s . d a t a . i n i C l a s s N a m e . m a t c h ( n e w   R e g E x p ( ' ( ^ | b t n - |   | b t n - o u t l i n e - ) ' + $ o p t i o n . v a l ( ) ) ) ) { i f ( $ o p t i o n . i s ( " i n p u t " ) ) { $ o p t i o n . p r o p ( " c h e c k e d " , t r u e ) ; } e l s e { $ o p t i o n . p a r e n t ( ) . f i n d ( ' o p t i o n ' ) . r e m o v e A t t r ( ' s e l e c t e d ' ) . r e m o v e P r o p ( ' s e l e c t e d ' ) ; $ o p t i o n . p a r e n t ( ) . v a l ( $ o p t i o n . v a l ( ) ) ; $ o p t i o n . a t t r ( ' s e l e c t e d ' , ' s e l e c t e d ' ) . p r o p ( ' s e l e c t e d ' , ' s e l e c t e d ' ) ; } } } ) ; } 
 i f ( t h i s . d a t a . u r l ) { v a r   m a t c h = / m a i l t o : ( . + ) / . e x e c ( t h i s . d a t a . u r l ) ; t h i s . $ ( ' i n p u t [ n a m e = " u r l " ] ' ) . v a l ( m a t c h ? m a t c h [ 1 ] : t h i s . d a t a . u r l ) ; t h i s . _ o n U R L I n p u t ( ) ; } 
 t h i s . _ u p d a t e O p t i o n s U I ( ) ; t h i s . _ a d a p t P r e v i e w ( ) ; t h i s . $ ( ' i n p u t : v i s i b l e : f i r s t ' ) . f o c u s ( ) ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , s a v e : f u n c t i o n ( ) { v a r   d a t a = t h i s . _ g e t D a t a ( ) ; i f ( d a t a = = = n u l l ) { v a r   $ u r l = t h i s . $ ( ' i n p u t [ n a m e = " u r l " ] ' ) ; $ u r l . c l o s e s t ( ' . f o r m - g r o u p ' ) . a d d C l a s s ( ' o _ h a s _ e r r o r ' ) . f i n d ( ' . f o r m - c o n t r o l ,   . c u s t o m - s e l e c t ' ) . a d d C l a s s ( ' i s - i n v a l i d ' ) ; $ u r l . f o c u s ( ) ; r e t u r n   P r o m i s e . r e j e c t ( ) ; } 
 t h i s . d a t a . t e x t = d a t a . l a b e l ; t h i s . d a t a . u r l = d a t a . u r l ; v a r   a l l W h i t e s p a c e = / \ s + / g i ; v a r   a l l S t a r t A n d E n d S p a c e = / ^ \ s + | \ s + $ / g i ; v a r   a l l B t n T y p e s = / ( ^ | [   ] ) ( b t n - s e c o n d a r y | b t n - s u c c e s s | b t n - p r i m a r y | b t n - i n f o | b t n - w a r n i n g | b t n - d a n g e r ) ( [   ] | $ ) / g i ; t h i s . d a t a . c l a s s N a m e = d a t a . c l a s s e s . r e p l a c e ( a l l W h i t e s p a c e , '   ' ) . r e p l a c e ( a l l S t a r t A n d E n d S p a c e , ' ' ) ; i f ( d a t a . c l a s s e s . r e p l a c e ( a l l B t n T y p e s , '   ' ) ) { t h i s . d a t a . s t y l e = { ' b a c k g r o u n d - c o l o r ' : ' ' , ' c o l o r ' : ' ' , } ; } 
 t h i s . d a t a . i s N e w W i n d o w = d a t a . i s N e w W i n d o w ; t h i s . f i n a l _ d a t a = t h i s . d a t a ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , _ a d a p t P r e v i e w : f u n c t i o n ( ) { v a r   d a t a = t h i s . _ g e t D a t a ( ) ; i f ( d a t a = = = n u l l ) { r e t u r n ; } 
 c o n s t   a t t r s = { t a r g e t : d a t a . i s N e w W i n d o w ? ' _ b l a n k ' : ' ' , h r e f : d a t a . u r l & & d a t a . u r l . l e n g t h ? d a t a . u r l : ' # ' , c l a s s : ` $ { d a t a . c l a s s e s . r e p l a c e ( / f l o a t - \ w + / ,   ' ' ) }   o _ b t n _ p r e v i e w ` , } ; t h i s . $ ( " # l i n k - p r e v i e w " ) . a t t r ( a t t r s ) . h t m l ( ( d a t a . l a b e l & & d a t a . l a b e l . l e n g t h ) ? d a t a . l a b e l : d a t a . u r l ) ; } , _ g e t D a t a : f u n c t i o n ( ) { v a r   $ u r l = t h i s . $ ( ' i n p u t [ n a m e = " u r l " ] ' ) ; v a r   u r l = $ u r l . v a l ( ) ; v a r   l a b e l = t h i s . $ ( ' i n p u t [ n a m e = " l a b e l " ] ' ) . v a l ( ) | | u r l ; i f ( l a b e l & & t h i s . d a t a . i m a g e s ) { f o r ( v a r   i = 0 ; i < t h i s . d a t a . i m a g e s . l e n g t h ; i + + ) { l a b e l = l a b e l . r e p l a c e ( ' < ' , " & l t ; " ) . r e p l a c e ( ' > ' , " & g t ; " ) . r e p l a c e ( / \ [ I M G \ ] / , t h i s . d a t a . i m a g e s [ i ] . o u t e r H T M L ) ; } } 
 i f ( $ u r l . p r o p ( ' r e q u i r e d ' ) & & ( ! u r l | | ! $ u r l [ 0 ] . c h e c k V a l i d i t y ( ) ) ) { r e t u r n   n u l l ; } 
 c o n s t   t y p e = t h i s . $ ( ' i n p u t [ n a m e = " l i n k _ s t y l e _ c o l o r " ] : c h e c k e d ' ) . v a l ( ) | | ' ' ; c o n s t   s i z e = t h i s . $ ( ' s e l e c t [ n a m e = " l i n k _ s t y l e _ s i z e " ] ' ) . v a l ( ) | | ' ' ; c o n s t   s h a p e = t h i s . $ ( ' s e l e c t [ n a m e = " l i n k _ s t y l e _ s h a p e " ] ' ) . v a l ( ) | | ' ' ; c o n s t   s h a p e s = s h a p e ? s h a p e . s p l i t ( ' , ' ) : [ ] ; c o n s t   s t y l e = [ ' o u t l i n e ' , ' f i l l ' ] . i n c l u d e s ( s h a p e s [ 0 ] ) ? ` $ { s h a p e s [ 0 ] } - ` : ' ' ; c o n s t   s h a p e C l a s s e s = s h a p e s . s l i c e ( s t y l e ? 1 : 0 ) . j o i n ( '   ' ) ; c o n s t   c l a s s e s = ( t h i s . d a t a . c l a s s N a m e | | ' ' ) + 
 ( t y p e ? ( `   b t n   b t n - $ { s t y l e } $ { t y p e } ` ) : ' ' ) + 
 ( s h a p e C l a s s e s ? ( `   $ { s h a p e C l a s s e s } ` ) : ' ' ) + 
 ( s i z e ? ( '   b t n - ' + s i z e ) : ' ' ) ; v a r   i s N e w W i n d o w = t h i s . $ ( ' i n p u t [ n a m e = " i s _ n e w _ w i n d o w " ] ' ) . p r o p ( ' c h e c k e d ' ) ; i f ( u r l . i n d e x O f ( ' @ ' ) > = 0 & & u r l . i n d e x O f ( ' m a i l t o : ' ) < 0 & & ! u r l . m a t c h ( / ^ h t t p [ s ] ? / i ) ) { u r l = ( ' m a i l t o : ' + u r l ) ; } e l s e   i f ( u r l . i n d e x O f ( l o c a t i o n . o r i g i n ) = = = 0 & & t h i s . $ ( ' # o _ l i n k _ d i a l o g _ u r l _ s t r i p _ d o m a i n ' ) . p r o p ( " c h e c k e d " ) ) { u r l = u r l . s l i c e ( l o c a t i o n . o r i g i n . l e n g t h ) ; } 
 v a r   a l l W h i t e s p a c e = / \ s + / g i ; v a r   a l l S t a r t A n d E n d S p a c e = / ^ \ s + | \ s + $ / g i ; r e t u r n { l a b e l : l a b e l , u r l : u r l , c l a s s e s : c l a s s e s . r e p l a c e ( a l l W h i t e s p a c e , '   ' ) . r e p l a c e ( a l l S t a r t A n d E n d S p a c e , ' ' ) , i s N e w W i n d o w : i s N e w W i n d o w , } ; } , _ u p d a t e O p t i o n s U I : f u n c t i o n ( ) { c o n s t   e l = t h i s . e l . q u e r y S e l e c t o r ( ' [ n a m e = " l i n k _ s t y l e _ c o l o r " ] : c h e c k e d ' ) ; $ ( t h i s . b u t t o n O p t s C o l l a p s e E l ) . c o l l a p s e ( e l & & e l . v a l u e ? ' s h o w ' : ' h i d e ' ) ; } , _ o n A n y C h a n g e : f u n c t i o n ( ) { t h i s . _ a d a p t P r e v i e w ( ) ; } , _ o n T y p e C h a n g e ( ) { t h i s . _ u p d a t e O p t i o n s U I ( ) ; } , _ o n U R L I n p u t : f u n c t i o n ( ) { v a r   $ l i n k U r l I n p u t = t h i s . $ ( ' # o _ l i n k _ d i a l o g _ u r l _ i n p u t ' ) ; $ l i n k U r l I n p u t . c l o s e s t ( ' . f o r m - g r o u p ' ) . r e m o v e C l a s s ( ' o _ h a s _ e r r o r ' ) . f i n d ( ' . f o r m - c o n t r o l ,   . c u s t o m - s e l e c t ' ) . r e m o v e C l a s s ( ' i s - i n v a l i d ' ) ; l e t   v a l u e = $ l i n k U r l I n p u t . v a l ( ) ; l e t   i s L i n k = v a l u e . i n d e x O f ( ' @ ' ) < 0 ; t h i s . $ ( ' i n p u t [ n a m e = " i s _ n e w _ w i n d o w " ] ' ) . c l o s e s t ( ' . f o r m - g r o u p ' ) . t o g g l e C l a s s ( ' d - n o n e ' , ! i s L i n k ) ; t h i s . $ ( ' . o _ s t r i p _ d o m a i n ' ) . t o g g l e C l a s s ( ' d - n o n e ' , v a l u e . i n d e x O f ( w i n d o w . l o c a t i o n . o r i g i n ) ! = = 0 ) ; } , } ) ; r e t u r n   L i n k D i a l o g ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / m e d i a _ d i a l o g . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . w i d g e t s . M e d i a D i a l o g ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   M e d i a M o d u l e s = r e q u i r e ( ' w y s i w y g . w i d g e t s . m e d i a ' ) ; v a r   D i a l o g = r e q u i r e ( ' w y s i w y g . w i d g e t s . D i a l o g ' ) ; v a r   _ t = c o r e . _ t ; v a r   M e d i a D i a l o g = D i a l o g . e x t e n d ( { t e m p l a t e : ' w y s i w y g . w i d g e t s . m e d i a ' , x m l D e p e n d e n c i e s : D i a l o g . p r o t o t y p e . x m l D e p e n d e n c i e s . c o n c a t ( [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / w y s i w y g . x m l ' ] ) , e v e n t s : _ . e x t e n d ( { } , D i a l o g . p r o t o t y p e . e v e n t s , { ' c l i c k   # e d i t o r - m e d i a - i m a g e - t a b ' : ' _ o n C l i c k I m a g e T a b ' , ' c l i c k   # e d i t o r - m e d i a - d o c u m e n t - t a b ' : ' _ o n C l i c k D o c u m e n t T a b ' , ' c l i c k   # e d i t o r - m e d i a - i c o n - t a b ' : ' _ o n C l i c k I c o n T a b ' , ' c l i c k   # e d i t o r - m e d i a - v i d e o - t a b ' : ' _ o n C l i c k V i d e o T a b ' , } ) , c u s t o m _ e v e n t s : _ . e x t e n d ( { } , D i a l o g . p r o t o t y p e . c u s t o m _ e v e n t s | | { } , { s a v e _ r e q u e s t : ' _ o n S a v e R e q u e s t ' , s h o w _ p a r e n t _ d i a l o g _ r e q u e s t : ' _ o n S h o w R e q u e s t ' , h i d e _ p a r e n t _ d i a l o g _ r e q u e s t : ' _ o n H i d e R e q u e s t ' , } ) , i n i t : f u n c t i o n ( p a r e n t , o p t i o n s , m e d i a ) { v a r   $ m e d i a = $ ( m e d i a ) ; m e d i a = $ m e d i a [ 0 ] ; o p t i o n s = _ . e x t e n d ( { } , o p t i o n s ) ; v a r   o n l y I m a g e s = o p t i o n s . o n l y I m a g e s | | t h i s . m u l t i I m a g e s | | ( m e d i a & & ( $ m e d i a . p a r e n t ( ) . d a t a ( ' o e F i e l d ' ) = = = ' i m a g e ' | | $ m e d i a . p a r e n t ( ) . d a t a ( ' o e T y p e ' ) = = = ' i m a g e ' ) ) ; o p t i o n s . n o D o c u m e n t s = o n l y I m a g e s | | o p t i o n s . n o D o c u m e n t s ; o p t i o n s . n o I c o n s = o n l y I m a g e s | | o p t i o n s . n o I c o n s ; o p t i o n s . n o V i d e o s = o n l y I m a g e s | | o p t i o n s . n o V i d e o s ; t h i s . _ s u p e r ( p a r e n t , _ . e x t e n d ( { } , { t i t l e : _ t ( " S e l e c t   a   M e d i a " ) , s a v e _ t e x t : _ t ( " A d d " ) , } , o p t i o n s ) ) ; t h i s . t r i g g e r _ u p ( ' g e t R e c o r d I n f o ' , { r e c o r d I n f o : o p t i o n s , t y p e : ' m e d i a ' , c a l l b a c k : f u n c t i o n ( r e c o r d I n f o ) { _ . d e f a u l t s ( o p t i o n s , r e c o r d I n f o ) ; } , } ) ; i f ( ! o p t i o n s . n o I m a g e s ) { t h i s . i m a g e W i d g e t = n e w   M e d i a M o d u l e s . I m a g e W i d g e t ( t h i s , m e d i a , o p t i o n s ) ; } 
 i f ( ! o p t i o n s . n o D o c u m e n t s ) { t h i s . d o c u m e n t W i d g e t = n e w   M e d i a M o d u l e s . D o c u m e n t W i d g e t ( t h i s , m e d i a , o p t i o n s ) ; } 
 i f ( ! o p t i o n s . n o I c o n s ) { t h i s . i c o n W i d g e t = n e w   M e d i a M o d u l e s . I c o n W i d g e t ( t h i s , m e d i a , o p t i o n s ) ; } 
 i f ( ! o p t i o n s . n o V i d e o s ) { t h i s . v i d e o W i d g e t = n e w   M e d i a M o d u l e s . V i d e o W i d g e t ( t h i s , m e d i a , o p t i o n s ) ; } 
 i f ( t h i s . i m a g e W i d g e t & & $ m e d i a . i s ( ' i m g ' ) ) { t h i s . a c t i v e W i d g e t = t h i s . i m a g e W i d g e t ; } e l s e   i f ( t h i s . d o c u m e n t W i d g e t & & $ m e d i a . i s ( ' a . o _ i m a g e ' ) ) { t h i s . a c t i v e W i d g e t = t h i s . d o c u m e n t W i d g e t ; } e l s e   i f ( t h i s . v i d e o W i d g e t & & $ m e d i a . i s ( ' . m e d i a _ i f r a m e _ v i d e o ,   . o _ b g _ v i d e o _ i f r a m e ' ) ) { t h i s . a c t i v e W i d g e t = t h i s . v i d e o W i d g e t ; } e l s e   i f ( t h i s . i c o n W i d g e t & & $ m e d i a . i s ( ' s p a n ,   i ' ) ) { t h i s . a c t i v e W i d g e t = t h i s . i c o n W i d g e t ; } e l s e { t h i s . a c t i v e W i d g e t = [ t h i s . i m a g e W i d g e t , t h i s . d o c u m e n t W i d g e t , t h i s . v i d e o W i d g e t , t h i s . i c o n W i d g e t ] . f i n d ( w = > ! ! w ) ; } } , s t a r t : f u n c t i o n ( ) { v a r   p r o m i s e s = [ t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ] ; t h i s . $ m o d a l . f i n d ( ' . m o d a l - d i a l o g ' ) . a d d C l a s s ( ' o _ s e l e c t _ m e d i a _ d i a l o g ' ) ; i f ( t h i s . i m a g e W i d g e t ) { p r o m i s e s . p u s h ( t h i s . i m a g e W i d g e t . a p p e n d T o ( t h i s . $ ( " # e d i t o r - m e d i a - i m a g e " ) ) ) ; } 
 i f ( t h i s . d o c u m e n t W i d g e t ) { p r o m i s e s . p u s h ( t h i s . d o c u m e n t W i d g e t . a p p e n d T o ( t h i s . $ ( " # e d i t o r - m e d i a - d o c u m e n t " ) ) ) ; } 
 i f ( t h i s . i c o n W i d g e t ) { p r o m i s e s . p u s h ( t h i s . i c o n W i d g e t . a p p e n d T o ( t h i s . $ ( " # e d i t o r - m e d i a - i c o n " ) ) ) ; } 
 i f ( t h i s . v i d e o W i d g e t ) { p r o m i s e s . p u s h ( t h i s . v i d e o W i d g e t . a p p e n d T o ( t h i s . $ ( " # e d i t o r - m e d i a - v i d e o " ) ) ) ; } 
 t h i s . o p e n e d ( ( ) = > t h i s . $ ( ' i n p u t . o _ w e _ s e a r c h : v i s i b l e : f i r s t ' ) . f o c u s ( ) ) ; r e t u r n   P r o m i s e . a l l ( p r o m i s e s ) ; } , i s D o c u m e n t A c t i v e : f u n c t i o n ( ) { r e t u r n   t h i s . a c t i v e W i d g e t = = = t h i s . d o c u m e n t W i d g e t ; } , i s I c o n A c t i v e : f u n c t i o n ( ) { r e t u r n   t h i s . a c t i v e W i d g e t = = = t h i s . i c o n W i d g e t ; } , i s I m a g e A c t i v e : f u n c t i o n ( ) { r e t u r n   t h i s . a c t i v e W i d g e t = = = t h i s . i m a g e W i d g e t ; } , i s V i d e o A c t i v e : f u n c t i o n ( ) { r e t u r n   t h i s . a c t i v e W i d g e t = = = t h i s . v i d e o W i d g e t ; } , s a v e : f u n c t i o n ( ) { v a r   s e l f = t h i s ; v a r   _ s u p e r = t h i s . _ s u p e r ; v a r   a r g s = a r g u m e n t s ; r e t u r n   t h i s . a c t i v e W i d g e t . s a v e ( ) . t h e n ( f u n c t i o n ( d a t a ) { s e l f . _ c l e a r W i d g e t s ( ) ; s e l f . f i n a l _ d a t a = d a t a ; _ s u p e r . a p p l y ( s e l f , a r g s ) ; $ ( d a t a ) . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } ) ; } , _ c l e a r W i d g e t s : f u n c t i o n ( ) { [ t h i s . i m a g e W i d g e t , t h i s . d o c u m e n t W i d g e t , t h i s . i c o n W i d g e t , t h i s . v i d e o W i d g e t ] . f o r E a c h ( ( w i d g e t ) = > { i f ( w i d g e t ! = = t h i s . a c t i v e W i d g e t ) { w i d g e t & & w i d g e t . c l e a r ( ) ; } } ) ; } , _ o n C l i c k D o c u m e n t T a b : f u n c t i o n ( ) { t h i s . a c t i v e W i d g e t = t h i s . d o c u m e n t W i d g e t ; } , _ o n C l i c k I c o n T a b : f u n c t i o n ( ) { t h i s . a c t i v e W i d g e t = t h i s . i c o n W i d g e t ; } , _ o n C l i c k I m a g e T a b : f u n c t i o n ( ) { t h i s . a c t i v e W i d g e t = t h i s . i m a g e W i d g e t ; } , _ o n C l i c k V i d e o T a b : f u n c t i o n ( ) { t h i s . a c t i v e W i d g e t = t h i s . v i d e o W i d g e t ; } , _ o n H i d e R e q u e s t : f u n c t i o n ( e v ) { t h i s . $ m o d a l . a d d C l a s s ( ' d - n o n e ' ) ; } , _ o n S a v e R e q u e s t : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; t h i s . s a v e ( ) ; } , _ o n S h o w R e q u e s t : f u n c t i o n ( e v ) { t h i s . $ m o d a l . r e m o v e C l a s s ( ' d - n o n e ' ) ; } , } ) ; r e t u r n   M e d i a D i a l o g ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w i d g e t s / w i d g e t s . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w y s i w y g . w i d g e t s ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   D i a l o g = r e q u i r e ( ' w y s i w y g . w i d g e t s . D i a l o g ' ) ; v a r   A l t D i a l o g = r e q u i r e ( ' w y s i w y g . w i d g e t s . A l t D i a l o g ' ) ; v a r   M e d i a D i a l o g = r e q u i r e ( ' w y s i w y g . w i d g e t s . M e d i a D i a l o g ' ) ; v a r   L i n k D i a l o g = r e q u i r e ( ' w y s i w y g . w i d g e t s . L i n k D i a l o g ' ) ; v a r   I m a g e C r o p W i d g e t = r e q u i r e ( ' w y s i w y g . w i d g e t s . I m a g e C r o p W i d g e t ' ) ; c o n s t { C o l o r p i c k e r D i a l o g } = r e q u i r e ( ' w e b . C o l o r p i c k e r ' ) ; v a r   m e d i a = r e q u i r e ( ' w y s i w y g . w i d g e t s . m e d i a ' ) ; r e t u r n { D i a l o g : D i a l o g , A l t D i a l o g : A l t D i a l o g , M e d i a D i a l o g : M e d i a D i a l o g , L i n k D i a l o g : L i n k D i a l o g , I m a g e C r o p W i d g e t : I m a g e C r o p W i d g e t , C o l o r p i c k e r D i a l o g : C o l o r p i c k e r D i a l o g , M e d i a W i d g e t : m e d i a . M e d i a W i d g e t , S e a r c h a b l e M e d i a W i d g e t : m e d i a . S e a r c h a b l e M e d i a W i d g e t , F i l e W i d g e t : m e d i a . F i l e W i d g e t , I m a g e W i d g e t : m e d i a . I m a g e W i d g e t , D o c u m e n t W i d g e t : m e d i a . D o c u m e n t W i d g e t , I c o n W i d g e t : m e d i a . I c o n W i d g e t , V i d e o W i d g e t : m e d i a . V i d e o W i d g e t , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / e d i t o r / s n i p p e t s . e d i t o r . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . s n i p p e t . e d i t o r ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o n c u r r e n c y = r e q u i r e ( ' w e b . c o n c u r r e n c y ' ) ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   D i a l o g = r e q u i r e ( ' w e b . D i a l o g ' ) ; v a r   d o m = r e q u i r e ( ' w e b . d o m ' ) ; v a r   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; v a r   o p t i o n s = r e q u i r e ( ' w e b _ e d i t o r . s n i p p e t s . o p t i o n s ' ) ; v a r   W y s i w y g = r e q u i r e ( ' w e b _ e d i t o r . w y s i w y g ' ) ; c o n s t { C o l o r P a l e t t e W i d g e t } = r e q u i r e ( ' w e b _ e d i t o r . C o l o r P a l e t t e ' ) ; c o n s t   S m o o t h S c r o l l O n D r a g = r e q u i r e ( ' w e b / s t a t i c / s r c / j s / c o r e / s m o o t h _ s c r o l l _ o n _ d r a g . j s ' ) ; c o n s t { g e t C S S V a r i a b l e V a l u e } = r e q u i r e ( ' w e b _ e d i t o r . u t i l s ' ) ; v a r   _ t = c o r e . _ t ; v a r   g l o b a l S e l e c t o r = { c l o s e s t : ( ) = > $ ( ) , a l l : ( ) = > $ ( ) , i s : ( ) = > f a l s e , } ; v a r   S n i p p e t E d i t o r = W i d g e t . e x t e n d ( { t e m p l a t e : ' w e b _ e d i t o r . s n i p p e t _ o v e r l a y ' , x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / s n i p p e t s . x m l ' ] , e v e n t s : { ' c l i c k   . o e _ s n i p p e t _ r e m o v e ' : ' _ o n R e m o v e C l i c k ' , ' w h e e l ' : ' _ o n M o u s e W h e e l ' , } , c u s t o m _ e v e n t s : { ' o p t i o n _ u p d a t e ' : ' _ o n O p t i o n U p d a t e ' , ' u s e r _ v a l u e _ w i d g e t _ r e q u e s t ' : ' _ o n U s e r V a l u e W i d g e t R e q u e s t ' , ' s n i p p e t _ o p t i o n _ u p d a t e ' : ' _ o n S n i p p e t O p t i o n U p d a t e ' , ' s n i p p e t _ o p t i o n _ v i s i b i l i t y _ u p d a t e ' : ' _ o n S n i p p e t O p t i o n V i s i b i l i t y U p d a t e ' , } , i n i t : f u n c t i o n ( p a r e n t , t a r g e t , t e m p l a t e O p t i o n s , $ e d i t a b l e , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . o p t i o n s = o p t i o n s ; t h i s . $ e d i t a b l e = $ e d i t a b l e ; t h i s . o w n e r D o c u m e n t = t h i s . $ e d i t a b l e [ 0 ] . o w n e r D o c u m e n t ; t h i s . $ b o d y = $ ( t h i s . o w n e r D o c u m e n t . b o d y ) ; t h i s . $ t a r g e t = $ ( t a r g e t ) ; t h i s . $ t a r g e t . d a t a ( ' s n i p p e t - e d i t o r ' , t h i s ) ; t h i s . t e m p l a t e O p t i o n s = t e m p l a t e O p t i o n s ; t h i s . i s T a r g e t P a r e n t E d i t a b l e = f a l s e ; t h i s . i s T a r g e t M o v a b l e = f a l s e ; t h i s . _ _ i s S t a r t e d = n e w   P r o m i s e ( r e s o l v e = > { t h i s . _ _ i s S t a r t e d R e s o l v e F u n c = r e s o l v e ; } ) ; } , s t a r t : f u n c t i o n ( ) { v a r   d e f s = [ t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ] ; d e f s . p u s h ( t h i s . _ i n i t i a l i z e O p t i o n s ( ) ) ; v a r   $ c u s t o m i z e = t h i s . _ c u s t o m i z e $ E l e m e n t s [ t h i s . _ c u s t o m i z e $ E l e m e n t s . l e n g t h - 1 ] ; t h i s . i s T a r g e t P a r e n t E d i t a b l e = t h i s . $ t a r g e t . p a r e n t ( ) . i s ( ' : o _ e d i t a b l e ' ) ; t h i s . i s T a r g e t M o v a b l e = t h i s . i s T a r g e t P a r e n t E d i t a b l e & & t h i s . i s T a r g e t M o v a b l e ; t h i s . i s T a r g e t R e m o v a b l e = t h i s . i s T a r g e t P a r e n t E d i t a b l e & & ! t h i s . $ t a r g e t . p a r e n t ( ) . i s ( ' [ d a t a - o e - t y p e = " i m a g e " ] ' ) ; i f ( t h i s . i s T a r g e t M o v a b l e ) { t h i s . d r o p p e d = f a l s e ; c o n s t   s m o o t h S c r o l l O p t i o n s = t h i s . o p t i o n s . g e t S c r o l l O p t i o n s ( { j Q u e r y D r a g g a b l e O p t i o n s : { c u r s o r A t : { l e f t : 1 0 , t o p : 1 0 } , h a n d l e : ' . o _ m o v e _ h a n d l e ' , h e l p e r : ( ) = > { v a r   $ c l o n e = t h i s . $ e l . c l o n e ( ) . c s s ( { w i d t h : ' 2 4 p x ' , h e i g h t : ' 2 4 p x ' , b o r d e r : 0 } ) ; $ c l o n e . a p p e n d T o ( t h i s . $ b o d y ) . r e m o v e C l a s s ( ' d - n o n e ' ) ; r e t u r n   $ c l o n e ; } , s t a r t : t h i s . _ o n D r a g A n d D r o p S t a r t . b i n d ( t h i s ) , s t o p : ( . . . a r g s ) = > { s e t T i m e o u t ( ( ) = > { t h i s . _ o n D r a g A n d D r o p S t o p ( . . . a r g s ) ; } , 0 ) ; } , } , } ) ; t h i s . d r a g g a b l e C o m p o n e n t = n e w   S m o o t h S c r o l l O n D r a g ( t h i s , t h i s . $ e l , $ ( ) . g e t S c r o l l i n g E l e m e n t ( ) , s m o o t h S c r o l l O p t i o n s ) ; } e l s e { t h i s . $ ( ' . o _ o v e r l a y _ m o v e _ o p t i o n s ' ) . a d d C l a s s ( ' d - n o n e ' ) ; $ c u s t o m i z e . f i n d ( ' . o e _ s n i p p e t _ c l o n e ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } 
 i f ( ! t h i s . i s T a r g e t R e m o v a b l e ) { t h i s . $ e l . a d d ( $ c u s t o m i z e ) . f i n d ( ' . o e _ s n i p p e t _ r e m o v e ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } 
 v a r   _ a n i m a t i o n s C o u n t = 0 ; v a r   p o s t A n i m a t i o n C o v e r = _ . t h r o t t l e ( ( ) = > t h i s . c o v e r ( ) , 1 0 0 ) ; t h i s . $ t a r g e t . o n ( ' t r a n s i t i o n s t a r t . s n i p p e t _ e d i t o r ,   a n i m a t i o n s t a r t . s n i p p e t _ e d i t o r ' , ( ) = > { _ a n i m a t i o n s C o u n t + + ; s e t T i m e o u t ( ( ) = > { i f ( ! - - _ a n i m a t i o n s C o u n t ) { p o s t A n i m a t i o n C o v e r ( ) ; } } , 5 0 0 ) ; } ) ; t h i s . $ t a r g e t . o n ( ' t r a n s i t i o n e n d . s n i p p e t _ e d i t o r ,   a n i m a t i o n e n d . s n i p p e t _ e d i t o r ' , p o s t A n i m a t i o n C o v e r ) ; r e t u r n   P r o m i s e . a l l ( d e f s ) . t h e n ( ( ) = > { t h i s . _ _ i s S t a r t e d R e s o l v e F u n c ( t h i s ) ; } ) ; } , d e s t r o y : f u n c t i o n ( ) { t h i s . t r i g g e r _ u p ( ' s n i p p e t _ e d i t o r _ d e s t r o y e d ' ) ; t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . $ t a r g e t . r e m o v e D a t a ( ' s n i p p e t - e d i t o r ' ) ; t h i s . $ t a r g e t . o f f ( ' . s n i p p e t _ e d i t o r ' ) ; } , a r e O p t i o n s S h o w n : f u n c t i o n ( ) { c o n s t   l a s t I n d e x = t h i s . _ c u s t o m i z e $ E l e m e n t s . l e n g t h - 1 ; r e t u r n ! ! t h i s . _ c u s t o m i z e $ E l e m e n t s [ l a s t I n d e x ] . p a r e n t ( ) . l e n g t h ; } , b u i l d S n i p p e t : a s y n c   f u n c t i o n ( ) { f o r ( v a r   i   i n   t h i s . s t y l e s ) { t h i s . s t y l e s [ i ] . o n B u i l t ( ) ; } 
 a w a i t   t h i s . t o g g l e T a r g e t V i s i b i l i t y ( t r u e ) ; } , c l e a n F o r S a v e : a s y n c   f u n c t i o n ( ) { i f ( t h i s . i s D e s t r o y e d ( ) ) { r e t u r n ; } 
 a w a i t   t h i s . t o g g l e T a r g e t V i s i b i l i t y ( ! t h i s . $ t a r g e t . h a s C l a s s ( ' o _ s n i p p e t _ i n v i s i b l e ' ) ) ; c o n s t   p r o m s = _ . m a p ( t h i s . s t y l e s , o p t i o n = > { r e t u r n   o p t i o n . c l e a n F o r S a v e ( ) ; } ) ; a w a i t   P r o m i s e . a l l ( p r o m s ) ; } , c l o s e W i d g e t s : f u n c t i o n ( ) { i f ( ! t h i s . s t y l e s | | ! t h i s . a r e O p t i o n s S h o w n ( ) ) { r e t u r n ; } 
 O b j e c t . k e y s ( t h i s . s t y l e s ) . f o r E a c h ( k e y = > { t h i s . s t y l e s [ k e y ] . c l o s e W i d g e t s ( ) ; } ) ; } , c o v e r : f u n c t i o n ( ) { i f ( ! t h i s . i s S h o w n ( ) | | ! t h i s . $ t a r g e t . l e n g t h ) { r e t u r n ; } 
 c o n s t   $ m o d a l = t h i s . $ t a r g e t . f i n d ( ' . m o d a l ' ) ; c o n s t   $ t a r g e t = $ m o d a l . l e n g t h ? $ m o d a l : t h i s . $ t a r g e t ; c o n s t   t a r g e t E l = $ t a r g e t [ 0 ] ; c o n s t   r e c t = t a r g e t E l . g e t B o u n d i n g C l i e n t R e c t ( ) ; c o n s t   v p W i d t h = w i n d o w . i n n e r W i d t h | | d o c u m e n t . d o c u m e n t E l e m e n t . c l i e n t W i d t h ; c o n s t   v p H e i g h t = w i n d o w . i n n e r H e i g h t | | d o c u m e n t . d o c u m e n t E l e m e n t . c l i e n t H e i g h t ; c o n s t   i s I n V i e w p o r t = ( r e c t . b o t t o m > - 0 . 1 & & r e c t . r i g h t > - 0 . 1 & & ( v p H e i g h t - r e c t . t o p ) > - 0 . 1 & & ( v p W i d t h - r e c t . l e f t ) > - 0 . 1 ) ; c o n s t   h a s S i z e = ( M a t h . a b s ( r e c t . b o t t o m - r e c t . t o p ) > 0 . 0 1 & & M a t h . a b s ( r e c t . r i g h t - r e c t . l e f t ) > 0 . 0 1 ) ; i f ( ! i s I n V i e w p o r t | | ! h a s S i z e | | ! t h i s . $ t a r g e t . i s ( ` : v i s i b l e ` ) ) { t h i s . t o g g l e O v e r l a y V i s i b i l i t y ( f a l s e ) ; r e t u r n ; } 
 c o n s t   o f f s e t = $ t a r g e t . o f f s e t ( ) ; v a r   m a n i p u l a t o r O f f s e t = t h i s . $ e l . p a r e n t ( ) . o f f s e t ( ) ; o f f s e t . t o p - = m a n i p u l a t o r O f f s e t . t o p ; o f f s e t . l e f t - = m a n i p u l a t o r O f f s e t . l e f t ; t h i s . $ e l . c s s ( { w i d t h : $ t a r g e t . o u t e r W i d t h ( ) , l e f t : o f f s e t . l e f t , t o p : o f f s e t . t o p , } ) ; t h i s . $ ( ' . o _ h a n d l e s ' ) . c s s ( ' h e i g h t ' , $ t a r g e t . o u t e r H e i g h t ( ) ) ; c o n s t   e d i t a b l e O f f s e t T o p = t h i s . $ e d i t a b l e . o f f s e t ( ) . t o p - m a n i p u l a t o r O f f s e t . t o p ; t h i s . $ e l . t o g g l e C l a s s ( ' o _ t o p _ c o v e r ' , o f f s e t . t o p - e d i t a b l e O f f s e t T o p < 2 5 ) ; } , g e t N a m e : f u n c t i o n ( ) { i f ( t h i s . $ t a r g e t . d a t a ( ' n a m e ' ) ! = = u n d e f i n e d ) { r e t u r n   t h i s . $ t a r g e t . d a t a ( ' n a m e ' ) ; } 
 i f ( t h i s . $ t a r g e t . i s ( ' i m g ' ) ) { r e t u r n   _ t ( " I m a g e " ) ; } 
 i f ( t h i s . $ t a r g e t . p a r e n t ( ' . r o w ' ) . l e n g t h ) { r e t u r n   _ t ( " C o l u m n " ) ; } 
 r e t u r n   _ t ( " B l o c k " ) ; } , i s S h o w n : f u n c t i o n ( ) { r e t u r n   t h i s . $ e l & & t h i s . $ e l . p a r e n t ( ) . l e n g t h & & t h i s . $ e l . h a s C l a s s ( ' o e _ a c t i v e ' ) ; } , i s S t i c k y : f u n c t i o n ( ) { r e t u r n   t h i s . $ e l & & t h i s . $ e l . h a s C l a s s ( ' o _ w e _ o v e r l a y _ s t i c k y ' ) ; } , i s T a r g e t V i s i b l e : f u n c t i o n ( ) { r e t u r n ( t h i s . $ t a r g e t [ 0 ] . d a t a s e t . i n v i s i b l e ! = = ' 1 ' ) ; } , r e m o v e S n i p p e t : a s y n c   f u n c t i o n ( ) { t h i s . t o g g l e O v e r l a y ( f a l s e ) ; t h i s . t o g g l e O p t i o n s ( f a l s e ) ; a w a i t   n e w   P r o m i s e ( r e s o l v e = > { t h i s . t r i g g e r _ u p ( ' c a l l _ f o r _ e a c h _ c h i l d _ s n i p p e t ' , { $ s n i p p e t : t h i s . $ t a r g e t , c a l l b a c k : f u n c t i o n ( e d i t o r , $ s n i p p e t ) { f o r ( v a r   i   i n   e d i t o r . s t y l e s ) { e d i t o r . s t y l e s [ i ] . o n R e m o v e ( ) ; } 
 r e s o l v e ( ) ; } , } ) ; } ) ; t h i s . t r i g g e r _ u p ( ' g o _ t o _ p a r e n t ' , { $ s n i p p e t : t h i s . $ t a r g e t } ) ; v a r   $ p a r e n t = t h i s . $ t a r g e t . p a r e n t ( ) ; t h i s . $ t a r g e t . f i n d ( ' * ' ) . a d d B a c k ( ) . t o o l t i p ( ' d i s p o s e ' ) ; t h i s . $ t a r g e t . r e m o v e ( ) ; t h i s . $ e l . r e m o v e ( ) ; v a r   n o d e = $ p a r e n t [ 0 ] ; i f ( n o d e & & n o d e . f i r s t C h i l d ) { i f ( ! n o d e . f i r s t C h i l d . t a g N a m e & & n o d e . f i r s t C h i l d . t e x t C o n t e n t = = = '   ' ) { n o d e . r e m o v e C h i l d ( n o d e . f i r s t C h i l d ) ; } } 
 i f ( $ p a r e n t . c l o s e s t ( ' : d a t a ( " s n i p p e t - e d i t o r " ) ' ) . l e n g t h ) { v a r   e d i t o r = $ p a r e n t . d a t a ( ' s n i p p e t - e d i t o r ' ) ; w h i l e ( ! e d i t o r ) { v a r   $ n e x t P a r e n t = $ p a r e n t . p a r e n t ( ) ; i f ( i s E m p t y A n d R e m o v a b l e ( $ p a r e n t ) ) { $ p a r e n t . r e m o v e ( ) ; } 
 $ p a r e n t = $ n e x t P a r e n t ; e d i t o r = $ p a r e n t . d a t a ( ' s n i p p e t - e d i t o r ' ) ; } 
 i f ( i s E m p t y A n d R e m o v a b l e ( $ p a r e n t , e d i t o r ) ) { s e t T i m e o u t ( ( ) = > e d i t o r . r e m o v e S n i p p e t ( ) ) ; } } 
 t h i s . $ b o d y . f i n d ( ' . n o t e - c o n t r o l - s e l e c t i o n ' ) . h i d e ( ) ; t h i s . $ b o d y . f i n d ( ' . o _ t a b l e _ h a n d l e r ' ) . r e m o v e ( ) ; t h i s . t r i g g e r _ u p ( ' s n i p p e t _ r e m o v e d ' ) ; t h i s . d e s t r o y ( ) ; $ p a r e n t . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; f u n c t i o n   i s E m p t y A n d R e m o v a b l e ( $ e l , e d i t o r ) { e d i t o r = e d i t o r | | $ e l . d a t a ( ' s n i p p e t - e d i t o r ' ) ; r e t u r n   $ e l . c h i l d r e n ( ) . l e n g t h = = = 0 & & $ e l . t e x t ( ) . t r i m ( ) = = = ' ' & & ! $ e l . h a s C l a s s ( ' o e _ s t r u c t u r e ' ) & & ( ! e d i t o r | | e d i t o r . i s T a r g e t P a r e n t E d i t a b l e ) ; } } , t o g g l e O v e r l a y : f u n c t i o n ( s h o w , p r e v i e w M o d e ) { i f ( ! t h i s . $ e l ) { r e t u r n ; } 
 i f ( p r e v i e w M o d e ) { t h i s . $ e l . t o g g l e C l a s s ( ' o _ w e _ o v e r l a y _ p r e v i e w ' , s h o w ) ; } e l s e { t h i s . $ e l . r e m o v e C l a s s ( ' o _ w e _ o v e r l a y _ p r e v i e w ' ) ; t h i s . $ e l . t o g g l e C l a s s ( ' o _ w e _ o v e r l a y _ s t i c k y ' , s h o w ) ; } 
 t h i s . $ e l . t o g g l e C l a s s ( ' o e _ a c t i v e ' , s h o w ) ; t h i s . c o v e r ( ) ; } , t o g g l e O p t i o n s : f u n c t i o n ( s h o w ) { i f ( ! t h i s . $ e l ) { r e t u r n ; } 
 i f ( t h i s . a r e O p t i o n s S h o w n ( ) = = = s h o w ) { r e t u r n ; } 
 t h i s . t r i g g e r _ u p ( ' u p d a t e _ c u s t o m i z e _ e l e m e n t s ' , { c u s t o m i z e $ E l e m e n t s : s h o w ? t h i s . _ c u s t o m i z e $ E l e m e n t s : [ ] , } ) ; t h i s . _ c u s t o m i z e $ E l e m e n t s . f o r E a c h ( ( $ e l , i ) = > { c o n s t   e d i t o r = $ e l . d a t a ( ' e d i t o r ' ) ; c o n s t   s t y l e s = _ . c h a i n ( e d i t o r . s t y l e s ) . v a l u e s ( ) . s o r t B y ( ' _ _ o r d e r ' ) . v a l u e ( ) ; i f ( s h o w ) { s t y l e s . f o r E a c h ( s t y l e = > s t y l e . o n F o c u s ( ) ) ; s t y l e s . f o r E a c h ( s t y l e = > s t y l e . u p d a t e U I ( ) ) ; } e l s e { s t y l e s . f o r E a c h ( s t y l e = > s t y l e . o n B l u r ( ) ) ; } } ) ; } , t o g g l e T a r g e t V i s i b i l i t y : a s y n c   f u n c t i o n ( s h o w ) { s h o w = t h i s . _ t o g g l e V i s i b i l i t y S t a t u s ( s h o w ) ; v a r   s t y l e s = _ . v a l u e s ( t h i s . s t y l e s ) ; c o n s t   p r o m s = _ . s o r t B y ( s t y l e s , ' _ _ o r d e r ' ) . m a p ( s t y l e = > { r e t u r n   s h o w ? s t y l e . o n T a r g e t S h o w ( ) : s t y l e . o n T a r g e t H i d e ( ) ; } ) ; a w a i t   P r o m i s e . a l l ( p r o m s ) ; r e t u r n   s h o w ; } , t o g g l e O v e r l a y V i s i b i l i t y : f u n c t i o n ( s h o w ) { i f ( t h i s . $ e l & & ! t h i s . s c r o l l i n g T i m e o u t ) { t h i s . $ e l . t o g g l e C l a s s ( ' o _ o v e r l a y _ h i d d e n ' , ! s h o w & & t h i s . i s S h o w n ( ) ) ; } } , c l o n e : a s y n c   f u n c t i o n ( r e c o r d U n d o ) { t h i s . t r i g g e r _ u p ( ' s n i p p e t _ w i l l _ b e _ c l o n e d ' , { $ t a r g e t : t h i s . $ t a r g e t } ) ; v a r   $ c l o n e = t h i s . $ t a r g e t . c l o n e ( f a l s e ) ; i f ( r e c o r d U n d o ) { t h i s . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : t h i s . $ t a r g e t } ) ; } 
 t h i s . $ t a r g e t . a f t e r ( $ c l o n e ) ; a w a i t   n e w   P r o m i s e ( r e s o l v e = > { t h i s . t r i g g e r _ u p ( ' c a l l _ f o r _ e a c h _ c h i l d _ s n i p p e t ' , { $ s n i p p e t : $ c l o n e , c a l l b a c k : f u n c t i o n ( e d i t o r , $ s n i p p e t ) { f o r ( v a r   i   i n   e d i t o r . s t y l e s ) { e d i t o r . s t y l e s [ i ] . o n C l o n e ( { i s C u r r e n t : ( $ s n i p p e t . i s ( $ c l o n e ) ) , } ) ; } 
 r e s o l v e ( ) ; } , } ) ; } ) ; t h i s . t r i g g e r _ u p ( ' s n i p p e t _ c l o n e d ' , { $ t a r g e t : $ c l o n e , $ o r i g i n : t h i s . $ t a r g e t } ) ; $ c l o n e . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } , _ i n i t i a l i z e O p t i o n s : f u n c t i o n ( ) { t h i s . _ c u s t o m i z e $ E l e m e n t s = [ ] ; t h i s . s t y l e s = { } ; t h i s . s e l e c t o r S i b l i n g s = [ ] ; t h i s . s e l e c t o r C h i l d r e n = [ ] ; v a r   $ e l e m e n t = t h i s . $ t a r g e t . p a r e n t ( ) ; w h i l e ( $ e l e m e n t . l e n g t h ) { v a r   p a r e n t E d i t o r = $ e l e m e n t . d a t a ( ' s n i p p e t - e d i t o r ' ) ; i f ( p a r e n t E d i t o r ) { t h i s . _ c u s t o m i z e $ E l e m e n t s = t h i s . _ c u s t o m i z e $ E l e m e n t s . c o n c a t ( p a r e n t E d i t o r . _ c u s t o m i z e $ E l e m e n t s ) ; b r e a k ; } 
 $ e l e m e n t = $ e l e m e n t . p a r e n t ( ) ; } 
 v a r   $ o p t i o n s S e c t i o n = $ ( c o r e . q w e b . r e n d e r ( ' w e b _ e d i t o r . c u s t o m i z e _ b l o c k _ o p t i o n s _ s e c t i o n ' , { n a m e : t h i s . g e t N a m e ( ) , } ) ) . d a t a ( ' e d i t o r ' , t h i s ) ; c o n s t   $ o p t i o n s S e c t i o n B t n G r o u p = $ o p t i o n s S e c t i o n . f i n d ( ' w e - t o p - b u t t o n - g r o u p ' ) ; $ o p t i o n s S e c t i o n B t n G r o u p . c o n t e n t s ( ) . e a c h ( ( i , n o d e ) = > { i f ( n o d e . n o d e T y p e = = = N o d e . T E X T _ N O D E ) { n o d e . p a r e n t N o d e . r e m o v e C h i l d ( n o d e ) ; } } ) ; $ o p t i o n s S e c t i o n . o n ( ' m o u s e e n t e r ' , t h i s . _ o n O p t i o n s S e c t i o n M o u s e E n t e r . b i n d ( t h i s ) ) ; $ o p t i o n s S e c t i o n . o n ( ' m o u s e l e a v e ' , t h i s . _ o n O p t i o n s S e c t i o n M o u s e L e a v e . b i n d ( t h i s ) ) ; $ o p t i o n s S e c t i o n . o n ( ' c l i c k ' , ' w e - t i t l e   >   s p a n ' , t h i s . _ o n O p t i o n s S e c t i o n C l i c k . b i n d ( t h i s ) ) ; $ o p t i o n s S e c t i o n . o n ( ' c l i c k ' , ' . o e _ s n i p p e t _ c l o n e ' , t h i s . _ o n C l o n e C l i c k . b i n d ( t h i s ) ) ; $ o p t i o n s S e c t i o n . o n ( ' c l i c k ' , ' . o e _ s n i p p e t _ r e m o v e ' , t h i s . _ o n R e m o v e C l i c k . b i n d ( t h i s ) ) ; t h i s . _ c u s t o m i z e $ E l e m e n t s . p u s h ( $ o p t i o n s S e c t i o n ) ; t h i s . $ e l . d a t a ( ' $ o p t i o n s S e c t i o n ' , $ o p t i o n s S e c t i o n ) ; v a r   i = 0 ; v a r   d e f s = _ . m a p ( t h i s . t e m p l a t e O p t i o n s , v a l = > { i f ( ! v a l . s e l e c t o r . i s ( t h i s . $ t a r g e t ) ) { r e t u r n ; } 
 i f ( v a l [ ' d r o p - n e a r ' ] ) { t h i s . s e l e c t o r S i b l i n g s . p u s h ( v a l [ ' d r o p - n e a r ' ] ) ; } 
 i f ( v a l [ ' d r o p - i n ' ] ) { t h i s . s e l e c t o r C h i l d r e n . p u s h ( v a l [ ' d r o p - i n ' ] ) ; } 
 v a r   o p t i o n N a m e = v a l . o p t i o n ; v a r   o p t i o n = n e w ( o p t i o n s . r e g i s t r y [ o p t i o n N a m e ] | | o p t i o n s . C l a s s ) ( t h i s , v a l . $ e l . c h i l d r e n ( ) , v a l . b a s e _ t a r g e t ? t h i s . $ t a r g e t . f i n d ( v a l . b a s e _ t a r g e t ) . e q ( 0 ) : t h i s . $ t a r g e t , t h i s . $ e l , _ . e x t e n d ( { o p t i o n N a m e : o p t i o n N a m e , s n i p p e t N a m e : t h i s . g e t N a m e ( ) , } , v a l . d a t a ) , t h i s . o p t i o n s ) ; v a r   k e y = o p t i o n N a m e | | _ . u n i q u e I d ( ' o p t i o n ' ) ; i f ( t h i s . s t y l e s [ k e y ] ) { k e y = _ . u n i q u e I d ( k e y ) ; } 
 t h i s . s t y l e s [ k e y ] = o p t i o n ; o p t i o n . _ _ o r d e r = i + + ; i f ( o p t i o n . f o r c e N o D e l e t e B u t t o n ) { t h i s . $ e l . a d d ( $ o p t i o n s S e c t i o n ) . f i n d ( ' . o e _ s n i p p e t _ r e m o v e ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } 
 r e t u r n   o p t i o n . a p p e n d T o ( d o c u m e n t . c r e a t e D o c u m e n t F r a g m e n t ( ) ) ; } ) ; t h i s . i s T a r g e t M o v a b l e = ( t h i s . s e l e c t o r S i b l i n g s . l e n g t h > 0 | | t h i s . s e l e c t o r C h i l d r e n . l e n g t h > 0 ) ; t h i s . $ e l . f i n d ( ' [ d a t a - t o g g l e = " d r o p d o w n " ] ' ) . d r o p d o w n ( ) ; r e t u r n   P r o m i s e . a l l ( d e f s ) . t h e n ( ( ) = > { c o n s t   o p t i o n s = _ . s o r t B y ( t h i s . s t y l e s , ' _ _ o r d e r ' ) ; o p t i o n s . f o r E a c h ( o p t i o n = > { i f ( o p t i o n . i s T o p O p t i o n ) { $ o p t i o n s S e c t i o n B t n G r o u p . p r e p e n d ( o p t i o n . $ e l ) ; } e l s e { $ o p t i o n s S e c t i o n . a p p e n d ( o p t i o n . $ e l ) ; } } ) ; $ o p t i o n s S e c t i o n . t o g g l e C l a s s ( ' d - n o n e ' , o p t i o n s . l e n g t h = = = 0 ) ; } ) ; } , _ t o g g l e V i s i b i l i t y S t a t u s : f u n c t i o n ( s h o w ) { i f ( s h o w = = = u n d e f i n e d ) { s h o w = ! t h i s . i s T a r g e t V i s i b l e ( ) ; } 
 i f ( s h o w ) { d e l e t e   t h i s . $ t a r g e t [ 0 ] . d a t a s e t . i n v i s i b l e ; } e l s e { t h i s . $ t a r g e t [ 0 ] . d a t a s e t . i n v i s i b l e = ' 1 ' ; } 
 r e t u r n   s h o w ; } , _ o n C l o n e C l i c k : f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; t h i s . c l o n e ( t r u e ) ; } , _ o n D r a g A n d D r o p S t a r t : f u n c t i o n ( ) { v a r   s e l f = t h i s ; t h i s . d r o p p e d = f a l s e ; s e l f . s i z e = { w i d t h : s e l f . $ t a r g e t . w i d t h ( ) , h e i g h t : s e l f . $ t a r g e t . h e i g h t ( ) } ; s e l f . $ t a r g e t . a f t e r ( ' < d i v   c l a s s = " o e _ d r o p _ c l o n e "   s t y l e = " d i s p l a y :   n o n e ; " / > ' ) ; s e l f . $ t a r g e t . d e t a c h ( ) ; s e l f . $ e l . a d d C l a s s ( ' d - n o n e ' ) ; v a r   $ s e l e c t o r S i b l i n g s ; f o r ( v a r   i = 0 ; i < s e l f . s e l e c t o r S i b l i n g s . l e n g t h ; i + + ) { i f ( ! $ s e l e c t o r S i b l i n g s ) { $ s e l e c t o r S i b l i n g s = s e l f . s e l e c t o r S i b l i n g s [ i ] . a l l ( ) ; } e l s e { $ s e l e c t o r S i b l i n g s = $ s e l e c t o r S i b l i n g s . a d d ( s e l f . s e l e c t o r S i b l i n g s [ i ] . a l l ( ) ) ; } } 
 v a r   $ s e l e c t o r C h i l d r e n ; f o r ( i = 0 ; i < s e l f . s e l e c t o r C h i l d r e n . l e n g t h ; i + + ) { i f ( ! $ s e l e c t o r C h i l d r e n ) { $ s e l e c t o r C h i l d r e n = s e l f . s e l e c t o r C h i l d r e n [ i ] . a l l ( ) ; } e l s e { $ s e l e c t o r C h i l d r e n = $ s e l e c t o r C h i l d r e n . a d d ( s e l f . s e l e c t o r C h i l d r e n [ i ] . a l l ( ) ) ; } } 
 t h i s . t r i g g e r _ u p ( ' g o _ t o _ p a r e n t ' , { $ s n i p p e t : t h i s . $ t a r g e t } ) ; t h i s . t r i g g e r _ u p ( ' a c t i v a t e _ i n s e r t i o n _ z o n e s ' , { $ s e l e c t o r S i b l i n g s : $ s e l e c t o r S i b l i n g s , $ s e l e c t o r C h i l d r e n : $ s e l e c t o r C h i l d r e n , } ) ; t h i s . $ b o d y . a d d C l a s s ( ' m o v e - i m p o r t a n t ' ) ; t h i s . $ e d i t a b l e . f i n d ( ' . o e _ d r o p _ z o n e ' ) . d r o p p a b l e ( { o v e r : f u n c t i o n ( ) { s e l f . $ e d i t a b l e . f i n d ( ' . o e _ d r o p _ z o n e . h i d e ' ) . r e m o v e C l a s s ( ' h i d e ' ) ; $ ( t h i s ) . a d d C l a s s ( ' h i d e ' ) . f i r s t ( ) . a f t e r ( s e l f . $ t a r g e t ) ; s e l f . d r o p p e d = t r u e ; } , o u t : f u n c t i o n ( ) { $ ( t h i s ) . r e m o v e C l a s s ( ' h i d e ' ) ; s e l f . $ t a r g e t . d e t a c h ( ) ; s e l f . d r o p p e d = f a l s e ; } , } ) ; } , _ o n D r a g A n d D r o p S t o p : f u n c t i o n ( e v , u i ) { i f ( ! t h i s . d r o p p e d ) { v a r   $ e l = $ . n e a r e s t ( { x : u i . p o s i t i o n . l e f t , y : u i . p o s i t i o n . t o p } , ' . o e _ d r o p _ z o n e ' , { c o n t a i n e r : d o c u m e n t . b o d y } ) . f i r s t ( ) ; i f ( $ e l . l e n g t h ) { $ e l . a f t e r ( t h i s . $ t a r g e t ) ; t h i s . d r o p p e d = t r u e ; } } 
 t h i s . $ e d i t a b l e . f i n d ( ' . o e _ d r o p _ z o n e ' ) . d r o p p a b l e ( ' d e s t r o y ' ) . r e m o v e ( ) ; v a r   p r e v = t h i s . $ t a r g e t . f i r s t ( ) [ 0 ] . p r e v i o u s S i b l i n g ; v a r   n e x t = t h i s . $ t a r g e t . l a s t ( ) [ 0 ] . n e x t S i b l i n g ; v a r   $ p a r e n t = t h i s . $ t a r g e t . p a r e n t ( ) ; v a r   $ c l o n e = t h i s . $ e d i t a b l e . f i n d ( ' . o e _ d r o p _ c l o n e ' ) ; i f ( p r e v = = = $ c l o n e [ 0 ] ) { p r e v = $ c l o n e [ 0 ] . p r e v i o u s S i b l i n g ; } e l s e   i f ( n e x t = = = $ c l o n e [ 0 ] ) { n e x t = $ c l o n e [ 0 ] . n e x t S i b l i n g ; } 
 $ c l o n e . a f t e r ( t h i s . $ t a r g e t ) ; v a r   $ f r o m = $ c l o n e . p a r e n t ( ) ; t h i s . $ e l . r e m o v e C l a s s ( ' d - n o n e ' ) ; t h i s . $ b o d y . r e m o v e C l a s s ( ' m o v e - i m p o r t a n t ' ) ; $ c l o n e . r e m o v e ( ) ; i f ( t h i s . d r o p p e d ) { t h i s . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : t h i s . $ t a r g e t } ) ; i f ( p r e v ) { t h i s . $ t a r g e t . i n s e r t A f t e r ( p r e v ) ; } e l s e   i f ( n e x t ) { t h i s . $ t a r g e t . i n s e r t B e f o r e ( n e x t ) ; } e l s e { $ p a r e n t . p r e p e n d ( t h i s . $ t a r g e t ) ; } 
 f o r ( v a r   i   i n   t h i s . s t y l e s ) { t h i s . s t y l e s [ i ] . o n M o v e ( ) ; } 
 t h i s . $ t a r g e t . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; $ f r o m . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } 
 t h i s . t r i g g e r _ u p ( ' d r a g _ a n d _ d r o p _ s t o p ' , { $ s n i p p e t : t h i s . $ t a r g e t , } ) ; } , _ o n O p t i o n s S e c t i o n M o u s e E n t e r : f u n c t i o n ( e v ) { i f ( ! t h i s . $ t a r g e t . i s ( ' : v i s i b l e ' ) ) { r e t u r n ; } 
 t h i s . t r i g g e r _ u p ( ' a c t i v a t e _ s n i p p e t ' , { $ s n i p p e t : t h i s . $ t a r g e t , p r e v i e w M o d e : t r u e , } ) ; } , _ o n O p t i o n s S e c t i o n M o u s e L e a v e : f u n c t i o n ( e v ) { t h i s . t r i g g e r _ u p ( ' a c t i v a t e _ s n i p p e t ' , { $ s n i p p e t : f a l s e , p r e v i e w M o d e : t r u e , } ) ; } , _ o n O p t i o n s S e c t i o n C l i c k : f u n c t i o n ( e v ) { t h i s . t r i g g e r _ u p ( ' a c t i v a t e _ s n i p p e t ' , { $ s n i p p e t : t h i s . $ t a r g e t , p r e v i e w M o d e : f a l s e , } ) ; } , _ o n O p t i o n U p d a t e : f u n c t i o n ( e v ) { v a r   s e l f = t h i s ; i f ( e v . d a t a . o p t i o n N a m e s ) { e v . s t o p P r o p a g a t i o n ( ) ; _ . e a c h ( e v . d a t a . o p t i o n N a m e s , f u n c t i o n ( n a m e ) { n o t i f y F o r E a c h M a t c h e d O p t i o n ( n a m e ) ; } ) ; } 
 i f ( e v . d a t a . o p t i o n N a m e ) { i f ( n o t i f y F o r E a c h M a t c h e d O p t i o n ( e v . d a t a . o p t i o n N a m e ) ) { e v . s t o p P r o p a g a t i o n ( ) ; } } 
 f u n c t i o n   n o t i f y F o r E a c h M a t c h e d O p t i o n ( n a m e ) { v a r   r e g e x = n e w   R e g E x p ( ' ^ ' + n a m e + ' \ \ d + $ ' ) ; v a r   h a s O p t i o n = f a l s e ; f o r ( v a r   k e y   i n   s e l f . s t y l e s ) { i f ( k e y = = = n a m e | | r e g e x . t e s t ( k e y ) ) { s e l f . s t y l e s [ k e y ] . n o t i f y ( e v . d a t a . n a m e , e v . d a t a . d a t a ) ; h a s O p t i o n = t r u e ; } } 
 r e t u r n   h a s O p t i o n ; } } , _ o n R e m o v e C l i c k : f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; e v . s t o p P r o p a g a t i o n ( ) ; t h i s . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : t h i s . $ t a r g e t } ) ; t h i s . r e m o v e S n i p p e t ( ) ; } , _ o n S n i p p e t O p t i o n U p d a t e : a s y n c   f u n c t i o n ( e v ) { c o n s t   p r o m s 1 = O b j e c t . k e y s ( t h i s . s t y l e s ) . m a p ( k e y = > { r e t u r n   t h i s . s t y l e s [ k e y ] . u p d a t e U I ( { n o V i s i b i l i t y : t r u e , } ) ; } ) ; a w a i t   P r o m i s e . a l l ( p r o m s 1 ) ; c o n s t   p r o m s 2 = O b j e c t . k e y s ( t h i s . s t y l e s ) . m a p ( k e y = > { r e t u r n   t h i s . s t y l e s [ k e y ] . u p d a t e U I V i s i b i l i t y ( ) ; } ) ; a w a i t   P r o m i s e . a l l ( p r o m s 2 ) ; e v . d a t a . o n S u c c e s s ( ) ; } , _ o n S n i p p e t O p t i o n V i s i b i l i t y U p d a t e : f u n c t i o n ( e v ) { e v . d a t a . s h o w = t h i s . _ t o g g l e V i s i b i l i t y S t a t u s ( e v . d a t a . s h o w ) ; } , _ o n U s e r V a l u e W i d g e t R e q u e s t : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; f o r ( c o n s t   k e y   o f   O b j e c t . k e y s ( t h i s . s t y l e s ) ) { c o n s t   w i d g e t = t h i s . s t y l e s [ k e y ] . f i n d W i d g e t ( e v . d a t a . n a m e ) ; i f ( w i d g e t ) { e v . d a t a . o n S u c c e s s ( w i d g e t ) ; r e t u r n ; } } } , _ o n M o u s e W h e e l : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; t h i s . $ e l . c s s ( ' p o i n t e r - e v e n t s ' , ' n o n e ' ) ; c l e a r T i m e o u t ( t h i s . w h e e l T i m e o u t ) ; t h i s . w h e e l T i m e o u t = s e t T i m e o u t ( ( ) = > { t h i s . $ e l . c s s ( ' p o i n t e r - e v e n t s ' , ' ' ) ; } , 2 5 0 ) ; } , } ) ; v a r   S n i p p e t s M e n u = W i d g e t . e x t e n d ( { i d : ' o e _ s n i p p e t s ' , c a c h e S n i p p e t T e m p l a t e : { } , e v e n t s : { ' c l i c k   . o _ i n s t a l l _ b t n ' : ' _ o n I n s t a l l B t n C l i c k ' , ' c l i c k   . o _ w e _ a d d _ s n i p p e t _ b t n ' : ' _ o n B l o c k s T a b C l i c k ' , ' c l i c k   . o _ w e _ i n v i s i b l e _ e n t r y ' : ' _ o n I n v i s i b l e E n t r y C l i c k ' , ' c l i c k   # s n i p p e t _ c u s t o m   . o _ d e l e t e _ b t n ' : ' _ o n D e l e t e B t n C l i c k ' , ' m o u s e d o w n ' : ' _ o n M o u s e D o w n ' , ' i n p u t   . o _ s n i p p e t _ s e a r c h _ f i l t e r _ i n p u t ' : ' _ o n S n i p p e t S e a r c h I n p u t ' , ' c l i c k   . o _ s n i p p e t _ s e a r c h _ f i l t e r _ r e s e t ' : ' _ o n S n i p p e t S e a r c h R e s e t C l i c k ' , ' s u m m e r n o t e _ p o p o v e r _ u p d a t e _ c a l l   . o _ w e _ s n i p p e t _ t e x t _ t o o l s ' : ' _ o n S u m m e r n o t e T o o l s U p d a t e ' , } , c u s t o m _ e v e n t s : { ' a c t i v a t e _ i n s e r t i o n _ z o n e s ' : ' _ o n A c t i v a t e I n s e r t i o n Z o n e s ' , ' a c t i v a t e _ s n i p p e t ' : ' _ o n A c t i v a t e S n i p p e t ' , ' c a l l _ f o r _ e a c h _ c h i l d _ s n i p p e t ' : ' _ o n C a l l F o r E a c h C h i l d S n i p p e t ' , ' c l o n e _ s n i p p e t ' : ' _ o n C l o n e S n i p p e t ' , ' c o v e r _ u p d a t e ' : ' _ o n O v e r l a y s C o v e r U p d a t e ' , ' d e a c t i v a t e _ s n i p p e t ' : ' _ o n D e a c t i v a t e S n i p p e t ' , ' d r a g _ a n d _ d r o p _ s t o p ' : ' _ o n D r a g A n d D r o p S t o p ' , ' g e t _ s n i p p e t _ v e r s i o n s ' : ' _ o n G e t S n i p p e t V e r s i o n s ' , ' g o _ t o _ p a r e n t ' : ' _ o n G o T o P a r e n t ' , ' r e m o v e _ s n i p p e t ' : ' _ o n R e m o v e S n i p p e t ' , ' s n i p p e t _ e d i t i o n _ r e q u e s t ' : ' _ o n S n i p p e t E d i t i o n R e q u e s t ' , ' s n i p p e t _ e d i t o r _ d e s t r o y e d ' : ' _ o n S n i p p e t E d i t o r D e s t r o y e d ' , ' s n i p p e t _ r e m o v e d ' : ' _ o n S n i p p e t R e m o v e d ' , ' s n i p p e t _ c l o n e d ' : ' _ o n S n i p p e t C l o n e d ' , ' s n i p p e t _ o p t i o n _ v i s i b i l i t y _ u p d a t e ' : ' _ o n S n i p p e t O p t i o n V i s i b i l i t y U p d a t e ' , ' s n i p p e t _ t h u m b n a i l _ u r l _ r e q u e s t ' : ' _ o n S n i p p e t T h u m b n a i l U R L R e q u e s t ' , ' r e l o a d _ s n i p p e t _ d r o p z o n e s ' : ' _ d i s a b l e U n d r o p p a b l e S n i p p e t s ' , ' r e q u e s t _ s a v e ' : ' _ o n S a v e R e q u e s t ' , ' u p d a t e _ c u s t o m i z e _ e l e m e n t s ' : ' _ o n U p d a t e C u s t o m i z e E l e m e n t s ' , ' h i d e _ o v e r l a y ' : ' _ o n H i d e O v e r l a y ' , ' b l o c k _ p r e v i e w _ o v e r l a y s ' : ' _ o n B l o c k P r e v i e w O v e r l a y s ' , ' u n b l o c k _ p r e v i e w _ o v e r l a y s ' : ' _ o n U n b l o c k P r e v i e w O v e r l a y s ' , ' u s e r _ v a l u e _ w i d g e t _ o p e n i n g ' : ' _ o n U s e r V a l u e W i d g e t O p e n i n g ' , ' u s e r _ v a l u e _ w i d g e t _ c l o s i n g ' : ' _ o n U s e r V a l u e W i d g e t C l o s i n g ' , ' r e l o a d _ s n i p p e t _ t e m p l a t e ' : ' _ o n R e l o a d S n i p p e t T e m p l a t e ' , } , t a b s : { B L O C K S : ' b l o c k s ' , O P T I O N S : ' o p t i o n s ' , } , i n i t : f u n c t i o n ( p a r e n t , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; o p t i o n s = o p t i o n s | | { } ; t h i s . t r i g g e r _ u p ( ' g e t R e c o r d I n f o ' , { r e c o r d I n f o : o p t i o n s , c a l l b a c k : f u n c t i o n ( r e c o r d I n f o ) { _ . d e f a u l t s ( o p t i o n s , r e c o r d I n f o ) ; } , } ) ; t h i s . o p t i o n s = o p t i o n s ; i f ( ! t h i s . o p t i o n s . s n i p p e t s ) { t h i s . o p t i o n s . s n i p p e t s = ' w e b _ e d i t o r . s n i p p e t s ' ; } 
 t h i s . s n i p p e t E d i t o r s = [ ] ; t h i s . _ e n a b l e d E d i t o r H i e r a r c h y = [ ] ; t h i s . _ m u t e x = n e w   c o n c u r r e n c y . M u t e x ( ) ; t h i s . s e t S e l e c t o r E d i t a b l e A r e a ( o p t i o n s . $ e l , o p t i o n s . s e l e c t o r E d i t a b l e A r e a ) ; t h i s . _ n o t A c t i v a b l e E l e m e n t s S e l e c t o r = [ ' # w e b _ e d i t o r - t o p - e d i t ' , ' . o _ w e _ w e b s i t e _ t o p _ a c t i o n s ' , ' # o e _ s n i p p e t s ' , ' # o e _ m a n i p u l a t o r s ' , ' . o _ t e c h n i c a l _ m o d a l ' , ' . o e _ d r o p _ z o n e ' , ' . o _ n o t i f i c a t i o n _ m a n a g e r ' , ' . o _ w e _ n o _ o v e r l a y ' , ' . u i - a u t o c o m p l e t e ' , ' . m o d a l   . c l o s e ' , ' . o _ w e _ c r o p _ w i d g e t ' , ] . j o i n ( ' ,   ' ) ; t h i s . l o a d i n g T i m e r s = { } ; t h i s . l o a d i n g E l e m e n t s = { } ; } , w i l l S t a r t : f u n c t i o n ( ) { C o l o r P a l e t t e W i d g e t . l o a d D e p e n d e n c i e s ( t h i s ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , a s y n c   s t a r t ( ) { v a r   d e f s = [ t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ] ; t h i s . o w n e r D o c u m e n t = t h i s . $ e l [ 0 ] . o w n e r D o c u m e n t ; t h i s . $ d o c u m e n t = $ ( t h i s . o w n e r D o c u m e n t ) ; t h i s . w i n d o w = t h i s . o w n e r D o c u m e n t . d e f a u l t V i e w ; t h i s . $ w i n d o w = $ ( t h i s . w i n d o w ) ; t h i s . c u s t o m i z e P a n e l = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; t h i s . c u s t o m i z e P a n e l . c l a s s L i s t . a d d ( ' o _ w e _ c u s t o m i z e _ p a n e l ' , ' d - n o n e ' ) ; t h i s . t e x t E d i t o r P a n e l E l = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; t h i s . t e x t E d i t o r P a n e l E l . c l a s s L i s t . a d d ( ' o _ w e _ s n i p p e t _ t e x t _ t o o l s ' , ' d - n o n e ' ) ; t h i s . i n v i s i b l e D O M P a n e l E l = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; t h i s . i n v i s i b l e D O M P a n e l E l . c l a s s L i s t . a d d ( ' o _ w e _ i n v i s i b l e _ e l _ p a n e l ' ) ; t h i s . i n v i s i b l e D O M P a n e l E l . a p p e n d C h i l d ( $ ( ' < d i v / > ' , { t e x t : _ t ( ' I n v i s i b l e   E l e m e n t s ' ) , c l a s s : ' o _ p a n e l _ h e a d e r ' , } ) [ 0 ] ) ; t h i s . o p t i o n s . g e t S c r o l l O p t i o n s = t h i s . _ g e t S c r o l l O p t i o n s . b i n d ( t h i s ) ; d e f s . p u s h ( ( a s y n c ( ) = > { a w a i t   t h i s . _ l o a d S n i p p e t s T e m p l a t e s ( ) ; a w a i t   t h i s . _ u p d a t e I n v i s i b l e D O M ( ) ; } ) ( ) ) ; t h i s . $ s n i p p e t E d i t o r A r e a = $ ( ' < d i v / > ' , { i d : ' o e _ m a n i p u l a t o r s ' , } ) . i n s e r t A f t e r ( t h i s . $ e l ) ; v a r   l a s t E l e m e n t ; t h i s . $ d o c u m e n t . o n ( ' c l i c k . s n i p p e t s _ m e n u ' , ' * ' , e v = > { v a r   s r c E l e m e n t = e v . t a r g e t | | ( e v . o r i g i n a l E v e n t & & ( e v . o r i g i n a l E v e n t . t a r g e t | | e v . o r i g i n a l E v e n t . o r i g i n a l T a r g e t ) ) | | e v . s r c E l e m e n t ; i f ( ! s r c E l e m e n t | | l a s t E l e m e n t = = = s r c E l e m e n t ) { r e t u r n ; } 
 l a s t E l e m e n t = s r c E l e m e n t ; _ . d e f e r ( f u n c t i o n ( ) { l a s t E l e m e n t = f a l s e ; } ) ; v a r   $ t a r g e t = $ ( s r c E l e m e n t ) ; i f ( ! $ t a r g e t . c l o s e s t ( ' w e - b u t t o n ,   w e - t o g g l e r ,   . o _ w e _ c o l o r _ p r e v i e w ' ) . l e n g t h ) { t h i s . _ c l o s e W i d g e t s ( ) ; } 
 i f ( ! $ t a r g e t . c l o s e s t ( ' b o d y   >   * ' ) . l e n g t h ) { r e t u r n ; } 
 i f ( $ t a r g e t . c l o s e s t ( t h i s . _ n o t A c t i v a b l e E l e m e n t s S e l e c t o r ) . l e n g t h ) { r e t u r n ; } 
 t h i s . _ a c t i v a t e S n i p p e t ( $ t a r g e t ) ; } ) ; c o r e . b u s . o n ( ' d e a c t i v a t e _ s n i p p e t ' , t h i s , t h i s . _ o n D e a c t i v a t e S n i p p e t ) ; v a r   d e b o u n c e d C o v e r U p d a t e = _ . t h r o t t l e ( ( ) = > { t h i s . u p d a t e C u r r e n t S n i p p e t E d i t o r O v e r l a y ( ) ; } , 5 0 ) ; t h i s . $ w i n d o w . o n ( ' r e s i z e . s n i p p e t s _ m e n u ' , d e b o u n c e d C o v e r U p d a t e ) ; t h i s . $ w i n d o w . o n ( ' c o n t e n t _ c h a n g e d . s n i p p e t s _ m e n u ' , d e b o u n c e d C o v e r U p d a t e ) ; t h i s . $ d o c u m e n t . o n ( ' k e y d o w n . s n i p p e t s _ m e n u ' , ( ) = > { t h i s . _ _ o v e r l a y K e y W a s D o w n = t r u e ; t h i s . s n i p p e t E d i t o r s . f o r E a c h ( e d i t o r = > { e d i t o r . t o g g l e O v e r l a y V i s i b i l i t y ( f a l s e ) ; } ) ; } ) ; t h i s . $ d o c u m e n t . o n ( ' m o u s e m o v e . s n i p p e t s _ m e n u ,   m o u s e d o w n . s n i p p e t s _ m e n u ' , _ . t h r o t t l e ( ( ) = > { i f ( ! t h i s . _ _ o v e r l a y K e y W a s D o w n ) { r e t u r n ; } 
 t h i s . _ _ o v e r l a y K e y W a s D o w n = f a l s e ; t h i s . s n i p p e t E d i t o r s . f o r E a c h ( e d i t o r = > { e d i t o r . t o g g l e O v e r l a y V i s i b i l i t y ( t r u e ) ; e d i t o r . c o v e r ( ) ; } ) ; } , 2 5 0 ) ) ; t h i s . $ s c r o l l i n g E l e m e n t = $ ( ) . g e t S c r o l l i n g E l e m e n t ( ) ; t h i s . $ s c r o l l i n g E l e m e n t . o n ( ' s c r o l l . s n i p p e t s _ m e n u ' , _ . t h r o t t l e ( ( ) = > { f o r ( c o n s t   e d i t o r   o f   t h i s . s n i p p e t E d i t o r s ) { e d i t o r . t o g g l e O v e r l a y V i s i b i l i t y ( f a l s e ) ; } 
 c l e a r T i m e o u t ( t h i s . s c r o l l i n g T i m e o u t ) ; t h i s . s c r o l l i n g T i m e o u t = s e t T i m e o u t ( ( ) = > { t h i s . _ s c r o l l i n g T i m e o u t = n u l l ; f o r ( c o n s t   e d i t o r   o f   t h i s . s n i p p e t E d i t o r s ) { e d i t o r . t o g g l e O v e r l a y V i s i b i l i t y ( t r u e ) ; e d i t o r . c o v e r ( ) ; } } , 2 5 0 ) ; } , 5 0 ) ) ; t h i s . $ d o c u m e n t . o n ( ' c l i c k . s n i p p e t s _ m e n u ' , ' . o _ d e f a u l t _ s n i p p e t _ t e x t ' , f u n c t i o n ( e v ) { $ ( e v . t a r g e t ) . c l o s e s t ( ' . o _ d e f a u l t _ s n i p p e t _ t e x t ' ) . r e m o v e C l a s s ( ' o _ d e f a u l t _ s n i p p e t _ t e x t ' ) ; $ ( e v . t a r g e t ) . s e l e c t C o n t e n t ( ) ; $ ( e v . t a r g e t ) . r e m o v e C l a s s ( ' o _ d e f a u l t _ s n i p p e t _ t e x t ' ) ; } ) ; t h i s . $ d o c u m e n t . o n ( ' k e y u p . s n i p p e t s _ m e n u ' , f u n c t i o n ( ) { v a r   r a n g e = W y s i w y g . g e t R a n g e ( t h i s ) ; $ ( r a n g e & & r a n g e . s c ) . c l o s e s t ( ' . o _ d e f a u l t _ s n i p p e t _ t e x t ' ) . r e m o v e C l a s s ( ' o _ d e f a u l t _ s n i p p e t _ t e x t ' ) ; } ) ; c o n s t   $ a u t o F o c u s E l s = $ ( ' . o _ w e _ s n i p p e t _ a u t o f o c u s ' ) ; t h i s . _ a c t i v a t e S n i p p e t ( $ a u t o F o c u s E l s . l e n g t h ? $ a u t o F o c u s E l s . f i r s t ( ) : f a l s e ) ; t h i s . $ e l . t o o l t i p ( { s e l e c t o r : ' w e - t i t l e ' , p l a c e m e n t : ' b o t t o m ' , d e l a y : 1 0 0 , t i t l e : f u n c t i o n ( ) { c o n s t   e l = t h i s ; e l . s t y l e . s e t P r o p e r t y ( ' o v e r f l o w ' , ' s c r o l l ' , ' i m p o r t a n t ' ) ; c o n s t   t i p C o n t e n t = e l . s c r o l l W i d t h > e l . c l i e n t W i d t h ? e l . i n n e r H T M L : ' ' ; e l . s t y l e . r e m o v e P r o p e r t y ( ' o v e r f l o w ' ) ; r e t u r n   t i p C o n t e n t ; } , } ) ; r e t u r n   P r o m i s e . a l l ( d e f s ) . t h e n ( ( ) = > { t h i s . $ ( ' [ d a t a - t i t l e ] ' ) . t o o l t i p ( { d e l a y : 1 0 0 , t i t l e : f u n c t i o n ( ) { r e t u r n   t h i s . c l a s s L i s t . c o n t a i n s ( ' a c t i v e ' ) ? f a l s e : t h i s . d a t a s e t . t i t l e ; } , } ) ; s e t T i m e o u t ( ( ) = > { t h i s . $ w i n d o w . t r i g g e r ( ' r e s i z e ' ) ; t h i s . _ m u t e x . e x e c ( ( ) = > t h i s . _ t e x t T o o l s S w i t c h i n g E n a b l e d = t r u e ) ; } , 1 0 0 0 ) ; } ) ; } , d e s t r o y : f u n c t i o n ( ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; i f ( t h i s . $ w i n d o w ) { t h i s . $ s n i p p e t E d i t o r A r e a . r e m o v e ( ) ; t h i s . $ w i n d o w . o f f ( ' . s n i p p e t s _ m e n u ' ) ; t h i s . $ d o c u m e n t . o f f ( ' . s n i p p e t s _ m e n u ' ) ; t h i s . $ s c r o l l i n g E l e m e n t . o f f ( ' . s n i p p e t s _ m e n u ' ) ; } 
 c o r e . b u s . o f f ( ' d e a c t i v a t e _ s n i p p e t ' , t h i s , t h i s . _ o n D e a c t i v a t e S n i p p e t ) ; d e l e t e   t h i s . c a c h e S n i p p e t T e m p l a t e [ t h i s . o p t i o n s . s n i p p e t s ] ; } , c l e a n F o r S a v e : a s y n c   f u n c t i o n ( ) { a w a i t   t h i s . _ a c t i v a t e S n i p p e t ( f a l s e ) ; t h i s . t r i g g e r _ u p ( ' r e a d y _ t o _ c l e a n _ f o r _ s a v e ' ) ; a w a i t   t h i s . _ d e s t r o y E d i t o r s ( ) ; t h i s . g e t E d i t a b l e A r e a ( ) . f i n d ( ' [ c o n t e n t E d i t a b l e ] ' ) . r e m o v e A t t r ( ' c o n t e n t E d i t a b l e ' ) . r e m o v e P r o p ( ' c o n t e n t E d i t a b l e ' ) ; t h i s . g e t E d i t a b l e A r e a ( ) . f i n d ( ' . o _ w e _ s e l e c t e d _ i m a g e ' ) . r e m o v e C l a s s ( ' o _ w e _ s e l e c t e d _ i m a g e ' ) ; } , l o a d S n i p p e t s : f u n c t i o n ( i n v a l i d a t e C a c h e ) { i f ( ! i n v a l i d a t e C a c h e & & t h i s . c a c h e S n i p p e t T e m p l a t e [ t h i s . o p t i o n s . s n i p p e t s ] ) { t h i s . _ d e f L o a d S n i p p e t s = t h i s . c a c h e S n i p p e t T e m p l a t e [ t h i s . o p t i o n s . s n i p p e t s ] ; r e t u r n   t h i s . _ d e f L o a d S n i p p e t s ; } 
 t h i s . _ d e f L o a d S n i p p e t s = t h i s . _ r p c ( { m o d e l : ' i r . u i . v i e w ' , m e t h o d : ' r e n d e r _ p u b l i c _ a s s e t ' , a r g s : [ t h i s . o p t i o n s . s n i p p e t s , { } ] , k w a r g s : { c o n t e x t : t h i s . o p t i o n s . c o n t e x t , } , } ) ; t h i s . c a c h e S n i p p e t T e m p l a t e [ t h i s . o p t i o n s . s n i p p e t s ] = t h i s . _ d e f L o a d S n i p p e t s ; r e t u r n   t h i s . _ d e f L o a d S n i p p e t s ; } , s e t S e l e c t o r E d i t a b l e A r e a : f u n c t i o n ( $ e d i t o r , s e l e c t o r E d i t a b l e A r e a ) { t h i s . s e l e c t o r E d i t a b l e A r e a = s e l e c t o r E d i t a b l e A r e a ; t h i s . $ e d i t o r = $ e d i t o r ; t h i s . $ b o d y = $ e d i t o r . c l o s e s t ( ' b o d y ' ) ; } , g e t E d i t a b l e A r e a : f u n c t i o n ( ) { r e t u r n   t h i s . $ e d i t o r . f i n d ( t h i s . s e l e c t o r E d i t a b l e A r e a ) . a d d ( t h i s . $ e d i t o r . f i l t e r ( t h i s . s e l e c t o r E d i t a b l e A r e a ) ) ; } , u p d a t e C u r r e n t S n i p p e t E d i t o r O v e r l a y : f u n c t i o n ( ) { f o r ( c o n s t   s n i p p e t E d i t o r   o f   t h i s . s n i p p e t E d i t o r s ) { i f ( s n i p p e t E d i t o r . $ t a r g e t . c l o s e s t ( ' b o d y ' ) . l e n g t h ) { s n i p p e t E d i t o r . c o v e r ( ) ; c o n t i n u e ; } 
 t h i s . _ m u t e x . e x e c ( ( ) = > s n i p p e t E d i t o r . d e s t r o y ( ) ) ; } } , _ a c t i v a t e I n s e r t i o n Z o n e s : f u n c t i o n ( $ s e l e c t o r S i b l i n g s , $ s e l e c t o r C h i l d r e n ) { v a r   s e l f = t h i s ; f u n c t i o n   i s F u l l W i d t h ( $ e l e m ) { r e t u r n   $ e l e m . p a r e n t ( ) . w i d t h ( ) = = = $ e l e m . o u t e r W i d t h ( t r u e ) ; } 
 i f ( $ s e l e c t o r C h i l d r e n ) { $ s e l e c t o r C h i l d r e n . e a c h ( f u n c t i o n ( ) { v a r   $ z o n e = $ ( t h i s ) ; v a r   s t y l e ; v a r   v e r t i c a l ; v a r   n o d e ; v a r   c s s = s e l f . w i n d o w . g e t C o m p u t e d S t y l e ( t h i s ) ; v a r   p a r e n t C s s = s e l f . w i n d o w . g e t C o m p u t e d S t y l e ( $ z o n e . p a r e n t ( ) [ 0 ] ) ; v a r   f l o a t = c s s . f l o a t | | c s s . c s s F l o a t ; v a r   p a r e n t D i s p l a y = p a r e n t C s s . d i s p l a y ; v a r   p a r e n t F l e x = p a r e n t C s s . f l e x D i r e c t i o n ; s t y l e = { } ; v e r t i c a l = f a l s e ; n o d e = $ z o n e [ 0 ] . l a s t C h i l d ; v a r   t e s t = ! ! ( n o d e & & ( ( ! n o d e . t a g N a m e & & n o d e . t e x t C o n t e n t . m a t c h ( / \ S / ) ) | | n o d e . t a g N a m e = = = ' B R ' ) ) ; i f ( t e s t ) { v e r t i c a l = t r u e ; s t y l e [ ' f l o a t ' ] = ' n o n e ' ; s t y l e [ ' h e i g h t ' ] = p a r s e I n t ( s e l f . w i n d o w . g e t C o m p u t e d S t y l e ( $ z o n e [ 0 ] ) . l i n e H e i g h t ) + ' p x ' ; s t y l e [ ' d i s p l a y ' ] = ' i n l i n e - b l o c k ' ; } e l s e   i f ( f l o a t = = = ' l e f t ' | | f l o a t = = = ' r i g h t ' | | ( p a r e n t D i s p l a y = = = ' f l e x ' & & p a r e n t F l e x = = = ' r o w ' ) ) { s t y l e [ ' f l o a t ' ] = f l o a t ; i f ( ! i s F u l l W i d t h ( $ z o n e ) & & ! $ z o n e . h a s C l a s s ( ' o e _ s t r u c t u r e ' ) ) { v e r t i c a l = t r u e ; s t y l e [ ' h e i g h t ' ] = M a t h . m a x ( $ z o n e . o u t e r H e i g h t ( ) , 3 0 ) + ' p x ' ; } } 
 s e l f . _ i n s e r t D r o p z o n e ( $ ( ' < w e - h o o k / > ' ) . a p p e n d T o ( $ z o n e ) , v e r t i c a l , s t y l e ) ; s t y l e = { } ; v e r t i c a l = f a l s e ; n o d e = $ z o n e [ 0 ] . f i r s t C h i l d ; t e s t = ! ! ( n o d e & & ( ( ! n o d e . t a g N a m e & & n o d e . t e x t C o n t e n t . m a t c h ( / \ S / ) ) | | n o d e . t a g N a m e = = = ' B R ' ) ) ; i f ( t e s t ) { v e r t i c a l = t r u e ; s t y l e [ ' f l o a t ' ] = ' n o n e ' ; s t y l e [ ' h e i g h t ' ] = p a r s e I n t ( s e l f . w i n d o w . g e t C o m p u t e d S t y l e ( $ z o n e [ 0 ] ) . l i n e H e i g h t ) + ' p x ' ; s t y l e [ ' d i s p l a y ' ] = ' i n l i n e - b l o c k ' ; } e l s e   i f ( f l o a t = = = ' l e f t ' | | f l o a t = = = ' r i g h t ' | | ( p a r e n t D i s p l a y = = = ' f l e x ' & & p a r e n t F l e x = = = ' r o w ' ) ) { s t y l e [ ' f l o a t ' ] = f l o a t ; i f ( ! i s F u l l W i d t h ( $ z o n e ) & & ! $ z o n e . h a s C l a s s ( ' o e _ s t r u c t u r e ' ) ) { v e r t i c a l = t r u e ; s t y l e [ ' h e i g h t ' ] = M a t h . m a x ( $ z o n e . o u t e r H e i g h t ( ) , 3 0 ) + ' p x ' ; } } 
 s e l f . _ i n s e r t D r o p z o n e ( $ ( ' < w e - h o o k / > ' ) . p r e p e n d T o ( $ z o n e ) , v e r t i c a l , s t y l e ) ; } ) ; $ s e l e c t o r S i b l i n g s = $ ( _ . u n i q ( ( $ s e l e c t o r S i b l i n g s | | $ ( ) ) . a d d ( $ s e l e c t o r C h i l d r e n . c h i l d r e n ( ) ) . g e t ( ) ) ) ; } 
 i f ( $ s e l e c t o r S i b l i n g s ) { $ s e l e c t o r S i b l i n g s . f i l t e r ( ' : n o t ( . o e _ d r o p _ z o n e ) : n o t ( . o e _ d r o p _ c l o n e ) ' ) . e a c h ( f u n c t i o n ( ) { v a r   $ z o n e = $ ( t h i s ) ; v a r   s t y l e ; v a r   v e r t i c a l ; v a r   c s s = s e l f . w i n d o w . g e t C o m p u t e d S t y l e ( t h i s ) ; v a r   p a r e n t C s s = s e l f . w i n d o w . g e t C o m p u t e d S t y l e ( $ z o n e . p a r e n t ( ) [ 0 ] ) ; v a r   f l o a t = c s s . f l o a t | | c s s . c s s F l o a t ; v a r   p a r e n t D i s p l a y = p a r e n t C s s . d i s p l a y ; v a r   p a r e n t F l e x = p a r e n t C s s . f l e x D i r e c t i o n ; i f ( $ z o n e . p r e v ( ' . o e _ d r o p _ z o n e : v i s i b l e ' ) . l e n g t h = = = 0 ) { s t y l e = { } ; v e r t i c a l = f a l s e ; i f ( f l o a t = = = ' l e f t ' | | f l o a t = = = ' r i g h t ' | | ( p a r e n t D i s p l a y = = = ' f l e x ' & & p a r e n t F l e x = = = ' r o w ' ) ) { s t y l e [ ' f l o a t ' ] = f l o a t ; i f ( ! i s F u l l W i d t h ( $ z o n e ) ) { v e r t i c a l = t r u e ; s t y l e [ ' h e i g h t ' ] = M a t h . m a x ( $ z o n e . o u t e r H e i g h t ( ) , 3 0 ) + ' p x ' ; } } 
 s e l f . _ i n s e r t D r o p z o n e ( $ ( ' < w e - h o o k / > ' ) . i n s e r t B e f o r e ( $ z o n e ) , v e r t i c a l , s t y l e ) ; } 
 i f ( $ z o n e . n e x t ( ' . o e _ d r o p _ z o n e : v i s i b l e ' ) . l e n g t h = = = 0 ) { s t y l e = { } ; v e r t i c a l = f a l s e ; i f ( f l o a t = = = ' l e f t ' | | f l o a t = = = ' r i g h t ' | | ( p a r e n t D i s p l a y = = = ' f l e x ' & & p a r e n t F l e x = = = ' r o w ' ) ) { s t y l e [ ' f l o a t ' ] = f l o a t ; i f ( ! i s F u l l W i d t h ( $ z o n e ) ) { v e r t i c a l = t r u e ; s t y l e [ ' h e i g h t ' ] = M a t h . m a x ( $ z o n e . o u t e r H e i g h t ( ) , 3 0 ) + ' p x ' ; } } 
 s e l f . _ i n s e r t D r o p z o n e ( $ ( ' < w e - h o o k / > ' ) . i n s e r t A f t e r ( $ z o n e ) , v e r t i c a l , s t y l e ) ; } } ) ; } 
 v a r   c o u n t ; v a r   $ z o n e s ; d o { c o u n t = 0 ; $ z o n e s = t h i s . g e t E d i t a b l e A r e a ( ) . f i n d ( ' . o e _ d r o p _ z o n e   >   . o e _ d r o p _ z o n e ' ) . r e m o v e ( ) ; c o u n t + = $ z o n e s . l e n g t h ; $ z o n e s . r e m o v e ( ) ; } w h i l e ( c o u n t > 0 ) ; $ z o n e s = t h i s . g e t E d i t a b l e A r e a ( ) . f i n d ( ' . o e _ d r o p _ z o n e : n o t ( . o e _ v e r t i c a l ) ' ) ; $ z o n e s . e a c h ( f u n c t i o n ( ) { v a r   z o n e = $ ( t h i s ) ; v a r   p r e v = z o n e . p r e v ( ) ; v a r   n e x t = z o n e . n e x t ( ) ; i f ( p r e v . i s ( ' . o e _ d r o p _ z o n e ' ) | | n e x t . i s ( ' . o e _ d r o p _ z o n e ' ) ) { z o n e . r e m o v e ( ) ; r e t u r n ; } 
 v a r   f l o a t P r e v = p r e v . c s s ( ' f l o a t ' ) | | ' n o n e ' ; v a r   f l o a t N e x t = n e x t . c s s ( ' f l o a t ' ) | | ' n o n e ' ; v a r   d i s p P r e v = p r e v . c s s ( ' d i s p l a y ' ) | | n u l l ; v a r   d i s p N e x t = n e x t . c s s ( ' d i s p l a y ' ) | | n u l l ; i f ( ( f l o a t P r e v = = = ' l e f t ' | | f l o a t P r e v = = = ' r i g h t ' ) & & ( f l o a t N e x t = = = ' l e f t ' | | f l o a t N e x t = = = ' r i g h t ' ) ) { z o n e . r e m o v e ( ) ; } e l s e   i f ( d i s p P r e v ! = = n u l l & & d i s p N e x t ! = = n u l l & & d i s p P r e v . i n d e x O f ( ' i n l i n e ' ) > = 0 & & d i s p N e x t . i n d e x O f ( ' i n l i n e ' ) > = 0 ) { z o n e . r e m o v e ( ) ; } } ) ; } , _ u p d a t e I n v i s i b l e D O M : f u n c t i o n ( ) { r e t u r n   t h i s . _ e x e c W i t h L o a d i n g E f f e c t ( ( ) = > { t h i s . i n v i s i b l e D O M M a p = n e w   M a p ( ) ; c o n s t   $ i n v i s i b l e D O M P a n e l E l = $ ( t h i s . i n v i s i b l e D O M P a n e l E l ) ; $ i n v i s i b l e D O M P a n e l E l . f i n d ( ' . o _ w e _ i n v i s i b l e _ e n t r y ' ) . r e m o v e ( ) ; c o n s t   $ i n v i s i b l e S n i p p e t s = g l o b a l S e l e c t o r . a l l ( ) . f i n d ( ' . o _ s n i p p e t _ i n v i s i b l e ' ) . a d d B a c k ( ' . o _ s n i p p e t _ i n v i s i b l e ' ) ; $ i n v i s i b l e D O M P a n e l E l . t o g g l e C l a s s ( ' d - n o n e ' , ! $ i n v i s i b l e S n i p p e t s . l e n g t h ) ; c o n s t   p r o m s = _ . m a p ( $ i n v i s i b l e S n i p p e t s , a s y n c   e l = > { c o n s t   e d i t o r = a w a i t   t h i s . _ c r e a t e S n i p p e t E d i t o r ( $ ( e l ) ) ; c o n s t   $ i n v i s E n t r y = $ ( ' < d i v / > ' , { c l a s s : ' o _ w e _ i n v i s i b l e _ e n t r y   d - f l e x   a l i g n - i t e m s - c e n t e r   j u s t i f y - c o n t e n t - b e t w e e n ' , t e x t : e d i t o r . g e t N a m e ( ) , } ) . a p p e n d ( $ ( ' < i / > ' , { c l a s s : ` f a   $ { e d i t o r . i s T a r g e t V i s i b l e ( )   ?   ' f a - e y e '   :   ' f a - e y e - s l a s h ' }   m l - 2 ` } ) ) ; $ i n v i s i b l e D O M P a n e l E l . a p p e n d ( $ i n v i s E n t r y ) ; t h i s . i n v i s i b l e D O M M a p . s e t ( $ i n v i s E n t r y [ 0 ] , e l ) ; } ) ; r e t u r n   P r o m i s e . a l l ( p r o m s ) ; } , f a l s e ) ; } , _ a c t i v a t e S n i p p e t : a s y n c   f u n c t i o n ( $ s n i p p e t , p r e v i e w M o d e , i f I n a c t i v e O p t i o n s ) { i f ( t h i s . _ b l o c k P r e v i e w O v e r l a y s & & p r e v i e w M o d e ) { r e t u r n ; } 
 i f ( $ s n i p p e t & & ! $ s n i p p e t . i s ( ' : v i s i b l e ' ) ) { r e t u r n ; } 
 c o n s t   e x e c = p r e v i e w M o d e ? a c t i o n = > t h i s . _ m u t e x . e x e c ( a c t i o n ) : a c t i o n = > t h i s . _ e x e c W i t h L o a d i n g E f f e c t ( a c t i o n , f a l s e ) ; r e t u r n   e x e c ( ( ) = > { r e t u r n   n e w   P r o m i s e ( r e s o l v e = > { i f ( $ s n i p p e t & & $ s n i p p e t . l e n g t h ) { $ s n i p p e t = g l o b a l S e l e c t o r . c l o s e s t ( $ s n i p p e t ) ; i f ( $ s n i p p e t . l e n g t h ) { r e t u r n   t h i s . _ c r e a t e S n i p p e t E d i t o r ( $ s n i p p e t ) . t h e n ( r e s o l v e ) ; } } 
 r e s o l v e ( n u l l ) ; } ) . t h e n ( e d i t o r T o E n a b l e = > { i f ( i f I n a c t i v e O p t i o n s & & t h i s . _ e n a b l e d E d i t o r H i e r a r c h y . i n c l u d e s ( e d i t o r T o E n a b l e ) ) { r e t u r n   e d i t o r T o E n a b l e ; } 
 c o n s t   e d i t o r T o E n a b l e H i e r a r c h y = [ ] ; l e t   c u r r e n t = e d i t o r T o E n a b l e ; w h i l e ( c u r r e n t & & c u r r e n t . $ t a r g e t ) { e d i t o r T o E n a b l e H i e r a r c h y . p u s h ( c u r r e n t ) ; c u r r e n t = c u r r e n t . g e t P a r e n t ( ) ; } 
 f o r ( l e t   i = t h i s . s n i p p e t E d i t o r s . l e n g t h ; i - - ; ) { c o n s t   e d i t o r = t h i s . s n i p p e t E d i t o r s [ i ] ; e d i t o r . t o g g l e O v e r l a y ( f a l s e , p r e v i e w M o d e ) ; i f ( ! p r e v i e w M o d e & & ! e d i t o r T o E n a b l e H i e r a r c h y . i n c l u d e s ( e d i t o r ) ) { e d i t o r . t o g g l e O p t i o n s ( f a l s e ) ; } } 
 i f ( ! e d i t o r T o E n a b l e ) { e d i t o r T o E n a b l e = t h i s . s n i p p e t E d i t o r s . f i n d ( e d i t o r = > e d i t o r . i s S t i c k y ( ) ) ; p r e v i e w M o d e = f a l s e ; } 
 i f ( e d i t o r T o E n a b l e ) { e d i t o r T o E n a b l e . t o g g l e O v e r l a y ( t r u e , p r e v i e w M o d e ) ; e d i t o r T o E n a b l e . t o g g l e O p t i o n s ( t r u e ) ; } 
 t h i s . _ e n a b l e d E d i t o r H i e r a r c h y = e d i t o r T o E n a b l e H i e r a r c h y ; r e t u r n   e d i t o r T o E n a b l e ; } ) ; } ) ; } , _ l o a d S n i p p e t s T e m p l a t e s : a s y n c   f u n c t i o n ( i n v a l i d a t e C a c h e ) { r e t u r n   t h i s . _ e x e c W i t h L o a d i n g E f f e c t ( a s y n c ( ) = > { a w a i t   t h i s . _ d e s t r o y E d i t o r s ( ) ; c o n s t   h t m l = a w a i t   t h i s . l o a d S n i p p e t s ( i n v a l i d a t e C a c h e ) ; a w a i t   t h i s . _ c o m p u t e S n i p p e t T e m p l a t e s ( h t m l ) ; } , f a l s e ) ; } , _ d e s t r o y E d i t o r s : a s y n c   f u n c t i o n ( ) { c o n s t   p r o m s = _ . m a p ( t h i s . s n i p p e t E d i t o r s , a s y n c   f u n c t i o n ( s n i p p e t E d i t o r ) { a w a i t   s n i p p e t E d i t o r . c l e a n F o r S a v e ( ) ; s n i p p e t E d i t o r . d e s t r o y ( ) ; } ) ; a w a i t   P r o m i s e . a l l ( p r o m s ) ; t h i s . s n i p p e t E d i t o r s . s p l i c e ( 0 ) ; } , _ c a l l F o r E a c h C h i l d S n i p p e t : f u n c t i o n ( $ s n i p p e t , c a l l b a c k ) { v a r   s e l f = t h i s ; v a r   d e f s = _ . m a p ( $ s n i p p e t . a d d ( g l o b a l S e l e c t o r . a l l ( $ s n i p p e t ) ) , f u n c t i o n ( e l ) { v a r   $ s n i p p e t = $ ( e l ) ; r e t u r n   s e l f . _ c r e a t e S n i p p e t E d i t o r ( $ s n i p p e t ) . t h e n ( f u n c t i o n ( e d i t o r ) { i f ( e d i t o r ) { r e t u r n   c a l l b a c k . c a l l ( s e l f , e d i t o r , $ s n i p p e t ) ; } } ) ; } ) ; r e t u r n   P r o m i s e . a l l ( d e f s ) ; } , _ c l o s e W i d g e t s : f u n c t i o n ( ) { t h i s . s n i p p e t E d i t o r s . f o r E a c h ( e d i t o r = > e d i t o r . c l o s e W i d g e t s ( ) ) ; } , _ c o m p u t e S e l e c t o r F u n c t i o n s : f u n c t i o n ( s e l e c t o r , e x c l u d e , t a r g e t , n o C h e c k , i s C h i l d r e n ) { v a r   s e l f = t h i s ; e x c l u d e + = ` $ { e x c l u d e   & &   ' ,   ' } . o _ s n i p p e t _ n o t _ s e l e c t a b l e ` ; l e t   f i l t e r F u n c = f u n c t i o n ( ) { r e t u r n ! $ ( t h i s ) . i s ( e x c l u d e ) ; } ; i f ( t a r g e t ) { c o n s t   o l d F i l t e r = f i l t e r F u n c ; f i l t e r F u n c = f u n c t i o n ( ) { r e t u r n   o l d F i l t e r . a p p l y ( t h i s ) & & $ ( t h i s ) . f i n d ( t a r g e t ) . l e n g t h ! = = 0 ; } ; } 
 v a r   f u n c t i o n s = { i s : f u n c t i o n ( $ f r o m ) { r e t u r n   $ f r o m . i s ( s e l e c t o r ) & & $ f r o m . f i l t e r ( f i l t e r F u n c ) . l e n g t h ! = = 0 ; } , } ; i f ( n o C h e c k ) { f u n c t i o n s . c l o s e s t = f u n c t i o n ( $ f r o m , p a r e n t N o d e ) { r e t u r n   $ f r o m . c l o s e s t ( s e l e c t o r , p a r e n t N o d e ) . f i l t e r ( f i l t e r F u n c ) ; } ; f u n c t i o n s . a l l = f u n c t i o n ( $ f r o m ) { r e t u r n ( $ f r o m ? d o m . c s s F i n d ( $ f r o m , s e l e c t o r ) : $ ( s e l e c t o r ) ) . f i l t e r ( f i l t e r F u n c ) ; } ; } e l s e { f u n c t i o n s . c l o s e s t = f u n c t i o n ( $ f r o m , p a r e n t N o d e ) { v a r   p a r e n t s = s e l f . g e t E d i t a b l e A r e a ( ) . g e t ( ) ; r e t u r n   $ f r o m . c l o s e s t ( s e l e c t o r , p a r e n t N o d e ) . f i l t e r ( f u n c t i o n ( ) { v a r   n o d e = t h i s ; w h i l e ( n o d e . p a r e n t N o d e ) { i f ( p a r e n t s . i n d e x O f ( n o d e ) ! = = - 1 ) { r e t u r n   t r u e ; } 
 n o d e = n o d e . p a r e n t N o d e ; } 
 r e t u r n   f a l s e ; } ) . f i l t e r ( f i l t e r F u n c ) ; } ; f u n c t i o n s . a l l = i s C h i l d r e n ? f u n c t i o n ( $ f r o m ) { r e t u r n   d o m . c s s F i n d ( $ f r o m | | s e l f . g e t E d i t a b l e A r e a ( ) , s e l e c t o r ) . f i l t e r ( f i l t e r F u n c ) ; } : f u n c t i o n ( $ f r o m ) { $ f r o m = $ f r o m | | s e l f . g e t E d i t a b l e A r e a ( ) ; r e t u r n   $ f r o m . f i l t e r ( s e l e c t o r ) . a d d ( d o m . c s s F i n d ( $ f r o m , s e l e c t o r ) ) . f i l t e r ( f i l t e r F u n c ) ; } ; } 
 r e t u r n   f u n c t i o n s ; } , _ c o m p u t e S n i p p e t T e m p l a t e s : f u n c t i o n ( h t m l ) { v a r   s e l f = t h i s ; v a r   $ h t m l = $ ( h t m l ) ; v a r   $ s c r o l l = $ h t m l . s i b l i n g s ( ' # o _ s c r o l l ' ) ; c o n s t   $ h e a d e r N a v F i x = $ h t m l . f i n d ( ' [ d a t a - j s = " H e a d e r N a v b a r " ] [ d a t a - s e l e c t o r = " # w r a p w r a p   >   h e a d e r   >   n a v " ] ' ) ; i f ( $ h e a d e r N a v F i x . l e n g t h ) { $ h e a d e r N a v F i x [ 0 ] . d a t a s e t . s e l e c t o r = ' # w r a p w r a p   >   h e a d e r   n a v . n a v b a r ' ; } 
 t h i s . t e m p l a t e O p t i o n s = [ ] ; v a r   s e l e c t o r s = [ ] ; v a r   $ s t y l e s = $ h t m l . f i n d ( ' [ d a t a - s e l e c t o r ] ' ) ; $ s t y l e s . e a c h ( f u n c t i o n ( ) { v a r   $ s t y l e = $ ( t h i s ) ; v a r   s e l e c t o r = $ s t y l e . d a t a ( ' s e l e c t o r ' ) ; v a r   e x c l u d e = $ s t y l e . d a t a ( ' e x c l u d e ' ) | | ' ' ; v a r   t a r g e t = $ s t y l e . d a t a ( ' t a r g e t ' ) ; v a r   n o C h e c k = $ s t y l e . d a t a ( ' n o - c h e c k ' ) ; v a r   o p t i o n I D = $ s t y l e . d a t a ( ' j s ' ) | | $ s t y l e . d a t a ( ' o p t i o n - n a m e ' ) ; v a r   o p t i o n = { ' o p t i o n ' : o p t i o n I D , ' b a s e _ s e l e c t o r ' : s e l e c t o r , ' b a s e _ e x c l u d e ' : e x c l u d e , ' b a s e _ t a r g e t ' : t a r g e t , ' s e l e c t o r ' : s e l f . _ c o m p u t e S e l e c t o r F u n c t i o n s ( s e l e c t o r , e x c l u d e , t a r g e t , n o C h e c k ) , ' $ e l ' : $ s t y l e , ' d r o p - n e a r ' : $ s t y l e . d a t a ( ' d r o p - n e a r ' ) & & s e l f . _ c o m p u t e S e l e c t o r F u n c t i o n s ( $ s t y l e . d a t a ( ' d r o p - n e a r ' ) , ' ' , f a l s e , n o C h e c k , t r u e ) , ' d r o p - i n ' : $ s t y l e . d a t a ( ' d r o p - i n ' ) & & s e l f . _ c o m p u t e S e l e c t o r F u n c t i o n s ( $ s t y l e . d a t a ( ' d r o p - i n ' ) , ' ' , f a l s e , n o C h e c k ) , ' d a t a ' : _ . e x t e n d ( { s t r i n g : $ s t y l e . a t t r ( ' s t r i n g ' ) } , $ s t y l e . d a t a ( ) ) , } ; s e l f . t e m p l a t e O p t i o n s . p u s h ( o p t i o n ) ; s e l e c t o r s . p u s h ( o p t i o n . s e l e c t o r ) ; } ) ; $ s t y l e s . a d d C l a s s ( ' d - n o n e ' ) ; g l o b a l S e l e c t o r . c l o s e s t = f u n c t i o n ( $ f r o m ) { v a r   $ t e m p ; v a r   $ t a r g e t ; f o r ( v a r   i = 0 , l e n = s e l e c t o r s . l e n g t h ; i < l e n ; i + + ) { $ t e m p = s e l e c t o r s [ i ] . c l o s e s t ( $ f r o m , $ t a r g e t & & $ t a r g e t [ 0 ] ) ; i f ( $ t e m p . l e n g t h ) { $ t a r g e t = $ t e m p ; } } 
 r e t u r n   $ t a r g e t | | $ ( ) ; } ; g l o b a l S e l e c t o r . a l l = f u n c t i o n ( $ f r o m ) { v a r   $ t a r g e t = $ ( ) ; f o r ( v a r   i = 0 , l e n = s e l e c t o r s . l e n g t h ; i < l e n ; i + + ) { $ t a r g e t = $ t a r g e t . a d d ( s e l e c t o r s [ i ] . a l l ( $ f r o m ) ) ; } 
 r e t u r n   $ t a r g e t ; } ; g l o b a l S e l e c t o r . i s = f u n c t i o n ( $ f r o m ) { f o r ( v a r   i = 0 , l e n = s e l e c t o r s . l e n g t h ; i < l e n ; i + + ) { i f ( s e l e c t o r s [ i ] . i s ( $ f r o m ) ) { r e t u r n   t r u e ; } } 
 r e t u r n   f a l s e ; } ; t h i s . $ s n i p p e t s = $ s c r o l l . f i n d ( ' . o _ p a n e l _ b o d y ' ) . c h i l d r e n ( ) . a d d C l a s s ( ' o e _ s n i p p e t ' ) . e a c h ( ( i , e l ) = > { c o n s t   $ s n i p p e t = $ ( e l ) ; c o n s t   n a m e = e l . g e t A t t r i b u t e ( ' n a m e ' ) ; c o n s t   $ s b o d y = $ s n i p p e t . c h i l d r e n ( ) . a d d C l a s s ( ' o e _ s n i p p e t _ b o d y ' ) ; c o n s t   i s C u s t o m S n i p p e t = ! ! e l . c l o s e s t ( ' # s n i p p e t _ c u s t o m ' ) ; l e t   s n i p p e t C l a s s e s = $ s b o d y . a t t r ( ' c l a s s ' ) . m a t c h ( / s _ [ ^   ] + / g ) ; i f ( s n i p p e t C l a s s e s & & s n i p p e t C l a s s e s . l e n g t h ) { s n i p p e t C l a s s e s = ' . ' + s n i p p e t C l a s s e s . j o i n ( ' . ' ) ; } 
 c o n s t   $ e l s = $ ( s n i p p e t C l a s s e s ) . n o t ( ' [ d a t a - n a m e ] ' ) . a d d ( $ s b o d y ) ; $ e l s . a t t r ( ' d a t a - n a m e ' , n a m e ) . d a t a ( ' n a m e ' , n a m e ) ; c o n s t   $ t h u m b n a i l = $ ( ` 
                                         < d i v   c l a s s = " o e _ s n i p p e t _ t h u m b n a i l " > 
                                                 < d i v   c l a s s = " o e _ s n i p p e t _ t h u m b n a i l _ i m g "   s t y l e = " b a c k g r o u n d - i m a g e :   u r l ( $ { e l . d a t a s e t . o e T h u m b n a i l } ) ; " / > 
                                                 < s p a n   c l a s s = " o e _ s n i p p e t _ t h u m b n a i l _ t i t l e " > $ { n a m e } < / s p a n > 
                                         < / d i v > 
                                 ` ) ; $ s n i p p e t . p r e p e n d ( $ t h u m b n a i l ) ; c o n s t   m o d u l e I D = $ s n i p p e t . d a t a ( ' m o d u l e I d ' ) ; i f ( m o d u l e I D ) { e l . c l a s s L i s t . a d d ( ' o _ s n i p p e t _ i n s t a l l ' ) ; $ t h u m b n a i l . a p p e n d ( $ ( ' < b u t t o n / > ' , { c l a s s : ' b t n   b t n - p r i m a r y   o _ i n s t a l l _ b t n   w - 1 0 0 ' , t y p e : ' b u t t o n ' , t e x t : _ t ( " I n s t a l l " ) , } ) ) ; } 
 i f ( i s C u s t o m S n i p p e t ) { c o n s t   b t n E l = d o c u m e n t . c r e a t e E l e m e n t ( ' w e - b u t t o n ' ) ; b t n E l . d a t a s e t . s n i p p e t I d = $ s n i p p e t . d a t a ( ' o e S n i p p e t I d ' ) ; b t n E l . c l a s s L i s t . a d d ( ' o _ d e l e t e _ b t n ' , ' f a ' , ' f a - t r a s h ' , ' b t n ' , ' o _ w e _ h o v e r _ d a n g e r ' ) ; b t n E l . t i t l e = _ . s t r . s p r i n t f ( _ t ( " D e l e t e   % s " ) , n a m e ) ; $ s n i p p e t . a p p e n d ( b t n E l ) ; } } ) . n o t ( ' [ d a t a - m o d u l e - i d ] ' ) ; i f ( ! t h i s . $ s n i p p e t s . l e n g t h ) { t h i s . $ e l . d e t a c h ( ) ; } 
 t h i s . _ r e g i s t e r D e f a u l t T e x t s ( ) ; $ h t m l . f i n d ( ' . o _ n o t _ e d i t a b l e ' ) . a t t r ( ' c o n t e n t E d i t a b l e ' , f a l s e ) ; t h i s . $ e l . h t m l ( $ h t m l ) ; t h i s . $ e l . a p p e n d ( t h i s . c u s t o m i z e P a n e l ) ; t h i s . $ e l . a p p e n d ( t h i s . t e x t E d i t o r P a n e l E l ) ; t h i s . $ e l . a p p e n d ( t h i s . i n v i s i b l e D O M P a n e l E l ) ; t h i s . _ m a k e S n i p p e t D r a g g a b l e ( t h i s . $ s n i p p e t s ) ; t h i s . _ d i s a b l e U n d r o p p a b l e S n i p p e t s ( ) ; t h i s . $ e l . a d d C l a s s ( ' o _ l o a d e d ' ) ; $ ( ' b o d y . e d i t o r _ e n a b l e ' ) . a d d C l a s s ( ' e d i t o r _ h a s _ s n i p p e t s ' ) ; t h i s . t r i g g e r _ u p ( ' s n i p p e t s _ l o a d e d ' , s e l f . $ e l ) ; } , _ c r e a t e S n i p p e t E d i t o r : f u n c t i o n ( $ s n i p p e t ) { v a r   s e l f = t h i s ; v a r   s n i p p e t E d i t o r = $ s n i p p e t . d a t a ( ' s n i p p e t - e d i t o r ' ) ; i f ( s n i p p e t E d i t o r ) { r e t u r n   s n i p p e t E d i t o r . _ _ i s S t a r t e d ; } 
 v a r   d e f ; v a r   $ p a r e n t = g l o b a l S e l e c t o r . c l o s e s t ( $ s n i p p e t . p a r e n t ( ) ) ; i f ( $ p a r e n t . l e n g t h ) { d e f = t h i s . _ c r e a t e S n i p p e t E d i t o r ( $ p a r e n t ) ; } 
 r e t u r n   P r o m i s e . r e s o l v e ( d e f ) . t h e n ( f u n c t i o n ( p a r e n t E d i t o r ) { s n i p p e t E d i t o r = $ s n i p p e t . d a t a ( ' s n i p p e t - e d i t o r ' ) ; i f ( s n i p p e t E d i t o r ) { r e t u r n   s n i p p e t E d i t o r . _ _ i s S t a r t e d ; } 
 l e t   e d i t a b l e A r e a = s e l f . g e t E d i t a b l e A r e a ( ) ; s n i p p e t E d i t o r = n e w   S n i p p e t E d i t o r ( p a r e n t E d i t o r | | s e l f , $ s n i p p e t , s e l f . t e m p l a t e O p t i o n s , $ s n i p p e t . c l o s e s t ( ' [ d a t a - o e - t y p e = " h t m l " ] ,   . o e _ s t r u c t u r e ' ) . a d d ( e d i t a b l e A r e a ) , s e l f . o p t i o n s ) ; s e l f . s n i p p e t E d i t o r s . p u s h ( s n i p p e t E d i t o r ) ; r e t u r n   s n i p p e t E d i t o r . a p p e n d T o ( s e l f . $ s n i p p e t E d i t o r A r e a ) ; } ) . t h e n ( f u n c t i o n ( ) { r e t u r n   s n i p p e t E d i t o r ; } ) ; } , _ d i s a b l e U n d r o p p a b l e S n i p p e t s : f u n c t i o n ( ) { v a r   s e l f = t h i s ; v a r   c a c h e = { } ; t h i s . $ s n i p p e t s . e a c h ( f u n c t i o n ( ) { v a r   $ s n i p p e t = $ ( t h i s ) ; v a r   $ s n i p p e t B o d y = $ s n i p p e t . f i n d ( ' . o e _ s n i p p e t _ b o d y ' ) ; v a r   c h e c k = f a l s e ; _ . e a c h ( s e l f . t e m p l a t e O p t i o n s , f u n c t i o n ( o p t i o n , k ) { i f ( c h e c k | | ! ( $ s n i p p e t B o d y . i s ( o p t i o n . b a s e _ s e l e c t o r ) & & ! $ s n i p p e t B o d y . i s ( o p t i o n . b a s e _ e x c l u d e ) ) ) { r e t u r n ; } 
 c a c h e [ k ] = c a c h e [ k ] | | { ' d r o p - n e a r ' : o p t i o n [ ' d r o p - n e a r ' ] ? o p t i o n [ ' d r o p - n e a r ' ] . a l l ( ) . l e n g t h : 0 , ' d r o p - i n ' : o p t i o n [ ' d r o p - i n ' ] ? o p t i o n [ ' d r o p - i n ' ] . a l l ( ) . l e n g t h : 0 } ; c h e c k = ( c a c h e [ k ] [ ' d r o p - n e a r ' ] | | c a c h e [ k ] [ ' d r o p - i n ' ] ) ; } ) ; $ s n i p p e t . t o g g l e C l a s s ( ' o _ d i s a b l e d ' , ! c h e c k ) ; $ s n i p p e t . a t t r ( ' t i t l e ' , c h e c k ? ' ' : _ t ( " N o   l o c a t i o n   t o   d r o p   i n " ) ) ; c o n s t   $ i c o n = $ s n i p p e t . f i n d ( ' . o _ s n i p p e t _ u n d r o p p a b l e ' ) . r e m o v e ( ) ; i f ( c h e c k ) { $ i c o n . r e m o v e ( ) ; } e l s e   i f ( ! $ i c o n . l e n g t h ) { c o n s t   i m g E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; i m g E l . c l a s s L i s t . a d d ( ' o _ s n i p p e t _ u n d r o p p a b l e ' ) ; i m g E l . s r c = ' / w e b _ e d i t o r / s t a t i c / s r c / i m g / s n i p p e t _ d i s a b l e d . s v g ' ; $ s n i p p e t . a p p e n d ( i m g E l ) ; } } ) ; } , _ f i l t e r S n i p p e t s ( s e a r c h ) { c o n s t   s e a r c h I n p u t E l = t h i s . e l . q u e r y S e l e c t o r ( ' . o _ s n i p p e t _ s e a r c h _ f i l t e r _ i n p u t ' ) ; c o n s t   s e a r c h I n p u t R e s e t = t h i s . e l . q u e r y S e l e c t o r ( ' . o _ s n i p p e t _ s e a r c h _ f i l t e r _ r e s e t ' ) ; i f ( s e a r c h ! = = u n d e f i n e d ) { s e a r c h I n p u t E l . v a l u e = s e a r c h ; } e l s e { s e a r c h = s e a r c h I n p u t E l . v a l u e ; } 
 s e a r c h = s e a r c h . t o L o w e r C a s e ( ) ; s e a r c h I n p u t R e s e t . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , ! s e a r c h ) ; c o n s t   s t r M a t c h e s = s t r = > ! s e a r c h | | s t r . t o L o w e r C a s e ( ) . i n c l u d e s ( s e a r c h ) ; f o r ( c o n s t   p a n e l E l   o f   t h i s . e l . q u e r y S e l e c t o r A l l ( ' . o _ p a n e l ' ) ) { l e t   h a s V i s i b l e S n i p p e t = f a l s e ; c o n s t   p a n e l T i t l e = p a n e l E l . q u e r y S e l e c t o r ( ' . o _ p a n e l _ h e a d e r ' ) . t e x t C o n t e n t ; c o n s t   i s P a n e l T i t l e M a t c h = s t r M a t c h e s ( p a n e l T i t l e ) ; f o r ( c o n s t   s n i p p e t E l   o f   p a n e l E l . q u e r y S e l e c t o r A l l ( ' . o e _ s n i p p e t ' ) ) { c o n s t   m a t c h e s = ( i s P a n e l T i t l e M a t c h | | s t r M a t c h e s ( s n i p p e t E l . g e t A t t r i b u t e ( ' n a m e ' ) ) | | s t r M a t c h e s ( s n i p p e t E l . d a t a s e t . o e K e y w o r d s | | ' ' ) ) ; i f ( m a t c h e s ) { h a s V i s i b l e S n i p p e t = t r u e ; } 
 s n i p p e t E l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , ! m a t c h e s ) ; } 
 p a n e l E l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , ! h a s V i s i b l e S n i p p e t ) ; } } , _ g e t S c r o l l O p t i o n s ( o p t i o n s = { } ) { r e t u r n   O b j e c t . a s s i g n ( { } , o p t i o n s , { s c r o l l B o u n d a r i e s : O b j e c t . a s s i g n ( { r i g h t : f a l s e , } , o p t i o n s . s c r o l l B o u n d a r i e s ) , j Q u e r y D r a g g a b l e O p t i o n s : O b j e c t . a s s i g n ( { a p p e n d T o : t h i s . $ b o d y , c u r s o r : ' m o v e ' , g r e e d y : t r u e , s c r o l l : f a l s e , } , o p t i o n s . j Q u e r y D r a g g a b l e O p t i o n s ) , } ) ; } , _ i n s e r t D r o p z o n e : f u n c t i o n ( $ h o o k , v e r t i c a l , s t y l e ) { v a r   $ d r o p z o n e = $ ( ' < d i v / > ' , { ' c l a s s ' : ' o e _ d r o p _ z o n e   o e _ i n s e r t ' + ( v e r t i c a l ? '   o e _ v e r t i c a l ' : ' ' ) , } ) ; i f ( s t y l e ) { $ d r o p z o n e . c s s ( s t y l e ) ; } 
 $ h o o k . r e p l a c e W i t h ( $ d r o p z o n e ) ; r e t u r n   $ d r o p z o n e ; } , _ m a k e S n i p p e t D r a g g a b l e : f u n c t i o n ( $ s n i p p e t s ) { v a r   s e l f = t h i s ; v a r   $ t o I n s e r t , d r o p p e d , $ s n i p p e t ; l e t   d r a g A n d D r o p R e s o l v e ; c o n s t   s m o o t h S c r o l l O p t i o n s = t h i s . _ g e t S c r o l l O p t i o n s ( { j Q u e r y D r a g g a b l e O p t i o n s : { d i s t a n c e : 0 , h a n d l e : ' . o e _ s n i p p e t _ t h u m b n a i l : n o t ( . o _ w e _ a l r e a d y _ d r a g g i n g ) ' , h e l p e r : f u n c t i o n ( ) { c o n s t   d r a g S n i p = t h i s . c l o n e N o d e ( t r u e ) ; d r a g S n i p . q u e r y S e l e c t o r A l l ( ' . o _ d e l e t e _ b t n ' ) . f o r E a c h ( e l = > e l . r e m o v e ( ) ) ; r e t u r n   d r a g S n i p ; } , s t a r t : f u n c t i o n ( ) { s e l f . $ e l . f i n d ( ' . o e _ s n i p p e t _ t h u m b n a i l ' ) . a d d C l a s s ( ' o _ w e _ a l r e a d y _ d r a g g i n g ' ) ; d r o p p e d = f a l s e ; $ s n i p p e t = $ ( t h i s ) ; v a r   $ b a s e B o d y = $ s n i p p e t . f i n d ( ' . o e _ s n i p p e t _ b o d y ' ) ; v a r   $ s e l e c t o r S i b l i n g s = $ ( ) ; v a r   $ s e l e c t o r C h i l d r e n = $ ( ) ; v a r   t e m p = s e l f . t e m p l a t e O p t i o n s ; f o r ( v a r   k   i n   t e m p ) { i f ( $ b a s e B o d y . i s ( t e m p [ k ] . b a s e _ s e l e c t o r ) & & ! $ b a s e B o d y . i s ( t e m p [ k ] . b a s e _ e x c l u d e ) ) { i f ( t e m p [ k ] [ ' d r o p - n e a r ' ] ) { $ s e l e c t o r S i b l i n g s = $ s e l e c t o r S i b l i n g s . a d d ( t e m p [ k ] [ ' d r o p - n e a r ' ] . a l l ( ) ) ; } 
 i f ( t e m p [ k ] [ ' d r o p - i n ' ] ) { $ s e l e c t o r C h i l d r e n = $ s e l e c t o r C h i l d r e n . a d d ( t e m p [ k ] [ ' d r o p - i n ' ] . a l l ( ) ) ; } } } 
 $ t o I n s e r t = $ b a s e B o d y . c l o n e ( ) ; [ . . . $ t o I n s e r t . f i n d ( ' i m g [ s r c ^ = " / w e b _ e d i t o r / s h a p e / " ] ' ) ] . f o r E a c h ( d y n a m i c S v g = > { c o n s t   c o l o r C u s t o m i z e d U R L = n e w   U R L ( d y n a m i c S v g . g e t A t t r i b u t e ( ' s r c ' ) , w i n d o w . l o c a t i o n . o r i g i n ) ; c o l o r C u s t o m i z e d U R L . s e a r c h P a r a m s . s e t ( ' c 1 ' , g e t C S S V a r i a b l e V a l u e ( ' o - c o l o r - 1 ' ) ) ; d y n a m i c S v g . s r c = c o l o r C u s t o m i z e d U R L . p a t h n a m e + c o l o r C u s t o m i z e d U R L . s e a r c h ; } ) ; i f ( ! $ s e l e c t o r S i b l i n g s . l e n g t h & & ! $ s e l e c t o r C h i l d r e n . l e n g t h ) { c o n s o l e . w a r n ( $ s n i p p e t . f i n d ( ' . o e _ s n i p p e t _ t h u m b n a i l _ t i t l e ' ) . t e x t ( ) + "   h a v e   n o t   i n s e r t   a c t i o n :   d a t a - d r o p - n e a r   o r   d a t a - d r o p - i n " ) ; r e t u r n ; } 
 s e l f . _ a c t i v a t e S n i p p e t ( f a l s e ) ; s e l f . _ a c t i v a t e I n s e r t i o n Z o n e s ( $ s e l e c t o r S i b l i n g s , $ s e l e c t o r C h i l d r e n ) ; s e l f . g e t E d i t a b l e A r e a ( ) . f i n d ( ' . o e _ d r o p _ z o n e ' ) . d r o p p a b l e ( { o v e r : f u n c t i o n ( ) { i f ( ! d r o p p e d ) { d r o p p e d = t r u e ; $ ( t h i s ) . f i r s t ( ) . a f t e r ( $ t o I n s e r t ) . a d d C l a s s ( ' d - n o n e ' ) ; $ t o I n s e r t . r e m o v e C l a s s ( ' o e _ s n i p p e t _ b o d y ' ) ; } } , o u t : f u n c t i o n ( ) { v a r   p r e v = $ t o I n s e r t . p r e v ( ) ; i f ( t h i s = = = p r e v [ 0 ] ) { d r o p p e d = f a l s e ; $ t o I n s e r t . d e t a c h ( ) ; $ ( t h i s ) . r e m o v e C l a s s ( ' d - n o n e ' ) ; $ t o I n s e r t . a d d C l a s s ( ' o e _ s n i p p e t _ b o d y ' ) ; } } , } ) ; c o n s t   p r o m = n e w   P r o m i s e ( r e s o l v e = > d r a g A n d D r o p R e s o l v e = ( ) = > r e s o l v e ( ) ) ; s e l f . _ m u t e x . e x e c ( ( ) = > p r o m ) ; } , s t o p : a s y n c   f u n c t i o n ( e v , u i ) { $ t o I n s e r t . r e m o v e C l a s s ( ' o e _ s n i p p e t _ b o d y ' ) ; i f ( ! d r o p p e d & & u i . p o s i t i o n . t o p > 3 & & u i . p o s i t i o n . l e f t + u i . h e l p e r . o u t e r H e i g h t ( ) < s e l f . e l . g e t B o u n d i n g C l i e n t R e c t ( ) . l e f t ) { v a r   $ e l = $ . n e a r e s t ( { x : u i . p o s i t i o n . l e f t , y : u i . p o s i t i o n . t o p } , ' . o e _ d r o p _ z o n e ' , { c o n t a i n e r : d o c u m e n t . b o d y } ) . f i r s t ( ) ; i f ( $ e l . l e n g t h ) { $ e l . a f t e r ( $ t o I n s e r t ) ; d r o p p e d = t r u e ; } } 
 s e l f . g e t E d i t a b l e A r e a ( ) . f i n d ( ' . o e _ d r o p _ z o n e ' ) . d r o p p a b l e ( ' d e s t r o y ' ) . r e m o v e ( ) ; i f ( d r o p p e d ) { v a r   p r e v = $ t o I n s e r t . f i r s t ( ) [ 0 ] . p r e v i o u s S i b l i n g ; v a r   n e x t = $ t o I n s e r t . l a s t ( ) [ 0 ] . n e x t S i b l i n g ; i f ( p r e v ) { $ t o I n s e r t . d e t a c h ( ) ; s e l f . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : $ ( p r e v ) } ) ; $ t o I n s e r t . i n s e r t A f t e r ( p r e v ) ; } e l s e   i f ( n e x t ) { $ t o I n s e r t . d e t a c h ( ) ; s e l f . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : $ ( n e x t ) } ) ; $ t o I n s e r t . i n s e r t B e f o r e ( n e x t ) ; } e l s e { v a r   $ p a r e n t = $ t o I n s e r t . p a r e n t ( ) ; $ t o I n s e r t . d e t a c h ( ) ; s e l f . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : $ p a r e n t } ) ; $ p a r e n t . p r e p e n d ( $ t o I n s e r t ) ; } 
 v a r   $ t a r g e t = $ t o I n s e r t ; a w a i t   s e l f . _ s c r o l l T o S n i p p e t ( $ t a r g e t ) ; _ . d e f e r ( a s y n c   f u n c t i o n ( ) { s e l f . t r i g g e r _ u p ( ' s n i p p e t _ d r o p p e d ' , { $ t a r g e t : $ t a r g e t } ) ; s e l f . _ d i s a b l e U n d r o p p a b l e S n i p p e t s ( ) ; d r a g A n d D r o p R e s o l v e ( ) ; a w a i t   s e l f . _ c a l l F o r E a c h C h i l d S n i p p e t ( $ t a r g e t , f u n c t i o n ( e d i t o r , $ s n i p p e t ) { r e t u r n   e d i t o r . b u i l d S n i p p e t ( ) ; } ) ; $ t a r g e t . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; a w a i t   s e l f . _ u p d a t e I n v i s i b l e D O M ( ) ; s e l f . $ e l . f i n d ( ' . o e _ s n i p p e t _ t h u m b n a i l ' ) . r e m o v e C l a s s ( ' o _ w e _ a l r e a d y _ d r a g g i n g ' ) ; } ) ; } e l s e { $ t o I n s e r t . r e m o v e ( ) ; d r a g A n d D r o p R e s o l v e ( ) ; s e l f . $ e l . f i n d ( ' . o e _ s n i p p e t _ t h u m b n a i l ' ) . r e m o v e C l a s s ( ' o _ w e _ a l r e a d y _ d r a g g i n g ' ) ; } } , } , } ) ; t h i s . d r a g g a b l e C o m p o n e n t = n e w   S m o o t h S c r o l l O n D r a g ( t h i s , $ s n i p p e t s , $ ( ) . g e t S c r o l l i n g E l e m e n t ( ) , s m o o t h S c r o l l O p t i o n s ) ; } , _ r e g i s t e r D e f a u l t T e x t s : f u n c t i o n ( $ i n ) { i f ( $ i n = = = u n d e f i n e d ) { $ i n = t h i s . $ s n i p p e t s . f i n d ( ' . o e _ s n i p p e t _ b o d y ' ) ; } 
 $ i n . f i n d ( ' * ' ) . a d d B a c k ( ) . c o n t e n t s ( ) . f i l t e r ( f u n c t i o n ( ) { r e t u r n   t h i s . n o d e T y p e = = = 3 & & t h i s . t e x t C o n t e n t . m a t c h ( / \ S / ) ; } ) . p a r e n t ( ) . a d d C l a s s ( ' o _ d e f a u l t _ s n i p p e t _ t e x t ' ) ; } , _ u p d a t e L e f t P a n e l C o n t e n t : f u n c t i o n ( { c o n t e n t , t a b } ) { c l e a r T i m e o u t ( t h i s . _ t e x t T o o l s S w i t c h i n g T i m e o u t ) ; t h i s . _ c l o s e W i d g e t s ( ) ; t a b = t a b | | t h i s . t a b s . B L O C K S ; i f ( c o n t e n t ) { w h i l e ( t h i s . c u s t o m i z e P a n e l . f i r s t C h i l d ) { t h i s . c u s t o m i z e P a n e l . r e m o v e C h i l d ( t h i s . c u s t o m i z e P a n e l . f i r s t C h i l d ) ; } 
 $ ( t h i s . c u s t o m i z e P a n e l ) . a p p e n d ( c o n t e n t ) ; } 
 t h i s . $ ( ' . o _ s n i p p e t _ s e a r c h _ f i l t e r ' ) . t o g g l e C l a s s ( ' d - n o n e ' , t a b ! = = t h i s . t a b s . B L O C K S ) ; t h i s . $ ( ' # o _ s c r o l l ' ) . t o g g l e C l a s s ( ' d - n o n e ' , t a b ! = = t h i s . t a b s . B L O C K S ) ; t h i s . c u s t o m i z e P a n e l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , t a b = = = t h i s . t a b s . B L O C K S ) ; t h i s . t e x t E d i t o r P a n e l E l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , t a b ! = = t h i s . t a b s . O P T I O N S ) ; t h i s . $ ( ' . o _ w e _ a d d _ s n i p p e t _ b t n ' ) . t o g g l e C l a s s ( ' a c t i v e ' , t a b = = = t h i s . t a b s . B L O C K S ) ; t h i s . $ ( ' . o _ w e _ c u s t o m i z e _ s n i p p e t _ b t n ' ) . t o g g l e C l a s s ( ' a c t i v e ' , t a b = = = t h i s . t a b s . O P T I O N S ) . p r o p ( ' d i s a b l e d ' , t a b ! = = t h i s . t a b s . O P T I O N S ) ; } , a s y n c   _ s c r o l l T o S n i p p e t ( $ e l ) { r e t u r n   d o m . s c r o l l T o ( $ e l [ 0 ] , { e x t r a O f f s e t : 5 0 } ) ; } , _ c r e a t e L o a d i n g E l e m e n t ( ) { c o n s t   l o a d e r C o n t a i n e r = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; c o n s t   l o a d e r = d o c u m e n t . c r e a t e E l e m e n t ( ' i ' ) ; c o n s t   l o a d e r C o n t a i n e r C l a s s L i s t = [ ' o _ w e _ u i _ l o a d i n g ' , ' d - f l e x ' , ' j u s t i f y - c o n t e n t - c e n t e r ' , ' a l i g n - i t e m s - c e n t e r ' , ] ; c o n s t   l o a d e r C l a s s L i s t = [ ' f a ' , ' f a - c i r c l e - o - n o t c h ' , ' f a - s p i n ' , ' f a - 4 x ' , ] ; l o a d e r C o n t a i n e r . c l a s s L i s t . a d d ( . . . l o a d e r C o n t a i n e r C l a s s L i s t ) ; l o a d e r . c l a s s L i s t . a d d ( . . . l o a d e r C l a s s L i s t ) ; l o a d e r C o n t a i n e r . a p p e n d C h i l d ( l o a d e r ) ; r e t u r n   l o a d e r C o n t a i n e r ; } , a s y n c   _ e x e c W i t h L o a d i n g E f f e c t ( a c t i o n , c o n t e n t L o a d i n g = t r u e , d e l a y = 5 0 0 ) { c o n s t   m u t e x E x e c R e s u l t = t h i s . _ m u t e x . e x e c ( a c t i o n ) ; i f ( ! t h i s . l o a d i n g T i m e r s [ c o n t e n t L o a d i n g ] ) { t h i s . l o a d i n g T i m e r s [ c o n t e n t L o a d i n g ] = s e t T i m e o u t ( ( ) = > { t h i s . l o a d i n g E l e m e n t s [ c o n t e n t L o a d i n g ] = t h i s . _ c r e a t e L o a d i n g E l e m e n t ( ) ; i f ( c o n t e n t L o a d i n g ) { t h i s . $ s n i p p e t E d i t o r A r e a . a p p e n d ( t h i s . l o a d i n g E l e m e n t s [ c o n t e n t L o a d i n g ] ) ; } e l s e { t h i s . e l . a p p e n d C h i l d ( t h i s . l o a d i n g E l e m e n t s [ c o n t e n t L o a d i n g ] ) ; } } , d e l a y ) ; t h i s . _ m u t e x . g e t U n l o c k e d D e f ( ) . t h e n ( ( ) = > { c l e a r T i m e o u t ( t h i s . l o a d i n g T i m e r s [ c o n t e n t L o a d i n g ] ) ; t h i s . l o a d i n g T i m e r s [ c o n t e n t L o a d i n g ] = u n d e f i n e d ; i f ( t h i s . l o a d i n g E l e m e n t s [ c o n t e n t L o a d i n g ] ) { t h i s . l o a d i n g E l e m e n t s [ c o n t e n t L o a d i n g ] . r e m o v e ( ) ; t h i s . l o a d i n g E l e m e n t s [ c o n t e n t L o a d i n g ] = n u l l ; } } ) ; } 
 r e t u r n   m u t e x E x e c R e s u l t ; } , _ o n A c t i v a t e I n s e r t i o n Z o n e s : f u n c t i o n ( e v ) { t h i s . _ a c t i v a t e I n s e r t i o n Z o n e s ( e v . d a t a . $ s e l e c t o r S i b l i n g s , e v . d a t a . $ s e l e c t o r C h i l d r e n ) ; } , _ o n A c t i v a t e S n i p p e t : f u n c t i o n ( e v ) { t h i s . _ a c t i v a t e S n i p p e t ( e v . d a t a . $ s n i p p e t , e v . d a t a . p r e v i e w M o d e , e v . d a t a . i f I n a c t i v e O p t i o n s ) ; } , _ o n C a l l F o r E a c h C h i l d S n i p p e t : f u n c t i o n ( e v ) { t h i s . _ c a l l F o r E a c h C h i l d S n i p p e t ( e v . d a t a . $ s n i p p e t , e v . d a t a . c a l l b a c k ) ; } , _ o n O v e r l a y s C o v e r U p d a t e : f u n c t i o n ( ) { t h i s . s n i p p e t E d i t o r s . f o r E a c h ( e d i t o r = > { e d i t o r . c o v e r ( ) ; } ) ; } , _ o n C l o n e S n i p p e t : a s y n c   f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; c o n s t   e d i t o r = a w a i t   t h i s . _ c r e a t e S n i p p e t E d i t o r ( e v . d a t a . $ s n i p p e t ) ; a w a i t   e d i t o r . c l o n e ( ) ; i f ( e v . d a t a . o n S u c c e s s ) { e v . d a t a . o n S u c c e s s ( ) ; } } , _ o n D e a c t i v a t e S n i p p e t : f u n c t i o n ( ) { t h i s . _ a c t i v a t e S n i p p e t ( f a l s e ) ; } , _ o n D r a g A n d D r o p S t o p : a s y n c   f u n c t i o n ( e v ) { a w a i t   t h i s . _ d e s t r o y E d i t o r s ( ) ; a w a i t   t h i s . _ a c t i v a t e S n i p p e t ( e v . d a t a . $ s n i p p e t ) ; } , _ o n G o T o P a r e n t : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; t h i s . _ a c t i v a t e S n i p p e t ( e v . d a t a . $ s n i p p e t . p a r e n t ( ) ) ; } , _ o n H i d e O v e r l a y : f u n c t i o n ( ) { f o r ( c o n s t   e d i t o r   o f   t h i s . s n i p p e t E d i t o r s ) { e d i t o r . t o g g l e O v e r l a y ( f a l s e ) ; } } , _ o n I n s t a l l B t n C l i c k : f u n c t i o n ( e v ) { v a r   s e l f = t h i s ; v a r   $ s n i p p e t = $ ( e v . c u r r e n t T a r g e t ) . c l o s e s t ( ' [ d a t a - m o d u l e - i d ] ' ) ; v a r   m o d u l e I D = $ s n i p p e t . d a t a ( ' m o d u l e I d ' ) ; v a r   n a m e = $ s n i p p e t . a t t r ( ' n a m e ' ) ; n e w   D i a l o g ( t h i s , { t i t l e : _ . s t r . s p r i n t f ( _ t ( " I n s t a l l   % s " ) , n a m e ) , s i z e : ' m e d i u m ' , $ c o n t e n t : $ ( ' < d i v / > ' , { t e x t : _ . s t r . s p r i n t f ( _ t ( " D o   y o u   w a n t   t o   i n s t a l l   t h e   % s   A p p ? " ) , n a m e ) } ) . a p p e n d ( $ ( ' < a / > ' , { t a r g e t : ' _ b l a n k ' , h r e f : ' / w e b # i d = ' + m o d u l e I D + ' & v i e w _ t y p e = f o r m & m o d e l = i r . m o d u l e . m o d u l e & a c t i o n = b a s e . o p e n _ m o d u l e _ t r e e ' , t e x t : _ t ( " M o r e   i n f o   a b o u t   t h i s   a p p . " ) , c l a s s : ' m l 4 ' , } ) ) , b u t t o n s : [ { t e x t : _ t ( " S a v e   a n d   I n s t a l l " ) , c l a s s e s : ' b t n - p r i m a r y ' , c l i c k : f u n c t i o n ( ) { t h i s . $ f o o t e r . f i n d ( ' . b t n ' ) . t o g g l e C l a s s ( ' o _ h i d d e n ' ) ; t h i s . _ r p c ( { m o d e l : ' i r . m o d u l e . m o d u l e ' , m e t h o d : ' b u t t o n _ i m m e d i a t e _ i n s t a l l ' , a r g s : [ [ m o d u l e I D ] ] , } ) . t h e n ( ( ) = > { s e l f . t r i g g e r _ u p ( ' r e q u e s t _ s a v e ' , { r e l o a d E d i t o r : t r u e , _ t o M u t e x : t r u e , } ) ; } ) . g u a r d e d C a t c h ( r e a s o n = > { r e a s o n . e v e n t . p r e v e n t D e f a u l t ( ) ; t h i s . c l o s e ( ) ; s e l f . d i s p l a y N o t i f i c a t i o n ( { m e s s a g e : _ . s t r . s p r i n t f ( _ t ( " C o u l d   n o t   i n s t a l l   m o d u l e   < s t r o n g > % s < / s t r o n g > " ) , n a m e ) , t y p e : ' d a n g e r ' , s t i c k y : t r u e , } ) ; } ) ; } , } , { t e x t : _ t ( " I n s t a l l   i n   p r o g r e s s " ) , i c o n : ' f a - s p i n   f a - s p i n n e r   f a - p u l s e   m r 8 ' , c l a s s e s : ' b t n - p r i m a r y   d i s a b l e d   o _ h i d d e n ' , } , { t e x t : _ t ( " C a n c e l " ) , c l o s e : t r u e , } ] , } ) . o p e n ( ) ; } , _ o n I n v i s i b l e E n t r y C l i c k : a s y n c   f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; c o n s t   $ s n i p p e t = $ ( t h i s . i n v i s i b l e D O M M a p . g e t ( e v . c u r r e n t T a r g e t ) ) ; c o n s t   i s V i s i b l e = a w a i t   t h i s . _ e x e c W i t h L o a d i n g E f f e c t ( a s y n c ( ) = > { c o n s t   e d i t o r = a w a i t   t h i s . _ c r e a t e S n i p p e t E d i t o r ( $ s n i p p e t ) ; r e t u r n   e d i t o r . t o g g l e T a r g e t V i s i b i l i t y ( ) ; } , t r u e ) ; $ ( e v . c u r r e n t T a r g e t ) . f i n d ( ' . f a ' ) . t o g g l e C l a s s ( ' f a - e y e ' , i s V i s i b l e ) . t o g g l e C l a s s ( ' f a - e y e - s l a s h ' , ! i s V i s i b l e ) ; r e t u r n   t h i s . _ a c t i v a t e S n i p p e t ( i s V i s i b l e ? $ s n i p p e t : f a l s e ) ; } , _ o n B l o c k s T a b C l i c k : f u n c t i o n ( e v ) { t h i s . _ a c t i v a t e S n i p p e t ( f a l s e ) . t h e n ( ( ) = > { t h i s . _ u p d a t e L e f t P a n e l C o n t e n t ( { c o n t e n t : [ ] , t a b : t h i s . t a b s . B L O C K S , } ) ; } ) ; } , _ o n D e l e t e B t n C l i c k : f u n c t i o n ( e v ) { c o n s t   $ s n i p p e t = $ ( e v . t a r g e t ) . c l o s e s t ( ' . o e _ s n i p p e t ' ) ; n e w   D i a l o g ( t h i s , { s i z e : ' m e d i u m ' , t i t l e : _ t ( ' C o n f i r m a t i o n ' ) , $ c o n t e n t : $ ( ' < d i v > < p > ' + _ t ( ` A r e   y o u   s u r e   y o u   w a n t   t o   d e l e t e   t h e   s n i p p e t :   $ { $ s n i p p e t . a t t r ( ' n a m e ' ) }   ? ` ) + ' < / p > < / d i v > ' ) , b u t t o n s : [ { t e x t : _ t ( " Y e s " ) , c l o s e : t r u e , c l a s s e s : ' b t n - p r i m a r y ' , c l i c k : a s y n c ( ) = > { a w a i t   t h i s . _ r p c ( { m o d e l : ' i r . u i . v i e w ' , m e t h o d : ' d e l e t e _ s n i p p e t ' , k w a r g s : { ' v i e w _ i d ' : p a r s e I n t ( e v . c u r r e n t T a r g e t . d a t a s e t . s n i p p e t I d ) , ' t e m p l a t e _ k e y ' : t h i s . o p t i o n s . s n i p p e t s , } , } ) ; a w a i t   t h i s . _ l o a d S n i p p e t s T e m p l a t e s ( t r u e ) ; } , } , { t e x t : _ t ( " N o " ) , c l o s e : t r u e , } ] , } ) . o p e n ( ) ; } , _ o n M o u s e D o w n : f u n c t i o n ( ) { c o n s t   $ b l o c k e d A r e a = $ ( ' # w r a p w r a p ' ) ; $ b l o c k e d A r e a . a d d C l a s s ( ' o _ w e _ n o _ p o i n t e r _ e v e n t s ' ) ; c o n s t   r e e n a b l e = ( ) = > $ b l o c k e d A r e a . r e m o v e C l a s s ( ' o _ w e _ n o _ p o i n t e r _ e v e n t s ' ) ; c o n s t   e n a b l e T i m e o u t I D = s e t T i m e o u t ( ( ) = > r e e n a b l e ( ) , 5 0 0 0 ) ; $ ( d o c u m e n t ) . o n e ( ' m o u s e u p ' , ( ) = > { c l e a r T i m e o u t ( e n a b l e T i m e o u t I D ) ; r e e n a b l e ( ) ; } ) ; } , _ o n G e t S n i p p e t V e r s i o n s : f u n c t i o n ( e v ) { c o n s t   s n i p p e t = t h i s . e l . q u e r y S e l e c t o r ( ` . o e _ s n i p p e t   >   [ d a t a - s n i p p e t = " $ { e v . d a t a . s n i p p e t N a m e } " ] ` ) ; e v . d a t a . o n S u c c e s s ( s n i p p e t & & { v c s s : s n i p p e t . d a t a s e t . v c s s , v j s : s n i p p e t . d a t a s e t . v j s , v x m l : s n i p p e t . d a t a s e t . v x m l , } ) ; } , _ o n R e l o a d S n i p p e t T e m p l a t e : a s y n c   f u n c t i o n ( e v ) { a w a i t   t h i s . _ a c t i v a t e S n i p p e t ( f a l s e ) ; a w a i t   t h i s . _ l o a d S n i p p e t s T e m p l a t e s ( t r u e ) ; } , _ o n B l o c k P r e v i e w O v e r l a y s : f u n c t i o n ( e v ) { t h i s . _ b l o c k P r e v i e w O v e r l a y s = t r u e ; } , _ o n U n b l o c k P r e v i e w O v e r l a y s : f u n c t i o n ( e v ) { t h i s . _ b l o c k P r e v i e w O v e r l a y s = f a l s e ; } , _ o n R e m o v e S n i p p e t : a s y n c   f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; c o n s t   e d i t o r = a w a i t   t h i s . _ c r e a t e S n i p p e t E d i t o r ( e v . d a t a . $ s n i p p e t ) ; a w a i t   e d i t o r . r e m o v e S n i p p e t ( ) ; i f ( e v . d a t a . o n S u c c e s s ) { e v . d a t a . o n S u c c e s s ( ) ; } } , _ o n S a v e R e q u e s t : f u n c t i o n ( e v ) { c o n s t   d a t a = e v . d a t a ; i f ( e v . t a r g e t = = = t h i s & & ! d a t a . _ t o M u t e x ) { r e t u r n ; } 
 d e l e t e   d a t a . _ t o M u t e x ; e v . s t o p P r o p a g a t i o n ( ) ; t h i s . _ e x e c W i t h L o a d i n g E f f e c t ( ( ) = > { i f ( d a t a . r e l o a d E d i t o r ) { d a t a . r e l o a d = f a l s e ; c o n s t   o l d O n S u c c e s s = d a t a . o n S u c c e s s ; d a t a . o n S u c c e s s = a s y n c   f u n c t i o n ( ) { i f ( o l d O n S u c c e s s ) { a w a i t   o l d O n S u c c e s s . c a l l ( t h i s , . . . a r g u m e n t s ) ; } 
 w i n d o w . l o c a t i o n . h r e f = w i n d o w . l o c a t i o n . o r i g i n + w i n d o w . l o c a t i o n . p a t h n a m e + ' ? e n a b l e _ e d i t o r = 1 ' ; } ; } 
 t h i s . t r i g g e r _ u p ( ' r e q u e s t _ s a v e ' , d a t a ) ; } , t r u e ) ; } , _ o n S n i p p e t E d i t i o n R e q u e s t : f u n c t i o n ( e v ) { t h i s . _ e x e c W i t h L o a d i n g E f f e c t ( e v . d a t a . e x e c , t r u e ) ; } , _ o n S n i p p e t E d i t o r D e s t r o y e d ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; c o n s t   i n d e x = t h i s . s n i p p e t E d i t o r s . i n d e x O f ( e v . t a r g e t ) ; t h i s . s n i p p e t E d i t o r s . s p l i c e ( i n d e x , 1 ) ; } , _ o n S n i p p e t C l o n e d : f u n c t i o n ( e v ) { t h i s . _ u p d a t e I n v i s i b l e D O M ( ) ; } , _ o n S n i p p e t R e m o v e d : f u n c t i o n ( ) { t h i s . _ d i s a b l e U n d r o p p a b l e S n i p p e t s ( ) ; t h i s . _ u p d a t e I n v i s i b l e D O M ( ) ; } , _ o n S n i p p e t O p t i o n V i s i b i l i t y U p d a t e : a s y n c   f u n c t i o n ( e v ) { i f ( ! e v . d a t a . s h o w ) { a w a i t   t h i s . _ a c t i v a t e S n i p p e t ( f a l s e ) ; } 
 a w a i t   t h i s . _ u p d a t e I n v i s i b l e D O M ( ) ; } , _ o n S n i p p e t T h u m b n a i l U R L R e q u e s t ( e v ) { c o n s t   $ s n i p p e t = t h i s . $ s n i p p e t s . h a s ( ` [ d a t a - s n i p p e t = " $ { e v . d a t a . k e y } " ] ` ) ; e v . d a t a . o n S u c c e s s ( $ s n i p p e t . l e n g t h ? $ s n i p p e t [ 0 ] . d a t a s e t . o e T h u m b n a i l : ' ' ) ; } , _ o n S u m m e r n o t e T o o l s U p d a t e ( e v ) { i f ( ! t h i s . _ t e x t T o o l s S w i t c h i n g E n a b l e d ) { r e t u r n ; } 
 c o n s t   r a n g e = $ . s u m m e r n o t e . c o r e . r a n g e . c r e a t e ( ) ; i f ( ! r a n g e ) { r e t u r n ; } 
 i f ( r a n g e . s c = = = r a n g e . e c & & r a n g e . s c . n o d e T y p e = = = N o d e . E L E M E N T _ N O D E & & r a n g e . s c . c l a s s L i s t . c o n t a i n s ( ' o e _ s t r u c t u r e ' ) & & r a n g e . s c . c h i l d r e n . l e n g t h = = = 0 ) { r e t u r n ; } 
 t h i s . t e x t E d i t o r P a n e l E l . c l a s s L i s t . a d d ( ' d - b l o c k ' ) ; c o n s t   h a s V i s i b l e B u t t o n s = ! ! $ ( t h i s . t e x t E d i t o r P a n e l E l ) . f i n d ( ' . b t n : v i s i b l e ' ) . l e n g t h ; t h i s . t e x t E d i t o r P a n e l E l . c l a s s L i s t . r e m o v e ( ' d - b l o c k ' ) ; i f ( ! h a s V i s i b l e B u t t o n s ) { r e t u r n ; } 
 c l e a r T i m e o u t ( t h i s . _ t e x t T o o l s S w i t c h i n g T i m e o u t ) ; t h i s . _ t e x t T o o l s S w i t c h i n g T i m e o u t = s e t T i m e o u t ( ( ) = > { t h i s . _ u p d a t e L e f t P a n e l C o n t e n t ( { t a b : t h i s . t a b s . O P T I O N S } ) ; } , 2 5 0 ) ; } , _ o n U p d a t e C u s t o m i z e E l e m e n t s : f u n c t i o n ( e v ) { t h i s . _ u p d a t e L e f t P a n e l C o n t e n t ( { c o n t e n t : e v . d a t a . c u s t o m i z e $ E l e m e n t s , t a b : e v . d a t a . c u s t o m i z e $ E l e m e n t s . l e n g t h ? t h i s . t a b s . O P T I O N S : t h i s . t a b s . B L O C K S , } ) ; } , _ o n U s e r V a l u e W i d g e t O p e n i n g : f u n c t i o n ( ) { t h i s . _ c l o s e W i d g e t s ( ) ; t h i s . e l . c l a s s L i s t . a d d ( ' o _ w e _ b a c k d r o p ' ) ; } , _ o n U s e r V a l u e W i d g e t C l o s i n g : f u n c t i o n ( ) { t h i s . e l . c l a s s L i s t . r e m o v e ( ' o _ w e _ b a c k d r o p ' ) ; } , _ o n S n i p p e t S e a r c h I n p u t : f u n c t i o n ( ) { t h i s . _ f i l t e r S n i p p e t s ( ) ; } , _ o n S n i p p e t S e a r c h R e s e t C l i c k : f u n c t i o n ( ) { t h i s . _ f i l t e r S n i p p e t s ( ' ' ) ; } , } ) ; r e t u r n { C l a s s : S n i p p e t s M e n u , E d i t o r : S n i p p e t E d i t o r , g l o b a l S e l e c t o r : g l o b a l S e l e c t o r , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / e d i t o r / s n i p p e t s . o p t i o n s . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . s n i p p e t s . o p t i o n s ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; c o n s t { C o l o r p i c k e r W i d g e t } = r e q u i r e ( ' w e b . C o l o r p i c k e r ' ) ; c o n s t   D i a l o g = r e q u i r e ( ' w e b . D i a l o g ' ) ; c o n s t   t i m e = r e q u i r e ( ' w e b . t i m e ' ) ; v a r   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; v a r   C o l o r P a l e t t e W i d g e t = r e q u i r e ( ' w e b _ e d i t o r . C o l o r P a l e t t e ' ) . C o l o r P a l e t t e W i d g e t ; c o n s t   w e U t i l s = r e q u i r e ( ' w e b _ e d i t o r . u t i l s ' ) ; c o n s t { n o r m a l i z e C o l o r , g e t B g I m a g e U R L , } = w e U t i l s ; v a r   w e W i d g e t s = r e q u i r e ( ' w y s i w y g . w i d g e t s ' ) ; c o n s t { l o a d I m a g e , l o a d I m a g e I n f o , a p p l y M o d i f i c a t i o n s , r e m o v e O n I m a g e C h a n g e A t t r s , } = r e q u i r e ( ' w e b _ e d i t o r . i m a g e _ p r o c e s s i n g ' ) ; v a r   q w e b = c o r e . q w e b ; v a r   _ t = c o r e . _ t ; f u n c t i o n   _ a d d T i t l e A n d A l l o w e d A t t r i b u t e s ( e l , t i t l e , o p t i o n s ) { l e t   t o o l t i p E l = e l ; i f ( t i t l e ) { c o n s t   t i t l e E l = _ b u i l d T i t l e E l e m e n t ( t i t l e ) ; t o o l t i p E l = t i t l e E l ; e l . a p p e n d C h i l d ( t i t l e E l ) ; } 
 i f ( o p t i o n s & & o p t i o n s . c l a s s e s ) { e l . c l a s s L i s t . a d d ( . . . o p t i o n s . c l a s s e s ) ; } 
 i f ( o p t i o n s & & o p t i o n s . t o o l t i p ) { t o o l t i p E l . t i t l e = o p t i o n s . t o o l t i p ; } 
 i f ( o p t i o n s & & o p t i o n s . p l a c e h o l d e r ) { e l . s e t A t t r i b u t e ( ' p l a c e h o l d e r ' , o p t i o n s . p l a c e h o l d e r ) ; } 
 i f ( o p t i o n s & & o p t i o n s . d a t a A t t r i b u t e s ) { f o r ( c o n s t   k e y   i n   o p t i o n s . d a t a A t t r i b u t e s ) { e l . d a t a s e t [ k e y ] = o p t i o n s . d a t a A t t r i b u t e s [ k e y ] ; } } 
 r e t u r n   e l ; } 
 f u n c t i o n   _ b u i l d E l e m e n t ( t a g N a m e , t i t l e , o p t i o n s ) { c o n s t   e l = d o c u m e n t . c r e a t e E l e m e n t ( t a g N a m e ) ; r e t u r n   _ a d d T i t l e A n d A l l o w e d A t t r i b u t e s ( e l , t i t l e , o p t i o n s ) ; } 
 f u n c t i o n   _ b u i l d T i t l e E l e m e n t ( t i t l e ) { c o n s t   t i t l e E l = d o c u m e n t . c r e a t e E l e m e n t ( ' w e - t i t l e ' ) ; t i t l e E l . t e x t C o n t e n t = t i t l e ; r e t u r n   t i t l e E l ; } 
 a s y n c   f u n c t i o n   _ b u i l d I m g E l e m e n t ( s r c ) { i f ( s r c . s p l i t ( ' . ' ) . p o p ( ) = = = ' s v g ' ) { c o n s t   r e s p o n s e = a w a i t   w i n d o w . f e t c h ( s r c ) ; c o n s t   t e x t = a w a i t   r e s p o n s e . t e x t ( ) ; c o n s t   p a r s e r = n e w   w i n d o w . D O M P a r s e r ( ) ; c o n s t   x m l D o c = p a r s e r . p a r s e F r o m S t r i n g ( t e x t , ' t e x t / x m l ' ) ; r e t u r n   x m l D o c . g e t E l e m e n t s B y T a g N a m e ( ' s v g ' ) [ 0 ] ; } 
 c o n s t   i m g E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; i m g E l . s r c = s r c ; r e t u r n   i m g E l ; } 
 f u n c t i o n   _ b u i l d R o w E l e m e n t ( t i t l e , o p t i o n s ) { c o n s t   g r o u p E l = _ b u i l d E l e m e n t ( ' w e - r o w ' , t i t l e , o p t i o n s ) ; c o n s t   r o w E l = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; g r o u p E l . a p p e n d C h i l d ( r o w E l ) ; i f ( o p t i o n s & & o p t i o n s . c h i l d N o d e s ) { o p t i o n s . c h i l d N o d e s . f o r E a c h ( n o d e = > r o w E l . a p p e n d C h i l d ( n o d e ) ) ; } 
 r e t u r n   g r o u p E l ; } 
 f u n c t i o n   _ b u i l d C o l l a p s e E l e m e n t ( t i t l e , o p t i o n s ) { c o n s t   g r o u p E l = _ b u i l d E l e m e n t ( ' w e - c o l l a p s e ' , t i t l e , o p t i o n s ) ; c o n s t   t i t l e E l = g r o u p E l . q u e r y S e l e c t o r ( ' w e - t i t l e ' ) ; c o n s t   c h i l d r e n = o p t i o n s & & o p t i o n s . c h i l d N o d e s | | [ ] ; i f ( t i t l e E l ) { t i t l e E l . r e m o v e ( ) ; c h i l d r e n . u n s h i f t ( t i t l e E l ) ; } 
 l e t   i = 0 ; f o r ( i = 0 ; i < c h i l d r e n . l e n g t h ; i + + ) { g r o u p E l . a p p e n d C h i l d ( c h i l d r e n [ i ] ) ; i f ( c h i l d r e n [ i ] . n o d e T y p e = = = N o d e . E L E M E N T _ N O D E ) { b r e a k ; } } 
 c o n s t   t o g g l e r E l = d o c u m e n t . c r e a t e E l e m e n t ( ' w e - t o g g l e r ' ) ; t o g g l e r E l . c l a s s L i s t . a d d ( ' o _ w e _ c o l l a p s e _ t o g g l e r ' ) ; g r o u p E l . a p p e n d C h i l d ( t o g g l e r E l ) ; c o n s t   c o n t a i n e r E l = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; c h i l d r e n . s l i c e ( i + 1 ) . f o r E a c h ( n o d e = > c o n t a i n e r E l . a p p e n d C h i l d ( n o d e ) ) ; g r o u p E l . a p p e n d C h i l d ( c o n t a i n e r E l ) ; r e t u r n   g r o u p E l ; } 
 f u n c t i o n   c r e a t e P r o p e r t y P r o x y ( o b j , p r o p e r t y N a m e , v a l u e ) { r e t u r n   n e w   P r o x y ( o b j , { g e t : f u n c t i o n ( o b j , p r o p ) { i f ( p r o p = = = p r o p e r t y N a m e ) { r e t u r n   v a l u e ; } 
 r e t u r n   o b j [ p r o p ] ; } , s e t : f u n c t i o n ( o b j , p r o p , v a l ) { i f ( p r o p = = = p r o p e r t y N a m e ) { r e t u r n ( v a l u e = v a l ) ; } 
 r e t u r n   R e f l e c t . s e t ( . . . a r g u m e n t s ) ; } , } ) ; } 
 c o n s t   N U L L _ I D = ' _ _ N U L L _ _ ' ; c o n s t   U s e r V a l u e W i d g e t = W i d g e t . e x t e n d ( { c l a s s N a m e : ' o _ w e _ u s e r _ v a l u e _ w i d g e t ' , c u s t o m _ e v e n t s : { ' u s e r _ v a l u e _ u p d a t e ' : ' _ o n U s e r V a l u e N o t i f i c a t i o n ' , } , i n i t : f u n c t i o n ( p a r e n t , t i t l e , o p t i o n s , $ t a r g e t ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . t i t l e = t i t l e ; t h i s . o p t i o n s = o p t i o n s ; t h i s . _ u s e r V a l u e W i d g e t s = [ ] ; t h i s . _ v a l u e = ' ' ; t h i s . $ t a r g e t = $ t a r g e t ; } , a s y n c   w i l l S t a r t ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; i f ( t h i s . o p t i o n s . d a t a A t t r i b u t e s . i m g ) { t h i s . i m g E l = a w a i t   _ b u i l d I m g E l e m e n t ( t h i s . o p t i o n s . d a t a A t t r i b u t e s . i m g ) ; } } , _ m a k e D e s c r i p t i v e : f u n c t i o n ( ) { c o n s t   $ e l = t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   e l = $ e l [ 0 ] ; _ a d d T i t l e A n d A l l o w e d A t t r i b u t e s ( e l , t h i s . t i t l e , t h i s . o p t i o n s ) ; t h i s . c o n t a i n e r E l = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; i f ( t h i s . i m g E l ) { t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( t h i s . i m g E l ) ; } 
 e l . a p p e n d C h i l d ( t h i s . c o n t a i n e r E l ) ; r e t u r n   $ e l ; } , a s y n c   s t a r t ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; i f ( t h i s . e l . c l a s s L i s t . c o n t a i n s ( ' o _ w e _ i m g _ a n i m a t e ' ) ) { c o n s t   b u i l d I m g E x t e n s i o n S w i t c h e r = ( f r o m , t o ) = > { c o n s t   r e g e x = n e w   R e g E x p ( ` $ { f r o m } $ ` , ' i ' ) ; r e t u r n   e v = > { c o n s t   i m g = e v . c u r r e n t T a r g e t . g e t E l e m e n t s B y T a g N a m e ( " i m g " ) [ 0 ] ; i m g . s r c = i m g . s r c . r e p l a c e ( r e g e x , t o ) ; } ; } ; t h i s . $ e l . o n ( ' m o u s e e n t e r . i m g _ a n i m a t e ' , b u i l d I m g E x t e n s i o n S w i t c h e r ( ' p n g ' , ' g i f ' ) ) ; t h i s . $ e l . o n ( ' m o u s e l e a v e . i m g _ a n i m a t e ' , b u i l d I m g E x t e n s i o n S w i t c h e r ( ' g i f ' , ' p n g ' ) ) ; } } , d e s t r o y ( ) { i f ( t h i s . $ e l ) { t h i s . $ e l . o f f ( ' . i m g _ a n i m a t e ' ) ; } 
 t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , c l o s e : f u n c t i o n ( ) { t h i s . t r i g g e r _ u p ( ' u s e r _ v a l u e _ w i d g e t _ c l o s i n g ' ) ; t h i s . e l . c l a s s L i s t . r e m o v e ( ' o _ w e _ w i d g e t _ o p e n e d ' ) ; t h i s . _ u s e r V a l u e W i d g e t s . f o r E a c h ( w i d g e t = > w i d g e t . c l o s e ( ) ) ; } , f i n d W i d g e t : f u n c t i o n ( n a m e ) { f o r ( c o n s t   w i d g e t   o f   t h i s . _ u s e r V a l u e W i d g e t s ) { i f ( w i d g e t . g e t N a m e ( ) = = = n a m e ) { r e t u r n   w i d g e t ; } 
 c o n s t   d e p W i d g e t = w i d g e t . f i n d W i d g e t ( n a m e ) ; i f ( d e p W i d g e t ) { r e t u r n   d e p W i d g e t ; } } 
 r e t u r n   n u l l ; } , g e t A c t i v e V a l u e : f u n c t i o n ( m e t h o d N a m e ) { r e t u r n   t h i s . _ v a l u e ; } , g e t D e f a u l t V a l u e : f u n c t i o n ( m e t h o d N a m e ) { c o n s t   p o s s i b l e V a l u e s = t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] ; r e t u r n   p o s s i b l e V a l u e s & & p o s s i b l e V a l u e s [ 0 ] | | ' ' ; } , g e t D e p e n d e n c i e s : f u n c t i o n ( ) { r e t u r n   t h i s . _ d e p e n d e n c i e s ; } , g e t M e t h o d s N a m e s : f u n c t i o n ( ) { r e t u r n   t h i s . _ m e t h o d s N a m e s ; } , g e t M e t h o d s P a r a m s : f u n c t i o n ( m e t h o d N a m e ) { c o n s t   p a r a m s = _ . e x t e n d ( { } , t h i s . _ m e t h o d s P a r a m s ) ; i f ( m e t h o d N a m e ) { p a r a m s . p o s s i b l e V a l u e s = p a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] | | [ ] ; p a r a m s . a c t i v e V a l u e = t h i s . g e t A c t i v e V a l u e ( m e t h o d N a m e ) ; p a r a m s . d e f a u l t V a l u e = t h i s . g e t D e f a u l t V a l u e ( m e t h o d N a m e ) ; } 
 r e t u r n   p a r a m s ; } , g e t N a m e : f u n c t i o n ( ) { r e t u r n   t h i s . _ m e t h o d s P a r a m s . n a m e | | ' ' ; } , g e t V a l u e : f u n c t i o n ( m e t h o d N a m e ) { c o n s t   i s A c t i v e = t h i s . i s A c t i v e ( ) ; i f ( ! m e t h o d N a m e | | ! t h i s . _ m e t h o d s N a m e s . i n c l u d e s ( m e t h o d N a m e ) ) { r e t u r n   i s A c t i v e ? ' t r u e ' : ' ' ; } 
 i f ( i s A c t i v e ) { r e t u r n   t h i s . g e t A c t i v e V a l u e ( m e t h o d N a m e ) ; } 
 r e t u r n   t h i s . g e t D e f a u l t V a l u e ( m e t h o d N a m e ) ; } , i s A c t i v e : f u n c t i o n ( ) { r e t u r n   t h i s . _ v a l u e & & t h i s . _ v a l u e ! = = N U L L _ I D ; } , i s C o n t a i n e r : f u n c t i o n ( ) { r e t u r n   f a l s e ; } , i s P r e v i e w e d : f u n c t i o n ( ) { c o n s t   f o c u s E l = d o c u m e n t . a c t i v e E l e m e n t ; i f ( f o c u s E l & & f o c u s E l . t a g N a m e = = = ' I N P U T ' & & ( t h i s . e l = = = f o c u s E l | | t h i s . e l . c o n t a i n s ( f o c u s E l ) ) ) { r e t u r n   t r u e ; } 
 r e t u r n   t h i s . e l . c l a s s L i s t . c o n t a i n s ( ' o _ w e _ p r e v i e w ' ) ; } , l o a d M e t h o d s D a t a : f u n c t i o n ( v a l i d M e t h o d N a m e s , e x t r a P a r a m s ) { t h i s . _ m e t h o d s N a m e s = [ ] ; t h i s . _ m e t h o d s P a r a m s = _ . e x t e n d ( { } , e x t r a P a r a m s ) ; t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s = { } ; t h i s . _ d e p e n d e n c i e s = [ ] ; t h i s . _ t r i g g e r W i d g e t s N a m e s = [ ] ; t h i s . _ t r i g g e r W i d g e t s V a l u e s = [ ] ; f o r ( c o n s t   k e y   i n   t h i s . e l . d a t a s e t ) { c o n s t   d a t a V a l u e = t h i s . e l . d a t a s e t [ k e y ] . t r i m ( ) ; i f ( k e y = = = ' d e p e n d e n c i e s ' ) { t h i s . _ d e p e n d e n c i e s . p u s h ( . . . d a t a V a l u e . s p l i t ( / \ s * , \ s * / g ) ) ; } e l s e   i f ( k e y = = = ' t r i g g e r ' ) { t h i s . _ t r i g g e r W i d g e t s N a m e s . p u s h ( . . . d a t a V a l u e . s p l i t ( / \ s * , \ s * / g ) ) ; } e l s e   i f ( k e y = = = ' t r i g g e r V a l u e ' ) { t h i s . _ t r i g g e r W i d g e t s V a l u e s . p u s h ( . . . d a t a V a l u e . s p l i t ( / \ s * , \ s * / g ) ) ; } e l s e   i f ( v a l i d M e t h o d N a m e s . i n c l u d e s ( k e y ) ) { t h i s . _ m e t h o d s N a m e s . p u s h ( k e y ) ; t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ k e y ] = d a t a V a l u e . s p l i t ( / \ s * \ | \ s * / g ) ; } e l s e { t h i s . _ m e t h o d s P a r a m s [ k e y ] = d a t a V a l u e ; } } 
 t h i s . _ u s e r V a l u e W i d g e t s . f o r E a c h ( w i d g e t = > { c o n s t   i n h e r i t e d P a r a m s = _ . e x t e n d ( { } , t h i s . _ m e t h o d s P a r a m s ) ; i n h e r i t e d P a r a m s . o p t i o n s P o s s i b l e V a l u e s = n u l l ; w i d g e t . l o a d M e t h o d s D a t a ( v a l i d M e t h o d N a m e s , i n h e r i t e d P a r a m s ) ; c o n s t   s u b M e t h o d s N a m e s = w i d g e t . g e t M e t h o d s N a m e s ( ) ; c o n s t   s u b M e t h o d s P a r a m s = w i d g e t . g e t M e t h o d s P a r a m s ( ) ; f o r ( c o n s t   m e t h o d N a m e   o f   s u b M e t h o d s N a m e s ) { i f ( ! t h i s . _ m e t h o d s N a m e s . i n c l u d e s ( m e t h o d N a m e ) ) { t h i s . _ m e t h o d s N a m e s . p u s h ( m e t h o d N a m e ) ; t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] = [ ] ; } 
 f o r ( c o n s t   s u b P o s s i b l e V a l u e   o f   s u b M e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] ) { t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] . p u s h ( s u b P o s s i b l e V a l u e ) ; } } } ) ; f o r ( c o n s t   m e t h o d N a m e   o f   t h i s . _ m e t h o d s N a m e s ) { c o n s t   a r r = t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] ; c o n s t   u n i q A r r = a r r . f i l t e r ( ( v , i , a r r ) = > i = = = a r r . i n d e x O f ( v ) ) ; t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] = u n i q A r r ; } } , n o t i f y V a l u e C h a n g e : f u n c t i o n ( p r e v i e w M o d e , i s S i m u l a t e d E v e n t ) { i f ( ! t h i s . _ m e t h o d s N a m e s . l e n g t h ) { r e t u r n ; } 
 c o n s t   i s P r e v i e w e d = t h i s . i s P r e v i e w e d ( ) ; i f ( ! p r e v i e w M o d e & & ! i s P r e v i e w e d ) { t h i s . n o t i f y V a l u e C h a n g e ( t r u e ) ; } 
 c o n s t   d a t a = { p r e v i e w M o d e : p r e v i e w M o d e | | f a l s e , i s S i m u l a t e d E v e n t : ! ! i s S i m u l a t e d E v e n t , } ; i f ( p r e v i e w M o d e = = = t r u e | | p r e v i e w M o d e = = = f a l s e ) { d a t a . p r e p a r e = ( ) = > t h i s . e l . c l a s s L i s t . a d d ( ' o _ w e _ p r e v i e w ' ) ; } e l s e   i f ( p r e v i e w M o d e = = = ' r e s e t ' ) { d a t a . p r e p a r e = ( ) = > t h i s . e l . c l a s s L i s t . r e m o v e ( ' o _ w e _ p r e v i e w ' ) ; } 
 t h i s . t r i g g e r _ u p ( ' u s e r _ v a l u e _ u p d a t e ' , d a t a ) ; } , o p e n ( ) { t h i s . t r i g g e r _ u p ( ' u s e r _ v a l u e _ w i d g e t _ o p e n i n g ' ) ; t h i s . e l . c l a s s L i s t . a d d ( ' o _ w e _ w i d g e t _ o p e n e d ' ) ; } , r e g i s t e r S u b W i d g e t : f u n c t i o n ( w i d g e t ) { t h i s . _ u s e r V a l u e W i d g e t s . p u s h ( w i d g e t ) ; } , a s y n c   s e t V a l u e ( v a l u e , m e t h o d N a m e ) { t h i s . _ v a l u e = v a l u e ; t h i s . e l . c l a s s L i s t . r e m o v e ( ' o _ w e _ p r e v i e w ' ) ; } , t o g g l e V i s i b i l i t y : f u n c t i o n ( s h o w ) { t h i s . e l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , ! s h o w ) ; } , _ h a n d l e N o t i f i e r E v e n t : f u n c t i o n ( e v ) { i f ( ! e v ) { r e t u r n   t r u e ; } 
 i f ( e v . _ s e e n ) { r e t u r n   f a l s e ; } 
 e v . _ s e e n = t r u e ; i f ( e v . p r e v e n t D e f a u l t ) { e v . p r e v e n t D e f a u l t ( ) ; } 
 r e t u r n   t r u e ; } , _ o n U s e r V a l u e C h a n g e : f u n c t i o n ( e v ) { i f ( t h i s . _ h a n d l e N o t i f i e r E v e n t ( e v ) ) { t h i s . n o t i f y V a l u e C h a n g e ( f a l s e ) ; } } , _ o n U s e r V a l u e N o t i f i c a t i o n : f u n c t i o n ( e v ) { e v . d a t a . w i d g e t = t h i s ; i f ( ! e v . d a t a . t r i g g e r W i d g e t s N a m e s ) { e v . d a t a . t r i g g e r W i d g e t s N a m e s = [ ] ; } 
 e v . d a t a . t r i g g e r W i d g e t s N a m e s . p u s h ( . . . t h i s . _ t r i g g e r W i d g e t s N a m e s ) ; i f ( ! e v . d a t a . t r i g g e r W i d g e t s V a l u e s ) { e v . d a t a . t r i g g e r W i d g e t s V a l u e s = [ ] ; } 
 e v . d a t a . t r i g g e r W i d g e t s V a l u e s . p u s h ( . . . t h i s . _ t r i g g e r W i d g e t s V a l u e s ) ; } , _ o n U s e r V a l u e P r e v i e w : f u n c t i o n ( e v ) { i f ( t h i s . _ h a n d l e N o t i f i e r E v e n t ( e v ) ) { t h i s . n o t i f y V a l u e C h a n g e ( t r u e ) ; } } , _ o n U s e r V a l u e R e s e t : f u n c t i o n ( e v ) { i f ( t h i s . _ h a n d l e N o t i f i e r E v e n t ( e v ) ) { t h i s . n o t i f y V a l u e C h a n g e ( ' r e s e t ' ) ; } } , } ) ; c o n s t   B u t t o n U s e r V a l u e W i d g e t = U s e r V a l u e W i d g e t . e x t e n d ( { t a g N a m e : ' w e - b u t t o n ' , e v e n t s : { ' c l i c k ' : ' _ o n B u t t o n C l i c k ' , ' c l i c k   [ r o l e = " b u t t o n " ] ' : ' _ o n I n n e r B u t t o n C l i c k ' , ' m o u s e e n t e r ' : ' _ o n U s e r V a l u e P r e v i e w ' , ' m o u s e l e a v e ' : ' _ o n U s e r V a l u e R e s e t ' , } , s t a r t : f u n c t i o n ( p a r e n t , t i t l e , o p t i o n s ) { i f ( t h i s . o p t i o n s & & t h i s . o p t i o n s . c h i l d N o d e s ) { t h i s . o p t i o n s . c h i l d N o d e s . f o r E a c h ( n o d e = > t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( n o d e ) ) ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , g e t A c t i v e V a l u e : f u n c t i o n ( m e t h o d N a m e ) { c o n s t   p o s s i b l e V a l u e s = t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] ; r e t u r n   p o s s i b l e V a l u e s & & p o s s i b l e V a l u e s [ p o s s i b l e V a l u e s . l e n g t h - 1 ] | | ' ' ; } , i s A c t i v e : f u n c t i o n ( ) { r e t u r n ( t h i s . i s P r e v i e w e d ( ) ! = = t h i s . e l . c l a s s L i s t . c o n t a i n s ( ' a c t i v e ' ) ) ; } , l o a d M e t h o d s D a t a : f u n c t i o n ( v a l i d M e t h o d N a m e s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; f o r ( c o n s t   m e t h o d N a m e   o f   t h i s . _ m e t h o d s N a m e s ) { c o n s t   p o s s i b l e V a l u e s = t h i s . _ m e t h o d s P a r a m s . o p t i o n s P o s s i b l e V a l u e s [ m e t h o d N a m e ] ; i f ( p o s s i b l e V a l u e s . l e n g t h < = 1 ) { p o s s i b l e V a l u e s . u n s h i f t ( ' ' ) ; } } } , a s y n c   s e t V a l u e ( v a l u e , m e t h o d N a m e ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; l e t   a c t i v e = ! ! v a l u e ; i f ( m e t h o d N a m e ) { i f ( ! t h i s . _ m e t h o d s N a m e s . i n c l u d e s ( m e t h o d N a m e ) ) { r e t u r n ; } 
 a c t i v e = ( t h i s . g e t A c t i v e V a l u e ( m e t h o d N a m e ) = = = v a l u e ) ; } 
 t h i s . e l . c l a s s L i s t . t o g g l e ( ' a c t i v e ' , a c t i v e ) ; } , _ o n B u t t o n C l i c k : f u n c t i o n ( e v ) { i f ( ! e v . _ i n n e r B u t t o n C l i c k e d ) { t h i s . _ o n U s e r V a l u e C h a n g e ( e v ) ; } } , _ o n I n n e r B u t t o n C l i c k : f u n c t i o n ( e v ) { e v . _ i n n e r B u t t o n C l i c k e d = t r u e ; } , } ) ; c o n s t   C h e c k b o x U s e r V a l u e W i d g e t = B u t t o n U s e r V a l u e W i d g e t . e x t e n d ( { c l a s s N a m e : ( B u t t o n U s e r V a l u e W i d g e t . p r o t o t y p e . c l a s s N a m e | | ' ' ) + '   o _ w e _ c h e c k b o x _ w r a p p e r ' , s t a r t : f u n c t i o n ( ) { c o n s t   c h e c k b o x E l = d o c u m e n t . c r e a t e E l e m e n t ( ' w e - c h e c k b o x ' ) ; t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( c h e c k b o x E l ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ o n B u t t o n C l i c k ( e v ) { i f ( ! e v . t a r g e t . c l o s e s t ( ' w e - t i t l e ,   w e - c h e c k b o x ' ) ) { r e t u r n ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , } ) ; c o n s t   B a s e S e l e c t i o n U s e r V a l u e W i d g e t = U s e r V a l u e W i d g e t . e x t e n d ( { a s y n c   s t a r t ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . m e n u E l = d o c u m e n t . c r e a t e E l e m e n t ( ' w e - s e l e c t i o n - i t e m s ' ) ; i f ( t h i s . o p t i o n s & & t h i s . o p t i o n s . c h i l d N o d e s ) { t h i s . o p t i o n s . c h i l d N o d e s . f o r E a c h ( n o d e = > t h i s . m e n u E l . a p p e n d C h i l d ( n o d e ) ) ; } 
 t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( t h i s . m e n u E l ) ; } , g e t M e t h o d s P a r a m s ( m e t h o d N a m e ) { c o n s t   p a r a m s = t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   a c t i v e W i d g e t = t h i s . _ g e t A c t i v e S u b W i d g e t ( ) ; i f ( ! a c t i v e W i d g e t ) { r e t u r n   p a r a m s ; } 
 r e t u r n   O b j e c t . a s s i g n ( a c t i v e W i d g e t . g e t M e t h o d s P a r a m s ( . . . a r g u m e n t s ) , p a r a m s ) ; } , g e t V a l u e ( m e t h o d N a m e ) { c o n s t   a c t i v e W i d g e t = t h i s . _ g e t A c t i v e S u b W i d g e t ( ) ; i f ( a c t i v e W i d g e t ) { r e t u r n   a c t i v e W i d g e t . g e t A c t i v e V a l u e ( m e t h o d N a m e ) ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , i s C o n t a i n e r ( ) { r e t u r n   t r u e ; } , a s y n c   s e t V a l u e ( v a l u e , m e t h o d N a m e ) { c o n s t   _ s u p e r = t h i s . _ s u p e r . b i n d ( t h i s ) ; f o r ( c o n s t   w i d g e t   o f   t h i s . _ u s e r V a l u e W i d g e t s ) { a w a i t   w i d g e t . s e t V a l u e ( N U L L _ I D , m e t h o d N a m e ) ; } 
 f o r ( c o n s t   w i d g e t   o f [ . . . t h i s . _ u s e r V a l u e W i d g e t s ] . r e v e r s e ( ) ) { a w a i t   w i d g e t . s e t V a l u e ( v a l u e , m e t h o d N a m e ) ; i f ( w i d g e t . i s A c t i v e ( ) ) { r e t u r n ; } } 
 a w a i t   _ s u p e r ( . . . a r g u m e n t s ) ; } , _ g e t A c t i v e S u b W i d g e t ( ) { c o n s t   p r e v i e w e d W i d g e t = t h i s . _ u s e r V a l u e W i d g e t s . f i n d ( w i d g e t = > w i d g e t . i s P r e v i e w e d ( ) ) ; i f ( p r e v i e w e d W i d g e t ) { r e t u r n   p r e v i e w e d W i d g e t ; } 
 r e t u r n   t h i s . _ u s e r V a l u e W i d g e t s . f i n d ( w i d g e t = > w i d g e t . i s A c t i v e ( ) ) ; } , } ) ; c o n s t   S e l e c t U s e r V a l u e W i d g e t = B a s e S e l e c t i o n U s e r V a l u e W i d g e t . e x t e n d ( { t a g N a m e : ' w e - s e l e c t ' , e v e n t s : { ' c l i c k ' : ' _ o n C l i c k ' , } , a s y n c   s t a r t ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; i f ( t h i s . o p t i o n s & & t h i s . o p t i o n s . v a l u e E l ) { t h i s . c o n t a i n e r E l . i n s e r t B e f o r e ( t h i s . o p t i o n s . v a l u e E l , t h i s . m e n u E l ) ; } 
 t h i s . m e n u T o g g l e r E l = d o c u m e n t . c r e a t e E l e m e n t ( ' w e - t o g g l e r ' ) ; t h i s . i c o n = t h i s . e l . d a t a s e t . i c o n | | f a l s e ; i f ( t h i s . i c o n ) { t h i s . e l . c l a s s L i s t . a d d ( ' o _ w e _ i c o n _ s e l e c t ' ) ; c o n s t   i c o n E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i ' ) ; i c o n E l . c l a s s L i s t . a d d ( ' f a ' , ' f a - f w ' , t h i s . i c o n ) ; t h i s . m e n u T o g g l e r E l . a p p e n d C h i l d ( i c o n E l ) ; } 
 t h i s . c o n t a i n e r E l . i n s e r t B e f o r e ( t h i s . m e n u T o g g l e r E l , t h i s . m e n u E l ) ; c o n s t   d r o p d o w n C a r e t E l = d o c u m e n t . c r e a t e E l e m e n t ( ' s p a n ' ) ; d r o p d o w n C a r e t E l . c l a s s L i s t . a d d ( ' o _ w e _ d r o p d o w n _ c a r e t ' ) ; t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( d r o p d o w n C a r e t E l ) ; } , c l o s e : f u n c t i o n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . m e n u T o g g l e r E l . c l a s s L i s t . r e m o v e ( ' a c t i v e ' ) ; } , i s P r e v i e w e d : f u n c t i o n ( ) { r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) | | t h i s . m e n u T o g g l e r E l . c l a s s L i s t . c o n t a i n s ( ' a c t i v e ' ) ; } , o p e n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . m e n u T o g g l e r E l . c l a s s L i s t . a d d ( ' a c t i v e ' ) ; } , a s y n c   s e t V a l u e ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; i f ( t h i s . i c o n ) { r e t u r n ; } 
 i f ( t h i s . m e n u T o g g l e r I t e m E l ) { t h i s . m e n u T o g g l e r I t e m E l . r e m o v e ( ) ; t h i s . m e n u T o g g l e r I t e m E l = n u l l ; } 
 l e t   t e x t C o n t e n t = ' ' ; c o n s t   a c t i v e W i d g e t = t h i s . _ u s e r V a l u e W i d g e t s . f i n d ( w i d g e t = > ! w i d g e t . i s P r e v i e w e d ( ) & & w i d g e t . i s A c t i v e ( ) ) ; i f ( a c t i v e W i d g e t ) { c o n s t   s v g T a g = a c t i v e W i d g e t . e l . q u e r y S e l e c t o r ( ' s v g ' ) ; c o n s t   v a l u e = ( a c t i v e W i d g e t . e l . d a t a s e t . s e l e c t L a b e l | | ( ! s v g T a g & & a c t i v e W i d g e t . e l . t e x t C o n t e n t . t r i m ( ) ) ) ; c o n s t   i m g S r c = a c t i v e W i d g e t . e l . d a t a s e t . i m g ; i f ( v a l u e ) { t e x t C o n t e n t = v a l u e ; } e l s e   i f ( i m g S r c ) { t h i s . m e n u T o g g l e r I t e m E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; t h i s . m e n u T o g g l e r I t e m E l . s r c = i m g S r c ; } e l s e { c o n s t   f a k e I m g E l = a c t i v e W i d g e t . e l . q u e r y S e l e c t o r ( ' . o _ w e _ f a k e _ i m g _ i t e m ' ) ; i f ( f a k e I m g E l ) { t h i s . m e n u T o g g l e r I t e m E l = f a k e I m g E l . c l o n e N o d e ( t r u e ) ; } } } e l s e { t e x t C o n t e n t = " / " ; } 
 t h i s . m e n u T o g g l e r E l . t e x t C o n t e n t = t e x t C o n t e n t ; i f ( t h i s . m e n u T o g g l e r I t e m E l ) { t h i s . m e n u T o g g l e r E l . a p p e n d C h i l d ( t h i s . m e n u T o g g l e r I t e m E l ) ; } } , _ o n C l i c k : f u n c t i o n ( e v ) { i f ( e v . t a r g e t . c l o s e s t ( ' [ r o l e = " b u t t o n " ] ' ) ) { r e t u r n ; } 
 i f ( ! t h i s . m e n u T o g g l e r E l . c l a s s L i s t . c o n t a i n s ( ' a c t i v e ' ) ) { t h i s . o p e n ( ) ; } e l s e { t h i s . c l o s e ( ) ; } 
 c o n s t   a c t i v e B u t t o n = t h i s . _ u s e r V a l u e W i d g e t s . f i n d ( w i d g e t = > w i d g e t . i s A c t i v e ( ) ) ; i f ( a c t i v e B u t t o n ) { t h i s . m e n u E l . s c r o l l T o p = a c t i v e B u t t o n . e l . o f f s e t T o p - ( t h i s . m e n u E l . o f f s e t H e i g h t / 2 ) ; } } , } ) ; c o n s t   B u t t o n G r o u p U s e r V a l u e W i d g e t = B a s e S e l e c t i o n U s e r V a l u e W i d g e t . e x t e n d ( { t a g N a m e : ' w e - b u t t o n - g r o u p ' , } ) ; c o n s t   U n i t U s e r V a l u e W i d g e t = U s e r V a l u e W i d g e t . e x t e n d ( { s t a r t : a s y n c   f u n c t i o n ( ) { c o n s t   u n i t = t h i s . e l . d a t a s e t . u n i t | | ' ' ; t h i s . e l . d a t a s e t . u n i t = u n i t ; i f ( t h i s . e l . d a t a s e t . s a v e U n i t = = = u n d e f i n e d ) { t h i s . e l . d a t a s e t . s a v e U n i t = u n i t ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , g e t A c t i v e V a l u e : f u n c t i o n ( m e t h o d N a m e ) { c o n s t   a c t i v e V a l u e = t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   p a r a m s = t h i s . _ m e t h o d s P a r a m s ; i f ( ! p a r a m s . u n i t ) { r e t u r n   a c t i v e V a l u e ; } 
 c o n s t   d e f a u l t V a l u e = t h i s . g e t D e f a u l t V a l u e ( m e t h o d N a m e , f a l s e ) ; r e t u r n   a c t i v e V a l u e . s p l i t ( / \ s + / g ) . m a p ( v = > { c o n s t   n u m V a l u e = p a r s e F l o a t ( v ) ; i f ( i s N a N ( n u m V a l u e ) ) { r e t u r n   d e f a u l t V a l u e ; } e l s e { c o n s t   v a l u e = w e U t i l s . c o n v e r t N u m e r i c T o U n i t ( n u m V a l u e , p a r a m s . u n i t , p a r a m s . s a v e U n i t , p a r a m s . c s s P r o p e r t y , t h i s . $ t a r g e t ) ; r e t u r n ` $ { t h i s . _ f l o a t T o S t r ( v a l u e ) } $ { p a r a m s . s a v e U n i t } ` ; } } ) . j o i n ( '   ' ) ; } , g e t D e f a u l t V a l u e : f u n c t i o n ( m e t h o d N a m e , u s e I n p u t U n i t ) { c o n s t   d e f a u l t V a l u e = t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   p a r a m s = t h i s . _ m e t h o d s P a r a m s ; i f ( ! p a r a m s . u n i t ) { r e t u r n   d e f a u l t V a l u e ; } 
 c o n s t   u n i t = u s e I n p u t U n i t ? p a r a m s . u n i t : p a r a m s . s a v e U n i t ; c o n s t   n u m V a l u e = w e U t i l s . c o n v e r t V a l u e T o U n i t ( d e f a u l t V a l u e | | ' 0 ' , u n i t , p a r a m s . c s s P r o p e r t y , t h i s . $ t a r g e t ) ; i f ( i s N a N ( n u m V a l u e ) ) { r e t u r n   d e f a u l t V a l u e ; } 
 r e t u r n ` $ { t h i s . _ f l o a t T o S t r ( n u m V a l u e ) } $ { u n i t } ` ; } , i s A c t i v e : f u n c t i o n ( ) { c o n s t   i s S u p e r A c t i v e = t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   p a r a m s = t h i s . _ m e t h o d s P a r a m s ; i f ( ! p a r a m s . u n i t ) { r e t u r n   i s S u p e r A c t i v e ; } 
 r e t u r n   i s S u p e r A c t i v e & & t h i s . _ f l o a t T o S t r ( p a r s e F l o a t ( t h i s . _ v a l u e ) ) ! = = ' 0 ' ; } , a s y n c   s e t V a l u e ( v a l u e , m e t h o d N a m e ) { c o n s t   p a r a m s = t h i s . _ m e t h o d s P a r a m s ; i f ( p a r a m s . u n i t ) { v a l u e = v a l u e . s p l i t ( '   ' ) . m a p ( v = > { c o n s t   n u m V a l u e = w e U t i l s . c o n v e r t V a l u e T o U n i t ( v , p a r a m s . u n i t , p a r a m s . c s s P r o p e r t y , t h i s . $ t a r g e t ) ; i f ( i s N a N ( n u m V a l u e ) ) { r e t u r n ' ' ; } 
 r e t u r n   t h i s . _ f l o a t T o S t r ( n u m V a l u e ) ; } ) . j o i n ( '   ' ) ; } 
 r e t u r n   t h i s . _ s u p e r ( v a l u e , m e t h o d N a m e ) ; } , _ f l o a t T o S t r : f u n c t i o n ( v a l u e ) { r e t u r n ` $ { p a r s e F l o a t ( v a l u e . t o F i x e d ( 5 ) ) } ` ; } , } ) ; c o n s t   I n p u t U s e r V a l u e W i d g e t = U n i t U s e r V a l u e W i d g e t . e x t e n d ( { t a g N a m e : ' w e - i n p u t ' , e v e n t s : { ' i n p u t   i n p u t ' : ' _ o n I n p u t I n p u t ' , ' b l u r   i n p u t ' : ' _ o n I n p u t B l u r ' , ' k e y d o w n   i n p u t ' : ' _ o n I n p u t K e y d o w n ' , } , s t a r t : a s y n c   f u n c t i o n ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   u n i t = t h i s . e l . d a t a s e t . u n i t ; t h i s . i n p u t E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i n p u t ' ) ; t h i s . i n p u t E l . s e t A t t r i b u t e ( ' t y p e ' , ' t e x t ' ) ; t h i s . i n p u t E l . s e t A t t r i b u t e ( ' a u t o c o m p l e t e ' , ' c h r o m e - o f f ' ) ; t h i s . i n p u t E l . s e t A t t r i b u t e ( ' p l a c e h o l d e r ' , t h i s . e l . g e t A t t r i b u t e ( ' p l a c e h o l d e r ' ) | | ' ' ) ; t h i s . i n p u t E l . c l a s s L i s t . t o g g l e ( ' t e x t - l e f t ' , ! u n i t ) ; t h i s . i n p u t E l . c l a s s L i s t . t o g g l e ( ' t e x t - r i g h t ' , ! ! u n i t ) ; t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( t h i s . i n p u t E l ) ; v a r   u n i t E l = d o c u m e n t . c r e a t e E l e m e n t ( ' s p a n ' ) ; u n i t E l . t e x t C o n t e n t = u n i t ; t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( u n i t E l ) ; i f ( u n i t . l e n g t h > 3 ) { t h i s . e l . c l a s s L i s t . a d d ( ' o _ w e _ l a r g e _ i n p u t ' ) ; } } , a s y n c   s e t V a l u e ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . i n p u t E l . v a l u e = t h i s . _ v a l u e ; } , _ o n I n p u t I n p u t : f u n c t i o n ( e v ) { t h i s . _ v a l u e = t h i s . i n p u t E l . v a l u e ; t h i s . _ o n U s e r V a l u e P r e v i e w ( e v ) ; } , _ o n I n p u t B l u r : f u n c t i o n ( e v ) { s e t T i m e o u t ( ( ) = > { i f ( e v . c u r r e n t T a r g e t = = = d o c u m e n t . a c t i v e E l e m e n t ) { r e t u r n ; } 
 t h i s . _ o n U s e r V a l u e C h a n g e ( e v ) ; } ) ; } , _ o n I n p u t K e y d o w n : f u n c t i o n ( e v ) { s w i t c h ( e v . w h i c h ) { c a s e   $ . u i . k e y C o d e . E N T E R : { t h i s . _ o n U s e r V a l u e C h a n g e ( e v ) ; b r e a k ; } 
 c a s e   $ . u i . k e y C o d e . U P : c a s e   $ . u i . k e y C o d e . D O W N : { c o n s t   i n p u t = e v . c u r r e n t T a r g e t ; c o n s t   p a r a m s = t h i s . _ m e t h o d s P a r a m s ; i f ( ! p a r a m s . u n i t & & ! p a r a m s . s t e p ) { b r e a k ; } 
 l e t   v a l u e = p a r s e F l o a t ( i n p u t . v a l u e | | i n p u t . p l a c e h o l d e r ) ; i f ( i s N a N ( v a l u e ) ) { v a l u e = 0 . 0 ; } 
 l e t   s t e p = p a r s e F l o a t ( p a r a m s . s t e p ) ; i f ( i s N a N ( s t e p ) ) { s t e p = 1 . 0 ; } 
 v a l u e + = ( e v . w h i c h = = = $ . u i . k e y C o d e . U P ? s t e p : - s t e p ) ; i n p u t . v a l u e = t h i s . _ f l o a t T o S t r ( v a l u e ) ; $ ( i n p u t ) . t r i g g e r ( ' i n p u t ' ) ; b r e a k ; } } } , } ) ; c o n s t   M u l t i U s e r V a l u e W i d g e t = U s e r V a l u e W i d g e t . e x t e n d ( { t a g N a m e : ' w e - m u l t i ' , s t a r t : f u n c t i o n ( ) { i f ( t h i s . o p t i o n s & & t h i s . o p t i o n s . c h i l d N o d e s ) { t h i s . o p t i o n s . c h i l d N o d e s . f o r E a c h ( n o d e = > t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( n o d e ) ) ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , g e t V a l u e : f u n c t i o n ( m e t h o d N a m e ) { c o n s t   v a l u e = t h i s . _ u s e r V a l u e W i d g e t s . m a p ( w i d g e t = > { r e t u r n   w i d g e t . g e t V a l u e ( m e t h o d N a m e ) ; } ) . j o i n ( '   ' ) . t r i m ( ) ; r e t u r n   v a l u e | | t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , i s C o n t a i n e r : f u n c t i o n ( ) { r e t u r n   t r u e ; } , a s y n c   s e t V a l u e ( v a l u e , m e t h o d N a m e ) { l e t   v a l u e s = v a l u e . s p l i t ( / \ s * \ | \ s * / g ) ; i f ( v a l u e s . l e n g t h = = = 1 ) { v a l u e s = v a l u e . s p l i t ( / \ s + / g ) ; } 
 f o r ( l e t   i = 0 ; i < t h i s . _ u s e r V a l u e W i d g e t s . l e n g t h - 1 ; i + + ) { a w a i t   t h i s . _ u s e r V a l u e W i d g e t s [ i ] . s e t V a l u e ( v a l u e s . s h i f t ( ) | | ' ' , m e t h o d N a m e ) ; } 
 a w a i t   t h i s . _ u s e r V a l u e W i d g e t s [ t h i s . _ u s e r V a l u e W i d g e t s . l e n g t h - 1 ] . s e t V a l u e ( v a l u e s . j o i n ( '   ' ) , m e t h o d N a m e ) ; } , } ) ; c o n s t   C o l o r p i c k e r U s e r V a l u e W i d g e t = S e l e c t U s e r V a l u e W i d g e t . e x t e n d ( { c l a s s N a m e : ( S e l e c t U s e r V a l u e W i d g e t . p r o t o t y p e . c l a s s N a m e | | ' ' ) + '   o _ w e _ s o _ c o l o r _ p a l e t t e ' , c u s t o m _ e v e n t s : _ . e x t e n d ( { } , S e l e c t U s e r V a l u e W i d g e t . p r o t o t y p e . c u s t o m _ e v e n t s , { ' c u s t o m _ c o l o r _ p i c k e d ' : ' _ o n C u s t o m C o l o r P i c k e d ' , ' c o l o r _ p i c k e d ' : ' _ o n C o l o r P i c k e d ' , ' c o l o r _ h o v e r ' : ' _ o n C o l o r H o v e r e d ' , ' c o l o r _ l e a v e ' : ' _ o n C o l o r L e f t ' , ' e n t e r _ k e y _ c o l o r _ c o l o r p i c k e r ' : ' _ o n E n t e r K e y ' } ) , s t a r t : a s y n c   f u n c t i o n ( ) { c o n s t   _ s u p e r = t h i s . _ s u p e r . b i n d ( t h i s ) ; c o n s t   a r g s = a r g u m e n t s ; a w a i t   t h i s . _ r e n d e r C o l o r P a l e t t e ( ) ; t h i s . c o l o r P r e v i e w E l = d o c u m e n t . c r e a t e E l e m e n t ( ' s p a n ' ) ; t h i s . c o l o r P r e v i e w E l . c l a s s L i s t . a d d ( ' o _ w e _ c o l o r _ p r e v i e w ' ) ; t h i s . o p t i o n s . c h i l d N o d e s = [ t h i s . c o l o r P a l e t t e . e l ] ; t h i s . o p t i o n s . v a l u e E l = t h i s . c o l o r P r e v i e w E l ; r e t u r n   _ s u p e r ( . . . a r g s ) ; } , c l o s e : f u n c t i o n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; i f ( t h i s . _ c u s t o m C o l o r V a l u e & & t h i s . _ c u s t o m C o l o r V a l u e ! = = t h i s . _ v a l u e ) { t h i s . _ v a l u e = t h i s . _ c u s t o m C o l o r V a l u e ; t h i s . _ c u s t o m C o l o r V a l u e = f a l s e ; t h i s . _ o n U s e r V a l u e C h a n g e ( ) ; } } , g e t M e t h o d s P a r a m s : f u n c t i o n ( ) { r e t u r n   _ . e x t e n d ( t h i s . _ s u p e r ( . . . a r g u m e n t s ) , { c o l o r N a m e s : t h i s . c o l o r P a l e t t e . g e t C o l o r N a m e s ( ) , } ) ; } , g e t V a l u e : f u n c t i o n ( m e t h o d N a m e ) { i f ( t y p e o f   t h i s . _ p r e v i e w C o l o r = = = ' s t r i n g ' ) { r e t u r n   t h i s . _ p r e v i e w C o l o r ; } 
 i f ( t y p e o f   t h i s . _ c u s t o m C o l o r V a l u e = = = ' s t r i n g ' ) { r e t u r n   t h i s . _ c u s t o m C o l o r V a l u e ; } 
 l e t   v a l u e = t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; i f ( v a l u e ) { c o n s t   u s e C s s C o l o r = t h i s . o p t i o n s . d a t a A t t r i b u t e s . h a s O w n P r o p e r t y ( ' u s e C s s C o l o r ' ) ; c o n s t   c s s C o m p a t i b l e = t h i s . o p t i o n s . d a t a A t t r i b u t e s . h a s O w n P r o p e r t y ( ' c s s C o m p a t i b l e ' ) ; i f ( ( u s e C s s C o l o r | | c s s C o m p a t i b l e ) & & ! C o l o r p i c k e r W i d g e t . i s C S S C o l o r ( v a l u e ) ) { i f ( u s e C s s C o l o r ) { v a l u e = w e U t i l s . g e t C S S V a r i a b l e V a l u e ( v a l u e ) ; } e l s e { v a l u e = ` v a r ( - - $ { v a l u e } ) ` ; } } } 
 r e t u r n   v a l u e ; } , i s C o n t a i n e r : f u n c t i o n ( ) { r e t u r n   f a l s e ; } , i s A c t i v e : f u n c t i o n ( ) { r e t u r n ! w e U t i l s . a r e C s s V a l u e s E q u a l ( t h i s . _ v a l u e , ' r g b a ( 0 ,   0 ,   0 ,   0 ) ' ) ; } , a s y n c   s e t V a l u e ( c o l o r ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; a w a i t   t h i s . _ r e n d e r C o l o r P a l e t t e ( ) ; c o n s t   c l a s s e s = w e U t i l s . c o m p u t e C o l o r C l a s s e s ( t h i s . c o l o r P a l e t t e . g e t C o l o r N a m e s ( ) ) ; t h i s . c o l o r P r e v i e w E l . c l a s s L i s t . r e m o v e ( . . . c l a s s e s ) ; t h i s . c o l o r P r e v i e w E l . s t y l e . r e m o v e P r o p e r t y ( ' b a c k g r o u n d - c o l o r ' ) ; i f ( t h i s . _ v a l u e ) { i f ( C o l o r p i c k e r W i d g e t . i s C S S C o l o r ( t h i s . _ v a l u e ) ) { t h i s . c o l o r P r e v i e w E l . s t y l e . b a c k g r o u n d C o l o r = t h i s . _ v a l u e ; } e l s e   i f ( w e U t i l s . i s C o l o r C o m b i n a t i o n N a m e ( t h i s . _ v a l u e ) ) { t h i s . c o l o r P r e v i e w E l . c l a s s L i s t . a d d ( ' o _ c c ' , ` o _ c c $ { t h i s . _ v a l u e } ` ) ; } e l s e { t h i s . c o l o r P r e v i e w E l . c l a s s L i s t . a d d ( ` b g - $ { t h i s . _ v a l u e } ` ) ; } } } , _ r e n d e r C o l o r P a l e t t e : f u n c t i o n ( ) { c o n s t   o p t i o n s = { s e l e c t e d C o l o r : t h i s . _ v a l u e , } ; i f ( t h i s . o p t i o n s . d a t a A t t r i b u t e s . e x c l u d e d ) { o p t i o n s . e x c l u d e d = t h i s . o p t i o n s . d a t a A t t r i b u t e s . e x c l u d e d . r e p l a c e ( /   / g , ' ' ) . s p l i t ( ' , ' ) ; } 
 i f ( t h i s . o p t i o n s . d a t a A t t r i b u t e s . w i t h C o m b i n a t i o n s ) { o p t i o n s . w i t h C o m b i n a t i o n s = ! ! t h i s . o p t i o n s . d a t a A t t r i b u t e s . w i t h C o m b i n a t i o n s ; } 
 c o n s t   o l d C o l o r P a l e t t e = t h i s . c o l o r P a l e t t e ; t h i s . c o l o r P a l e t t e = n e w   C o l o r P a l e t t e W i d g e t ( t h i s , o p t i o n s ) ; i f ( o l d C o l o r P a l e t t e ) { r e t u r n   t h i s . c o l o r P a l e t t e . i n s e r t A f t e r ( o l d C o l o r P a l e t t e . e l ) . t h e n ( ( ) = > { o l d C o l o r P a l e t t e . d e s t r o y ( ) ; } ) ; } 
 r e t u r n   t h i s . c o l o r P a l e t t e . a p p e n d T o ( d o c u m e n t . c r e a t e D o c u m e n t F r a g m e n t ( ) ) ; } , _ o n C u s t o m C o l o r P i c k e d : f u n c t i o n ( e v ) { t h i s . _ c u s t o m C o l o r V a l u e = e v . d a t a . c o l o r ; } , _ o n C o l o r P i c k e d : f u n c t i o n ( e v ) { t h i s . _ p r e v i e w C o l o r = f a l s e ; t h i s . _ c u s t o m C o l o r V a l u e = f a l s e ; t h i s . _ v a l u e = e v . d a t a . c o l o r ; t h i s . _ o n U s e r V a l u e C h a n g e ( e v ) ; } , _ o n C o l o r H o v e r e d : f u n c t i o n ( e v ) { t h i s . _ p r e v i e w C o l o r = e v . d a t a . c o l o r ; t h i s . _ o n U s e r V a l u e P r e v i e w ( e v ) ; } , _ o n C o l o r L e f t : f u n c t i o n ( e v ) { t h i s . _ p r e v i e w C o l o r = f a l s e ; t h i s . _ o n U s e r V a l u e R e s e t ( e v ) ; } , _ o n E n t e r K e y : f u n c t i o n ( ) { t h i s . c l o s e ( ) ; } , _ o n C l i c k : f u n c t i o n ( e v ) { i f ( ! e v . o r i g i n a l E v e n t . _ _ i s C o l o r p i c k e r C l i c k ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } 
 e v . s t o p P r o p a g a t i o n ( ) ; } , } ) ; c o n s t   M e d i a p i c k e r U s e r V a l u e W i d g e t = U s e r V a l u e W i d g e t . e x t e n d ( { t a g N a m e : ' w e - b u t t o n ' , e v e n t s : { ' c l i c k ' : ' _ o n E d i t M e d i a ' , } , a s y n c   s t a r t ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   i c o n E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i ' ) ; i f ( t h i s . o p t i o n s . d a t a A t t r i b u t e s . b u t t o n S t y l e ) { i c o n E l . c l a s s L i s t . a d d ( ' f a ' , ' f a - f w ' , ' f a - c a m e r a ' ) ; } e l s e { i c o n E l . c l a s s L i s t . a d d ( ' f a ' , ' f a - f w ' , ' f a - r e f r e s h ' , ' m r - 1 ' ) ; t h i s . e l . c l a s s L i s t . a d d ( ' o _ w e _ n o _ t o g g l e ' ) ; t h i s . c o n t a i n e r E l . t e x t C o n t e n t = _ t ( " R e p l a c e   m e d i a " ) ; } 
 $ ( t h i s . c o n t a i n e r E l ) . p r e p e n d ( i c o n E l ) ; } , _ o p e n D i a l o g ( e l , { i m a g e s = f a l s e , v i d e o s = f a l s e } ) { e l . s r c = t h i s . _ v a l u e ; c o n s t   $ e d i t a b l e = t h i s . $ t a r g e t . c l o s e s t ( ' . o _ e d i t a b l e ' ) ; c o n s t   m e d i a D i a l o g = n e w   w e W i d g e t s . M e d i a D i a l o g ( t h i s , { n o I m a g e s : ! i m a g e s , n o V i d e o s : ! v i d e o s , n o I c o n s : t r u e , n o D o c u m e n t s : t r u e , i s F o r B g V i d e o : t r u e , ' r e s _ m o d e l ' : $ e d i t a b l e . d a t a ( ' o e - m o d e l ' ) , ' r e s _ i d ' : $ e d i t a b l e . d a t a ( ' o e - i d ' ) , } , e l ) . o p e n ( ) ; r e t u r n   m e d i a D i a l o g ; } , a s y n c   s e t V a l u e ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . e l . c l a s s L i s t . t o g g l e ( ' a c t i v e ' , t h i s . i s A c t i v e ( ) ) ; } , _ o n E d i t M e d i a : f u n c t i o n ( e v ) { } , } ) ; c o n s t   I m a g e p i c k e r U s e r V a l u e W i d g e t = M e d i a p i c k e r U s e r V a l u e W i d g e t . e x t e n d ( { _ o n E d i t M e d i a ( e v ) { c o n s t   d u m m y E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; c o n s t   d i a l o g = t h i s . _ o p e n D i a l o g ( d u m m y E l , { i m a g e s : t r u e } ) ; d i a l o g . o n ( ' s a v e ' , t h i s , d a t a = > { t h i s . _ v a l u e = d u m m y E l . g e t A t t r i b u t e ( ' s r c ' ) ; t h i s . _ o n U s e r V a l u e C h a n g e ( ) ; } ) ; } , } ) ; c o n s t   V i d e o p i c k e r U s e r V a l u e W i d g e t = M e d i a p i c k e r U s e r V a l u e W i d g e t . e x t e n d ( { _ o n E d i t M e d i a ( e v ) { c o n s t   d u m m y E l = d o c u m e n t . c r e a t e E l e m e n t ( ' i f r a m e ' ) ; c o n s t   d i a l o g = t h i s . _ o p e n D i a l o g ( d u m m y E l , { v i d e o s : t r u e } ) ; d i a l o g . o n ( ' s a v e ' , t h i s , d a t a = > { t h i s . _ v a l u e = d a t a . b g V i d e o S r c ; t h i s . _ o n U s e r V a l u e C h a n g e ( ) ; } ) ; } , } ) ; c o n s t   D a t e t i m e P i c k e r U s e r V a l u e W i d g e t = I n p u t U s e r V a l u e W i d g e t . e x t e n d ( { e v e n t s : { ' b l u r   i n p u t ' : ' _ o n I n p u t B l u r ' , ' c h a n g e . d a t e t i m e p i c k e r ' : ' _ o n D a t e T i m e P i c k e r C h a n g e ' , ' e r r o r . d a t e t i m e p i c k e r ' : ' _ o n D a t e T i m e P i c k e r E r r o r ' , } , i n i t : f u n c t i o n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . _ v a l u e = m o m e n t ( ) . u n i x ( ) . t o S t r i n g ( ) ; t h i s . _ _ l i b I n p u t = 0 ; } , s t a r t : a s y n c   f u n c t i o n ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   d a t e t i m e P i c k e r I d = _ . u n i q u e I d ( ' d a t e t i m e p i c k e r ' ) ; t h i s . e l . c l a s s L i s t . a d d ( ' o _ w e _ l a r g e _ i n p u t ' ) ; t h i s . i n p u t E l . c l a s s L i s t . a d d ( ' d a t e t i m e p i c k e r - i n p u t ' , ' m x - 0 ' , ' t e x t - l e f t ' ) ; t h i s . i n p u t E l . s e t A t t r i b u t e ( ' i d ' , d a t e t i m e P i c k e r I d ) ; t h i s . i n p u t E l . s e t A t t r i b u t e ( ' d a t a - t a r g e t ' , ' # ' + d a t e t i m e P i c k e r I d ) ; c o n s t   d a t e p i c k e r s O p t i o n s = { m i n D a t e : m o m e n t ( { y : 1 } ) , m a x D a t e : m o m e n t ( ) . a d d ( 2 0 0 , ' y ' ) , c a l e n d a r W e e k s : t r u e , d e f a u l t D a t e : m o m e n t ( ) . f o r m a t ( ) , i c o n s : { c l o s e : ' f a   f a - c h e c k   p r i m a r y ' , } , l o c a l e : m o m e n t . l o c a l e ( ) , f o r m a t : t i m e . g e t L a n g D a t e t i m e F o r m a t ( ) , s i d e B y S i d e : t r u e , b u t t o n s : { s h o w C l o s e : t r u e , s h o w T o d a y : t r u e , } , w i d g e t P a r e n t : ' b o d y ' , a l l o w I n p u t T o g g l e : t r u e , } ; t h i s . _ _ l i b I n p u t + + ; c o n s t   $ i n p u t = $ ( t h i s . i n p u t E l ) ; $ i n p u t . d a t e t i m e p i c k e r ( d a t e p i c k e r s O p t i o n s ) ; t h i s . _ _ l i b I n p u t - - ; c o n s t   l i b O b j e c t = $ i n p u t . d a t a ( ' d a t e t i m e p i c k e r ' ) ; c o n s t   o l d F u n c = l i b O b j e c t . _ g e t T e m p l a t e ; l i b O b j e c t . _ g e t T e m p l a t e = f u n c t i o n ( ) { c o n s t   $ t e m p l a t e = o l d F u n c . c a l l ( t h i s , . . . a r g u m e n t s ) ; $ t e m p l a t e . a d d C l a s s ( ' o _ w e _ n o _ o v e r l a y   o _ w e _ d a t e t i m e p i c k e r ' ) ; r e t u r n   $ t e m p l a t e ; } ; } , i s P r e v i e w e d : f u n c t i o n ( ) { r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) | | ! ! $ ( t h i s . i n p u t E l ) . d a t a ( ' d a t e t i m e p i c k e r ' ) . w i d g e t ; } , a s y n c   s e t V a l u e ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; l e t   m o m e n t O b j = m o m e n t . u n i x ( t h i s . _ v a l u e ) ; i f ( ! m o m e n t O b j . i s V a l i d ( ) ) { m o m e n t O b j = m o m e n t ( ) ; } 
 t h i s . _ _ l i b I n p u t + + ; $ ( t h i s . i n p u t E l ) . d a t e t i m e p i c k e r ( ' d a t e ' , m o m e n t O b j ) ; t h i s . _ _ l i b I n p u t - - ; } , _ o n D a t e T i m e P i c k e r C h a n g e : f u n c t i o n ( e v ) { i f ( t h i s . _ _ l i b I n p u t > 0 ) { r e t u r n ; } 
 i f ( ! e v . d a t e | | ! e v . d a t e . i s V a l i d ( ) ) { r e t u r n ; } 
 t h i s . _ v a l u e = e v . d a t e . u n i x ( ) . t o S t r i n g ( ) ; t h i s . _ o n U s e r V a l u e P r e v i e w ( e v ) ; } , _ o n D a t e T i m e P i c k e r E r r o r : f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; } , } ) ; c o n s t   R a n g e U s e r V a l u e W i d g e t = U n i t U s e r V a l u e W i d g e t . e x t e n d ( { t a g N a m e : ' w e - r a n g e ' , e v e n t s : { ' c h a n g e   i n p u t ' : ' _ o n I n p u t C h a n g e ' , } , a s y n c   s t a r t ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . i n p u t = d o c u m e n t . c r e a t e E l e m e n t ( ' i n p u t ' ) ; t h i s . i n p u t . t y p e = " r a n g e " ; l e t   m i n = t h i s . e l . d a t a s e t . m i n & & p a r s e F l o a t ( t h i s . e l . d a t a s e t . m i n ) | | 0 ; l e t   m a x = t h i s . e l . d a t a s e t . m a x & & p a r s e F l o a t ( t h i s . e l . d a t a s e t . m a x ) | | 1 0 0 ; c o n s t   s t e p = t h i s . e l . d a t a s e t . s t e p & & p a r s e F l o a t ( t h i s . e l . d a t a s e t . s t e p ) | | 1 ; i f ( m i n > m a x ) { [ m i n , m a x ] = [ m a x , m i n ] ; t h i s . i n p u t . c l a s s L i s t . a d d ( ' o _ w e _ i n v e r t e d _ r a n g e ' ) ; } 
 t h i s . i n p u t . s e t A t t r i b u t e ( ' m i n ' , m i n ) ; t h i s . i n p u t . s e t A t t r i b u t e ( ' m a x ' , m a x ) ; t h i s . i n p u t . s e t A t t r i b u t e ( ' s t e p ' , s t e p ) ; t h i s . c o n t a i n e r E l . a p p e n d C h i l d ( t h i s . i n p u t ) ; } , a s y n c   s e t V a l u e ( v a l u e , m e t h o d N a m e ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . i n p u t . v a l u e = t h i s . _ v a l u e ; } , _ o n I n p u t C h a n g e ( e v ) { t h i s . _ v a l u e = e v . t a r g e t . v a l u e ; t h i s . _ o n U s e r V a l u e C h a n g e ( e v ) ; } , } ) ; c o n s t   S e l e c t P a g e r U s e r V a l u e W i d g e t = S e l e c t U s e r V a l u e W i d g e t . e x t e n d ( { c l a s s N a m e : ( S e l e c t U s e r V a l u e W i d g e t . p r o t o t y p e . c l a s s N a m e | | ' ' ) + '   o _ w e _ s e l e c t _ p a g e r ' , e v e n t s : O b j e c t . a s s i g n ( { } , S e l e c t U s e r V a l u e W i d g e t . p r o t o t y p e . e v e n t s , { ' c l i c k   . o _ w e _ p a g e r _ n e x t ,   . o _ w e _ p a g e r _ p r e v ' : ' _ o n P a g e C h a n g e ' , } ) , a s y n c   s t a r t ( ) { c o n s t   _ s u p e r = t h i s . _ s u p e r . b i n d ( t h i s ) ; t h i s . p a g e s = t h i s . o p t i o n s . c h i l d N o d e s . f i l t e r ( n o d e = > n o d e . m a t c h e s & & n o d e . m a t c h e s ( ' w e - s e l e c t - p a g e ' ) ) ; t h i s . n u m P a g e s = t h i s . p a g e s . l e n g t h ; c o n s t   p r e v = d o c u m e n t . c r e a t e E l e m e n t ( ' i ' ) ; p r e v . c l a s s L i s t . a d d ( ' o _ w e _ p a g e r _ p r e v ' , ' f a ' , ' f a - c h e v r o n - l e f t ' ) ; t h i s . p a g e N u m = d o c u m e n t . c r e a t e E l e m e n t ( ' s p a n ' ) ; t h i s . c u r r e n t P a g e = 0 ; c o n s t   n e x t = d o c u m e n t . c r e a t e E l e m e n t ( ' i ' ) ; n e x t . c l a s s L i s t . a d d ( ' o _ w e _ p a g e r _ n e x t ' , ' f a ' , ' f a - c h e v r o n - r i g h t ' ) ; c o n s t   p a g e r C o n t r o l s = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; p a g e r C o n t r o l s . c l a s s L i s t . a d d ( ' o _ w e _ p a g e r _ c o n t r o l s ' ) ; p a g e r C o n t r o l s . a p p e n d C h i l d ( p r e v ) ; p a g e r C o n t r o l s . a p p e n d C h i l d ( t h i s . p a g e N u m ) ; p a g e r C o n t r o l s . a p p e n d C h i l d ( n e x t ) ; t h i s . p a g e N a m e = d o c u m e n t . c r e a t e E l e m e n t ( ' b ' ) ; c o n s t   p a g e r H e a d e r = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; p a g e r H e a d e r . c l a s s L i s t . a d d ( ' o _ w e _ p a g e r _ h e a d e r ' ) ; p a g e r H e a d e r . a p p e n d C h i l d ( t h i s . p a g e N a m e ) ; p a g e r H e a d e r . a p p e n d C h i l d ( p a g e r C o n t r o l s ) ; a w a i t   _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . m e n u E l . c l a s s L i s t . a d d ( ' o _ w e _ h a s _ p a g e r ' ) ; $ ( t h i s . m e n u E l ) . p r e p e n d ( p a g e r H e a d e r ) ; t h i s . _ u p d a t e P a g e ( ) ; } , _ u p d a t e P a g e ( ) { t h i s . p a g e s . f o r E a c h ( ( p a g e , i ) = > p a g e . c l a s s L i s t . t o g g l e ( ' a c t i v e ' , i = = = t h i s . c u r r e n t P a g e ) ) ; t h i s . p a g e N u m . t e x t C o n t e n t = ` $ { t h i s . c u r r e n t P a g e   +   1 } / $ { t h i s . n u m P a g e s } ` ; c o n s t   a c t i v e P a g e = t h i s . p a g e s . f i n d ( ( p a g e , i ) = > i = = = t h i s . c u r r e n t P a g e ) ; t h i s . p a g e N a m e . t e x t C o n t e n t = a c t i v e P a g e . g e t A t t r i b u t e ( ' s t r i n g ' ) ; } , _ o n P a g e C h a n g e ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; e v . s t o p P r o p a g a t i o n ( ) ; c o n s t   d e l t a = e v . t a r g e t . m a t c h e s ( ' . o _ w e _ p a g e r _ n e x t ' ) ? 1 : - 1 ; t h i s . c u r r e n t P a g e = ( t h i s . c u r r e n t P a g e + t h i s . n u m P a g e s + d e l t a ) % t h i s . n u m P a g e s ; t h i s . _ u p d a t e P a g e ( ) ; } , _ o n C l i c k ( e v ) { c o n s t   a c t i v e B u t t o n = t h i s . _ g e t A c t i v e S u b W i d g e t ( ) ; i f ( a c t i v e B u t t o n ) { c o n s t   c u r r e n t P a g e = t h i s . p a g e s . i n d e x O f ( a c t i v e B u t t o n . e l . c l o s e s t ( ' w e - s e l e c t - p a g e ' ) ) ; i f ( c u r r e n t P a g e ! = = - 1 ) { t h i s . c u r r e n t P a g e = c u r r e n t P a g e ; t h i s . _ u p d a t e P a g e ( ) ; } } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , } ) ; c o n s t   u s e r V a l u e W i d g e t s R e g i s t r y = { ' w e - b u t t o n ' : B u t t o n U s e r V a l u e W i d g e t , ' w e - c h e c k b o x ' : C h e c k b o x U s e r V a l u e W i d g e t , ' w e - s e l e c t ' : S e l e c t U s e r V a l u e W i d g e t , ' w e - b u t t o n - g r o u p ' : B u t t o n G r o u p U s e r V a l u e W i d g e t , ' w e - i n p u t ' : I n p u t U s e r V a l u e W i d g e t , ' w e - m u l t i ' : M u l t i U s e r V a l u e W i d g e t , ' w e - c o l o r p i c k e r ' : C o l o r p i c k e r U s e r V a l u e W i d g e t , ' w e - d a t e t i m e p i c k e r ' : D a t e t i m e P i c k e r U s e r V a l u e W i d g e t , ' w e - i m a g e p i c k e r ' : I m a g e p i c k e r U s e r V a l u e W i d g e t , ' w e - v i d e o p i c k e r ' : V i d e o p i c k e r U s e r V a l u e W i d g e t , ' w e - r a n g e ' : R a n g e U s e r V a l u e W i d g e t , ' w e - s e l e c t - p a g e r ' : S e l e c t P a g e r U s e r V a l u e W i d g e t , } ; c o n s t   S n i p p e t O p t i o n W i d g e t = W i d g e t . e x t e n d ( { t a g N a m e : ' w e - c u s t o m i z e b l o c k - o p t i o n ' , e v e n t s : { ' c l i c k   . o _ w e _ c o l l a p s e _ t o g g l e r ' : ' _ o n C o l l a p s e T o g g l e r C l i c k ' , } , c u s t o m _ e v e n t s : { ' u s e r _ v a l u e _ u p d a t e ' : ' _ o n U s e r V a l u e U p d a t e ' , ' u s e r _ v a l u e _ w i d g e t _ c r i t i c a l ' : ' _ o n U s e r V a l u e W i d g e t C r i t i c a l ' , } , i s T o p O p t i o n : f a l s e , f o r c e N o D e l e t e B u t t o n : f a l s e , i n i t : f u n c t i o n ( p a r e n t , $ u i E l e m e n t s , $ t a r g e t , $ o v e r l a y , d a t a , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . $ o r i g i n a l U I E l e m e n t s = $ u i E l e m e n t s ; t h i s . $ t a r g e t = $ t a r g e t ; t h i s . $ o v e r l a y = $ o v e r l a y ; t h i s . d a t a = d a t a ; t h i s . o p t i o n s = o p t i o n s ; t h i s . c l a s s N a m e = ' s n i p p e t - o p t i o n - ' + t h i s . d a t a . o p t i o n N a m e ; t h i s . o w n e r D o c u m e n t = t h i s . $ t a r g e t [ 0 ] . o w n e r D o c u m e n t ; t h i s . _ u s e r V a l u e W i d g e t s = [ ] ; t h i s . _ a c t i o n Q u e u e s = n e w   M a p ( ) ; } , w i l l S t a r t : a s y n c   f u n c t i o n ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; r e t u r n   t h i s . _ r e n d e r O r i g i n a l X M L ( ) . t h e n ( u i F r a g m e n t = > { t h i s . u i F r a g m e n t = u i F r a g m e n t ; } ) ; } , r e n d e r E l e m e n t : f u n c t i o n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . e l . a p p e n d C h i l d ( t h i s . u i F r a g m e n t ) ; t h i s . u i F r a g m e n t = n u l l ; } , o n F o c u s : f u n c t i o n ( ) { } , o n B u i l t : f u n c t i o n ( ) { } , o n B l u r : f u n c t i o n ( ) { } , o n C l o n e : f u n c t i o n ( o p t i o n s ) { } , o n M o v e : f u n c t i o n ( ) { } , o n R e m o v e : f u n c t i o n ( ) { } , o n T a r g e t S h o w : a s y n c   f u n c t i o n ( ) { } , o n T a r g e t H i d e : a s y n c   f u n c t i o n ( ) { } , c l e a n F o r S a v e : a s y n c   f u n c t i o n ( ) { } , s e l e c t C l a s s : f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { f o r ( c o n s t   c l a s s N a m e s   o f   p a r a m s . p o s s i b l e V a l u e s ) { i f ( c l a s s N a m e s ) { t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . r e m o v e ( . . . c l a s s N a m e s . t r i m ( ) . s p l i t ( / \ s + / g ) ) ; } } 
 i f ( w i d g e t V a l u e ) { t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . a d d ( . . . w i d g e t V a l u e . t r i m ( ) . s p l i t ( / \ s + / g ) ) ; } } , s e l e c t D a t a A t t r i b u t e : f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { c o n s t   v a l u e = t h i s . _ s e l e c t A t t r i b u t e H e l p e r ( w i d g e t V a l u e , p a r a m s ) ; t h i s . $ t a r g e t [ 0 ] . d a t a s e t [ p a r a m s . a t t r i b u t e N a m e ] = v a l u e ; } , s e l e c t A t t r i b u t e : f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { c o n s t   v a l u e = t h i s . _ s e l e c t A t t r i b u t e H e l p e r ( w i d g e t V a l u e , p a r a m s ) ; t h i s . $ t a r g e t [ 0 ] . s e t A t t r i b u t e ( p a r a m s . a t t r i b u t e N a m e , v a l u e ) ; } , s e l e c t S t y l e : f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . a d d ( ' o _ w e _ f o r c e _ n o _ t r a n s i t i o n ' ) ; c o n s t   _ r e s t o r e T r a n s i t i o n s = ( ) = > t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . r e m o v e ( ' o _ w e _ f o r c e _ n o _ t r a n s i t i o n ' ) ; i f ( p a r a m s . c s s P r o p e r t y = = = ' b a c k g r o u n d - c o l o r ' ) { t h i s . $ t a r g e t . t r i g g e r ( ' b a c k g r o u n d - c o l o r - e v e n t ' , p r e v i e w M o d e ) ; } 
 c o n s t   c s s P r o p s = w e U t i l s . C S S _ S H O R T H A N D S [ p a r a m s . c s s P r o p e r t y ] | | [ p a r a m s . c s s P r o p e r t y ] ; f o r ( c o n s t   c s s P r o p   o f   c s s P r o p s ) { t h i s . $ t a r g e t [ 0 ] . s t y l e . s e t P r o p e r t y ( c s s P r o p , ' ' ) ; } 
 i f ( p a r a m s . e x t r a C l a s s ) { t h i s . $ t a r g e t . r e m o v e C l a s s ( p a r a m s . e x t r a C l a s s ) ; } 
 i f ( p a r a m s . c o l o r N a m e s & & p a r a m s . c o l o r P r e f i x ) { c o n s t   c l a s s e s = w e U t i l s . c o m p u t e C o l o r C l a s s e s ( p a r a m s . c o l o r N a m e s , p a r a m s . c o l o r P r e f i x ) ; t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . r e m o v e ( . . . c l a s s e s ) ; i f ( w e U t i l s . i s C o l o r C o m b i n a t i o n N a m e ( w i d g e t V a l u e ) ) { t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . a d d ( ' o _ c c ' , ` o _ c c $ { w i d g e t V a l u e } ` , p a r a m s . e x t r a C l a s s ) ; _ r e s t o r e T r a n s i t i o n s ( ) ; r e t u r n ; } 
 i f ( p a r a m s . c o l o r N a m e s . i n c l u d e s ( w i d g e t V a l u e ) ) { c o n s t   o r i g i n a l C S S V a l u e = w i n d o w . g e t C o m p u t e d S t y l e ( t h i s . $ t a r g e t [ 0 ] ) [ c s s P r o p s [ 0 ] ] ; c o n s t   c l a s s N a m e = p a r a m s . c o l o r P r e f i x + w i d g e t V a l u e ; t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . a d d ( c l a s s N a m e ) ; i f ( o r i g i n a l C S S V a l u e ! = = w i n d o w . g e t C o m p u t e d S t y l e ( t h i s . $ t a r g e t [ 0 ] ) [ c s s P r o p s [ 0 ] ] ) { t h i s . $ t a r g e t . a d d C l a s s ( p a r a m s . e x t r a C l a s s ) ; _ r e s t o r e T r a n s i t i o n s ( ) ; r e t u r n ; } 
 t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . r e m o v e ( c l a s s N a m e ) ; } } 
 c o n s t   h t m l P r o p V a l u e = w e U t i l s . g e t C S S V a r i a b l e V a l u e ( w i d g e t V a l u e ) ; i f ( h t m l P r o p V a l u e ) { w i d g e t V a l u e = ` v a r ( - - $ { w i d g e t V a l u e } ) ` ; } 
 c o n s t   v a l u e s = w i d g e t V a l u e . r e p l a c e ( / , \ s / g , ' , ' ) . s p l i t ( / \ s + / g ) ; w h i l e ( v a l u e s . l e n g t h < c s s P r o p s . l e n g t h ) { s w i t c h ( v a l u e s . l e n g t h ) { c a s e   1 : c a s e   2 : { v a l u e s . p u s h ( v a l u e s [ 0 ] ) ; b r e a k ; } 
 c a s e   3 : { v a l u e s . p u s h ( v a l u e s [ 1 ] ) ; b r e a k ; } 
 d e f a u l t : { v a l u e s . p u s h ( v a l u e s [ v a l u e s . l e n g t h - 1 ] ) ; } } } 
 c o n s t   s t y l e s = w i n d o w . g e t C o m p u t e d S t y l e ( t h i s . $ t a r g e t [ 0 ] ) ; l e t   h a s U s e r V a l u e = f a l s e ; f o r ( l e t   i = c s s P r o p s . l e n g t h - 1 ; i > 0 ; i - - ) { h a s U s e r V a l u e = a p p l y C S S . c a l l ( t h i s , c s s P r o p s [ i ] , v a l u e s . p o p ( ) , s t y l e s ) | | h a s U s e r V a l u e ; } 
 h a s U s e r V a l u e = a p p l y C S S . c a l l ( t h i s , c s s P r o p s [ 0 ] , v a l u e s . j o i n ( '   ' ) , s t y l e s ) | | h a s U s e r V a l u e ; f u n c t i o n   a p p l y C S S ( c s s P r o p , c s s V a l u e , s t y l e s ) { i f ( ! w e U t i l s . a r e C s s V a l u e s E q u a l ( s t y l e s [ c s s P r o p ] , c s s V a l u e ) ) { t h i s . $ t a r g e t [ 0 ] . s t y l e . s e t P r o p e r t y ( c s s P r o p , c s s V a l u e , ' i m p o r t a n t ' ) ; r e t u r n   t r u e ; } 
 r e t u r n   f a l s e ; } 
 i f ( p a r a m s . e x t r a C l a s s ) { t h i s . $ t a r g e t . t o g g l e C l a s s ( p a r a m s . e x t r a C l a s s , h a s U s e r V a l u e ) ; } 
 _ r e s t o r e T r a n s i t i o n s ( ) ; } , $ : f u n c t i o n ( ) { r e t u r n   t h i s . $ t a r g e t . f i n d . a p p l y ( t h i s . $ t a r g e t , a r g u m e n t s ) ; } , c l o s e W i d g e t s : f u n c t i o n ( ) { t h i s . _ u s e r V a l u e W i d g e t s . f o r E a c h ( w i d g e t = > w i d g e t . c l o s e ( ) ) ; } , f i n d W i d g e t : f u n c t i o n ( n a m e ) { f o r ( c o n s t   w i d g e t   o f   t h i s . _ u s e r V a l u e W i d g e t s ) { i f ( w i d g e t . g e t N a m e ( ) = = = n a m e ) { r e t u r n   w i d g e t ; } 
 c o n s t   d e p W i d g e t = w i d g e t . f i n d W i d g e t ( n a m e ) ; i f ( d e p W i d g e t ) { r e t u r n   d e p W i d g e t ; } } 
 r e t u r n   n u l l ; } , n o t i f y : f u n c t i o n ( n a m e , d a t a ) { i f ( n a m e = = = ' t a r g e t ' ) { t h i s . s e t T a r g e t ( d a t a ) ; } } , s e t T a r g e t : f u n c t i o n ( $ t a r g e t ) { t h i s . $ t a r g e t = $ t a r g e t ; } , u p d a t e U I : a s y n c   f u n c t i o n ( { n o V i s i b i l i t y } = { } ) { c o n s t   p r o m s = t h i s . _ u s e r V a l u e W i d g e t s . m a p ( a s y n c   w i d g e t = > { c o n s t   m e t h o d s N a m e s = w i d g e t . g e t M e t h o d s N a m e s ( ) ; f o r ( c o n s t   m e t h o d N a m e   o f   m e t h o d s N a m e s ) { c o n s t   p a r a m s = w i d g e t . g e t M e t h o d s P a r a m s ( m e t h o d N a m e ) ; l e t   o b j = t h i s ; i f ( p a r a m s . a p p l y T o ) { c o n s t   $ f i r s t S u b T a r g e t = t h i s . $ ( p a r a m s . a p p l y T o ) . e q ( 0 ) ; i f ( ! $ f i r s t S u b T a r g e t . l e n g t h ) { c o n t i n u e ; } 
 o b j = c r e a t e P r o p e r t y P r o x y ( t h i s , ' $ t a r g e t ' , $ f i r s t S u b T a r g e t ) ; } 
 c o n s t   v a l u e = a w a i t   t h i s . _ c o m p u t e W i d g e t S t a t e . c a l l ( o b j , m e t h o d N a m e , p a r a m s ) ; i f ( v a l u e = = = u n d e f i n e d ) { c o n t i n u e ; } 
 c o n s t   n o r m a l i z e d V a l u e = t h i s . _ n o r m a l i z e W i d g e t V a l u e ( v a l u e ) ; a w a i t   w i d g e t . s e t V a l u e ( n o r m a l i z e d V a l u e , m e t h o d N a m e ) ; } } ) ; a w a i t   P r o m i s e . a l l ( p r o m s ) ; i f ( ! n o V i s i b i l i t y ) { a w a i t   t h i s . u p d a t e U I V i s i b i l i t y ( ) ; } } , u p d a t e U I V i s i b i l i t y : a s y n c   f u n c t i o n ( ) { c o n s t   p r o m s = t h i s . _ u s e r V a l u e W i d g e t s . m a p ( a s y n c   w i d g e t = > { c o n s t   p a r a m s = w i d g e t . g e t M e t h o d s P a r a m s ( ) ; l e t   o b j = t h i s ; i f ( p a r a m s . a p p l y T o ) { c o n s t   $ f i r s t S u b T a r g e t = t h i s . $ ( p a r a m s . a p p l y T o ) . e q ( 0 ) ; i f ( ! $ f i r s t S u b T a r g e t . l e n g t h ) { w i d g e t . t o g g l e V i s i b i l i t y ( f a l s e ) ; r e t u r n ; } 
 o b j = c r e a t e P r o p e r t y P r o x y ( t h i s , ' $ t a r g e t ' , $ f i r s t S u b T a r g e t ) ; } 
 c o n s t   a l l S u b W i d g e t s = [ w i d g e t ] ; l e t   i = 0 ; w h i l e ( i < a l l S u b W i d g e t s . l e n g t h ) { a l l S u b W i d g e t s . p u s h ( . . . a l l S u b W i d g e t s [ i ] . _ u s e r V a l u e W i d g e t s ) ; i + + ; } 
 c o n s t   p r o m s = a l l S u b W i d g e t s . m a p ( a s y n c   w i d g e t = > { c o n s t   s h o w = a w a i t   t h i s . _ c o m p u t e W i d g e t V i s i b i l i t y . c a l l ( o b j , w i d g e t . g e t N a m e ( ) , p a r a m s ) ; i f ( ! s h o w ) { w i d g e t . t o g g l e V i s i b i l i t y ( f a l s e ) ; r e t u r n ; } 
 c o n s t   d e p e n d e n c i e s = w i d g e t . g e t D e p e n d e n c i e s ( ) ; c o n s t   d e p e n d e n c i e s D a t a = [ ] ; d e p e n d e n c i e s . f o r E a c h ( d e p N a m e = > { c o n s t   t o B e A c t i v e = ( d e p N a m e [ 0 ] ! = = ' ! ' ) ; i f ( ! t o B e A c t i v e ) { d e p N a m e = d e p N a m e . s u b s t r ( 1 ) ; } 
 c o n s t   w i d g e t = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( d e p N a m e ) [ 0 ] ; i f ( w i d g e t ) { d e p e n d e n c i e s D a t a . p u s h ( { w i d g e t : w i d g e t , t o B e A c t i v e : t o B e A c t i v e , } ) ; } } ) ; c o n s t   d e p e n d e n c i e s O K = ! d e p e n d e n c i e s D a t a . l e n g t h | | d e p e n d e n c i e s D a t a . s o m e ( d e p D a t a = > { r e t u r n ( d e p D a t a . w i d g e t . i s A c t i v e ( ) = = = d e p D a t a . t o B e A c t i v e ) ; } ) ; w i d g e t . t o g g l e V i s i b i l i t y ( d e p e n d e n c i e s O K ) ; } ) ; r e t u r n   P r o m i s e . a l l ( p r o m s ) ; } ) ; c o n s t   s h o w U I = a w a i t   t h i s . _ c o m p u t e V i s i b i l i t y ( ) ; t h i s . e l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , ! s h o w U I ) ; a w a i t   P r o m i s e . a l l ( p r o m s ) ; f o r ( c o n s t   e l   o f   t h i s . $ e l . f i n d ( ' w e - r o w ' ) ) { e l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , ! $ ( e l ) . f i n d ( ' >   d i v   >   . o _ w e _ u s e r _ v a l u e _ w i d g e t ' ) . n o t ( ' . d - n o n e ' ) . l e n g t h ) ; } 
 f o r ( c o n s t   e l   o f   t h i s . $ e l . f i n d ( ' w e - c o l l a p s e ' ) ) { c o n s t   $ e l = $ ( e l ) ; e l . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , $ e l . c h i l d r e n ( ) . f i r s t ( ) . h a s C l a s s ( ' d - n o n e ' ) ) ; c o n s t   h a s N o V i s i b l e E l I n C o l l a p s e M e n u = ! $ e l . c h i l d r e n ( ) . l a s t ( ) . c h i l d r e n ( ) . n o t ( ' . d - n o n e ' ) . l e n g t h ; i f ( h a s N o V i s i b l e E l I n C o l l a p s e M e n u ) { t h i s . _ t o g g l e C o l l a p s e E l ( e l , f a l s e ) ; } 
 e l . q u e r y S e l e c t o r ( ' . o _ w e _ c o l l a p s e _ t o g g l e r ' ) . c l a s s L i s t . t o g g l e ( ' d - n o n e ' , h a s N o V i s i b l e E l I n C o l l a p s e M e n u ) ; } } , a s y n c   _ c h e c k I f W i d g e t s U p d a t e N e e d W a r n i n g ( w i d g e t s ) { c o n s t   m e s s a g e s = [ ] ; f o r ( c o n s t   w i d g e t   o f   w i d g e t s ) { c o n s t   m e s s a g e = w i d g e t . g e t M e t h o d s P a r a m s ( ) . w a r n M e s s a g e ; i f ( m e s s a g e ) { m e s s a g e s . p u s h ( m e s s a g e ) ; } } 
 r e t u r n   m e s s a g e s . j o i n ( '   ' ) ; } , a s y n c   _ c h e c k I f W i d g e t s U p d a t e N e e d R e l o a d ( w i d g e t s ) { r e t u r n   f a l s e ; } , _ c o m p u t e V i s i b i l i t y : a s y n c   f u n c t i o n ( ) { r e t u r n   t r u e ; } , _ c o m p u t e W i d g e t S t a t e : a s y n c   f u n c t i o n ( m e t h o d N a m e , p a r a m s ) { s w i t c h ( m e t h o d N a m e ) { c a s e ' s e l e c t C l a s s ' : { l e t   m a x N b C l a s s e s = 0 ; l e t   a c t i v e C l a s s N a m e s = ' ' ; p a r a m s . p o s s i b l e V a l u e s . f o r E a c h ( c l a s s N a m e s = > { i f ( ! c l a s s N a m e s ) { r e t u r n ; } 
 c o n s t   c l a s s e s = c l a s s N a m e s . s p l i t ( / \ s + / g ) ; i f ( c l a s s e s . l e n g t h > = m a x N b C l a s s e s & & c l a s s e s . e v e r y ( c l a s s N a m e = > t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . c o n t a i n s ( c l a s s N a m e ) ) ) { m a x N b C l a s s e s = c l a s s e s . l e n g t h ; a c t i v e C l a s s N a m e s = c l a s s N a m e s ; } } ) ; r e t u r n   a c t i v e C l a s s N a m e s ; } 
 c a s e ' s e l e c t A t t r i b u t e ' : c a s e ' s e l e c t D a t a A t t r i b u t e ' : { c o n s t   a t t r N a m e = p a r a m s . a t t r i b u t e N a m e ; l e t   a t t r V a l u e ; i f ( m e t h o d N a m e = = = ' s e l e c t A t t r i b u t e ' ) { a t t r V a l u e = t h i s . $ t a r g e t [ 0 ] . g e t A t t r i b u t e ( a t t r N a m e ) ; } e l s e   i f ( m e t h o d N a m e = = = ' s e l e c t D a t a A t t r i b u t e ' ) { a t t r V a l u e = t h i s . $ t a r g e t [ 0 ] . d a t a s e t [ a t t r N a m e ] ; } 
 a t t r V a l u e = ( a t t r V a l u e | | ' ' ) . t r i m ( ) ; i f ( p a r a m s . s a v e U n i t & & ! p a r a m s . w i t h U n i t ) { a t t r V a l u e = a t t r V a l u e . s p l i t ( / \ s + / g ) . m a p ( v = > v + p a r a m s . s a v e U n i t ) . j o i n ( '   ' ) ; } 
 r e t u r n   a t t r V a l u e | | p a r a m s . a t t r i b u t e D e f a u l t V a l u e | | ' ' ; } 
 c a s e ' s e l e c t S t y l e ' : { i f ( p a r a m s . c o l o r P r e f i x & & p a r a m s . c o l o r N a m e s ) { f o r ( c o n s t   c   o f   p a r a m s . c o l o r N a m e s ) { c o n s t   c l a s s N a m e = w e U t i l s . c o m p u t e C o l o r C l a s s e s ( [ c ] , p a r a m s . c o l o r P r e f i x ) [ 0 ] ; i f ( t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . c o n t a i n s ( c l a s s N a m e ) ) { r e t u r n   c ; } } } 
 t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . a d d ( ' o _ w e _ f o r c e _ n o _ t r a n s i t i o n ' ) ; c o n s t   _ r e s t o r e T r a n s i t i o n s = ( ) = > t h i s . $ t a r g e t [ 0 ] . c l a s s L i s t . r e m o v e ( ' o _ w e _ f o r c e _ n o _ t r a n s i t i o n ' ) ; c o n s t   s t y l e s = w i n d o w . g e t C o m p u t e d S t y l e ( t h i s . $ t a r g e t [ 0 ] ) ; c o n s t   c s s P r o p s = w e U t i l s . C S S _ S H O R T H A N D S [ p a r a m s . c s s P r o p e r t y ] | | [ p a r a m s . c s s P r o p e r t y ] ; c o n s t   c s s V a l u e s = c s s P r o p s . m a p ( c s s P r o p = > { l e t   v a l u e = s t y l e s [ c s s P r o p ] . t r i m ( ) ; i f ( c s s P r o p = = = ' b o x - s h a d o w ' ) { c o n s t   i n s e t = v a l u e . i n c l u d e s ( ' i n s e t ' ) ; l e t   v a l u e s = v a l u e . r e p l a c e ( / , \ s / g , ' , ' ) . r e p l a c e ( ' i n s e t ' , ' ' ) . t r i m ( ) . s p l i t ( / \ s + / g ) ; c o n s t   c o l o r = v a l u e s . f i n d ( s = > ! s . m a t c h ( / ^ \ d / ) ) ; v a l u e s = v a l u e s . j o i n ( '   ' ) . r e p l a c e ( c o l o r , ' ' ) . t r i m ( ) ; v a l u e = ` $ { c o l o r }   $ { v a l u e s } $ { i n s e t   ?   '   i n s e t '   :   ' ' } ` ; } 
 r e t u r n   v a l u e ; } ) ; i f ( c s s V a l u e s . l e n g t h = = = 4 & & w e U t i l s . a r e C s s V a l u e s E q u a l ( c s s V a l u e s [ 3 ] , c s s V a l u e s [ 1 ] , p a r a m s . c s s P r o p e r t y , t h i s . $ t a r g e t ) ) { c s s V a l u e s . p o p ( ) ; } 
 i f ( c s s V a l u e s . l e n g t h = = = 3 & & w e U t i l s . a r e C s s V a l u e s E q u a l ( c s s V a l u e s [ 2 ] , c s s V a l u e s [ 0 ] , p a r a m s . c s s P r o p e r t y , t h i s . $ t a r g e t ) ) { c s s V a l u e s . p o p ( ) ; } 
 i f ( c s s V a l u e s . l e n g t h = = = 2 & & w e U t i l s . a r e C s s V a l u e s E q u a l ( c s s V a l u e s [ 1 ] , c s s V a l u e s [ 0 ] , p a r a m s . c s s P r o p e r t y , t h i s . $ t a r g e t ) ) { c s s V a l u e s . p o p ( ) ; } 
 _ r e s t o r e T r a n s i t i o n s ( ) ; r e t u r n   c s s V a l u e s . j o i n ( '   ' ) ; } } } , _ c o m p u t e W i d g e t V i s i b i l i t y : a s y n c   f u n c t i o n ( w i d g e t N a m e , p a r a m s ) { i f ( w i d g e t N a m e = = = ' m o v e _ u p _ o p t ' | | w i d g e t N a m e = = = ' m o v e _ l e f t _ o p t ' ) { r e t u r n ! t h i s . $ t a r g e t . i s ( ' : f i r s t - c h i l d ' ) ; } 
 i f ( w i d g e t N a m e = = = ' m o v e _ d o w n _ o p t ' | | w i d g e t N a m e = = = ' m o v e _ r i g h t _ o p t ' ) { r e t u r n ! t h i s . $ t a r g e t . i s ( ' : l a s t - c h i l d ' ) ; } 
 r e t u r n   t r u e ; } , _ e x t r a I n f o F r o m D e s c r i p t i o n E l e m e n t : f u n c t i o n ( e l ) { r e t u r n { t i t l e : e l . g e t A t t r i b u t e ( ' s t r i n g ' ) , o p t i o n s : { c l a s s e s : e l . c l a s s L i s t , d a t a A t t r i b u t e s : e l . d a t a s e t , t o o l t i p : e l . t i t l e , p l a c e h o l d e r : e l . g e t A t t r i b u t e ( ' p l a c e h o l d e r ' ) , c h i l d N o d e s : [ . . . e l . c h i l d N o d e s ] , } , } ; } , _ n o r m a l i z e W i d g e t V a l u e : f u n c t i o n ( v a l u e ) { v a l u e = ` $ { v a l u e } ` . t r i m ( ) ; v a l u e = C o l o r p i c k e r W i d g e t . n o r m a l i z e C S S C o l o r ( v a l u e ) ; r e t u r n   v a l u e ; } , _ r e g i s t e r U s e r V a l u e W i d g e t : f u n c t i o n ( w i d g e t N a m e , p a r e n t , t i t l e , o p t i o n s ) { c o n s t   w i d g e t = n e w   u s e r V a l u e W i d g e t s R e g i s t r y [ w i d g e t N a m e ] ( p a r e n t , t i t l e , o p t i o n s , t h i s . $ t a r g e t ) ; i f ( ! p a r e n t | | p a r e n t = = = t h i s ) { t h i s . _ u s e r V a l u e W i d g e t s . p u s h ( w i d g e t ) ; } e l s e { p a r e n t . r e g i s t e r S u b W i d g e t ( w i d g e t ) ; } 
 r e t u r n   w i d g e t ; } , _ r e n d e r C u s t o m W i d g e t s : f u n c t i o n ( u i F r a g m e n t ) { r e t u r n   P r o m i s e . r e s o l v e ( ) ; } , _ r e n d e r C u s t o m X M L : f u n c t i o n ( u i F r a g m e n t ) { r e t u r n   P r o m i s e . r e s o l v e ( ) ; } , _ r e n d e r O r i g i n a l X M L : a s y n c   f u n c t i o n ( $ x m l ) { c o n s t   u i F r a g m e n t = d o c u m e n t . c r e a t e D o c u m e n t F r a g m e n t ( ) ; ( $ x m l | | t h i s . $ o r i g i n a l U I E l e m e n t s ) . c l o n e ( t r u e ) . a p p e n d T o ( u i F r a g m e n t ) ; a w a i t   t h i s . _ r e n d e r C u s t o m X M L ( u i F r a g m e n t ) ; f o r ( c o n s t [ i t e m N a m e , b u i l d ] o f [ [ ' w e - r o w ' , _ b u i l d R o w E l e m e n t ] , [ ' w e - c o l l a p s e ' , _ b u i l d C o l l a p s e E l e m e n t ] ] ) { u i F r a g m e n t . q u e r y S e l e c t o r A l l ( i t e m N a m e ) . f o r E a c h ( e l = > { c o n s t   i n f o s = t h i s . _ e x t r a I n f o F r o m D e s c r i p t i o n E l e m e n t ( e l ) ; c o n s t   g r o u p E l = b u i l d ( i n f o s . t i t l e , i n f o s . o p t i o n s ) ; e l . p a r e n t N o d e . i n s e r t B e f o r e ( g r o u p E l , e l ) ; e l . p a r e n t N o d e . r e m o v e C h i l d ( e l ) ; } ) ; } 
 a w a i t   t h i s . _ r e n d e r X M L W i d g e t s ( u i F r a g m e n t ) ; a w a i t   t h i s . _ r e n d e r C u s t o m W i d g e t s ( u i F r a g m e n t ) ; i f ( t h i s . i s D e s t r o y e d ( ) ) { r e t u r n   u i F r a g m e n t ; } 
 c o n s t   v a l i d M e t h o d N a m e s = [ ] ; f o r ( c o n s t   k e y   i n   t h i s ) { v a l i d M e t h o d N a m e s . p u s h ( k e y ) ; } 
 t h i s . _ u s e r V a l u e W i d g e t s . f o r E a c h ( w i d g e t = > { w i d g e t . l o a d M e t h o d s D a t a ( v a l i d M e t h o d N a m e s ) ; } ) ; r e t u r n   u i F r a g m e n t ; } , _ r e n d e r X M L W i d g e t s : f u n c t i o n ( p a r e n t E l , p a r e n t W i d g e t ) { c o n s t   p r o m s = [ . . . p a r e n t E l . c h i l d r e n ] . m a p ( e l = > { c o n s t   w i d g e t N a m e = e l . t a g N a m e . t o L o w e r C a s e ( ) ; i f ( ! u s e r V a l u e W i d g e t s R e g i s t r y . h a s O w n P r o p e r t y ( w i d g e t N a m e ) ) { r e t u r n   t h i s . _ r e n d e r X M L W i d g e t s ( e l , p a r e n t W i d g e t ) ; } 
 c o n s t   i n f o s = t h i s . _ e x t r a I n f o F r o m D e s c r i p t i o n E l e m e n t ( e l ) ; c o n s t   w i d g e t = t h i s . _ r e g i s t e r U s e r V a l u e W i d g e t ( w i d g e t N a m e , p a r e n t W i d g e t | | t h i s , i n f o s . t i t l e , i n f o s . o p t i o n s ) ; r e t u r n   w i d g e t . i n s e r t A f t e r ( e l ) . t h e n ( ( ) = > { p a r e n t E l . r e m o v e C h i l d ( e l ) ; i f ( w i d g e t . i s C o n t a i n e r ( ) ) { r e t u r n   t h i s . _ r e n d e r X M L W i d g e t s ( w i d g e t . e l , w i d g e t ) ; } } ) ; } ) ; r e t u r n   P r o m i s e . a l l ( p r o m s ) ; } , _ r e q u e s t U s e r V a l u e W i d g e t s : f u n c t i o n ( . . . w i d g e t N a m e s ) { c o n s t   w i d g e t s = [ ] ; f o r ( c o n s t   w i d g e t N a m e   o f   w i d g e t N a m e s ) { l e t   w i d g e t = n u l l ; t h i s . t r i g g e r _ u p ( ' u s e r _ v a l u e _ w i d g e t _ r e q u e s t ' , { n a m e : w i d g e t N a m e , o n S u c c e s s : _ w i d g e t = > w i d g e t = _ w i d g e t , } ) ; i f ( w i d g e t ) { w i d g e t s . p u s h ( w i d g e t ) ; } } 
 r e t u r n   w i d g e t s ; } , _ r e r e n d e r X M L : a s y n c   f u n c t i o n ( c a l l b a c k ) { t h i s . _ u s e r V a l u e W i d g e t s . f o r E a c h ( w i d g e t = > w i d g e t . d e s t r o y ( ) ) ; t h i s . _ u s e r V a l u e W i d g e t s = [ ] ; t h i s . $ e l . e m p t y ( ) ; l e t   $ x m l = u n d e f i n e d ; i f ( c a l l b a c k ) { $ x m l = a w a i t   c a l l b a c k . c a l l ( t h i s ) ; } 
 r e t u r n   t h i s . _ r e n d e r O r i g i n a l X M L ( $ x m l ) . t h e n ( u i F r a g m e n t = > { t h i s . $ e l . a p p e n d ( u i F r a g m e n t ) ; r e t u r n   t h i s . u p d a t e U I ( ) ; } ) ; } , _ s e l e c t : a s y n c   f u n c t i o n ( p r e v i e w M o d e , w i d g e t ) { l e t   $ a p p l y T o = n u l l ; f o r ( c o n s t   m e t h o d N a m e   o f   w i d g e t . g e t M e t h o d s N a m e s ( ) ) { c o n s t   w i d g e t V a l u e = w i d g e t . g e t V a l u e ( m e t h o d N a m e ) ; c o n s t   p a r a m s = w i d g e t . g e t M e t h o d s P a r a m s ( m e t h o d N a m e ) ; i f ( p a r a m s . a p p l y T o ) { i f ( ! $ a p p l y T o ) { $ a p p l y T o = t h i s . $ ( p a r a m s . a p p l y T o ) ; } 
 c o n s t   p r o m s = _ . m a p ( $ a p p l y T o , s u b T a r g e t E l = > { c o n s t   p r o x y = c r e a t e P r o p e r t y P r o x y ( t h i s , ' $ t a r g e t ' , $ ( s u b T a r g e t E l ) ) ; r e t u r n   t h i s [ m e t h o d N a m e ] . c a l l ( p r o x y , p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) ; } ) ; a w a i t   P r o m i s e . a l l ( p r o m s ) ; } e l s e { a w a i t   t h i s [ m e t h o d N a m e ] ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) ; } } 
 ( $ a p p l y T o | | t h i s . $ t a r g e t ) . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } , _ s e l e c t A t t r i b u t e H e l p e r ( v a l u e , p a r a m s ) { i f ( ! p a r a m s . a t t r i b u t e N a m e ) { t h r o w   n e w   E r r o r ( ' A t t r i b u t e   n a m e   m i s s i n g ' ) ; } 
 i f ( p a r a m s . s a v e U n i t & & ! p a r a m s . w i t h U n i t ) { v a l u e = v a l u e . s p l i t ( p a r a m s . s a v e U n i t ) . j o i n ( ' ' ) ; } 
 i f ( p a r a m s . e x t r a C l a s s ) { t h i s . $ t a r g e t . t o g g l e C l a s s ( p a r a m s . e x t r a C l a s s , p a r a m s . d e f a u l t V a l u e ! = = v a l u e ) ; } 
 r e t u r n   v a l u e ; } , _ t o g g l e C o l l a p s e E l ( c o l l a p s e E l , s h o w ) { c o l l a p s e E l . c l a s s L i s t . t o g g l e ( ' a c t i v e ' , s h o w ) ; c o l l a p s e E l . q u e r y S e l e c t o r ( ' . o _ w e _ c o l l a p s e _ t o g g l e r ' ) . c l a s s L i s t . t o g g l e ( ' a c t i v e ' , s h o w ) ; } , _ o n C o l l a p s e T o g g l e r C l i c k ( e v ) { c o n s t   c u r r e n t C o l l a p s e E l = e v . c u r r e n t T a r g e t . p a r e n t N o d e ; t h i s . _ t o g g l e C o l l a p s e E l ( c u r r e n t C o l l a p s e E l ) ; f o r ( c o n s t   c o l l a p s e E l   o f   c u r r e n t C o l l a p s e E l . q u e r y S e l e c t o r A l l ( ' w e - c o l l a p s e ' ) ) { t h i s . _ t o g g l e C o l l a p s e E l ( c o l l a p s e E l , f a l s e ) ; } } , _ o n U s e r V a l u e U p d a t e : a s y n c   f u n c t i o n ( e v ) { e v . s t o p P r o p a g a t i o n ( ) ; c o n s t   w i d g e t = e v . d a t a . w i d g e t ; c o n s t   p r e v i e w M o d e = e v . d a t a . p r e v i e w M o d e ; l e t   r e q u i r e s R e l o a d = f a l s e ; i f ( ! e v . d a t a . p r e v i e w M o d e & & ! e v . d a t a . i s S i m u l a t e d E v e n t ) { c o n s t   l i n k e d W i d g e t s = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( . . . e v . d a t a . t r i g g e r W i d g e t s N a m e s ) ; c o n s t   w i d g e t s = [ e v . d a t a . w i d g e t ] . c o n c a t ( l i n k e d W i d g e t s ) ; c o n s t   w a r n M e s s a g e = a w a i t   t h i s . _ c h e c k I f W i d g e t s U p d a t e N e e d W a r n i n g ( w i d g e t s ) ; i f ( w a r n M e s s a g e ) { c o n s t   o k W a r n i n g = a w a i t   n e w   P r o m i s e ( r e s o l v e = > { D i a l o g . c o n f i r m ( t h i s , w a r n M e s s a g e , { c o n f i r m _ c a l l b a c k : ( ) = > r e s o l v e ( t r u e ) , c a n c e l _ c a l l b a c k : ( ) = > r e s o l v e ( f a l s e ) , } ) ; } ) ; i f ( ! o k W a r n i n g ) { r e t u r n ; } } 
 c o n s t   r e l o a d M e s s a g e = a w a i t   t h i s . _ c h e c k I f W i d g e t s U p d a t e N e e d R e l o a d ( w i d g e t s ) ; r e q u i r e s R e l o a d = ! ! r e l o a d M e s s a g e ; i f ( r e q u i r e s R e l o a d ) { c o n s t   s a v e = a w a i t   n e w   P r o m i s e ( r e s o l v e = > { D i a l o g . c o n f i r m ( t h i s , _ t ( " T h i s   c h a n g e   n e e d s   t o   r e l o a d   t h e   p a g e ,   t h i s   w i l l   s a v e   a l l   y o u r   c h a n g e s   a n d   r e l o a d   t h e   p a g e ,   a r e   y o u   s u r e   y o u   w a n t   t o   p r o c e e d ? " ) + '   ' 
 + ( t y p e o f   r e l o a d M e s s a g e = = = ' s t r i n g ' ? r e l o a d M e s s a g e : ' ' ) , { c o n f i r m _ c a l l b a c k : ( ) = > r e s o l v e ( t r u e ) , c a n c e l _ c a l l b a c k : ( ) = > r e s o l v e ( f a l s e ) , } ) ; } ) ; i f ( ! s a v e ) { r e t u r n ; } } } 
 i f ( ! t h i s . _ a c t i o n Q u e u e s . g e t ( w i d g e t ) ) { t h i s . _ a c t i o n Q u e u e s . s e t ( w i d g e t , [ ] ) ; } 
 c o n s t   c u r r e n t A c t i o n = { p r e v i e w M o d e } ; t h i s . _ a c t i o n Q u e u e s . g e t ( w i d g e t ) . p u s h ( c u r r e n t A c t i o n ) ; c o n s t   s h o u l d R e c o r d U n d o = ( ! p r e v i e w M o d e & & ! e v . d a t a . i s S i m u l a t e d E v e n t ) ; t h i s . t r i g g e r _ u p ( ' s n i p p e t _ e d i t i o n _ r e q u e s t ' , { e x e c : a s y n c ( ) = > { c o n s t   a c t i o n Q u e u e = t h i s . _ a c t i o n Q u e u e s . g e t ( w i d g e t ) . f i l t e r ( ( { p r e v i e w M o d e } , i , a c t i o n s ) = > { c o n s t   p r e v = a c t i o n s [ i - 1 ] ; c o n s t   n e x t = a c t i o n s [ i + 1 ] ; i f ( p r e v i e w M o d e = = = t r u e & & n e x t & & n e x t . p r e v i e w M o d e ) { r e t u r n   f a l s e ; } e l s e   i f ( p r e v i e w M o d e = = = ' r e s e t ' & & p r e v & & p r e v . p r e v i e w M o d e ) { r e t u r n   f a l s e ; } 
 r e t u r n   t r u e ; } ) ; i f ( ! a c t i o n Q u e u e . i n c l u d e s ( c u r r e n t A c t i o n ) ) { t h i s . _ a c t i o n Q u e u e s . s e t ( w i d g e t , a c t i o n Q u e u e ) ; r e t u r n ; } 
 t h i s . _ a c t i o n Q u e u e s . s e t ( w i d g e t , a c t i o n Q u e u e . f i l t e r ( a c t i o n = > a c t i o n ! = = c u r r e n t A c t i o n ) ) ; i f ( e v . d a t a . p r e p a r e ) { e v . d a t a . p r e p a r e ( ) ; } 
 i f ( p r e v i e w M o d e & & ( w i d g e t . $ e l . c l o s e s t ( ' [ d a t a - n o - p r e v i e w = " t r u e " ] ' ) . l e n g t h ) ) { r e t u r n ; } 
 i f ( s h o u l d R e c o r d U n d o ) { t h i s . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : t h i s . $ t a r g e t } ) ; } 
 a w a i t   t h i s . _ s e l e c t ( p r e v i e w M o d e , w i d g e t ) ; i f ( p r e v i e w M o d e ) { r e t u r n ; } 
 a w a i t   n e w   P r o m i s e ( r e s o l v e = > s e t T i m e o u t ( ( ) = > { t h i s . t r i g g e r _ u p ( ' s n i p p e t _ o p t i o n _ u p d a t e ' , { o n S u c c e s s : ( ) = > r e s o l v e ( ) , } ) ; } ) ) ; } } ) ; i f ( e v . d a t a . i s S i m u l a t e d E v e n t ) { r e t u r n ; } 
 c o n s t   l i n k e d W i d g e t s = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( . . . e v . d a t a . t r i g g e r W i d g e t s N a m e s ) ; i f ( l i n k e d W i d g e t s . l e n g t h ! = = e v . d a t a . t r i g g e r W i d g e t s N a m e s . l e n g t h ) { c o n s o l e . w a r n ( ' M i s s i n g   w i d g e t   t o   t r i g g e r ' ) ; r e t u r n ; } 
 l e t   i = 0 ; c o n s t   t r i g g e r W i d g e t s V a l u e s = e v . d a t a . t r i g g e r W i d g e t s V a l u e s ; f o r ( c o n s t   l i n k e d W i d g e t   o f   l i n k e d W i d g e t s ) { c o n s t   w i d g e t V a l u e = t r i g g e r W i d g e t s V a l u e s [ i ] ; i f ( w i d g e t V a l u e ! = = u n d e f i n e d ) { c o n s t   n o r m V a l u e = t h i s . _ n o r m a l i z e W i d g e t V a l u e ( w i d g e t V a l u e ) ; i f ( p r e v i e w M o d e = = = t r u e ) { l i n k e d W i d g e t . _ p r e v i e w C o l o r = n o r m V a l u e ; } e l s e   i f ( p r e v i e w M o d e = = = f a l s e ) { l i n k e d W i d g e t . _ p r e v i e w C o l o r = f a l s e ; l i n k e d W i d g e t . _ v a l u e = n o r m V a l u e ; } e l s e { l i n k e d W i d g e t . _ p r e v i e w C o l o r = f a l s e ; } } 
 l i n k e d W i d g e t . n o t i f y V a l u e C h a n g e ( p r e v i e w M o d e , t r u e ) ; i + + ; } 
 i f ( r e q u i r e s R e l o a d ) { t h i s . t r i g g e r _ u p ( ' r e q u e s t _ s a v e ' , { r e l o a d E d i t o r : t r u e , } ) ; } } , _ o n U s e r V a l u e W i d g e t C r i t i c a l ( ) { t h i s . t r i g g e r _ u p ( ' r e m o v e _ s n i p p e t ' , { $ s n i p p e t : t h i s . $ t a r g e t , } ) ; } , } ) ; c o n s t   r e g i s t r y = { } ; r e g i s t r y . s i z i n g = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { s t a r t : f u n c t i o n ( ) { v a r   s e l f = t h i s ; v a r   d e f = t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . $ h a n d l e s = t h i s . $ o v e r l a y . f i n d ( ' . o _ h a n d l e ' ) ; v a r   r e s i z e V a l u e s = t h i s . _ g e t S i z e ( ) ; t h i s . $ h a n d l e s . o n ( ' m o u s e d o w n ' , f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; r e s i z e V a l u e s = s e l f . _ g e t S i z e ( ) ; v a r   $ h a n d l e = $ ( e v . c u r r e n t T a r g e t ) ; v a r   c o m p a s s = f a l s e ; v a r   X Y = f a l s e ; i f ( $ h a n d l e . h a s C l a s s ( ' n ' ) ) { c o m p a s s = ' n ' ; X Y = ' Y ' ; } e l s e   i f ( $ h a n d l e . h a s C l a s s ( ' s ' ) ) { c o m p a s s = ' s ' ; X Y = ' Y ' ; } e l s e   i f ( $ h a n d l e . h a s C l a s s ( ' e ' ) ) { c o m p a s s = ' e ' ; X Y = ' X ' ; } e l s e   i f ( $ h a n d l e . h a s C l a s s ( ' w ' ) ) { c o m p a s s = ' w ' ; X Y = ' X ' ; } 
 v a r   r e s i z e = r e s i z e V a l u e s [ c o m p a s s ] ; i f ( ! r e s i z e ) { r e t u r n ; } 
 v a r   c u r r e n t = 0 ; v a r   c s s P r o p e r t y = r e s i z e [ 2 ] ; v a r   c s s P r o p e r t y V a l u e = p a r s e I n t ( s e l f . $ t a r g e t . c s s ( c s s P r o p e r t y ) ) ; _ . e a c h ( r e s i z e [ 0 ] , f u n c t i o n ( v a l , k e y ) { i f ( s e l f . $ t a r g e t . h a s C l a s s ( v a l ) ) { c u r r e n t = k e y ; } e l s e   i f ( r e s i z e [ 1 ] [ k e y ] = = = c s s P r o p e r t y V a l u e ) { c u r r e n t = k e y ; } } ) ; v a r   b e g i n = c u r r e n t ; v a r   b e g i n C l a s s = s e l f . $ t a r g e t . a t t r ( ' c l a s s ' ) ; v a r   r e g C l a s s = n e w   R e g E x p ( ' \ \ s * ' + r e s i z e [ 0 ] [ b e g i n ] . r e p l a c e ( / [ - ] * [ 0 - 9 ] + / , ' [ - ] * [ 0 - 9 ] + ' ) , ' g ' ) ; v a r   c u r s o r = $ h a n d l e . c s s ( ' c u r s o r ' ) + ' - i m p o r t a n t ' ; v a r   $ b o d y = $ ( t h i s . o w n e r D o c u m e n t . b o d y ) ; $ b o d y . a d d C l a s s ( c u r s o r ) ; v a r   x y = e v [ ' p a g e ' + X Y ] ; v a r   b o d y M o u s e M o v e = f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; v a r   d d = e v [ ' p a g e ' + X Y ] - x y + r e s i z e [ 1 ] [ b e g i n ] ; v a r   n e x t = c u r r e n t + ( c u r r e n t + 1 = = = r e s i z e [ 1 ] . l e n g t h ? 0 : 1 ) ; v a r   p r e v = c u r r e n t ? ( c u r r e n t - 1 ) : 0 ; v a r   c h a n g e = f a l s e ; i f ( d d > ( 2 * r e s i z e [ 1 ] [ n e x t ] + r e s i z e [ 1 ] [ c u r r e n t ] ) / 3 ) { s e l f . $ t a r g e t . a t t r ( ' c l a s s ' , ( s e l f . $ t a r g e t . a t t r ( ' c l a s s ' ) | | ' ' ) . r e p l a c e ( r e g C l a s s , ' ' ) ) ; s e l f . $ t a r g e t . a d d C l a s s ( r e s i z e [ 0 ] [ n e x t ] ) ; c u r r e n t = n e x t ; c h a n g e = t r u e ; } 
 i f ( p r e v ! = = c u r r e n t & & d d < ( 2 * r e s i z e [ 1 ] [ p r e v ] + r e s i z e [ 1 ] [ c u r r e n t ] ) / 3 ) { s e l f . $ t a r g e t . a t t r ( ' c l a s s ' , ( s e l f . $ t a r g e t . a t t r ( ' c l a s s ' ) | | ' ' ) . r e p l a c e ( r e g C l a s s , ' ' ) ) ; s e l f . $ t a r g e t . a d d C l a s s ( r e s i z e [ 0 ] [ p r e v ] ) ; c u r r e n t = p r e v ; c h a n g e = t r u e ; } 
 i f ( c h a n g e ) { s e l f . _ o n R e s i z e ( c o m p a s s , b e g i n C l a s s , c u r r e n t ) ; s e l f . t r i g g e r _ u p ( ' c o v e r _ u p d a t e ' ) ; $ h a n d l e . a d d C l a s s ( ' o _ a c t i v e ' ) ; } } ; v a r   b o d y M o u s e U p = f u n c t i o n ( ) { $ b o d y . o f f ( ' m o u s e m o v e ' , b o d y M o u s e M o v e ) ; $ ( w i n d o w ) . o f f ( ' m o u s e u p ' , b o d y M o u s e U p ) ; $ b o d y . r e m o v e C l a s s ( c u r s o r ) ; $ h a n d l e . r e m o v e C l a s s ( ' o _ a c t i v e ' ) ; v a r   $ h a n d l e r s = s e l f . $ o v e r l a y . f i n d ( ' . o _ h a n d l e ' ) ; $ h a n d l e r s . a d d C l a s s ( ' o _ a c t i v e ' ) . d e l a y ( 3 0 0 ) . q u e u e ( f u n c t i o n ( ) { $ h a n d l e r s . r e m o v e C l a s s ( ' o _ a c t i v e ' ) . d e q u e u e ( ) ; } ) ; i f ( b e g i n = = = c u r r e n t ) { r e t u r n ; } 
 s e t T i m e o u t ( f u n c t i o n ( ) { s e l f . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : s e l f . $ t a r g e t , e v e n t : ' r e s i z e _ ' + X Y , } ) ; } , 0 ) ; } ; $ b o d y . o n ( ' m o u s e m o v e ' , b o d y M o u s e M o v e ) ; $ ( w i n d o w ) . o n ( ' m o u s e u p ' , b o d y M o u s e U p ) ; } ) ; r e t u r n   d e f ; } , o n F o c u s : f u n c t i o n ( ) { t h i s . _ o n R e s i z e ( ) ; } , o n B l u r : f u n c t i o n ( ) { t h i s . $ h a n d l e s . a d d C l a s s ( ' r e a d o n l y ' ) ; } , s e t T a r g e t : f u n c t i o n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . _ o n R e s i z e ( ) ; } , u p d a t e U I : a s y n c   f u n c t i o n ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; c o n s t   r e s i z e V a l u e s = t h i s . _ g e t S i z e ( ) ; _ . e a c h ( r e s i z e V a l u e s , ( v a l u e , k e y ) = > { t h i s . $ h a n d l e s . f i l t e r ( ' . ' + k e y ) . t o g g l e C l a s s ( ' r e a d o n l y ' , ! v a l u e ) ; } ) ; } , _ g e t S i z e : f u n c t i o n ( ) { } , _ o n R e s i z e : f u n c t i o n ( c o m p a s s , b e g i n C l a s s , c u r r e n t ) { v a r   s e l f = t h i s ; v a r   r e s i z e V a l u e s = t h i s . _ g e t S i z e ( ) ; v a r   $ h a n d l e s = t h i s . $ o v e r l a y . f i n d ( ' . o _ h a n d l e ' ) ; _ . e a c h ( r e s i z e V a l u e s , f u n c t i o n ( r e s i z e V a l u e , d i r e c t i o n ) { v a r   c l a s s e s = r e s i z e V a l u e [ 0 ] ; v a r   v a l u e s = r e s i z e V a l u e [ 1 ] ; v a r   c s s P r o p e r t y = r e s i z e V a l u e [ 2 ] ; v a r   $ h a n d l e = $ h a n d l e s . f i l t e r ( ' . ' + d i r e c t i o n ) ; v a r   c u r r e n t = 0 ; v a r   c s s P r o p e r t y V a l u e = p a r s e I n t ( s e l f . $ t a r g e t . c s s ( c s s P r o p e r t y ) ) ; _ . e a c h ( c l a s s e s , f u n c t i o n ( c l a s s N a m e , k e y ) { i f ( s e l f . $ t a r g e t . h a s C l a s s ( c l a s s N a m e ) ) { c u r r e n t = k e y ; } e l s e   i f ( v a l u e s [ k e y ] = = = c s s P r o p e r t y V a l u e ) { c u r r e n t = k e y ; } } ) ; $ h a n d l e . t o g g l e C l a s s ( ' o _ h a n d l e _ s t a r t ' , c u r r e n t = = = 0 ) ; $ h a n d l e . t o g g l e C l a s s ( ' o _ h a n d l e _ e n d ' , c u r r e n t = = = c l a s s e s . l e n g t h - 1 ) ; } ) ; v a r   m l = t h i s . $ t a r g e t . c s s ( ' m a r g i n - l e f t ' ) ; t h i s . $ o v e r l a y . f i n d ( ' . o _ h a n d l e . w ' ) . c s s ( { w i d t h : m l , l e f t : ' - ' + m l , } ) ; t h i s . $ o v e r l a y . f i n d ( ' . o _ h a n d l e . e ' ) . c s s ( { w i d t h : 0 , } ) ; _ . e a c h ( t h i s . $ o v e r l a y . f i n d ( " . o _ h a n d l e . n ,   . o _ h a n d l e . s " ) , f u n c t i o n ( h a n d l e ) { v a r   $ h a n d l e = $ ( h a n d l e ) ; v a r   d i r e c t i o n = $ h a n d l e . h a s C l a s s ( ' n ' ) ? ' t o p ' : ' b o t t o m ' ; $ h a n d l e . h e i g h t ( s e l f . $ t a r g e t . c s s ( ' p a d d i n g - ' + d i r e c t i o n ) ) ; } ) ; t h i s . $ t a r g e t . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; } , } ) ; r e g i s t r y [ ' s i z i n g _ y ' ] = r e g i s t r y . s i z i n g . e x t e n d ( { _ g e t S i z e : f u n c t i o n ( ) { v a r   n C l a s s = ' p t ' ; v a r   n P r o p = ' p a d d i n g - t o p ' ; v a r   s C l a s s = ' p b ' ; v a r   s P r o p = ' p a d d i n g - b o t t o m ' ; i f ( t h i s . $ t a r g e t . i s ( ' h r ' ) ) { n C l a s s = ' m t ' ; n P r o p = ' m a r g i n - t o p ' ; s C l a s s = ' m b ' ; s P r o p = ' m a r g i n - b o t t o m ' ; } 
 v a r   g r i d = [ ] ; f o r ( v a r   i = 0 ; i < = ( 2 5 6 / 8 ) ; i + + ) { g r i d . p u s h ( i * 8 ) ; } 
 g r i d . s p l i c e ( 1 , 0 , 4 ) ; t h i s . g r i d = { n : [ g r i d . m a p ( v = > n C l a s s + v ) , g r i d , n P r o p ] , s : [ g r i d . m a p ( v = > s C l a s s + v ) , g r i d , s P r o p ] , } ; r e t u r n   t h i s . g r i d ; } , } ) ; c o n s t   I m a g e H a n d l e r O p t i o n = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { a s y n c   w i l l S t a r t ( ) { c o n s t   _ s u p e r = t h i s . _ s u p e r . b i n d ( t h i s ) ; a w a i t   t h i s . _ l o a d I m a g e I n f o ( ) ; c o n s t   i m g = t h i s . _ g e t I m g ( ) ; a w a i t   n e w   P r o m i s e ( ( r e s o l v e , r e j e c t ) = > { i f ( i m g . c o m p l e t e ) { r e t u r n   r e s o l v e ( ) ; } 
 i m g . a d d E v e n t L i s t e n e r ( ' l o a d ' , r e s o l v e , { o n c e : t r u e } ) ; i m g . a d d E v e n t L i s t e n e r ( ' e r r o r ' , r e s o l v e , { o n c e : t r u e } ) ; } ) ; r e t u r n   _ s u p e r ( . . . a r g u m e n t s ) ; } , s e l e c t W i d t h ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . _ g e t I m g ( ) . d a t a s e t . r e s i z e W i d t h = w i d g e t V a l u e ; r e t u r n   t h i s . _ a p p l y O p t i o n s ( ) ; } , s e t Q u a l i t y ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . _ g e t I m g ( ) . d a t a s e t . q u a l i t y = w i d g e t V a l u e ; r e t u r n   t h i s . _ a p p l y O p t i o n s ( ) ; } , g l F i l t e r ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { c o n s t   d a t a s e t = t h i s . _ g e t I m g ( ) . d a t a s e t ; i f ( w i d g e t V a l u e ) { d a t a s e t . g l F i l t e r = w i d g e t V a l u e ; } e l s e { d e l e t e   d a t a s e t . g l F i l t e r ; } 
 r e t u r n   t h i s . _ a p p l y O p t i o n s ( ) ; } , c u s t o m F i l t e r ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { c o n s t   i m g = t h i s . _ g e t I m g ( ) ; c o n s t { f i l t e r O p t i o n s } = i m g . d a t a s e t ; c o n s t { f i l t e r P r o p e r t y } = p a r a m s ; i f ( f i l t e r P r o p e r t y = = = ' f i l t e r C o l o r ' ) { w i d g e t V a l u e = n o r m a l i z e C o l o r ( w i d g e t V a l u e ) ; } 
 c o n s t   n e w O p t i o n s = O b j e c t . a s s i g n ( J S O N . p a r s e ( f i l t e r O p t i o n s | | " { } " ) , { [ f i l t e r P r o p e r t y ] : w i d g e t V a l u e } ) ; i m g . d a t a s e t . f i l t e r O p t i o n s = J S O N . s t r i n g i f y ( n e w O p t i o n s ) ; r e t u r n   t h i s . _ a p p l y O p t i o n s ( ) ; } , _ c o m p u t e V i s i b i l i t y ( ) { c o n s t   i m g = t h i s . _ g e t I m g ( ) ; i f ( ! [ ' i m a g e / j p e g ' , ' i m a g e / p n g ' ] . i n c l u d e s ( i m g . d a t a s e t . m i m e t y p e ) ) { r e t u r n   f a l s e ; } 
 c o n s t   s r c = i m g . g e t A t t r i b u t e ( ' s r c ' ) ; r e t u r n   s r c & & s r c ! = = ' / ' ; } , _ c o m p u t e W i d g e t S t a t e ( m e t h o d N a m e , p a r a m s ) { c o n s t   i m g = t h i s . _ g e t I m g ( ) ; s w i t c h ( m e t h o d N a m e ) { c a s e ' s e l e c t W i d t h ' : r e t u r n   i m g . n a t u r a l W i d t h ; c a s e ' s e t F i l t e r ' : r e t u r n   i m g . d a t a s e t . f i l t e r ; c a s e ' g l F i l t e r ' : r e t u r n   i m g . d a t a s e t . g l F i l t e r | | " " ; c a s e ' s e t Q u a l i t y ' : r e t u r n   i m g . d a t a s e t . q u a l i t y | | 7 5 ; c a s e ' c u s t o m F i l t e r ' : { c o n s t { f i l t e r P r o p e r t y } = p a r a m s ; c o n s t   o p t i o n s = J S O N . p a r s e ( i m g . d a t a s e t . f i l t e r O p t i o n s | | " { } " ) ; c o n s t   d e f a u l t V a l u e = f i l t e r P r o p e r t y = = = ' b l e n d ' ? ' n o r m a l ' : 0 ; r e t u r n   o p t i o n s [ f i l t e r P r o p e r t y ] | | d e f a u l t V a l u e ; } } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , a s y n c   _ r e n d e r C u s t o m X M L ( u i F r a g m e n t ) { i f ( ! t h i s . o r i g i n a l S r c ) { r e t u r n [ . . . u i F r a g m e n t . c h i l d N o d e s ] . f o r E a c h ( n o d e = > { i f ( n o d e . m a t c h e s ( ' . o _ w e _ e x t e r n a l _ w a r n i n g ' ) ) { n o d e . c l a s s L i s t . r e m o v e ( ' d - n o n e ' ) ; } e l s e { n o d e . r e m o v e ( ) ; } } ) ; } 
 c o n s t   i m g = t h i s . _ g e t I m g ( ) ; c o n s t   $ s e l e c t = $ ( u i F r a g m e n t ) . f i n d ( ' w e - s e l e c t [ d a t a - n a m e = w i d t h _ s e l e c t _ o p t ] ' ) ; ( a w a i t   t h i s . _ c o m p u t e A v a i l a b l e W i d t h s ( ) ) . f o r E a c h ( ( [ v a l u e , l a b e l ] ) = > { $ s e l e c t . a p p e n d ( ` < w e - b u t t o n   d a t a - s e l e c t - w i d t h = " $ { v a l u e } " > $ { l a b e l } < / w e - b u t t o n > ` ) ; } ) ; c o n s t   q u a l i t y R a n g e = u i F r a g m e n t . q u e r y S e l e c t o r ( ' w e - r a n g e ' ) ; i f ( i m g . d a t a s e t . m i m e t y p e ! = = ' i m a g e / j p e g ' ) { q u a l i t y R a n g e . r e m o v e ( ) ; } } , a s y n c   _ c o m p u t e A v a i l a b l e W i d t h s ( ) { c o n s t   i m g = t h i s . _ g e t I m g ( ) ; c o n s t   o r i g i n a l = a w a i t   l o a d I m a g e ( t h i s . o r i g i n a l S r c ) ; c o n s t   m a x W i d t h = i m g . d a t a s e t . w i d t h ? i m g . n a t u r a l W i d t h : o r i g i n a l . n a t u r a l W i d t h ; c o n s t   o p t i m i z e d W i d t h = M a t h . m i n ( m a x W i d t h , t h i s . _ c o m p u t e M a x D i s p l a y W i d t h ( ) ) ; t h i s . o p t i m i z e d W i d t h = o p t i m i z e d W i d t h ; c o n s t   w i d t h s = { 1 2 8 : ' 1 2 8 p x ' , 2 5 6 : ' 2 5 6 p x ' , 5 1 2 : ' 5 1 2 p x ' , 1 0 2 4 : ' 1 0 2 4 p x ' , 1 9 2 0 : ' 1 9 2 0 p x ' , } ; w i d t h s [ i m g . n a t u r a l W i d t h ] = _ . s t r . s p r i n t f ( _ t ( " % s p x " ) , i m g . n a t u r a l W i d t h ) ; w i d t h s [ o p t i m i z e d W i d t h ] = _ . s t r . s p r i n t f ( _ t ( " % d p x   ( S u g g e s t e d ) " ) , o p t i m i z e d W i d t h ) ; w i d t h s [ m a x W i d t h ] = _ . s t r . s p r i n t f ( _ t ( " % d p x   ( O r i g i n a l ) " ) , m a x W i d t h ) ; r e t u r n   O b j e c t . e n t r i e s ( w i d t h s ) . f i l t e r ( ( [ w i d t h ] ) = > w i d t h < = m a x W i d t h ) . s o r t ( ( [ v 1 ] , [ v 2 ] ) = > v 1 - v 2 ) ; } , a s y n c   _ a p p l y O p t i o n s ( ) { c o n s t   i m g = t h i s . _ g e t I m g ( ) ; i f ( ! [ ' i m a g e / j p e g ' , ' i m a g e / p n g ' ] . i n c l u d e s ( i m g . d a t a s e t . m i m e t y p e ) ) { t h i s . o r i g i n a l I d = n u l l ; r e t u r n ; } 
 c o n s t   d a t a U R L = a w a i t   a p p l y M o d i f i c a t i o n s ( i m g ) ; c o n s t   w e i g h t = d a t a U R L . s p l i t ( ' , ' ) [ 1 ] . l e n g t h / 4 * 3 ; c o n s t   $ w e i g h t = t h i s . $ e l . f i n d ( ' . o _ w e _ i m a g e _ w e i g h t ' ) ; $ w e i g h t . f i n d ( ' >   s m a l l ' ) . t e x t ( _ t ( " N e w   s i z e " ) ) ; $ w e i g h t . f i n d ( ' b ' ) . t e x t ( ` $ { ( w e i g h t   /   1 0 2 4 ) . t o F i x e d ( 1 ) }   k b ` ) ; $ w e i g h t . r e m o v e C l a s s ( ' d - n o n e ' ) ; i m g . c l a s s L i s t . a d d ( ' o _ m o d i f i e d _ i m a g e _ t o _ s a v e ' ) ; r e t u r n   l o a d I m a g e ( d a t a U R L , i m g ) ; } , a s y n c   _ l o a d I m a g e I n f o ( ) { c o n s t   i m g = t h i s . _ g e t I m g ( ) ; a w a i t   l o a d I m a g e I n f o ( i m g , t h i s . _ r p c . b i n d ( t h i s ) ) ; i f ( ! i m g . d a t a s e t . o r i g i n a l I d ) { t h i s . o r i g i n a l I d = n u l l ; t h i s . o r i g i n a l S r c = n u l l ; r e t u r n ; } 
 t h i s . o r i g i n a l I d = i m g . d a t a s e t . o r i g i n a l I d ; t h i s . o r i g i n a l S r c = i m g . d a t a s e t . o r i g i n a l S r c ; } , a s y n c   _ a u t o O p t i m i z e I m a g e ( ) { a w a i t   t h i s . _ l o a d I m a g e I n f o ( ) ; a w a i t   t h i s . _ r e r e n d e r X M L ( ) ; t h i s . _ g e t I m g ( ) . d a t a s e t . r e s i z e W i d t h = t h i s . o p t i m i z e d W i d t h ; a w a i t   t h i s . _ a p p l y O p t i o n s ( ) ; a w a i t   t h i s . u p d a t e U I ( ) ; } , _ g e t I m g ( ) { } , _ c o m p u t e M a x D i s p l a y W i d t h ( ) { } , } ) ; r e g i s t r y . I m a g e O p t i m i z e = I m a g e H a n d l e r O p t i o n . e x t e n d ( { s t a r t ( ) { t h i s . $ t a r g e t . o n ( ' i m a g e _ c h a n g e d . I m a g e O p t i m i z a t i o n ' , t h i s . _ o n I m a g e C h a n g e d . b i n d ( t h i s ) ) ; t h i s . $ t a r g e t . o n ( ' i m a g e _ c r o p p e d . I m a g e O p t i m i z a t i o n ' , t h i s . _ o n I m a g e C r o p p e d . b i n d ( t h i s ) ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , d e s t r o y ( ) { t h i s . $ t a r g e t . o f f ( ' . I m a g e O p t i m i z a t i o n ' ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ c o m p u t e M a x D i s p l a y W i d t h ( ) { c o n s t   d i s p l a y W i d t h = t h i s . _ g e t I m g ( ) . c l i e n t W i d t h ; i f ( t h i s . $ t a r g e t . c l o s e s t ( ' [ c l a s s * = " c o l - l g " ] ' ) . l e n g t h ) { i f ( t h i s . $ t a r g e t . c l o s e s t ( ' . c o n t a i n e r ,   . o _ c o n t a i n e r _ s m a l l ' ) . l e n g t h ) { r e t u r n   M a t h . m i n ( 1 9 2 0 , M a t h . m a x ( d i s p l a y W i d t h , 6 9 0 ) ) ; } 
 r e t u r n   M a t h . m i n ( 1 9 2 0 , M a t h . m a x ( d i s p l a y W i d t h , 9 6 2 ) ) ; } 
 r e t u r n   d i s p l a y W i d t h ; } , _ g e t I m g ( ) { r e t u r n   t h i s . $ t a r g e t [ 0 ] ; } , a s y n c   _ o n I m a g e C h a n g e d ( e v ) { t h i s . t r i g g e r _ u p ( ' s n i p p e t _ e d i t i o n _ r e q u e s t ' , { e x e c : a s y n c ( ) = > { a w a i t   t h i s . _ a u t o O p t i m i z e I m a g e ( ) ; t h i s . t r i g g e r _ u p ( ' c o v e r _ u p d a t e ' ) ; } } ) ; } , a s y n c   _ o n I m a g e C r o p p e d ( e v ) { a w a i t   t h i s . _ r e r e n d e r X M L ( ) ; } , } ) ; r e g i s t r y . B a c k g r o u n d O p t i m i z e = I m a g e H a n d l e r O p t i o n . e x t e n d ( { s t a r t ( ) { t h i s . $ t a r g e t . o n ( ' b a c k g r o u n d _ c h a n g e d . B a c k g r o u n d O p t i m i z e ' , t h i s . _ o n B a c k g r o u n d C h a n g e d . b i n d ( t h i s ) ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , d e s t r o y ( ) { t h i s . $ t a r g e t . o f f ( ' . B a c k g r o u n d O p t i m i z e ' ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , a s y n c   c l e a n F o r S a v e ( ) { c o n s t   i m g = t h i s . _ g e t I m g ( ) ; i f ( i m g . m a t c h e s ( ' . o _ m o d i f i e d _ i m a g e _ t o _ s a v e ' ) ) { t h i s . $ t a r g e t . a d d C l a s s ( ' o _ m o d i f i e d _ i m a g e _ t o _ s a v e ' ) ; O b j e c t . e n t r i e s ( i m g . d a t a s e t ) . f o r E a c h ( ( [ k e y , v a l u e ] ) = > { t h i s . $ t a r g e t [ 0 ] . d a t a s e t [ k e y ] = v a l u e ; } ) ; t h i s . $ t a r g e t [ 0 ] . d a t a s e t . b g S r c = i m g . g e t A t t r i b u t e ( ' s r c ' ) ; } } , _ g e t I m g ( ) { r e t u r n   t h i s . i m g ; } , _ c o m p u t e M a x D i s p l a y W i d t h ( ) { r e t u r n   1 9 2 0 ; } , a s y n c   _ a p p l y O p t i o n s ( ) { a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - i m a g e ' , ` u r l ( ' $ { t h i s . _ g e t I m g ( ) . g e t A t t r i b u t e ( ' s r c ' ) } ' ) ` ) ; } , a s y n c   _ l o a d I m a g e I n f o ( ) { t h i s . i m g = n e w   I m a g e ( ) ; O b j e c t . e n t r i e s ( t h i s . $ t a r g e t [ 0 ] . d a t a s e t ) . f o r E a c h ( ( [ k e y , v a l u e ] ) = > { t h i s . i m g . d a t a s e t [ k e y ] = v a l u e ; } ) ; c o n s t   s r c = g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; t h i s . i m g . s r c = s r c . s t a r t s W i t h ( ' / ' ) ? s r c : ' ' ; r e t u r n   a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , a s y n c   _ o n B a c k g r o u n d C h a n g e d ( e v , p r e v i e w M o d e ) { i f ( ! p r e v i e w M o d e ) { t h i s . t r i g g e r _ u p ( ' s n i p p e t _ e d i t i o n _ r e q u e s t ' , { e x e c : a s y n c ( ) = > { a w a i t   t h i s . _ a u t o O p t i m i z e I m a g e ( ) ; } } ) ; } } , } ) ; r e g i s t r y . B a c k g r o u n d T o g g l e r = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { s t a r t ( ) { t h i s . $ t a r g e t . o n ( ' c o n t e n t _ c h a n g e d . B a c k g r o u n d T o g g l e r ' , t h i s . _ o n E x t e r n a l U p d a t e . b i n d ( t h i s ) ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , d e s t r o y ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . $ t a r g e t . o f f ( ' . B a c k g r o u n d T o g g l e r ' ) ; } , t o g g l e B g I m a g e ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { i f ( ! w i d g e t V a l u e ) { c o n s t [ b g I m a g e W i d g e t ] = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( ' b g _ i m a g e _ o p t ' ) ; c o n s t   b g I m a g e O p t = b g I m a g e W i d g e t . g e t P a r e n t ( ) ; r e t u r n   b g I m a g e O p t . b a c k g r o u n d ( f a l s e , ' ' , b g I m a g e W i d g e t . g e t M e t h o d s P a r a m s ( ' b a c k g r o u n d ' ) ) ; } e l s e { t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( ' b g _ i m a g e _ o p t ' ) [ 0 ] . e l . c l i c k ( ) ; } } , t o g g l e B g S h a p e ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { c o n s t [ s h a p e W i d g e t ] = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( ' b g _ s h a p e _ o p t ' ) ; c o n s t   s h a p e O p t i o n = s h a p e W i d g e t . g e t P a r e n t ( ) ; r e t u r n   s h a p e O p t i o n . _ t o g g l e S h a p e ( ) ; } , t o g g l e B g F i l t e r ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { i f ( w i d g e t V a l u e ) { c o n s t   b g F i l t e r E l = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; b g F i l t e r E l . c l a s s L i s t . a d d ( ' o _ w e _ b g _ f i l t e r ' , ' b g - b l a c k - 5 0 ' ) ; c o n s t   l a s t B a c k g r o u n d E l = t h i s . _ g e t L a s t P r e F i l t e r L a y e r E l e m e n t ( ) ; i f ( l a s t B a c k g r o u n d E l ) { $ ( l a s t B a c k g r o u n d E l ) . a f t e r ( b g F i l t e r E l ) ; } e l s e { t h i s . $ t a r g e t . p r e p e n d ( b g F i l t e r E l ) ; } } e l s e { t h i s . $ t a r g e t . f i n d ( ' . o _ w e _ b g _ f i l t e r ' ) . r e m o v e ( ) ; } } , _ c o m p u t e W i d g e t S t a t e ( m e t h o d N a m e , p a r a m s ) { s w i t c h ( m e t h o d N a m e ) { c a s e ' t o g g l e B g I m a g e ' : { c o n s t [ b g I m a g e W i d g e t ] = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( ' b g _ i m a g e _ o p t ' ) ; c o n s t   b g I m a g e O p t = b g I m a g e W i d g e t . g e t P a r e n t ( ) ; r e t u r n ! ! b g I m a g e O p t . _ c o m p u t e W i d g e t S t a t e ( ' b a c k g r o u n d ' , b g I m a g e W i d g e t . g e t M e t h o d s P a r a m s ( ' b a c k g r o u n d ' ) ) ; } 
 c a s e ' t o g g l e B g F i l t e r ' : { r e t u r n   t h i s . _ h a s B g F i l t e r ( ) ; } 
 c a s e ' t o g g l e B g S h a p e ' : { c o n s t [ s h a p e W i d g e t ] = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( ' b g _ s h a p e _ o p t ' ) ; c o n s t   s h a p e O p t i o n = s h a p e W i d g e t . g e t P a r e n t ( ) ; r e t u r n ! ! s h a p e O p t i o n . _ c o m p u t e W i d g e t S t a t e ( ' s h a p e ' , s h a p e W i d g e t . g e t M e t h o d s P a r a m s ( ' s h a p e ' ) ) ; } } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ g e t L a s t P r e F i l t e r L a y e r E l e m e n t ( ) { r e t u r n   n u l l ; } , _ h a s B g F i l t e r ( ) { r e t u r n ! ! t h i s . $ t a r g e t . f i n d ( ' >   . o _ w e _ b g _ f i l t e r ' ) . l e n g t h ; } , _ o n E x t e r n a l U p d a t e ( ) { i f ( t h i s . _ h a s B g F i l t e r ( ) & & ! t h i s . _ g e t L a s t P r e F i l t e r L a y e r E l e m e n t ( ) & & ! g e t B g I m a g e U R L ( t h i s . $ t a r g e t ) ) { c o n s t   w i d g e t = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( ' b g _ f i l t e r _ t o g g l e _ o p t ' ) [ 0 ] ; w i d g e t . $ e l . c l i c k ( ) ; } } , } ) ; r e g i s t r y . B a c k g r o u n d I m a g e = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { s t a r t : f u n c t i o n ( ) { t h i s . _ _ c u s t o m I m a g e S r c = g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , b a c k g r o u n d : a s y n c   f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { i f ( p r e v i e w M o d e = = = t r u e ) { t h i s . _ _ c u s t o m I m a g e S r c = g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; } e l s e   i f ( p r e v i e w M o d e = = = ' r e s e t ' ) { w i d g e t V a l u e = t h i s . _ _ c u s t o m I m a g e S r c ; } e l s e { t h i s . _ _ c u s t o m I m a g e S r c = w i d g e t V a l u e ; } 
 t h i s . _ s e t B a c k g r o u n d ( w i d g e t V a l u e ) ; i f ( p r e v i e w M o d e ! = = ' r e s e t ' ) { r e m o v e O n I m a g e C h a n g e A t t r s . f o r E a c h ( a t t r = > d e l e t e   t h i s . $ t a r g e t [ 0 ] . d a t a s e t [ a t t r ] ) ; t h i s . $ t a r g e t . t r i g g e r ( ' b a c k g r o u n d _ c h a n g e d ' , [ p r e v i e w M o d e ] ) ; } } , a s y n c   d y n a m i c C o l o r ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { c o n s t   c u r r e n t S r c = g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; s w i t c h ( p r e v i e w M o d e ) { c a s e   t r u e : t h i s . p r e v i o u s S r c = c u r r e n t S r c ; b r e a k ; c a s e ' r e s e t ' : t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - i m a g e ' , ` u r l ( ' $ { t h i s . p r e v i o u s S r c } ' ) ` ) ; r e t u r n ; } 
 c o n s t   n e w U R L = n e w   U R L ( c u r r e n t S r c , w i n d o w . l o c a t i o n . o r i g i n ) ; n e w U R L . s e a r c h P a r a m s . s e t ( ' c 1 ' , n o r m a l i z e C o l o r ( w i d g e t V a l u e ) ) ; c o n s t   s r c = n e w U R L . p a t h n a m e + n e w U R L . s e a r c h ; a w a i t   l o a d I m a g e ( s r c ) ; t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - i m a g e ' , ` u r l ( ' $ { s r c } ' ) ` ) ; i f ( ! p r e v i e w M o d e ) { t h i s . p r e v i o u s S r c = s r c ; } } , s e t T a r g e t : f u n c t i o n ( ) { c o n s t   o l d B g U R L = g e t B g I m a g e U R L ( t h i s . $ t a r g e t ) ; t h i s . _ s e t B a c k g r o u n d ( ' ' ) ; t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; i f ( o l d B g U R L ) { t h i s . _ s e t B a c k g r o u n d ( o l d B g U R L ) ; } 
 t h i s . _ _ c u s t o m I m a g e S r c = g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; } , _ c o m p u t e W i d g e t S t a t e : f u n c t i o n ( m e t h o d N a m e ) { s w i t c h ( m e t h o d N a m e ) { c a s e ' b a c k g r o u n d ' : r e t u r n   g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; c a s e ' d y n a m i c C o l o r ' : r e t u r n   n e w   U R L ( g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) , w i n d o w . l o c a t i o n . o r i g i n ) . s e a r c h P a r a m s . g e t ( ' c 1 ' ) ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ c o m p u t e W i d g e t V i s i b i l i t y ( w i d g e t N a m e , p a r a m s ) { i f ( w i d g e t N a m e = = = ' d y n a m i c _ c o l o r _ o p t ' ) { c o n s t   s r c = n e w   U R L ( g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) , w i n d o w . l o c a t i o n . o r i g i n ) ; r e t u r n   s r c . o r i g i n = = = w i n d o w . l o c a t i o n . o r i g i n & & s r c . p a t h n a m e . s t a r t s W i t h ( ' / w e b _ e d i t o r / s h a p e / ' ) ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ s e t B a c k g r o u n d ( b a c k g r o u n d U R L ) { i f ( b a c k g r o u n d U R L ) { t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - i m a g e ' , ` u r l ( ' $ { b a c k g r o u n d U R L } ' ) ` ) ; t h i s . $ t a r g e t . a d d C l a s s ( ' o e _ i m g _ b g ' ) ; } e l s e { t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - i m a g e ' , ' ' ) ; t h i s . $ t a r g e t . r e m o v e C l a s s ( ' o e _ i m g _ b g ' ) ; } } , } ) ; r e g i s t r y . B a c k g r o u n d S h a p e = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { u p d a t e U I ( ) { i f ( t h i s . r e r e n d e r ) { t h i s . r e r e n d e r = f a l s e ; r e t u r n   t h i s . _ r e r e n d e r X M L ( ) ; } 
 r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , s h a p e ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . _ h a n d l e P r e v i e w S t a t e ( p r e v i e w M o d e , ( ) = > { r e t u r n { s h a p e : w i d g e t V a l u e , c o l o r s : t h i s . _ g e t D e f a u l t C o l o r s ( ) , f l i p : [ ] } ; } ) ; } , c o l o r ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . _ h a n d l e P r e v i e w S t a t e ( p r e v i e w M o d e , ( ) = > { c o n s t { c o l o r N a m e } = p a r a m s ; c o n s t { c o l o r s : p r e v i o u s C o l o r s } = t h i s . _ g e t S h a p e D a t a ( ) ; c o n s t   n e w C o l o r = n o r m a l i z e C o l o r ( w i d g e t V a l u e ) | | t h i s . _ g e t D e f a u l t C o l o r s ( ) [ c o l o r N a m e ] ; c o n s t   n e w C o l o r s = O b j e c t . a s s i g n ( p r e v i o u s C o l o r s , { [ c o l o r N a m e ] : n e w C o l o r } ) ; r e t u r n { c o l o r s : n e w C o l o r s } ; } ) ; } , f l i p X ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . _ f l i p S h a p e ( p r e v i e w M o d e , ' x ' ) ; } , f l i p Y ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . _ f l i p S h a p e ( p r e v i e w M o d e , ' y ' ) ; } , _ c o m p u t e W i d g e t S t a t e ( m e t h o d N a m e , p a r a m s ) { s w i t c h ( m e t h o d N a m e ) { c a s e ' s h a p e ' : { r e t u r n   t h i s . _ g e t S h a p e D a t a ( ) . s h a p e ; } 
 c a s e ' c o l o r ' : { c o n s t { s h a p e , c o l o r s : c u s t o m C o l o r s } = t h i s . _ g e t S h a p e D a t a ( ) ; c o n s t   c o l o r s = O b j e c t . a s s i g n ( t h i s . _ g e t D e f a u l t C o l o r s ( ) , c u s t o m C o l o r s ) ; c o n s t   c o l o r = s h a p e & & c o l o r s [ p a r a m s . c o l o r N a m e ] ; r e t u r n   c o l o r | | ' ' ; } 
 c a s e ' f l i p X ' : { r e t u r n   t h i s . $ t a r g e t . f i n d ( ' >   . o _ w e _ s h a p e . o _ w e _ f l i p _ x ' ) . l e n g t h ! = = 0 ; } 
 c a s e ' f l i p Y ' : { r e t u r n   t h i s . $ t a r g e t . f i n d ( ' >   . o _ w e _ s h a p e . o _ w e _ f l i p _ y ' ) . l e n g t h ! = = 0 ; } } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ r e n d e r C u s t o m X M L ( u i F r a g m e n t ) { O b j e c t . k e y s ( t h i s . _ g e t D e f a u l t C o l o r s ( ) ) . m a p ( c o l o r N a m e = > { u i F r a g m e n t . q u e r y S e l e c t o r ( ' [ d a t a - n a m e = " c o l o r s " ] ' ) . p r e p e n d ( $ ( ` < w e - c o l o r p i c k e r   d a t a - c o l o r = " t r u e "   d a t a - c o l o r - n a m e = " $ { c o l o r N a m e } " > ` ) [ 0 ] ) ; } ) ; u i F r a g m e n t . q u e r y S e l e c t o r A l l ( ' w e - s e l e c t - p a g e r   w e - b u t t o n [ d a t a - s h a p e ] ' ) . f o r E a c h ( b t n = > { c o n s t   b t n C o n t e n t = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; b t n C o n t e n t . c l a s s L i s t . a d d ( ' o _ w e _ s h a p e _ b t n _ c o n t e n t ' , ' p o s i t i o n - r e l a t i v e ' , ' b o r d e r - d a r k ' ) ; c o n s t   b t n C o n t e n t I n n e r D i v = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; b t n C o n t e n t I n n e r D i v . c l a s s L i s t . a d d ( ' o _ w e _ s h a p e ' ) ; b t n C o n t e n t . a p p e n d C h i l d ( b t n C o n t e n t I n n e r D i v ) ; c o n s t { s h a p e } = b t n . d a t a s e t ; c o n s t   s h a p e E l = b t n C o n t e n t . q u e r y S e l e c t o r ( ' . o _ w e _ s h a p e ' ) ; s h a p e E l . c l a s s L i s t . a d d ( ` o _ $ { s h a p e . r e p l a c e ( / \ / / g ,   ' _ ' ) } ` ) ; b t n . a p p e n d ( b t n C o n t e n t ) ; } ) ; r e t u r n   u i F r a g m e n t ; } , a s y n c   _ c o m p u t e W i d g e t V i s i b i l i t y ( w i d g e t N a m e , p a r a m s ) { i f ( w i d g e t N a m e = = = ' s h a p e _ n o n e _ o p t ' ) { r e t u r n   f a l s e ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ f l i p S h a p e ( p r e v i e w M o d e , a x i s ) { t h i s . _ h a n d l e P r e v i e w S t a t e ( p r e v i e w M o d e , ( ) = > { c o n s t   f l i p = n e w   S e t ( t h i s . _ g e t S h a p e D a t a ( ) . f l i p ) ; i f ( f l i p . h a s ( a x i s ) ) { f l i p . d e l e t e ( a x i s ) ; } e l s e { f l i p . a d d ( a x i s ) ; } 
 r e t u r n { f l i p : [ . . . f l i p ] } ; } ) ; } , _ h a n d l e P r e v i e w S t a t e ( p r e v i e w M o d e , c o m p u t e S h a p e D a t a ) { i f ( p r e v i e w M o d e = = = ' r e s e t ' ) { i f ( t h i s . p r e v S h a p e ) { t h i s . $ t a r g e t [ 0 ] . d a t a s e t . o e S h a p e D a t a = t h i s . p r e v S h a p e ; } e l s e { d e l e t e   t h i s . $ t a r g e t [ 0 ] . d a t a s e t . o e S h a p e D a t a ; } } e l s e { i f ( p r e v i e w M o d e = = = t r u e ) { t h i s . p r e v S h a p e = t h i s . $ t a r g e t [ 0 ] . d a t a s e t . o e S h a p e D a t a ; } 
 c o n s t   n e w S h a p e D a t a = c o m p u t e S h a p e D a t a ( ) ; t h i s . _ m a r k S h a p e ( n e w S h a p e D a t a ) ; i f ( p r e v i e w M o d e = = = f a l s e ) { t h i s . p r e v S h a p e = t h i s . $ t a r g e t [ 0 ] . d a t a s e t . o e S h a p e D a t a ; i f ( n e w S h a p e D a t a . h a s O w n P r o p e r t y ( ' s h a p e ' ) ) { t h i s . r e r e n d e r = t r u e ; } } } 
 c o n s t   j s o n = t h i s . $ t a r g e t [ 0 ] . d a t a s e t . o e S h a p e D a t a ; c o n s t { s h a p e , c o l o r s , f l i p = [ ] } = j s o n ? J S O N . p a r s e ( j s o n ) : { } ; c o n s t   t a r g e t = t h i s . $ t a r g e t [ 0 ] ; l e t   s h a p e C o n t a i n e r = t a r g e t . q u e r y S e l e c t o r ( ' : s c o p e   >   . o _ w e _ s h a p e ' ) ; i f ( ! s h a p e ) { i f ( s h a p e C o n t a i n e r ) { s h a p e C o n t a i n e r . r e m o v e ( ) ; } 
 r e t u r n ; } 
 i f ( ! s h a p e C o n t a i n e r ) { s h a p e C o n t a i n e r = d o c u m e n t . c r e a t e E l e m e n t ( ' d i v ' ) ; c o n s t   p r e S h a p e L a y e r E l e m e n t = t h i s . _ g e t L a s t P r e S h a p e L a y e r E l e m e n t ( ) ; i f ( p r e S h a p e L a y e r E l e m e n t ) { $ ( p r e S h a p e L a y e r E l e m e n t ) . a f t e r ( s h a p e C o n t a i n e r ) ; } e l s e { t a r g e t . p r e p e n d ( s h a p e C o n t a i n e r ) ; } 
 t a r g e t . s t y l e . p o s i t i o n = ' r e l a t i v e ' ; } 
 s h a p e C o n t a i n e r . c l a s s N a m e = ` o _ w e _ s h a p e   o _ $ { s h a p e . r e p l a c e ( / \ / / g ,   ' _ ' ) } ` ; f l i p . f o r E a c h ( d i r = > { s h a p e C o n t a i n e r . c l a s s L i s t . a d d ( ` o _ w e _ f l i p _ $ { d i r } ` ) ; } ) ; $ ( s h a p e C o n t a i n e r ) . c s s ( ' b a c k g r o u n d - i m a g e ' , c o l o r s ? ` u r l ( " $ { t h i s . _ g e t S h a p e S r c ( ) } " ) ` : ' ' ) ; } , _ m a r k S h a p e ( n e w D a t a ) { c o n s t   d e f a u l t C o l o r s = t h i s . _ g e t D e f a u l t C o l o r s ( ) ; c o n s t   s h a p e D a t a = O b j e c t . a s s i g n ( t h i s . _ g e t S h a p e D a t a ( ) , n e w D a t a ) ; c o n s t   a r e C o l o r s D e f a u l t = O b j e c t . e n t r i e s ( s h a p e D a t a . c o l o r s ) . e v e r y ( ( [ c o l o r N a m e , c o l o r V a l u e ] ) = > { r e t u r n   c o l o r V a l u e . t o L o w e r C a s e ( ) = = = d e f a u l t C o l o r s [ c o l o r N a m e ] . t o L o w e r C a s e ( ) ; } ) ; i f ( a r e C o l o r s D e f a u l t ) { d e l e t e   s h a p e D a t a . c o l o r s ; } 
 i f ( ! s h a p e D a t a . s h a p e ) { d e l e t e   t h i s . $ t a r g e t [ 0 ] . d a t a s e t . o e S h a p e D a t a ; } e l s e { t h i s . $ t a r g e t [ 0 ] . d a t a s e t . o e S h a p e D a t a = J S O N . s t r i n g i f y ( s h a p e D a t a ) ; } } , _ g e t L a s t P r e S h a p e L a y e r E l e m e n t ( ) { c o n s t   $ f i l t e r E l = t h i s . $ t a r g e t . f i n d ( ' >   . o _ w e _ b g _ f i l t e r ' ) ; i f ( $ f i l t e r E l . l e n g t h ) { r e t u r n   $ f i l t e r E l [ 0 ] ; } 
 r e t u r n   n u l l ; } , _ g e t S h a p e S r c ( ) { c o n s t { s h a p e , c o l o r s } = t h i s . _ g e t S h a p e D a t a ( ) ; i f ( ! s h a p e ) { r e t u r n ' ' ; } 
 c o n s t   q u e r y S t r i n g = O b j e c t . e n t r i e s ( c o l o r s ) . m a p ( ( [ c o l o r N a m e , c o l o r V a l u e ] ) = > { c o n s t   e n c o d e d C o l = e n c o d e U R I C o m p o n e n t ( c o l o r V a l u e ) ; r e t u r n ` $ { c o l o r N a m e } = $ { e n c o d e d C o l } ` ; } ) . j o i n ( ' & ' ) ; r e t u r n ` / w e b _ e d i t o r / s h a p e / $ { s h a p e } . s v g ? $ { q u e r y S t r i n g } ` ; } , _ g e t S h a p e D a t a ( t a r g e t = t h i s . $ t a r g e t [ 0 ] ) { c o n s t   d e f a u l t D a t a = { s h a p e : ' ' , c o l o r s : t h i s . _ g e t D e f a u l t C o l o r s ( ) , f l i p : [ ] , } ; c o n s t   j s o n = t a r g e t . d a t a s e t . o e S h a p e D a t a ; r e t u r n   j s o n ? O b j e c t . a s s i g n ( d e f a u l t D a t a , J S O N . p a r s e ( j s o n ) ) : d e f a u l t D a t a ; } , _ g e t D e f a u l t C o l o r s ( ) { c o n s t   $ s h a p e C o n t a i n e r = t h i s . $ t a r g e t . f i n d ( ' >   . o _ w e _ s h a p e ' ) . c l o n e ( ) . a d d C l a s s ( ' d - n o n e ' ) . a p p e n d T o ( d o c u m e n t . b o d y ) ; c o n s t   s h a p e C o n t a i n e r = $ s h a p e C o n t a i n e r [ 0 ] ; $ s h a p e C o n t a i n e r . c s s ( ' b a c k g r o u n d - i m a g e ' , ' ' ) ; c o n s t   s h a p e S r c = s h a p e C o n t a i n e r & & g e t B g I m a g e U R L ( s h a p e C o n t a i n e r ) ; $ s h a p e C o n t a i n e r . r e m o v e ( ) ; i f ( ! s h a p e S r c ) { r e t u r n { } ; } 
 c o n s t   u r l = n e w   U R L ( s h a p e S r c , w i n d o w . l o c a t i o n . o r i g i n ) ; r e t u r n   O b j e c t . f r o m E n t r i e s ( u r l . s e a r c h P a r a m s . e n t r i e s ( ) ) ; } , _ t o g g l e S h a p e ( ) { i f ( t h i s . _ g e t S h a p e D a t a ( ) . s h a p e ) { r e t u r n   t h i s . _ h a n d l e P r e v i e w S t a t e ( f a l s e , ( ) = > ( { s h a p e : ' ' } ) ) ; } e l s e { c o n s t   t a r g e t = t h i s . $ t a r g e t [ 0 ] ; c o n s t   p r e v i o u s S i b l i n g = t a r g e t . p r e v i o u s E l e m e n t S i b l i n g ; c o n s t [ s h a p e W i d g e t ] = t h i s . _ r e q u e s t U s e r V a l u e W i d g e t s ( ' b g _ s h a p e _ o p t ' ) ; c o n s t   p o s s i b l e S h a p e s = s h a p e W i d g e t . g e t M e t h o d s P a r a m s ( ' s h a p e ' ) . p o s s i b l e V a l u e s ; l e t   s h a p e T o S e l e c t ; i f ( p r e v i o u s S i b l i n g ) { c o n s t   p r e v i o u s S h a p e = t h i s . _ g e t S h a p e D a t a ( p r e v i o u s S i b l i n g ) . s h a p e ; s h a p e T o S e l e c t = p o s s i b l e S h a p e s . f i n d ( ( s h a p e , i ) = > { r e t u r n   p o s s i b l e S h a p e s [ i - 1 ] = = = p r e v i o u s S h a p e ; } ) ; } e l s e { s h a p e T o S e l e c t = p o s s i b l e S h a p e s [ 1 ] ; } 
 r e t u r n   t h i s . _ h a n d l e P r e v i e w S t a t e ( f a l s e , ( ) = > ( { s h a p e : s h a p e T o S e l e c t } ) ) ; } } , } ) ; r e g i s t r y . B a c k g r o u n d P o s i t i o n = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / e d i t o r . x m l ' ] , s t a r t : f u n c t i o n ( ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . _ i n i t O v e r l a y ( ) ; $ ( w i n d o w ) . o n ( ' r e s i z e . b g p o s i t i o n ' , ( ) = > t h i s . _ d i m e n s i o n O v e r l a y ( ) ) ; } , d e s t r o y : f u n c t i o n ( ) { t h i s . _ t o g g l e B g O v e r l a y ( f a l s e ) ; $ ( w i n d o w ) . o f f ( ' . b g p o s i t i o n ' ) ; t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , b a c k g r o u n d T y p e : f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { t h i s . $ t a r g e t . t o g g l e C l a s s ( ' o _ b g _ i m g _ o p t _ r e p e a t ' , w i d g e t V a l u e = = = ' r e p e a t - p a t t e r n ' ) ; t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - p o s i t i o n ' , ' ' ) ; t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - s i z e ' , ' ' ) ; } , b a c k g r o u n d P o s i t i o n O v e r l a y : a s y n c   f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { a w a i t   n e w   P r o m i s e ( r e s o l v e = > { t h i s . i m g = d o c u m e n t . c r e a t e E l e m e n t ( ' i m g ' ) ; t h i s . i m g . a d d E v e n t L i s t e n e r ( ' l o a d ' , ( ) = > r e s o l v e ( ) ) ; t h i s . i m g . s r c = g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; } ) ; c o n s t   p o s i t i o n = t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - p o s i t i o n ' ) . s p l i t ( '   ' ) . m a p ( v = > p a r s e I n t ( v ) ) ; c o n s t   d e l t a = t h i s . _ g e t B a c k g r o u n d D e l t a ( ) ; t h i s . o r i g i n a l P o s i t i o n = { l e f t : p o s i t i o n [ 0 ] , t o p : p o s i t i o n [ 1 ] , } ; t h i s . c u r r e n t P o s i t i o n = { l e f t : p o s i t i o n [ 0 ] / 1 0 0 * d e l t a . x | | 0 , t o p : p o s i t i o n [ 1 ] / 1 0 0 * d e l t a . y | | 0 , } ; t h i s . _ t o g g l e B g O v e r l a y ( t r u e ) ; } , s e l e c t S t y l e : f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { i f ( p a r a m s . c s s P r o p e r t y = = = ' b a c k g r o u n d - s i z e ' & & ! t h i s . $ t a r g e t . h a s C l a s s ( ' o _ b g _ i m g _ o p t _ r e p e a t ' ) ) { r e t u r n ; } 
 t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ c o m p u t e V i s i b i l i t y : f u n c t i o n ( ) { r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) & & ! ! g e t B g I m a g e U R L ( t h i s . $ t a r g e t [ 0 ] ) ; } , _ c o m p u t e W i d g e t S t a t e : f u n c t i o n ( m e t h o d N a m e , p a r a m s ) { i f ( m e t h o d N a m e = = = ' b a c k g r o u n d T y p e ' ) { r e t u r n   t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - r e p e a t ' ) = = = ' r e p e a t ' ? ' r e p e a t - p a t t e r n ' : ' c o v e r ' ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ i n i t O v e r l a y : f u n c t i o n ( ) { t h i s . $ b a c k g r o u n d O v e r l a y = $ ( q w e b . r e n d e r ( ' w e b _ e d i t o r . b a c k g r o u n d _ p o s i t i o n _ o v e r l a y ' ) ) ; t h i s . $ o v e r l a y C o n t e n t = t h i s . $ b a c k g r o u n d O v e r l a y . f i n d ( ' . o _ w e _ o v e r l a y _ c o n t e n t ' ) ; t h i s . $ o v e r l a y B a c k g r o u n d = t h i s . $ o v e r l a y C o n t e n t . f i n d ( ' . o _ o v e r l a y _ b a c k g r o u n d ' ) ; t h i s . $ b a c k g r o u n d O v e r l a y . o n ( ' c l i c k ' , ' . o _ b t n _ a p p l y ' , ( ) = > { t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - p o s i t i o n ' , t h i s . $ b g D r a g g e r . c s s ( ' b a c k g r o u n d - p o s i t i o n ' ) ) ; t h i s . _ t o g g l e B g O v e r l a y ( f a l s e ) ; } ) ; t h i s . $ b a c k g r o u n d O v e r l a y . o n ( ' c l i c k ' , ' . o _ b t n _ d i s c a r d ' , ( ) = > { t h i s . _ t o g g l e B g O v e r l a y ( f a l s e ) ; } ) ; t h i s . $ b a c k g r o u n d O v e r l a y . i n s e r t A f t e r ( t h i s . $ o v e r l a y ) ; } , _ d i m e n s i o n O v e r l a y : f u n c t i o n ( ) { i f ( ! t h i s . $ b a c k g r o u n d O v e r l a y . i s ( ' . o e _ a c t i v e ' ) ) { r e t u r n ; } 
 c o n s t   $ w r a p w r a p = $ ( ' # w r a p w r a p ' ) ; c o n s t   t a r g e t O f f s e t = t h i s . $ t a r g e t . o f f s e t ( ) ; t h i s . $ b a c k g r o u n d O v e r l a y . c s s ( { w i d t h : $ w r a p w r a p . i n n e r W i d t h ( ) , h e i g h t : $ w r a p w r a p . i n n e r H e i g h t ( ) , } ) ; t h i s . $ o v e r l a y C o n t e n t . o f f s e t ( t a r g e t O f f s e t ) ; t h i s . $ b g D r a g g e r . c s s ( { w i d t h : ` $ { t h i s . $ t a r g e t . i n n e r W i d t h ( ) } p x ` , h e i g h t : ` $ { t h i s . $ t a r g e t . i n n e r H e i g h t ( ) } p x ` , } ) ; c o n s t   t o p P o s = ( p a r s e I n t ( t h i s . $ o v e r l a y . c s s ( ' t o p ' ) ) - p a r s e I n t ( t h i s . $ o v e r l a y C o n t e n t . c s s ( ' t o p ' ) ) ) ; t h i s . $ o v e r l a y C o n t e n t . f i n d ( ' . o _ w e _ o v e r l a y _ b u t t o n s ' ) . c s s ( ' t o p ' , ` $ { t o p P o s } p x ` ) ; } , _ t o g g l e B g O v e r l a y : f u n c t i o n ( a c t i v a t e ) { i f ( ! t h i s . $ b a c k g r o u n d O v e r l a y | | t h i s . $ b a c k g r o u n d O v e r l a y . i s ( ' . o e _ a c t i v e ' ) = = = a c t i v a t e ) { r e t u r n ; } 
 i f ( ! a c t i v a t e ) { t h i s . $ b a c k g r o u n d O v e r l a y . r e m o v e C l a s s ( ' o e _ a c t i v e ' ) ; t h i s . t r i g g e r _ u p ( ' u n b l o c k _ p r e v i e w _ o v e r l a y s ' ) ; t h i s . t r i g g e r _ u p ( ' a c t i v a t e _ s n i p p e t ' , { $ s n i p p e t : t h i s . $ t a r g e t } ) ; $ ( d o c u m e n t ) . o f f ( ' c l i c k . b g p o s i t i o n ' ) ; r e t u r n ; } 
 t h i s . t r i g g e r _ u p ( ' h i d e _ o v e r l a y ' ) ; t h i s . t r i g g e r _ u p ( ' a c t i v a t e _ s n i p p e t ' , { $ s n i p p e t : t h i s . $ t a r g e t , p r e v i e w M o d e : t r u e , } ) ; t h i s . t r i g g e r _ u p ( ' b l o c k _ p r e v i e w _ o v e r l a y s ' ) ; t h i s . $ b g D r a g g e r = t h i s . $ t a r g e t . c l o n e ( ) . e m p t y ( ) ; t h i s . $ b g D r a g g e r . c s s ( ' b a c k g r o u n d - a t t a c h m e n t ' , t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - a t t a c h m e n t ' ) ) ; t h i s . $ b g D r a g g e r . o n ( ' m o u s e d o w n ' , t h i s . _ o n D r a g B a c k g r o u n d S t a r t . b i n d ( t h i s ) ) ; t h i s . $ b g D r a g g e r . t o o l t i p ( { t i t l e : ' C l i c k   a n d   d r a g   t h e   b a c k g r o u n d   t o   a d j u s t   i t s   p o s i t i o n ! ' , t r i g g e r : ' m a n u a l ' , c o n t a i n e r : t h i s . $ b a c k g r o u n d O v e r l a y } ) ; t h i s . $ o v e r l a y B a c k g r o u n d . e m p t y ( ) . a p p e n d ( t h i s . $ b g D r a g g e r ) ; t h i s . $ b a c k g r o u n d O v e r l a y . a d d C l a s s ( ' o e _ a c t i v e ' ) ; t h i s . _ d i m e n s i o n O v e r l a y ( ) ; t h i s . $ b g D r a g g e r . t o o l t i p ( ' s h o w ' ) ; w i n d o w . s e t T i m e o u t ( ( ) = > $ ( d o c u m e n t ) . o n ( ' c l i c k . b g p o s i t i o n ' , t h i s . _ o n D o c u m e n t C l i c k e d . b i n d ( t h i s ) ) , 0 ) ; } , _ g e t B a c k g r o u n d D e l t a : f u n c t i o n ( ) { c o n s t   b g S i z e = t h i s . $ t a r g e t . c s s ( ' b a c k g r o u n d - s i z e ' ) ; i f ( b g S i z e ! = = ' c o v e r ' ) { l e t [ w i d t h , h e i g h t ] = b g S i z e . s p l i t ( '   ' ) ; i f ( w i d t h = = = ' a u t o ' & & ( h e i g h t = = = ' a u t o ' | | ! h e i g h t ) ) { r e t u r n { x : t h i s . $ t a r g e t . o u t e r W i d t h ( ) - t h i s . i m g . n a t u r a l W i d t h , y : t h i s . $ t a r g e t . o u t e r H e i g h t ( ) - t h i s . i m g . n a t u r a l H e i g h t , } ; } 
 [ w i d t h , h e i g h t ] = [ p a r s e I n t ( w i d t h ) , p a r s e I n t ( h e i g h t ) ] ; r e t u r n { x : t h i s . $ t a r g e t . o u t e r W i d t h ( ) - ( w i d t h | | ( h e i g h t * t h i s . i m g . n a t u r a l W i d t h / t h i s . i m g . n a t u r a l H e i g h t ) ) , y : t h i s . $ t a r g e t . o u t e r H e i g h t ( ) - ( h e i g h t | | ( w i d t h * t h i s . i m g . n a t u r a l H e i g h t / t h i s . i m g . n a t u r a l W i d t h ) ) , } ; } 
 c o n s t   r e n d e r R a t i o = M a t h . m a x ( t h i s . $ t a r g e t . o u t e r W i d t h ( ) / t h i s . i m g . n a t u r a l W i d t h , t h i s . $ t a r g e t . o u t e r H e i g h t ( ) / t h i s . i m g . n a t u r a l H e i g h t ) ; r e t u r n { x : t h i s . $ t a r g e t . o u t e r W i d t h ( ) - M a t h . r o u n d ( r e n d e r R a t i o * t h i s . i m g . n a t u r a l W i d t h ) , y : t h i s . $ t a r g e t . o u t e r H e i g h t ( ) - M a t h . r o u n d ( r e n d e r R a t i o * t h i s . i m g . n a t u r a l H e i g h t ) , } ; } , _ o n D r a g B a c k g r o u n d S t a r t : f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; t h i s . $ b g D r a g g e r . a d d C l a s s ( ' o _ w e _ g r a b b i n g ' ) ; c o n s t   $ d o c u m e n t = $ ( t h i s . o w n e r D o c u m e n t ) ; $ d o c u m e n t . o n ( ' m o u s e m o v e . b g p o s i t i o n ' , t h i s . _ o n D r a g B a c k g r o u n d M o v e . b i n d ( t h i s ) ) ; $ d o c u m e n t . o n e ( ' m o u s e u p ' , ( ) = > { t h i s . $ b g D r a g g e r . r e m o v e C l a s s ( ' o _ w e _ g r a b b i n g ' ) ; $ d o c u m e n t . o f f ( ' m o u s e m o v e . b g p o s i t i o n ' ) ; } ) ; } , _ o n D r a g B a c k g r o u n d M o v e : f u n c t i o n ( e v ) { e v . p r e v e n t D e f a u l t ( ) ; c o n s t   d e l t a = t h i s . _ g e t B a c k g r o u n d D e l t a ( ) ; t h i s . c u r r e n t P o s i t i o n . l e f t = c l a m p ( t h i s . c u r r e n t P o s i t i o n . l e f t + e v . o r i g i n a l E v e n t . m o v e m e n t X , [ 0 , d e l t a . x ] ) ; t h i s . c u r r e n t P o s i t i o n . t o p = c l a m p ( t h i s . c u r r e n t P o s i t i o n . t o p + e v . o r i g i n a l E v e n t . m o v e m e n t Y , [ 0 , d e l t a . y ] ) ; c o n s t   p e r c e n t P o s i t i o n = { l e f t : t h i s . c u r r e n t P o s i t i o n . l e f t / d e l t a . x * 1 0 0 , t o p : t h i s . c u r r e n t P o s i t i o n . t o p / d e l t a . y * 1 0 0 , } ; p e r c e n t P o s i t i o n . l e f t = i s F i n i t e ( p e r c e n t P o s i t i o n . l e f t ) ? p e r c e n t P o s i t i o n . l e f t : t h i s . o r i g i n a l P o s i t i o n . l e f t ; p e r c e n t P o s i t i o n . t o p = i s F i n i t e ( p e r c e n t P o s i t i o n . t o p ) ? p e r c e n t P o s i t i o n . t o p : t h i s . o r i g i n a l P o s i t i o n . t o p ; t h i s . $ b g D r a g g e r . c s s ( ' b a c k g r o u n d - p o s i t i o n ' , ` $ { p e r c e n t P o s i t i o n . l e f t } %   $ { p e r c e n t P o s i t i o n . t o p } % ` ) ; f u n c t i o n   c l a m p ( v a l , b o u n d s ) { b o u n d s = b o u n d s . s o r t ( ) ; r e t u r n   M a t h . m a x ( b o u n d s [ 0 ] , M a t h . m i n ( v a l , b o u n d s [ 1 ] ) ) ; } } , _ o n D o c u m e n t C l i c k e d : f u n c t i o n ( e v ) { i f ( ! e v . t a r g e t . c l o s e s t ( ' . o _ w e _ b a c k g r o u n d _ p o s i t i o n _ o v e r l a y ' ) ) { t h i s . _ t o g g l e B g O v e r l a y ( f a l s e ) ; } } , } ) ; r e g i s t r y . C o l o r e d L e v e l B a c k g r o u n d = r e g i s t r y . B a c k g r o u n d T o g g l e r . e x t e n d ( { s t a r t : f u n c t i o n ( ) { t h i s . _ m a r k C o l o r L e v e l ( ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , o n B u i l t : f u n c t i o n ( ) { t h i s . _ m a r k C o l o r L e v e l ( ) ; } , _ m a r k C o l o r L e v e l : f u n c t i o n ( ) { t h i s . $ t a r g e t . a d d C l a s s ( ' o _ c o l o r e d _ l e v e l ' ) ; } , } ) ; r e g i s t r y . m a n y 2 o n e = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / s n i p p e t s . x m l ' ] , s t a r t : f u n c t i o n ( ) { v a r   s e l f = t h i s ; t h i s . t r i g g e r _ u p ( ' g e t R e c o r d I n f o ' , _ . e x t e n d ( t h i s . o p t i o n s , { c a l l b a c k : f u n c t i o n ( r e c o r d I n f o ) { _ . d e f a u l t s ( s e l f . o p t i o n s , r e c o r d I n f o ) ; } , } ) ) ; t h i s . M o d e l = t h i s . $ t a r g e t . d a t a ( ' o e - m a n y 2 o n e - m o d e l ' ) ; t h i s . I D = + t h i s . $ t a r g e t . d a t a ( ' o e - m a n y 2 o n e - i d ' ) ; t h i s . $ b t n = $ ( q w e b . r e n d e r ( ' w e b _ e d i t o r . m a n y 2 o n e . b u t t o n ' ) ) . p r e p e n d T o ( t h i s . $ e l ) ; t h i s . $ u l = t h i s . $ b t n . f i n d ( ' u l ' ) ; t h i s . $ s e a r c h = t h i s . $ u l . f i n d ( ' l i : f i r s t ' ) ; t h i s . $ s e a r c h . f i n d ( ' i n p u t ' ) . o n ( ' m o u s e d o w n   c l i c k   m o u s e u p   k e y u p   k e y d o w n ' , f u n c t i o n ( e ) { e . s t o p P r o p a g a t i o n ( ) ; } ) ; s e t T i m e o u t ( f u n c t i o n ( ) { s e l f . $ b t n . f i n d ( ' a ' ) . o n ( ' c l i c k ' , f u n c t i o n ( e ) { s e l f . _ c l e a r ( ) ; } ) ; } , 0 ) ; t h i s . $ s e a r c h . f i n d ( ' i n p u t ' ) . f o c u s ( ) . o n ( ' k e y u p ' , f u n c t i o n ( e ) { s e l f . $ o v e r l a y . r e m o v e C l a s s ( ' o _ o v e r l a y _ h i d d e n ' ) ; s e l f . _ f i n d E x i s t i n g ( $ ( t h i s ) . v a l ( ) ) ; } ) ; t h i s . $ u l . o n ( ' c l i c k ' , ' l i : n o t ( : f i r s t )   a ' , f u n c t i o n ( e ) { s e l f . _ s e l e c t R e c o r d ( $ ( e . c u r r e n t T a r g e t ) ) ; } ) ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , o n F o c u s : f u n c t i o n ( ) { t h i s . $ t a r g e t . a t t r ( ' c o n t e n t E d i t a b l e ' , ' f a l s e ' ) ; t h i s . _ c l e a r ( ) ; } , _ c l e a r : f u n c t i o n ( ) { v a r   s e l f = t h i s ; t h i s . $ s e a r c h . s i b l i n g s ( ) . r e m o v e ( ) ; s e l f . $ s e a r c h . f i n d ( ' i n p u t ' ) . v a l ( ' ' ) ; s e t T i m e o u t ( f u n c t i o n ( ) { s e l f . $ s e a r c h . f i n d ( ' i n p u t ' ) . f o c u s ( ) ; } , 0 ) ; } , _ f i n d E x i s t i n g : f u n c t i o n ( n a m e ) { v a r   s e l f = t h i s ; v a r   d o m a i n = [ ] ; i f ( ! n a m e | | ! n a m e . l e n g t h ) { s e l f . $ s e a r c h . s i b l i n g s ( ) . r e m o v e ( ) ; r e t u r n ; } 
 i f ( i s N a N ( + n a m e ) ) { i f ( t h i s . M o d e l ! = = ' r e s . p a r t n e r ' ) { d o m a i n . p u s h ( [ ' n a m e ' , ' i l i k e ' , n a m e ] ) ; } e l s e { d o m a i n . p u s h ( ' | ' , [ ' n a m e ' , ' i l i k e ' , n a m e ] , [ ' e m a i l ' , ' i l i k e ' , n a m e ] ) ; } } e l s e { d o m a i n . p u s h ( [ ' i d ' , ' = ' , n a m e ] ) ; } 
 r e t u r n   t h i s . _ r p c ( { m o d e l : t h i s . M o d e l , m e t h o d : ' s e a r c h _ r e a d ' , a r g s : [ d o m a i n , t h i s . M o d e l = = = ' r e s . p a r t n e r ' ? [ ' n a m e ' , ' d i s p l a y _ n a m e ' , ' c i t y ' , ' c o u n t r y _ i d ' ] : [ ' n a m e ' , ' d i s p l a y _ n a m e ' ] ] , k w a r g s : { o r d e r : [ { n a m e : ' n a m e ' , a s c : f a l s e } ] , l i m i t : 5 , c o n t e x t : t h i s . o p t i o n s . c o n t e x t , } , } ) . t h e n ( f u n c t i o n ( r e s u l t ) { s e l f . $ s e a r c h . s i b l i n g s ( ) . r e m o v e ( ) ; s e l f . $ s e a r c h . a f t e r ( q w e b . r e n d e r ( ' w e b _ e d i t o r . m a n y 2 o n e . s e a r c h ' , { c o n t a c t s : r e s u l t } ) ) ; } ) ; } , _ s e l e c t R e c o r d : f u n c t i o n ( $ l i ) { v a r   s e l f = t h i s ; t h i s . I D = + $ l i . d a t a ( ' i d ' ) ; t h i s . $ t a r g e t . a t t r ( ' d a t a - o e - m a n y 2 o n e - i d ' , t h i s . I D ) . d a t a ( ' o e - m a n y 2 o n e - i d ' , t h i s . I D ) ; t h i s . t r i g g e r _ u p ( ' r e q u e s t _ h i s t o r y _ u n d o _ r e c o r d ' , { $ t a r g e t : t h i s . $ t a r g e t } ) ; t h i s . $ t a r g e t . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; i f ( s e l f . $ t a r g e t . d a t a ( ' o e - t y p e ' ) = = = ' c o n t a c t ' ) { $ ( ' [ d a t a - o e - c o n t a c t - o p t i o n s ] ' ) . f i l t e r ( ' [ d a t a - o e - m o d e l = " ' + s e l f . $ t a r g e t . d a t a ( ' o e - m o d e l ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - i d = " ' + s e l f . $ t a r g e t . d a t a ( ' o e - i d ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - f i e l d = " ' + s e l f . $ t a r g e t . d a t a ( ' o e - f i e l d ' ) + ' " ] ' ) . f i l t e r ( ' [ d a t a - o e - c o n t a c t - o p t i o n s ! = " ' + s e l f . $ t a r g e t . d a t a ( ' o e - c o n t a c t - o p t i o n s ' ) + ' " ] ' ) . a d d ( s e l f . $ t a r g e t ) . a t t r ( ' d a t a - o e - m a n y 2 o n e - i d ' , s e l f . I D ) . d a t a ( ' o e - m a n y 2 o n e - i d ' , s e l f . I D ) . e a c h ( f u n c t i o n ( ) { v a r   $ n o d e = $ ( t h i s ) ; v a r   o p t i o n s = $ n o d e . d a t a ( ' o e - c o n t a c t - o p t i o n s ' ) ; s e l f . _ r p c ( { m o d e l : ' i r . q w e b . f i e l d . c o n t a c t ' , m e t h o d : ' g e t _ r e c o r d _ t o _ h t m l ' , a r g s : [ [ s e l f . I D ] ] , k w a r g s : { o p t i o n s : o p t i o n s , c o n t e x t : s e l f . o p t i o n s . c o n t e x t , } , } ) . t h e n ( f u n c t i o n ( h t m l ) { $ n o d e . h t m l ( h t m l ) ; } ) ; } ) ; } e l s e { s e l f . $ t a r g e t . h t m l ( $ l i . d a t a ( ' n a m e ' ) ) ; } 
 t h i s . _ c l e a r ( ) ; } } ) ; r e g i s t r y . V e r s i o n C o n t r o l = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / s n i p p e t s . x m l ' ] , s t a r t : f u n c t i o n ( ) { t h i s . t r i g g e r _ u p ( ' g e t _ s n i p p e t _ v e r s i o n s ' , { s n i p p e t N a m e : t h i s . $ t a r g e t [ 0 ] . d a t a s e t . s n i p p e t , o n S u c c e s s : s n i p p e t V e r s i o n s = > { c o n s t   i s U p T o D a t e = s n i p p e t V e r s i o n s & & [ ' v j s ' , ' v c s s ' , ' v x m l ' ] . e v e r y ( k e y = > t h i s . $ t a r g e t [ 0 ] . d a t a s e t [ k e y ] = = = s n i p p e t V e r s i o n s [ k e y ] ) ; i f ( ! i s U p T o D a t e ) { t h i s . $ e l . p r e p e n d ( q w e b . r e n d e r ( ' w e b _ e d i t o r . o u t d a t e d _ b l o c k _ m e s s a g e ' ) ) ; } } , } ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , } ) ; r e g i s t r y . S n i p p e t S a v e = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { x m l D e p e n d e n c i e s : [ ' / w e b _ e d i t o r / s t a t i c / s r c / x m l / e d i t o r . x m l ' ] , i s T o p O p t i o n : t r u e , s a v e S n i p p e t : f u n c t i o n ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { r e t u r n   n e w   P r o m i s e ( r e s o l v e = > { c o n s t   d i a l o g = n e w   D i a l o g ( t h i s , { t i t l e : _ t ( " S a v e   Y o u r   B l o c k " ) , s i z e : ' s m a l l ' , $ c o n t e n t : $ ( q w e b . r e n d e r ( ' w e b _ e d i t o r . d i a l o g . s a v e _ s n i p p e t ' , { c u r r e n t S n i p p e t N a m e : _ . s t r . s p r i n t f ( _ t ( " C u s t o m   % s " ) , t h i s . d a t a . s n i p p e t N a m e ) , } ) ) , b u t t o n s : [ { t e x t : _ t ( " S a v e " ) , c l a s s e s : ' b t n - p r i m a r y ' , c l o s e : t r u e , c l i c k : a s y n c ( ) = > { c o n s t   s n i p p e t N a m e = d i a l o g . e l . q u e r y S e l e c t o r ( ' . o _ w e _ s n i p p e t _ n a m e _ i n p u t ' ) . v a l u e ; c o n s t   t a r g e t C o p y E l = t h i s . $ t a r g e t [ 0 ] . c l o n e N o d e ( t r u e ) ; d e l e t e   t a r g e t C o p y E l . d a t a s e t . n a m e ; c o n s t   s n i p p e t K e y = t h i s . $ t a r g e t [ 0 ] . d a t a s e t . s n i p p e t ; l e t   t h u m b n a i l U R L ; t h i s . t r i g g e r _ u p ( ' s n i p p e t _ t h u m b n a i l _ u r l _ r e q u e s t ' , { k e y : s n i p p e t K e y , o n S u c c e s s : u r l = > t h u m b n a i l U R L = u r l , } ) ; a w a i t   t h i s . _ r p c ( { m o d e l : ' i r . u i . v i e w ' , m e t h o d : ' s a v e _ s n i p p e t ' , k w a r g s : { ' n a m e ' : s n i p p e t N a m e , ' a r c h ' : t a r g e t C o p y E l . o u t e r H T M L , ' t e m p l a t e _ k e y ' : t h i s . o p t i o n s . s n i p p e t s , ' s n i p p e t _ k e y ' : s n i p p e t K e y , ' t h u m b n a i l _ u r l ' : t h u m b n a i l U R L , } , } ) ; t h i s . t r i g g e r _ u p ( ' r e l o a d _ s n i p p e t _ t e m p l a t e ' ) ; } , } , { t e x t : _ t ( " D i s c a r d " ) , c l o s e : t r u e , } ] , } ) . o p e n ( ) ; d i a l o g . o n ( ' c l o s e d ' , t h i s , ( ) = > r e s o l v e ( ) ) ; } ) ; } , } ) ; r e g i s t r y . D y n a m i c S v g = S n i p p e t O p t i o n W i d g e t . e x t e n d ( { s t a r t ( ) { t h i s . $ t a r g e t . o n ( ' i m a g e _ c h a n g e d . D y n a m i c S v g ' , t h i s . _ o n I m a g e C h a n g e d . b i n d ( t h i s ) ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , d e s t r o y ( ) { t h i s . $ t a r g e t . o f f ( ' . D y n a m i c S v g ' ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , a s y n c   c o l o r ( p r e v i e w M o d e , w i d g e t V a l u e , p a r a m s ) { c o n s t   t a r g e t = t h i s . $ t a r g e t [ 0 ] ; s w i t c h ( p r e v i e w M o d e ) { c a s e   t r u e : t h i s . p r e v i o u s S r c = t a r g e t . g e t A t t r i b u t e ( ' s r c ' ) ; b r e a k ; c a s e ' r e s e t ' : t a r g e t . s r c = t h i s . p r e v i o u s S r c ; r e t u r n ; } 
 c o n s t   n e w U R L = n e w   U R L ( t a r g e t . s r c , w i n d o w . l o c a t i o n . o r i g i n ) ; n e w U R L . s e a r c h P a r a m s . s e t ( ' c 1 ' , n o r m a l i z e C o l o r ( w i d g e t V a l u e ) ) ; c o n s t   s r c = n e w U R L . p a t h n a m e + n e w U R L . s e a r c h ; a w a i t   l o a d I m a g e ( s r c ) ; t a r g e t . s r c = s r c ; i f ( ! p r e v i e w M o d e ) { t h i s . p r e v i o u s S r c = s r c ; } } , _ c o m p u t e W i d g e t S t a t e ( m e t h o d N a m e , p a r a m s ) { s w i t c h ( m e t h o d N a m e ) { c a s e ' c o l o r ' : r e t u r n   n e w   U R L ( t h i s . $ t a r g e t [ 0 ] . s r c , w i n d o w . l o c a t i o n . o r i g i n ) . s e a r c h P a r a m s . g e t ( ' c 1 ' ) ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ c o m p u t e V i s i b i l i t y ( m e t h o d N a m e , p a r a m s ) { r e t u r n   t h i s . $ t a r g e t . i s ( " i m g [ s r c ^ = ' / w e b _ e d i t o r / s h a p e / ' ] " ) ; } , _ o n I m a g e C h a n g e d ( m e t h o d N a m e , p a r a m s ) { r e t u r n   t h i s . u p d a t e U I ( ) ; } , } ) ; r e t u r n { S n i p p e t O p t i o n W i d g e t : S n i p p e t O p t i o n W i d g e t , s n i p p e t O p t i o n R e g i s t r y : r e g i s t r y , N U L L _ I D : N U L L _ I D , U s e r V a l u e W i d g e t : U s e r V a l u e W i d g e t , u s e r V a l u e W i d g e t s R e g i s t r y : u s e r V a l u e W i d g e t s R e g i s t r y , U n i t U s e r V a l u e W i d g e t : U n i t U s e r V a l u e W i d g e t , a d d T i t l e A n d A l l o w e d A t t r i b u t e s : _ a d d T i t l e A n d A l l o w e d A t t r i b u t e s , b u i l d E l e m e n t : _ b u i l d E l e m e n t , b u i l d T i t l e E l e m e n t : _ b u i l d T i t l e E l e m e n t , b u i l d R o w E l e m e n t : _ b u i l d R o w E l e m e n t , b u i l d C o l l a p s e E l e m e n t : _ b u i l d C o l l a p s e E l e m e n t , C l a s s : S n i p p e t O p t i o n W i d g e t , r e g i s t r y : r e g i s t r y , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / l i b / j a b b e r w o c k / j a b b e r w o c k . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w y s i w y g _ t r a n s l a t e _ a t t r i b u t e s . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w y s i w y g . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . w y s i w y g ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   W i d g e t = r e q u i r e ( ' w e b . W i d g e t ' ) ; v a r   S u m m e r n o t e M a n a g e r = r e q u i r e ( ' w e b _ e d i t o r . r t e . s u m m e r n o t e ' ) ; v a r   s u m m e r n o t e C u s t o m C o l o r s = r e q u i r e ( ' w e b _ e d i t o r . r t e . s u m m e r n o t e _ c u s t o m _ c o l o r s ' ) ; v a r   i d = 0 ; v a r   W y s i w y g = W i d g e t . e x t e n d ( { x m l D e p e n d e n c i e s : [ ] , d e f a u l t O p t i o n s : { ' f o c u s ' : f a l s e , ' t o o l b a r ' : [ [ ' s t y l e ' , [ ' s t y l e ' ] ] , [ ' f o n t ' , [ ' b o l d ' , ' i t a l i c ' , ' u n d e r l i n e ' , ' c l e a r ' ] ] , [ ' f o n t s i z e ' , [ ' f o n t s i z e ' ] ] , [ ' c o l o r ' , [ ' c o l o r ' ] ] , [ ' p a r a ' , [ ' u l ' , ' o l ' , ' p a r a g r a p h ' ] ] , [ ' t a b l e ' , [ ' t a b l e ' ] ] , [ ' i n s e r t ' , [ ' l i n k ' , ' p i c t u r e ' ] ] , [ ' h i s t o r y ' , [ ' u n d o ' , ' r e d o ' ] ] , ] , ' s t y l e W i t h S p a n ' : f a l s e , ' i n l i n e m e d i a ' : [ ' p ' ] , ' l a n g ' : ' o d o o ' , ' c o l o r s ' : s u m m e r n o t e C u s t o m C o l o r s , r e c o r d I n f o : { c o n t e x t : { } , } , } , i n i t : f u n c t i o n ( p a r e n t , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . i d = + + i d ; t h i s . o p t i o n s = o p t i o n s ; } , w i l l S t a r t : f u n c t i o n ( ) { t h i s . _ s u m m e r n o t e M a n a g e r = n e w   S u m m e r n o t e M a n a g e r ( t h i s ) ; t h i s . $ t a r g e t = t h i s . $ e l ; r e t u r n   t h i s . _ s u p e r ( ) ; } , s t a r t : f u n c t i o n ( ) { t h i s . $ t a r g e t . w r a p ( ' < o d o o - w y s i w y g - c o n t a i n e r > ' ) ; t h i s . $ e l = t h i s . $ t a r g e t . p a r e n t ( ) ; v a r   o p t i o n s = t h i s . _ e d i t o r O p t i o n s ( ) ; t h i s . $ t a r g e t . s u m m e r n o t e ( o p t i o n s ) ; t h i s . $ e d i t o r = t h i s . $ ( ' . n o t e - e d i t a b l e : f i r s t ' ) ; t h i s . $ e d i t o r . d a t a ( ' w y s i w y g ' , t h i s ) ; t h i s . $ e d i t o r . d a t a ( ' o e - m o d e l ' , o p t i o n s . r e c o r d I n f o . r e s _ m o d e l ) ; t h i s . $ e d i t o r . d a t a ( ' o e - i d ' , o p t i o n s . r e c o r d I n f o . r e s _ i d ) ; $ ( d o c u m e n t ) . o n ( ' m o u s e d o w n ' , t h i s . _ b l u r ) ; t h i s . _ v a l u e = t h i s . $ t a r g e t . h t m l ( ) | | t h i s . $ t a r g e t . v a l ( ) ; r e t u r n   t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , d e s t r o y : f u n c t i o n ( ) { $ ( d o c u m e n t ) . o f f ( ' m o u s e d o w n ' , t h i s . _ b l u r ) ; i f ( t h i s . $ t a r g e t & & t h i s . $ t a r g e t . i s ( ' t e x t a r e a ' ) & & t h i s . $ t a r g e t . n e x t ( ' . n o t e - e d i t o r ' ) . l e n g t h ) { t h i s . $ t a r g e t . s u m m e r n o t e ( ' d e s t r o y ' ) ; } 
 t h i s . _ s u p e r ( ) ; } , g e t E d i t a b l e : f u n c t i o n ( ) { r e t u r n   t h i s . $ e d i t o r ; } , i s D i r t y : f u n c t i o n ( ) { r e t u r n   t h i s . _ v a l u e ! = = ( t h i s . $ e d i t o r . h t m l ( ) | | t h i s . $ e d i t o r . v a l ( ) ) ; } , f o c u s : f u n c t i o n ( ) { c o n s o l e . l o g ( ' f o c u s ' ) ; } , g e t V a l u e : f u n c t i o n ( o p t i o n s ) { v a r   $ e d i t a b l e = o p t i o n s & & o p t i o n s . $ l a y o u t | | t h i s . $ e d i t o r . c l o n e ( ) ; $ e d i t a b l e . f i n d ( ' [ c o n t e n t e d i t a b l e ] ' ) . r e m o v e A t t r ( ' c o n t e n t e d i t a b l e ' ) ; $ e d i t a b l e . f i n d ( ' [ c l a s s = " " ] ' ) . r e m o v e A t t r ( ' c l a s s ' ) ; $ e d i t a b l e . f i n d ( ' [ s t y l e = " " ] ' ) . r e m o v e A t t r ( ' s t y l e ' ) ; $ e d i t a b l e . f i n d ( ' [ t i t l e = " " ] ' ) . r e m o v e A t t r ( ' t i t l e ' ) ; $ e d i t a b l e . f i n d ( ' [ a l t = " " ] ' ) . r e m o v e A t t r ( ' a l t ' ) ; $ e d i t a b l e . f i n d ( ' [ d a t a - o r i g i n a l - t i t l e = " " ] ' ) . r e m o v e A t t r ( ' d a t a - o r i g i n a l - t i t l e ' ) ; $ e d i t a b l e . f i n d ( ' a . o _ i m a g e ,   s p a n . f a ,   i . f a ' ) . h t m l ( ' ' ) ; $ e d i t a b l e . f i n d ( ' [ a r i a - d e s c r i b e d b y ] ' ) . r e m o v e A t t r ( ' a r i a - d e s c r i b e d b y ' ) . r e m o v e A t t r ( ' d a t a - o r i g i n a l - t i t l e ' ) ; r e t u r n   $ e d i t a b l e . h t m l ( ) ; } , s a v e : f u n c t i o n ( ) { v a r   i s D i r t y = t h i s . i s D i r t y ( ) ; v a r   h t m l = t h i s . g e t V a l u e ( ) ; i f ( t h i s . $ t a r g e t . i s ( ' t e x t a r e a ' ) ) { t h i s . $ t a r g e t . v a l ( h t m l ) ; } e l s e { t h i s . $ t a r g e t . h t m l ( h t m l ) ; } 
 r e t u r n   P r o m i s e . r e s o l v e ( { i s D i r t y : i s D i r t y , h t m l : h t m l } ) ; } , s a v e M o d i f i e d I m a g e s : f u n c t i o n ( $ e d i t a b l e ) { r e t u r n   t h i s . _ s u m m e r n o t e M a n a g e r . s a v e M o d i f i e d I m a g e s ( $ e d i t a b l e ) ; } , s e t V a l u e : f u n c t i o n ( v a l u e , o p t i o n s ) { i f ( t h i s . $ e d i t o r . i s ( ' t e x t a r e a ' ) ) { t h i s . $ t a r g e t . v a l ( v a l u e ) ; } e l s e { t h i s . $ t a r g e t . h t m l ( v a l u e ) ; } 
 t h i s . $ e d i t o r . h t m l ( v a l u e ) ; } , _ e d i t o r O p t i o n s : f u n c t i o n ( ) { v a r   s e l f = t h i s ; v a r   o p t i o n s = O b j e c t . a s s i g n ( { } , $ . s u m m e r n o t e . o p t i o n s , t h i s . d e f a u l t O p t i o n s , t h i s . o p t i o n s ) ; i f ( t h i s . o p t i o n s . g e n e r a t e O p t i o n s ) { o p t i o n s = t h i s . o p t i o n s . g e n e r a t e O p t i o n s ( o p t i o n s ) ; } 
 o p t i o n s . a i r P o p o v e r = o p t i o n s . t o o l b a r ; o p t i o n s . o n C h a n g e = f u n c t i o n ( h t m l , $ e d i t a b l e ) { $ e d i t a b l e . t r i g g e r ( ' c o n t e n t _ c h a n g e d ' ) ; s e l f . t r i g g e r _ u p ( ' w y s i w y g _ c h a n g e ' ) ; } ; o p t i o n s . o n U p l o a d = f u n c t i o n ( a t t a c h m e n t s ) { s e l f . t r i g g e r _ u p ( ' w y s i w y g _ a t t a c h m e n t ' , a t t a c h m e n t s ) ; } ; o p t i o n s . o n F o c u s = f u n c t i o n ( ) { s e l f . t r i g g e r _ u p ( ' w y s i w y g _ f o c u s ' ) ; } ; o p t i o n s . o n B l u r = f u n c t i o n ( ) { s e l f . t r i g g e r _ u p ( ' w y s i w y g _ b l u r ' ) ; } ; r e t u r n   o p t i o n s ; } , } ) ; W y s i w y g . g e t R a n g e = f u n c t i o n ( n o d e ) { v a r   r a n g e = $ . s u m m e r n o t e . c o r e . r a n g e . c r e a t e ( ) ; r e t u r n   r a n g e & & { s c : r a n g e . s c , s o : r a n g e . s o , e c : r a n g e . e c , e o : r a n g e . e o , } ; } ; W y s i w y g . s e t R a n g e = f u n c t i o n ( s t a r t N o d e , s t a r t O f f s e t , e n d N o d e , e n d O f f s e t ) { $ ( s t a r t N o d e ) . f o c u s ( ) ; i f ( e n d N o d e ) { $ . s u m m e r n o t e . c o r e . r a n g e . c r e a t e ( s t a r t N o d e , s t a r t O f f s e t , e n d N o d e , e n d O f f s e t ) . s e l e c t ( ) ; } e l s e { $ . s u m m e r n o t e . c o r e . r a n g e . c r e a t e ( s t a r t N o d e , s t a r t O f f s e t ) . s e l e c t ( ) ; } 
 $ ( s t a r t N o d e . t a g N a m e ? s t a r t N o d e : s t a r t N o d e . p a r e n t N o d e ) . t r i g g e r ( ' w y s i w y g . r a n g e ' ) ; } ; W y s i w y g . s e t R a n g e F r o m N o d e = f u n c t i o n ( n o d e , o p t i o n s ) { v a r   l a s t = n o d e ; w h i l e ( l a s t . l a s t C h i l d ) { l a s t = l a s t . l a s t C h i l d ; } 
 v a r   f i r s t = n o d e ; w h i l e ( f i r s t . f i r s t C h i l d ) { f i r s t = f i r s t . f i r s t C h i l d ; } 
 i f ( o p t i o n s & & o p t i o n s . b e g i n & & ! o p t i o n s . e n d ) { W y s i w y g . s e t R a n g e ( f i r s t , 0 ) ; } e l s e   i f ( o p t i o n s & & ! o p t i o n s . b e g i n & & o p t i o n s . e n d ) { W y s i w y g . s e t R a n g e ( l a s t , l a s t . t e x t C o n t e n t . l e n g t h ) ; } e l s e { W y s i w y g . s e t R a n g e ( f i r s t , 0 , l a s t , l a s t . t a g N a m e ? l a s t . c h i l d N o d e s . l e n g t h : l a s t . t e x t C o n t e n t . l e n g t h ) ; } } ; r e t u r n   W y s i w y g ; } ) ; o d o o . d e f i n e ( ' w e b _ e d i t o r . w i d g e t ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; r e t u r n { D i a l o g : r e q u i r e ( ' w y s i w y g . w i d g e t s . D i a l o g ' ) , M e d i a D i a l o g : r e q u i r e ( ' w y s i w y g . w i d g e t s . M e d i a D i a l o g ' ) , L i n k D i a l o g : r e q u i r e ( ' w y s i w y g . w i d g e t s . L i n k D i a l o g ' ) , } ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w y s i w y g _ s n i p p e t s . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . w y s i w y g . s n i p p e t s ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   e d i t o r = r e q u i r e ( ' w e b _ e d i t o r . e d i t o r ' ) ; v a r   W y s i w y g = r e q u i r e ( ' w e b _ e d i t o r . w y s i w y g ' ) ; W y s i w y g . i n c l u d e ( { i n i t : f u n c t i o n ( p a r e n t , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . E d i t o r = e d i t o r . C l a s s ; i f ( ! t h i s . o p t i o n s . t o o l b a r H a n d l e r ) { t h i s . o p t i o n s . t o o l b a r H a n d l e r = $ ( ' # w e b _ e d i t o r - t o p - e d i t ' ) ; } } , s t a r t : a s y n c   f u n c t i o n ( ) { i f ( t h i s . o p t i o n s . s n i p p e t s ) { v a r   s e l f = t h i s ; t h i s . e d i t o r = n e w ( t h i s . E d i t o r ) ( t h i s , t h i s . o p t i o n s ) ; t h i s . $ e d i t o r = t h i s . e d i t o r . r t e . e d i t a b l e ( ) ; c o n s t   $ b o d y = t h i s . $ e d i t o r [ 0 ] ? t h i s . $ e d i t o r [ 0 ] . o w n e r D o c u m e n t . b o d y : d o c u m e n t . b o d y ; a w a i t   t h i s . e d i t o r . p r e p e n d T o ( $ b o d y ) ; t h i s . _ r e l o c a t e E d i t o r B a r ( ) ; t h i s . $ e l . o n ( ' c o n t e n t _ c h a n g e d ' , f u n c t i o n ( e ) { s e l f . t r i g g e r _ u p ( ' w y s i w y g _ c h a n g e ' ) ; } ) ; } e l s e { r e t u r n   t h i s . _ s u p e r ( ) ; } } , _ r e l o c a t e E d i t o r B a r : f u n c t i o n ( ) { i f ( ! t h i s . o p t i o n s . t o o l b a r H a n d l e r . l e n g t h ) { t h i s . o p t i o n s . t o o l b a r H a n d l e r = $ ( ' . o _ w e _ s n i p p e t _ t e x t _ t o o l s ' ) ; } 
 t h i s . o p t i o n s . t o o l b a r H a n d l e r . a p p e n d ( t h i s . e d i t o r . $ e l ) ; i f ( t h i s . e d i t o r . s n i p p e t s M e n u & & ! t h i s . e d i t o r . s n i p p e t s M e n u . $ e l . h a s ( t h i s . o p t i o n s . t o o l b a r H a n d l e r ) . l e n g t h ) { t h i s . e d i t o r . s n i p p e t s M e n u . $ e l . i n s e r t A f t e r ( t h i s . o p t i o n s . t o o l b a r H a n d l e r ) ; t h i s . e d i t o r . s n i p p e t s M e n u . $ s n i p p e t E d i t o r A r e a . i n s e r t A f t e r ( t h i s . e d i t o r . s n i p p e t s M e n u . $ e l ) ; } } , } ) ; } ) ; ; 
 
 / *   / w e b _ e d i t o r / s t a t i c / s r c / j s / w y s i w y g / w y s i w y g _ i f r a m e . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ e d i t o r . w y s i w y g . i f r a m e ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   W y s i w y g = r e q u i r e ( ' w e b _ e d i t o r . w y s i w y g ' ) ; v a r   a j a x = r e q u i r e ( ' w e b . a j a x ' ) ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   c o n f i g = r e q u i r e ( ' w e b . c o n f i g ' ) ; v a r   q w e b = c o r e . q w e b ; v a r   p r o m i s e C o m m o n ; v a r   p r o m i s e W y s i w y g ; W y s i w y g . i n c l u d e ( { i n i t : f u n c t i o n ( p a r e n t , o p t i o n s ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; i f ( t h i s . o p t i o n s . i n I f r a m e ) { t h i s . _ o n U p d a t e I f r a m e I d = ' o n L o a d _ ' + t h i s . i d ; } 
 t h i s . _ _ e x t r a A s s e t s F o r I f r a m e = [ ] ; } , w i l l S t a r t : f u n c t i o n ( ) { i f ( ! t h i s . o p t i o n s . i n I f r a m e ) { r e t u r n   t h i s . _ s u p e r ( ) ; } 
 v a r   d e f A s s e t ; i f ( t h i s . o p t i o n s . i f r a m e C s s A s s e t s ) { d e f A s s e t = a j a x . l o a d A s s e t ( t h i s . o p t i o n s . i f r a m e C s s A s s e t s ) ; } e l s e { d e f A s s e t = P r o m i s e . r e s o l v e ( { c s s L i b s : [ ] , c s s C o n t e n t s : [ ] } ) ; } 
 p r o m i s e W y s i w y g = p r o m i s e W y s i w y g | | a j a x . l o a d A s s e t ( ' w e b _ e d i t o r . w y s i w y g _ i f r a m e _ e d i t o r _ a s s e t s ' ) ; t h i s . d e f A s s e t = P r o m i s e . a l l ( [ p r o m i s e W y s i w y g , d e f A s s e t ] ) ; t h i s . $ t a r g e t = t h i s . $ e l ; r e t u r n   t h i s . d e f A s s e t . t h e n ( t h i s . _ l o a d I f r a m e . b i n d ( t h i s ) ) . t h e n ( t h i s . _ s u p e r . b i n d ( t h i s ) ) ; } , _ l o a d I f r a m e : f u n c t i o n ( ) { v a r   s e l f = t h i s ; t h i s . $ i f r a m e = $ ( ' < i f r a m e   c l a s s = " w y s i w y g _ i f r a m e " > ' ) . c s s ( { ' m i n - h e i g h t ' : ' 5 5 v h ' , w i d t h : ' 1 0 0 % ' } ) ; v a r   a v o i d D o u b l e L o a d = 0 ; v a r   d e f = n e w   P r o m i s e ( f u n c t i o n ( r e s o l v e ) { w i n d o w . t o p [ s e l f . _ o n U p d a t e I f r a m e I d ] = f u n c t i o n ( E d i t o r , _ a v o i d D o u b l e L o a d ) { i f ( _ a v o i d D o u b l e L o a d ! = = a v o i d D o u b l e L o a d ) { c o n s o l e . w a r n ( ' W y s i w y g   i f r a m e   d o u b l e   l o a d   d e t e c t e d ' ) ; r e t u r n ; } 
 d e l e t e   w i n d o w . t o p [ s e l f . _ o n U p d a t e I f r a m e I d ] ; v a r   $ i f r a m e T a r g e t = s e l f . $ i f r a m e . c o n t e n t s ( ) . f i n d ( ' # i f r a m e _ t a r g e t ' ) ; $ i f r a m e T a r g e t . a t t r ( " i s M o b i l e " , c o n f i g . d e v i c e . i s M o b i l e ) ; $ i f r a m e T a r g e t . f i n d ( ' . o _ e d i t a b l e ' ) . h t m l ( s e l f . $ t a r g e t . v a l ( ) ) ; s e l f . o p t i o n s . t o o l b a r H a n d l e r = $ ( ' # w e b _ e d i t o r - t o p - e d i t ' , s e l f . $ i f r a m e [ 0 ] . c o n t e n t W i n d o w . d o c u m e n t ) ; $ ( q w e b . r e n d e r ( ' w e b _ e d i t o r . F i e l d T e x t H t m l . f u l l s c r e e n ' ) ) . a p p e n d T o ( s e l f . o p t i o n s . t o o l b a r H a n d l e r ) . o n ( ' c l i c k ' , ' . o _ f u l l s c r e e n ' , f u n c t i o n ( ) { $ ( " b o d y " ) . t o g g l e C l a s s ( " o _ f i e l d _ w i d g e t T e x t H t m l _ f u l l s c r e e n " ) ; v a r   f u l l = $ ( " b o d y " ) . h a s C l a s s ( " o _ f i e l d _ w i d g e t T e x t H t m l _ f u l l s c r e e n " ) ; s e l f . $ i f r a m e . p a r e n t s ( ) . t o g g l e C l a s s ( ' o _ f o r m _ f u l l s c r e e n _ a n c e s t o r ' , f u l l ) ; $ ( w i n d o w ) . t r i g g e r ( " r e s i z e " ) ; } ) ; s e l f . E d i t o r = E d i t o r ; r e s o l v e ( ) ; } ; } ) ; t h i s . $ i f r a m e . d a t a ( ' l o a d D e f ' , d e f ) ; t h i s . $ i f r a m e . o n ( ' l o a d ' , f u n c t i o n   o n L o a d ( e v ) { v a r   _ a v o i d D o u b l e L o a d = + + a v o i d D o u b l e L o a d ; s e l f . d e f A s s e t . t h e n ( f u n c t i o n ( a s s e t s ) { i f ( _ a v o i d D o u b l e L o a d ! = = a v o i d D o u b l e L o a d ) { c o n s o l e . w a r n ( ' W y s i w y g   i m m e d i a t e   i f r a m e   d o u b l e   l o a d   d e t e c t e d ' ) ; r e t u r n ; } 
 v a r   i f r a m e C o n t e n t = q w e b . r e n d e r ( ' w y s i w y g . i f r a m e C o n t e n t ' , { a s s e t s : a s s e t s . c o n c a t ( s e l f . _ _ e x t r a A s s e t s F o r I f r a m e ) , u p d a t e I f r a m e I d : s e l f . _ o n U p d a t e I f r a m e I d , a v o i d D o u b l e L o a d : _ a v o i d D o u b l e L o a d } ) ; s e l f . $ i f r a m e [ 0 ] . c o n t e n t W i n d o w . d o c u m e n t . o p e n ( " t e x t / h t m l " , " r e p l a c e " ) . w r i t e ( i f r a m e C o n t e n t ) ; } ) ; } ) ; t h i s . $ i f r a m e . i n s e r t A f t e r ( t h i s . $ t a r g e t ) ; r e t u r n   d e f ; } , } ) ; } ) ; ; 
 
 / *   / w e b _ u n s p l a s h / s t a t i c / s r c / j s / u n s p l a s h a p i . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' u n s p l a s h . a p i ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   C l a s s = r e q u i r e ( ' w e b . C l a s s ' ) ; v a r   r p c = r e q u i r e ( ' w e b . r p c ' ) ; v a r   M i x i n s = r e q u i r e ( ' w e b . m i x i n s ' ) ; v a r   S e r v i c e s M i x i n = r e q u i r e ( ' w e b . S e r v i c e s M i x i n ' ) ; v a r   U n s p l a s h C o r e = C l a s s . e x t e n d ( M i x i n s . E v e n t D i s p a t c h e r M i x i n , S e r v i c e s M i x i n , { i n i t : f u n c t i o n ( p a r e n t ) { M i x i n s . E v e n t D i s p a t c h e r M i x i n . i n i t . c a l l ( t h i s , a r g u m e n t s ) ; t h i s . s e t P a r e n t ( p a r e n t ) ; t h i s . _ c a c h e = { } ; t h i s . c l i e n t I d = f a l s e ; } , g e t I m a g e s : f u n c t i o n ( q u e r y , p a g e S i z e ) { v a r   f r o m = 0 ; v a r   t o = p a g e S i z e ; v a r   c a c h e d D a t a = t h i s . _ c a c h e [ q u e r y ] ; i f ( c a c h e d D a t a & & ( c a c h e d D a t a . i m a g e s . l e n g t h > = t o | | ( c a c h e d D a t a . t o t a l I m a g e s ! = = 0 & & c a c h e d D a t a . t o t a l I m a g e s < t o ) ) ) { r e t u r n   P r o m i s e . r e s o l v e ( { i m a g e s : c a c h e d D a t a . i m a g e s . s l i c e ( f r o m , t o ) , i s M a x e d : t o > c a c h e d D a t a . t o t a l I m a g e s } ) ; } 
 r e t u r n   t h i s . _ f e t c h I m a g e s ( q u e r y ) . t h e n ( f u n c t i o n ( c a c h e d D a t a ) { r e t u r n { i m a g e s : c a c h e d D a t a . i m a g e s . s l i c e ( f r o m , t o ) , i s M a x e d : t o > c a c h e d D a t a . t o t a l I m a g e s } ; } ) ; } , _ f e t c h I m a g e s : f u n c t i o n ( q u e r y ) { i f ( ! t h i s . _ c a c h e [ q u e r y ] ) { t h i s . _ c a c h e [ q u e r y ] = { i m a g e s : [ ] , m a x P a g e s : 0 , t o t a l I m a g e s : 0 , p a g e C a c h e d : 0 } ; } 
 v a r   c a c h e d D a t a = t h i s . _ c a c h e [ q u e r y ] ; v a r   p a y l o a d = { q u e r y : q u e r y , p a g e : c a c h e d D a t a . p a g e C a c h e d + 1 , p e r _ p a g e : 3 0 , } ; r e t u r n   t h i s . _ r p c ( { r o u t e : ' / w e b _ u n s p l a s h / f e t c h _ i m a g e s ' , p a r a m s : p a y l o a d , } ) . t h e n ( f u n c t i o n ( r e s u l t ) { i f ( r e s u l t . e r r o r ) { r e t u r n   P r o m i s e . r e j e c t ( r e s u l t . e r r o r ) ; } 
 c a c h e d D a t a . p a g e C a c h e d + + ; c a c h e d D a t a . i m a g e s . p u s h . a p p l y ( c a c h e d D a t a . i m a g e s , r e s u l t . r e s u l t s ) ; c a c h e d D a t a . m a x P a g e s = r e s u l t . t o t a l _ p a g e s ; c a c h e d D a t a . t o t a l I m a g e s = r e s u l t . t o t a l ; r e t u r n   c a c h e d D a t a ; } ) ; } , } ) ; r e t u r n   U n s p l a s h C o r e ; } ) ; ; 
 
 / *   / w e b _ u n s p l a s h / s t a t i c / s r c / j s / u n s p l a s h _ i m a g e _ w i d g e t . j s   d e f i n e d   i n   b u n d l e   ' w e b _ e d i t o r . a s s e t s _ w y s i w y g '   * / 
 o d o o . d e f i n e ( ' w e b _ u n s p l a s h . i m a g e _ w i d g e t s ' , f u n c t i o n ( r e q u i r e ) { ' u s e   s t r i c t ' ; v a r   c o r e = r e q u i r e ( ' w e b . c o r e ' ) ; v a r   U n s p l a s h A P I = r e q u i r e ( ' u n s p l a s h . a p i ' ) ; v a r   w i d g e t s M e d i a = r e q u i r e ( ' w y s i w y g . w i d g e t s . m e d i a ' ) ; v a r   u n s p l a s h A P I = n u l l ; c o n s t   o r i g i n a l E v e n t s = w i d g e t s M e d i a . I m a g e W i d g e t . p r o t o t y p e . e v e n t s ; c o n s t   c l i c k H a n d l e r = o r i g i n a l E v e n t s [ ' c l i c k   . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l ' ] ; i f ( ! c l i c k H a n d l e r ) { t h r o w   n e w   E r r o r ( ` C o u l d n ' t   f i n d   a   h a n d l e r   f o r   o _ e x i s t i n g _ a t t a c h m e n t _ c e l l   c l i c k s . 
 T h e   u n s p l a s h   i m a g e   w i d g e t   n e e d s   t o   p r e v e n t   t h i s   h a n d l e r   f r o m   e x e c u t i n g   o n   u n s p l a s h   a t t a c h m e n t s . ` ) ; } 
 _ . e x t e n d ( o r i g i n a l E v e n t s , { ' c l i c k   . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l : n o t ( . o _ u n s p l a s h _ a t t a c h m e n t _ c e l l ) ' : c l i c k H a n d l e r , } ) ; d e l e t e   o r i g i n a l E v e n t s [ ' c l i c k   . o _ e x i s t i n g _ a t t a c h m e n t _ c e l l ' ] ; w i d g e t s M e d i a . I m a g e W i d g e t . i n c l u d e ( { x m l D e p e n d e n c i e s : w i d g e t s M e d i a . I m a g e W i d g e t . p r o t o t y p e . x m l D e p e n d e n c i e s . c o n c a t ( [ ' / w e b _ u n s p l a s h / s t a t i c / s r c / x m l / u n s p l a s h _ i m a g e _ w i d g e t . x m l ' ] ) , e v e n t s : _ . e x t e n d ( { } , w i d g e t s M e d i a . I m a g e W i d g e t . p r o t o t y p e . e v e n t s , { ' c l i c k   . o _ u n s p l a s h _ a t t a c h m e n t _ c e l l [ d a t a - i m g i d ] ' : ' _ o n U n s p l a s h I m g C l i c k ' , ' c l i c k   b u t t o n . s a v e _ u n s p l a s h ' : ' _ o n S a v e U n s p l a s h C r e d e n t i a l s ' , } ) , i n i t : f u n c t i o n ( ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; t h i s . _ u n s p l a s h = { s e l e c t e d I m a g e s : { } , i s M a x e d : f a l s e , q u e r y : f a l s e , e r r o r : f a l s e , r e c o r d s : [ ] , } ; i f ( u n s p l a s h A P I = = = n u l l ) { t h i s . u n s p l a s h A P I = n e w   U n s p l a s h A P I ( t h i s ) ; u n s p l a s h A P I = t h i s . u n s p l a s h A P I ; } e l s e { t h i s . u n s p l a s h A P I = u n s p l a s h A P I ; t h i s . u n s p l a s h A P I . s e t P a r e n t ( t h i s ) ; } } , d e s t r o y : f u n c t i o n ( ) { t h i s . u n s p l a s h A P I . s e t P a r e n t ( u n d e f i n e d ) ; t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , _ s a v e : a s y n c   f u n c t i o n ( ) { c o n s t   _ s u p e r = t h i s . _ s u p e r ; i f ( O b j e c t . k e y s ( t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s ) . l e n g t h ) { t h i s . s a v e d = t r u e ; c o n s t   i m a g e s = a w a i t   t h i s . _ r p c ( { r o u t e : ' / w e b _ u n s p l a s h / a t t a c h m e n t / a d d ' , p a r a m s : { u n s p l a s h u r l s : t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s , r e s _ m o d e l : t h i s . o p t i o n s . r e s _ m o d e l , r e s _ i d : t h i s . o p t i o n s . r e s _ i d , q u e r y : t h i s . _ u n s p l a s h . q u e r y , } , } ) ; t h i s . a t t a c h m e n t s . p u s h ( . . . i m a g e s ) ; t h i s . s e l e c t e d A t t a c h m e n t s . p u s h ( . . . i m a g e s ) ; } 
 r e t u r n   _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; } , s e a r c h : a s y n c   f u n c t i o n ( n e e d l e ) { v a r   s e l f = t h i s ; a w a i t   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . _ u n s p l a s h . q u e r y = n e e d l e ; i f ( ! n e e d l e ) { t h i s . _ u n s p l a s h . r e c o r d s = [ ] ; r e t u r n ; } 
 a w a i t   t h i s . u n s p l a s h A P I . g e t I m a g e s ( n e e d l e , t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y ) . t h e n ( f u n c t i o n ( r e s ) { s e l f . _ u n s p l a s h . i s M a x e d = r e s . i s M a x e d ; s e l f . _ u n s p l a s h . r e c o r d s = r e s . i m a g e s ; s e l f . _ u n s p l a s h . e r r o r = f a l s e ; } , f u n c t i o n ( e r r ) { s e l f . _ u n s p l a s h . e r r o r = e r r ; } ) ; } , h a s C o n t e n t ( ) { i f ( t h i s . s e a r c h S e r v i c e = = = ' a l l ' ) { r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) | | ( t h i s . u n s p l a s h R e c o r d s & & t h i s . u n s p l a s h R e c o r d s . l e n g t h ) ; } e l s e   i f ( t h i s . s e a r c h S e r v i c e = = = ' u n s p l a s h ' ) { r e t u r n ( t h i s . u n s p l a s h R e c o r d s & & t h i s . u n s p l a s h R e c o r d s . l e n g t h ) ; } 
 r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ h i g h l i g h t S e l e c t e d : f u n c t i o n ( ) { t h i s . _ s u p e r . a p p l y ( t h i s , a r g u m e n t s ) ; c o n s t   $ s e l e c t = t h i s . $ ( ' . o _ u n s p l a s h _ a t t a c h m e n t _ c e l l [ d a t a - i m g i d ] ' ) . f i l t e r ( ( i , e l ) = > { r e t u r n   $ ( e l ) . d a t a ( ' i m g i d ' ) i n   t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s ; } ) . a d d C l a s s ( ' o _ w e _ a t t a c h m e n t _ s e l e c t e d ' ) ; r e t u r n   $ s e l e c t ; } , _ l o a d M o r e I m a g e s : f u n c t i o n ( f o r c e S e a r c h ) { i f ( ! t h i s . $ ( ' . o _ w e _ s e a r c h ' ) . v a l ( ) ) { r e t u r n   t h i s . _ s u p e r ( f o r c e S e a r c h ) ; } 
 t h i s . n u m b e r O f A t t a c h m e n t s T o D i s p l a y + = 1 0 ; t h i s . s e a r c h ( t h i s . $ ( ' . o _ w e _ s e a r c h ' ) . v a l ( ) ) . t h e n ( ( ) = > t h i s . _ r e n d e r T h u m b n a i l s ( ) ) ; } , _ r e n d e r T h u m b n a i l s : f u n c t i o n ( ) { t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; t h i s . $ ( ' . u n s p l a s h _ e r r o r ' ) . e m p t y ( ) ; i f ( ! [ ' a l l ' , ' u n s p l a s h ' ] . i n c l u d e s ( t h i s . s e a r c h S e r v i c e ) ) { r e t u r n ; } 
 i f ( t h i s . _ u n s p l a s h . q u e r y & & t h i s . _ u n s p l a s h . e r r o r ) { t h i s . $ ( ' . u n s p l a s h _ e r r o r ' ) . h t m l ( c o r e . q w e b . r e n d e r ( ' w e b _ u n s p l a s h . d i a l o g . e r r o r . c o n t e n t ' , { s t a t u s : t h i s . _ u n s p l a s h . e r r o r , } ) ) ; r e t u r n ; } 
 i f ( [ ' a l l ' , ' u n s p l a s h ' ] . i n c l u d e s ( t h i s . s e a r c h S e r v i c e ) & & t h i s . _ u n s p l a s h . q u e r y & & ! t h i s . _ u n s p l a s h . i s M a x e d ) { t h i s . $ ( ' . o _ l o a d _ m o r e ' ) . r e m o v e C l a s s ( ' d - n o n e ' ) ; t h i s . $ ( ' . o _ l o a d _ d o n e _ m s g ' ) . a d d C l a s s ( ' d - n o n e ' ) ; } } , _ r e n d e r E x i s t i n g : f u n c t i o n ( a t t a c h m e n t s ) { t h i s . u n s p l a s h R e c o r d s = t h i s . _ u n s p l a s h . r e c o r d s . m a p ( r e c o r d = > { c o n s t   u r l = n e w   U R L ( r e c o r d . u r l s . r e g u l a r ) ; u r l . s e a r c h P a r a m s . s e t ( ' h ' , 2 * t h i s . M I N _ R O W _ H E I G H T ) ; u r l . s e a r c h P a r a m s . d e l e t e ( ' w ' ) ; r e t u r n   O b j e c t . a s s i g n ( { } , r e c o r d , { u r l : u r l . t o S t r i n g ( ) , } ) ; } ) ; r e t u r n   t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ s e l e c t A t t a c h e m e n t : f u n c t i o n ( a t t a c h m e n t , s a v e ) { i f ( ! t h i s . o p t i o n s . m u l t i I m a g e s ) { t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s = { } ; } 
 t h i s . _ s u p e r ( . . . a r g u m e n t s ) ; } , _ o n S a v e U n s p l a s h C r e d e n t i a l s : f u n c t i o n ( ) { v a r   s e l f = t h i s ; v a r   k e y = t h i s . $ ( ' # a c c e s s K e y I n p u t ' ) . v a l ( ) . t r i m ( ) ; v a r   a p p I d = t h i s . $ ( ' # a p p I d I n p u t ' ) . v a l ( ) . t r i m ( ) ; t h i s . $ ( ' # a c c e s s K e y I n p u t ' ) . t o g g l e C l a s s ( ' i s - i n v a l i d ' , ! k e y ) ; t h i s . $ ( ' # a p p I d I n p u t ' ) . t o g g l e C l a s s ( ' i s - i n v a l i d ' , ! a p p I d ) ; i f ( k e y & & a p p I d ) { i f ( ! t h i s . $ e l . f i n d ( ' . i s - i n v a l i d ' ) . l e n g t h ) { t h i s . _ r p c ( { r o u t e : ' / w e b _ u n s p l a s h / s a v e _ u n s p l a s h ' , p a r a m s : { k e y : k e y , a p p I d : a p p I d } , } ) . t h e n ( f u n c t i o n ( ) { s e l f . u n s p l a s h A P I . c l i e n t I d = k e y ; s e l f . _ u n s p l a s h . e r r o r = f a l s e ; s e l f . s e a r c h ( s e l f . _ u n s p l a s h . q u e r y ) . t h e n ( ( ) = > s e l f . _ r e n d e r T h u m b n a i l s ( ) ) ; } ) ; } } } , _ o n U n s p l a s h I m g C l i c k : f u n c t i o n ( e v ) { i f ( t h i s . s a v e d ) { r e t u r n ; } 
 c o n s t { i m g i d , u r l , d o w n l o a d U r l , d e s c r i p t i o n } = e v . c u r r e n t T a r g e t . d a t a s e t ; i f ( ! t h i s . o p t i o n s . m u l t i I m a g e s ) { t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s = { } ; t h i s . s e l e c t e d A t t a c h m e n t s = [ ] ; } 
 i f ( i m g i d   i n   t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s ) { d e l e t e   t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s [ i m g i d ] ; } e l s e { c o n s t   _ 1 9 2 0 U r l = n e w   U R L ( u r l ) ; _ 1 9 2 0 U r l . s e a r c h P a r a m s . s e t ( ' w ' , ' 1 9 2 0 ' ) ; t h i s . _ u n s p l a s h . s e l e c t e d I m a g e s [ i m g i d ] = { u r l : _ 1 9 2 0 U r l . h r e f , d o w n l o a d _ u r l : d o w n l o a d U r l , d e s c r i p t i o n : d e s c r i p t i o n } ; } 
 t h i s . _ h i g h l i g h t S e l e c t e d ( ) ; i f ( ! t h i s . o p t i o n s . m u l t i I m a g e s ) { t h i s . t r i g g e r _ u p ( ' s a v e _ r e q u e s t ' ) ; } } , } ) ; } ) ;    L       http://hr.deerom.com/web/content/458-ec554a4/1/web_editor.assets_wysiwyg.js     #     #                           Q       Q        Q        Q       Q      
=       Q      
=       Q      
=   	    Q      
=   
    Q      
=       Q      
=	       Q      
=
       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q      
=       Q  L  L W O W j Z j t ~ 4      E [ c |       a    jQuery   window	   odoo   define   wysiwyg.fonts   web_editor.base%   web_editor.context!   web_editor.ready#   web_editor.editor   web_editor.rteO   web_editor.rte.summernote_custom_colors3   web_editor.rte.summernote7   web_editor.image_processing+   wysiwyg.widgets.media-   wysiwyg.widgets.Dialog3   wysiwyg.widgets.AltDialog/   web_editor.ColorPalette?   wysiwyg.widgets.ImageCropWidget5   wysiwyg.widgets.LinkDialog7   wysiwyg.widgets.MediaDialog   wysiwyg.widgets3   web_editor.snippet.editor7   web_editor.snippets.options%   web_editor.wysiwyg#   web_editor.widget7   web_editor.wysiwyg.snippets3   web_editor.wysiwyg.iframe   unsplash.api5   web_unsplash.image_widgets!!            +H!!        C         	                                         j   2  b   2                        '=   HE   Q   '=   I      T :  6    c      '=   HE   Q   5            T  )   T  D   Q   U  QT  T :  6   Q+
'    exports   object   module   undefined   define   function   amd	   self   Cropper!!      global   factory        +H;5!!       C   
              r                  @             @  x  8  x                          Q    I  Q    @  Q    L  Q      Q    \  Q    k  Q    c  Q    `  Q	    K  Q
      Q    )  Q      Q      Q    W  Q    G  Q    _  Q      Q    d  Q    ,  Q    F  Q    b  Q    -  Q    	  Q    H  Q    <  Q    U  Q    a  Q    ]  Q    *  Q    .  Q      Q     R  Q!    /  Q"    Q  Q#      Q$      Q%    =  Q&    '  Q'      Q(    >  Q)      Q*    ^  Q    '=   IE   Q    5   =   I +  Q +            [+    D  Q +      =    D  5   5   q   BW   Q +     =    D  q   BW  Q=    #  Q=      Q=    
  Q=	    Y  Q=
    %  Q=    6  Q=       Q=      Q=      Q=      Q=    X  Q=    J  Q=    A  Q=      
 #  =   :  M  Q=      
 #  =   :  ?  Q=      
 #  =   :  C  Q=      
 #  =   :  "  Q=      
 #  =   :  P  Q=      
 #  =   :  !  Q=      
 #  =   :    Q=      
 #  =   :    Q=      
 #  =   :  h  Q=      Q=	    g  Q=    E  Q=    :  Q=      Q=       Q=!    V  Q="    [  QV      =#      =$   W  QV      =%      =&   W  QV      ='      =(   W  QV     =)   
   V   1  QV     =*   
   V   S  QV     =+   
   V   2  Q=,    5  Q=-    8  Q=.    &  Q=
    ;  Q=/    e  Q,    Z  Q-    j  Q.    9  Q/    4  QX    Qd B  Q[0   >]0      ]1   2   ]3   2   ]4   @]5   =   ]6   C]7   C]8   C]9   C]:   C];   C]<   C]=   C]>   C]?   C]@   <    ]A   C]B   C]C   C]D   C]E   C]F   C]G   <   ]H   C]I   C]J   C]K   >]L   >]M   >]N   >]O   X ]P   d]Q   @],   @]!   @]    @]   @]   @]
      Q=R    O  QS   5T   D   Q D  5T    T  Q1      QU   5V   5W    3  QX   5V   5Y    N  QU   5Z   D   Q2    $  Q3      Q4    f  Q5    (  Q6    7  Q7   :     Q D  5[    0  Q8      Q\   5]      Q9    i  Q[D   :   ]^   ;   ]_   <   ]`   =   ]a   >   ]b   ?   ]c   @   ]d   A   ]e   B   ]f   C   ]g   W	  Q[H   E   ]h   F   ]i   G   ]6   W  Q[K   I   ]j   J   ]k   W  Q[R   L   ]-   M   ]"   N   ].   O   ]l   P   ]m   Q   ]n   W  Q[T   S   ]o   W  Q[p   U   ]   V   ]p   W   ]q   X   ]r   Y   ]s   Z   ]t   [   ]u   \   ]	   ]   ]v   ^   ]
   _   ]w   `   ]x   a   ]y   b   ]z   c   ]{   d   ]|   e   ]}   f   ]~   g   ]   h   ]   i   ]   j   ]   k   ]   l   ]   m   ]   n   ]   o   ]   W  Q D  5      Qq   :  W
  Q $  V
  5V   V	  V  V  V  V  V   QV
  ) V?" # !?=EIHQ >5$


 	&,8IKU   # Y '\  - ` d$e	h   k  r y  
{  T       V  G	 <Yaxx  bV      "  H    window   undefined   document   ontouchstart   documentElement   PointerEvent   cropper   all	   crop	   move	   zoom   e   w   s   n   ne   nw   se   sw      concat   -crop   -disabled   -hidden   -hide   -invisible   -modal   -move   Action   Preview	   none   cropend   cropmove   cropstart   dblclick   touchstart   mousedown   touchmove   mousemove)   touchend touchcancel   mouseup   pointerdown   pointermove/   pointerup pointercancel   ready   resize   wheel   image/jpeg   viewMode   dragMode   NaN%   initialAspectRatio   aspectRatio	   data   preview   responsive   restore!   checkCrossOrigin!   checkOrientation   modal   guides   center   highlight   background   autoCrop   autoCropArea   movable   rotatable   scalable   zoomable   zoomOnTouch   zoomOnWheel   wheelZoomRatio   cropBoxMovable!   cropBoxResizable1   toggleDragModeOnDblclick   minCanvasWidth   minCanvasHeight   minCropBoxWidth!   minCropBoxHeight#   minContainerWidth%   minContainerHeightc	  <div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>   Number   isNaN   Object   prototype   hasOwnProperty   Array   slice   assign   location   String   fromCharCode   render   initContainer   initCanvas   limitCanvas   renderCanvas   renderImage   initCropBox   limitCropBox   renderCropBox   output   initPreview   resetPreview	   bind   unbind   cropStart   cropMove   cropEnd   change   reset   clear   replace   enable   disable   destroy   moveTo   zoomTo   rotate   rotateTo   scaleX   scaleY   scale   getData   setData!   getContainerData   getImageData   getCanvasData   setCanvasData   getCropBoxData   setCropBoxData!   getCroppedCanvas   setAspectRatio   setDragMode   Cropper!!?!!?!!v   '   MIN_CONTAINER_WIDTH   CLASS_MOVE!   isPositiveNumber#   ACTION_NORTH_EAST   getRotatedSizes   getTransforms   hasClass   setData   ACTION_CROP   ACTION_ALL   IS_TOUCH_DEVICE!   getAdjustedSizes   REGEXP_ORIGINS   fromCharCode%   _toConsumableArray   DATA_ACTION   _typeof   onceSupported)   dataURLToArrayBuffer   isObject   isFunction   DEFAULTS-   resetAndGetOrientation   toArray   DRAG_MODE_CROP   ACTION_SOUTH   handlers   REGEXP_DECIMALS   EVENT_CROP_MOVE#   EVENT_TOUCH_START   ACTION_NORTH   change   EVENT_CROP_END   AnotherCropper   ACTION_WEST   CLASS_MODAL   CLASS_HIDE   NAMESPACE   assign   ACTION_ZOOM   EVENT_WHEEL   methods+   getStringFromCharCode#   REGEXP_CAMEL_CASE   isPlainObject!   isCrossOriginURL   IS_BROWSER   removeClass   getData   addTimestamp   getPointer   location!   EVENT_TOUCH_MOVE%   EVENT_POINTER_DOWN!   EVENT_POINTER_UP   hasOwnProperty   REGEXP_TAG_NAME   preview   EVENT_READY   ACTION_EAST   REGEXP_SPACES   EVENT_RESIZE)   REGEXP_DATA_URL_JPEG   EVENT_CROP   EVENT_ZOOM   removeListener   getSourceCanvas)   arrayBufferToDataURL   CLASS_DISABLED#   _defineProperties#   ACTION_SOUTH_WEST)   MIN_CONTAINER_HEIGHT   CLASS_HIDDEN   WINDOW#   HAS_POINTER_EVENT   events   DRAG_MODE_NONE   toggleClass-   normalizeDecimalNumber   removeData   render   _classCallCheck#   ACTION_SOUTH_EAST   isUndefined   _createClass   CLASS_CROP   slice   TEMPLATE   CLASS_INVISIBLE#   getPointersCenter   getMaxZoomRatio%   EVENT_POINTER_MOVE   isNaN   addListener!   EVENT_CROP_START   forEach#   ACTION_NORTH_WEST   ACTION_MOVE   REGEXP_ACTIONS   EVENT_DBLCLICK%   _arrayWithoutHoles   getOffset!   parseOrientation   setStyle   isNumber   Cropper   dispatchEvent   EVENT_TOUCH_END   toParamCase%   _nonIterableSpread   addClass   MIME_TYPE_JPEG   REGEXP_SUFFIX   DRAG_MODE_MOVE   DATA_PREVIEW)   REGEXP_DATA_URL_HEAD   REGEXP_DATA_URL!   _iterableToArray        +H!!           _typeof `  t  P  t        0         B            W         5    B   \    \              5 5!!          _classCallCheck     u                  5 !!       #   _defineProperties            5                                     !  #    #                  >W   Q    mT V   7W  QV  V  5    D   QB0    QV  C0   Q=   V  q   V  C0   Q      
T  V  5   V   QV   #W   QQV   T    r-&  v  3b      enumerable   configurable   value   writable   Object   defineProperty   key   length!!      target   props   i   descriptor       +H;                  5!!          _createClass  >                                                9    $                     T     @  T  5    T  QT     @  T  T  QT  :4+    prototype!!      Constructor   protoProps   staticProps        +H;       5!!       %   _toConsumableArray 
  ]    ]               5 !!       %   _arrayWithoutHoles y    ^    	              5!!       !   _iterableToArray         
             5 !!       %   _nonIterableSpread                       5 !!          isNumber     u                5 !!          isUndefined )  T    T     k          5!!          isObject f    U                 5 !!          isPlainObject            I   P       5!!          isFunction   
    
               5 !!          toArray ;  z  +  z     0          5!!          forEach     {          `       	   data    callback    B   7    7               5    B t    l                 5 5!!       -   normalizeDecimalNumber M    .       Z          5 !!          setStyle A    0       R              style    B     y                  55!!          hasClass   ~    ~               5 !!          addClass               p          value   B            5          5 5!!          removeClass    3!    3!        `          value   B i      a          5          5 5!!          toggleClass H!  "  4!  "  #      p          value    added   B !  !  !  !  $   5          5 5!!          toParamCase \"  "  H"  "  &   >          5!!          getData "  i#  "  i#  '      0       5!!          setData z#  .$  j#  .$  *      @       5 !!          removeData B$  Z%  /$  Z%  +             5!!          removeListener &  ")  &  ")  -   ,   Q          element    listener    options    handler   B '  )  '  )  -      P       5 5!!          addListener 7)  y,  #)  y,  0      Q          element    listener    options    _handler   B )  v,  )  v,  0      `          event    listeners      handlerB  *  n+  v*  n+  0   c  1       555!!          dispatchEvent ,  -  z,  -  5      0       5!!          getOffset -  .  -  .  7             5!!       !   isCrossOriginURL .  /  .  /  8   i          5 !!          addTimestamp /  
0  /  
0  9             5 !!          getTransforms !0  2  0  2  :      `       5 !!          getMaxZoomRatio 2  5  2  5  @      0          pointers2    ratios    B ?3  4  73  4  @   l              pointer    B 3  4  3  4  @             5 5   B 4  4  4  4  @            5 5!!          getPointer 5  5  5  5  A             5 !!       #   getPointersCenter 5  6  5  6  B      @          pageX    pageY    count   B 6  i6  6  i6  B   b          5 5!!       !   getAdjustedSizes 6  9  6  9  C      a       5!!          getRotatedSizes 9  :  9  :  F              5 !!          getSourceCanvas :  D  :  D  H               B qD  D  iD  D  H   	         5 5!!       +   getStringFromCharCode E  E  D  E  I   C           5 !!       )   dataURLToArrayBuffer E  F  E  F  K   B   0          binary    uint8   B F  F  F  F  K            5 5!!       )   arrayBufferToDataURL F  &H  F  &H  L              5!!       -   resetAndGetOrientation FH  L  'H  L  N             5 !!       !   parseOrientation L  N  L  N  S              5!!            !!Q   ^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$    !!   ^data:    !!3   ^data:image\/jpeg;base64,    !!   ^img|canvas$   !!    '   !!   viewMode!!!!   dragMode!!!!%   initialAspectRatio!!!!   aspectRatio!!!!	   data!!!!   preview!!!!   responsive!!!!   restore!!!!!   checkCrossOrigin!!!!!   checkOrientation!!!!   modal!!!!   guides!!!!   center!!!!   highlight!!!!   background!!!!   autoCrop!!!!   autoCropArea!!!!   movable!!!!   rotatable!!!!   scalable!!!!   zoomable!!!!   zoomOnTouch!!!!   zoomOnWheel!!!!   wheelZoomRatio!!!!   cropBoxMovable!!!!!   cropBoxResizable!!!!1   toggleDragModeOnDblclick!!!!   minCanvasWidth!!!!   minCanvasHeight!!!!   minCropBoxWidth!!!!!   minCropBoxHeight!!!!#   minContainerWidth!!!!%   minContainerHeight!!!!   ready!!!!   cropstart!!!!   cropmove!!!!   cropend!!!!	   crop!!!!	   zoom!!    !!       !   isPositiveNumberB            .           5!!          assignB            )   Q          target    B            9   0          arg   B            r          5 55!!)   \.\d*(?:0|9){12}\d*$    !!Y   ^width|height|left|top|marginLeft|marginTop$    !!!   ([a-z\d])([A-Z])   !!   \s\s*    !!           onceSupported<c             #                                      %  &  %  &  ,                 B   Q+     B   Q    W   Q       
[   =   [      ]      ]   : W  QD     
=   V   V   QD     
=   V   V   Q   ;#)0x1    Object   defineProperty	   once   get   set!   addEventListener	   test'   removeEventListener!!      supported	   once   listener   options        +H!!          listenerB  %  %  %  %  ,              5!!            !!          getC              
                                       $&  C&  &  C&  ,                C   Q      !!      get          !!                  +H;        5 !!          setB T&  h&  H&  h&  ,              5 !!       !!   get!!!!   set!!    ;5!!9   ^(\w+:)\/\/([^:/?#]*):?(\d*)   !!   ^data:.*,    !!           renderB  >N  N  /N  N  U   "   2       5 !!          initContainerB  N  P  N  P  U      "       5 !!          initCanvasB  P  U  P  U  U     r       5 !!          limitCanvasB U  _  U  _  V     B      5 !!          renderCanvasB _  ef  _  ef  Y   I  b       5!!          renderImageB f  h  rf  h  \     2       5!!          initCropBoxB  h  l  h  l  \     R       5!!          limitCropBoxB m  t  m  t  ]            5!!          renderCropBoxB  u  y  t  y  `     r       5!!          outputB  z  Jz  y  Jz  d   :   "       5!!    
   !!   render!!!!   initContainer!!!!   initCanvas!!!!   limitCanvas!!!!   renderCanvas!!!!   renderImage!!!!   initCropBox!!!!   limitCropBox!!!!   renderCropBox!!!!   output!!    !!           initPreviewB  yz  ~  ez  ~  d                crossOrigin    url    alt    B |  ~  |  ~  g   0           55!!          resetPreviewB  ~  t  ~  t  h   4  "         B ~  q  ~  q  h   U         5 5!!          previewB      }    h               imageData    cropBoxWidth    cropBoxHeight    width    height 	   left    top    B         i      0       5 5!!       !!   initPreview!!!!   resetPreview!!!!   preview!!    !!       	   bindB  '  }    }  k   	         5!!          unbindB    z    z  r   0         5!!       !!	   bind!!!!   unbind!!    !!          resizeB          y                ratio    canvasData    cropBoxData    B 8  U  0  U  {   P          5    B         {             5 5!!          dblclickB    `    `  {      2       5 !!          wheelB u    g    |   h             _this   B  >  W  6  W  ~   &          5 5!!          cropStartB -  `    `     <             pointers   B D  z  <  z     y          5 5!!          cropMoveB {  8  j  8        r          pointers    B            >          5 5!!          cropEndB Q  W  A  W     -             pointers   B            l          5 5!!       !!   resize!!!!   dblclick!!!!   wheel!!!!   cropStart!!!!   cropMove!!!!   cropEnd!!    !!           changeB {  &  l  &     t   R      	   left    top    right    bottom    minLeft    minTop    maxWidth    maxHeight    range      checkB 8  |  *  |        p       5   B   #    #               5 5!!       !!   change!!    !!       	   cropB  G  F  :  F     b   B       5!!          resetB  [  ]  M  ]     "   B       5 !!          clearB  r    d       "   2       5!!          replaceB   Q    Q     &             url    B            w          5 5!!          enableB  h    Y       $   2       5 !!          disableB    X    X     &   2       5!!          destroyB  q  *  a  *     &   B       5 !!       	   moveB =  f  0  f     0   #       5!!          moveToB }    n       p  c       5!!       	   zoomB                B       5!!          zoomToB            o   r       5 !!          rotateB            $   "       5!!          rotateToB 9    (          2       5 !!          scaleXB   f    f     $   "       5!!          scaleYB }    n          "       5!!          scaleB              c       5 !!          getDataB             &          	   data    ratio    B U  l  M  l              5 5!!          setDataB             &          5!!       !   getContainerDataB    %    %     8   "       5!!          getImageDataB  H  {  3  {        "       5!!          getCanvasDataB    X    X        R          canvasData 	   data   B ,  G  $  G     v         5 5!!          setCanvasDataB }  Q  g  Q     2   r       5!!          getCropBoxDataB  x  8  a  8     4   2       5 !!          setCropBoxDataB _    H       8          5!!       !   getCroppedCanvasB  C    *       8             B O    G       V          5 5!!          setAspectRatioB               R       5 !!          setDragModeB            .   B       5 !!       !!	   crop!!!!   reset!!!!   clear!!!!   replace!!!!   enable!!!!   disable!!!!   destroy!!!!	   move!!!!   moveTo!!!!	   zoom!!!!   zoomTo!!!!   rotate!!!!   rotateTo!!!!   scaleX!!!!   scaleY!!!!   scale!!!!   getData!!!!   setData!!!!!   getContainerData!!!!   getImageData!!!!   getCanvasData!!!!   setCanvasData!!!!   getCropBoxData!!!!   setCropBoxData!!!!!   getCroppedCanvas!!!!   setAspectRatio!!!!   setDragMode!!    !!           Cropper<c   u                                                                                QL     Z	   [   =    ]      ]   `    [   =   ]      ]   `   [   =   ]      ]   `   [   =   ]      ]   `   [
   =   ]   	   ]   `   [   =   ]      ]   `   [   =   ]      ]   `   [   =	   ]      ]   `   [   =
   ]      ]   `   Z   [   =   ]      ]   `    [   =   ]      ]   `    Q     }      &   L     	   init   key   value	   load	   read   clone   start	   stop   build   unbuild   uncreate   noConflict   setDefaults!!      Cropper         +H!!          Cropper            X   #       5 !!       	   initB  H    ;       5   b       5!!       !!   key!!!!   value!!    !!       	   loadB            1             _this    xhr    B    T     T                5   B  h    `                5    B             A         5 5!!       !!   key!!!!   value!!    !!       	   readB               R       5 !!       !!   key!!!!   value!!    !!          cloneB    b    b     1   R       5!!       !!   key!!!!   value!!    !!          startB      w                   _this2    isIOSWebKit 	   done    sizingImage 	   body   	   doneB b  -  U  -               5   B                         55!!       !!   key!!!!   value!!    !!       	   stopB    '    '     ,  "       5!!       !!   key!!!!   value!!    !!          buildB  J  G  <  G              5 !!       !!   key!!!!   value!!    !!          unbuildB  n    ^      K   2       5!!       !!   key!!!!   value!!    !!          uncreateB  @  >  /  >       b       5!!       !!   key!!!!   value!!    !!          noConflictB  m    Z                5!!       !!   key!!!!   value!!    !!          setDefaultsB   	    	    C          5 !!       !!   key!!!!   value!!    ;5;5!!       C            )                                                                   '=   HE   Q   '=   I6   T       =   :       =   :  p      '=   HE   Q   5	   4         Z   =   `    =   `   T     T T  5
   T  5    Q$0/	('    exports   object   module   undefined   require   jquery   cropperjs   define   function   amd   jQuery   Cropper!!      global   factory        +H;5!!       C            .                         !              <   <                     E   Q       
=   :       5            Q   E   Q       
=   :       5            Q   5         5   5      Q=      Q   5       0   Q   5   5      0   Q   5   5      5   0   Q   5   5      0   Q  += [!-Y    hasOwnProperty   default   fn   cropper   Constructor   setDefaults   noConflict!!      $   Cropper   AnotherCropper   NAMESPACE       +H!!           jQueryCropperB         c          option 	   args    result    B  j  j   $   p       5 5!!          noConflictB   9  9      "       5;5!!       C           9                                     2  2                         Q      Q      Q      Q    	  Q    
  Q      Q      Q      Q	      Q
      Q      Q      Q    5   X    Q[      ]      ]      ]      ]      ]      ]      ]      ]	      Q   5
      0   Q	  qm      >F Lj 	   Math   PI	   init   destroy   reset   toggle	   hide	   show   settings   center   fn   transfo!!      $   rad   methods   _init#   _overwriteOptions   _stop_animation   _setOptions   _bind   _mouseDown   _mouseUp   _mouseMove   _setCss   _targetCss   _showHide   _destroy   _reset       +H!!          _init s  e       0          $this    transfo   B    >  > (            5 5!!       #   _overwriteOptions     )            5!!          _stop_animation     *            5!!          _setOptions     +     P         B      -            5 5!!          _bind     .     P          $this    transfo    mousemove    mouseup      mousedown 5  #  .  0          5      mousemove     /            5      mouseup  [  [ 0            55!!          _mouseDown     2            5 !!          _mouseUp   3   3  3            5 !!          _mouseMove G  * 4  * 4            5 !!          _setCss * - * - =     p       5!!          _targetCss . 1 - 1 I            5 !!          _showHide 1  2 1  2 J     0       5!!          _destroy 22 ~2 !2 ~2 K            5 !!          _reset 2 2 2 2 L            5 !!       	   initB       H   "          settings   B        l   2       5 5!!          destroyB   "  "   "           B        >  "       55!!          resetB  1  )               B  M  E      "       55!!          toggleB   I  I               B   F  F     "       55!!       	   hideB  W  O                B  s  k      "       55!!       	   showB   	  	   ]            B  	 	 	 	   y  "       55!!          settingsB  	 b
 	 b
     "         B  	 !
 	 !
   .         5 5!!          centerB  r
 ; j
 ;   M   "         B  
 
 
 
   s          5 5!!       !!	   init!!!!   destroy!!!!   reset!!!!   toggle!!!!	   hide!!!!	   show!!!!   settings!!!!   center!!    !!          $.fn.transfob R d J d   [   C       5;5!!       C  O                                               _3 k> W3 k> O                        Q      Q       
Z   =   `    =   `   =   `       Q U
   	   each   nearest   furthest   touching!!      $   undefined   rPerc   nearest       +H!!          nearest 3 F; 3 F; O  @   p         point1y    point2x    point2y    max    cache    checkY    furthest    checkX    compDist    hasEach2    min    point1x    tolerance   B F7 : >7 : R  &   2       5 5!!   ^([\d.]+)%$    !!        C            (                                      x; h> p; h> U                 [    >]    >]   >]   >]   ?]      ]   T =   ]   B]   T =	   ]
   T =	   ]      Q  T    8Q  5   T    8Q>
T      x   y   w   h   tolerance   document   container   furthest   includeSelf   touching   checkHoriz   checkVert   fn!!      i	   name   defaults       +H!!    
   !!   x!!!!   y!!!!   w!!!!   h!!!!   tolerance!!!!   container!!!!   furthest!!!!   includeSelf!!!!   checkHoriz!!!!   checkVert!!    !!           $[name]b 2< < *< < U             5 !!          $.fn[name]b < f> < f> V  g   "       5;5;5!!       C  ;                                               > Zv > Zv Z                         Qf      Q      QT     6    W   Q  @% j $ !   WebGLImageFilter!!      window   WebGLProgram!   WebGLImageFilter      !!          identityMatrix   weightedAvg          +H!!         WebGLProgramB ? C ? C Z  +   B         B M? ? E? ? Z  a              collection   B ? ? ? ? Z            5 5   B ? @ ? @ Z            55!!      !!   !!    !!    !!    !!    !!    !!   !!    !!    !!    !!    !!    !!   !!    !!    !!    !!    !!    !!   !!       !!         weightedAvgD# C C C C ]            5!!      /   window.WebGLImageFilterb "D Xv D Xv ]  I  r         gl    _drawCount    _sourceTexture    _lastInChain 1   _currentFramebufferIndex #   _tempFramebuffers    _filterChain    _width    _height    _vertexBuffer    _currentProgram    _canvas '   _shaderProgramCache    _resize '   _getTempFramebuffer 3   _createFramebufferTexture    _draw    _compileShader 	   DRAW    SHADER    _filter    B E hF E hF `            5    B  |F F tF F `            5    B F I F I `     2       5    B I yK I yK c  %   0       5    B K  L K  L e  `          5    B GL WO ?L WO e           5    B jO Q bO Q e  0  P       5    B Q RT Q RT i             5   B CV W ;V W j    0          amount    D" gV V gV V j           5 5   B [ D\ [ D\ j  	         5    B `\ \ X\ \ j  
         5    B  \ ] \ ] j  
         5    B %] ] ] ] j  
         5    B  ] ] ] ] j  b         5    B ] _ ] _ j           5    B _ _` _ _` j  p         5    B v` a n` a j  +         5    B a Cb a Cb j           5    B cb c [b c j           5    B c d c d j  R         5    B d  f d  f j           5    B f f f f j           5    B f  g f  g j  e         5    B g h g h j           5    B  ~k k vk k j  3         5    B  k l k l j           5    B   l Zl l Zl j           5    B sl l kl l j  (         5    B l @m l @m j           5    B Vm Fn Nm Fn j           5    B Dt t <t t j  !         5 5;      5   5!!       C  \       	   #                                     v { v { m                 [   [    ]       ]   Z   [   =   ]      ]   `    ]         
   : ]   ; t(
&   #   cacheCssSelectors   getCssSelectors   fa	   base   parser   fontIcons   _	   once   computeFonts!!      require        +H!!            !!           getCssSelectorsB 5w z -w z m  o          5 !!3   \.(fa-(?:\w|-)+)::?before   !!       !!	   base!!!!   parser!!    !!           .computeFonts<b  z { z { t     "       	   self   B ){ { !{ { t            5 5!!       !!#   cacheCssSelectors!!!!   getCssSelectors!!!!   fontIcons!!!!   computeFonts!!    ;5 !!       C            8                                     '|  |  w                 T  =    :    QT  =   :    Q   A    ,  R    Q[   [   ]      ]   Z   [   =   ]      ]   `    ]   	   
   
   : ]      ]   A	, ~(
&  T    web.ajax   web.session   Promise#   cacheCssSelectors   getCssSelectors   fa	   base   parser   fontIcons   _	   once   computeFonts   ready!!      require	   ajax   session   domReady       +H!!           domReady<c            	                                      | | | | w                        T   Q      $!!      resolve        +H;       5!!            !!          getCssSelectorsB | W | W w            5 !!3   \.(fa-(?:\w|-)+)::?before   !!       !!	   base!!!!   parser!!    !!           .computeFonts<b   W  W ~     "       	   self   B  T  T ~            5 5!!          readyC  C                                    	             g  _  ~  7                    
Z      `       5   `         
:  `   :  :	8    Promise   all   is_bound   loadXML!!              +H;       5 !!       !!#   cacheCssSelectors!!!!   getCssSelectors!!!!   fontIcons!!!!   computeFonts!!!!   ready!!    ;5!!       C  /                                                   ~                       Q   W   Q[      ]    V   ]       get   getExtra!!      require   getContext   getExtraContext      +H!!           getContext     ~           5 !!          getExtraContext                 5!!       !!   get!!!!   getExtra!!    ;5 !!       C  !                                                * z " z   [             T  =    : W   QV      
:  v    web_editor.base   ready!!      require	   base       +H;      5 !!       C        !                            
                                T  =    :    QT  =   : W   QT  =   :    QT  =   :    QT  =   :    QT  =   :    Q   5      QV      
[   =   ]	   Z   =
   `    ]   [    =   ]   =   ]   ]   [   =   ]   =   ]   =   ]   ]      ]      ]      ]      ]      ]      ]      ]   	   ]   
   ]      ]      ]      ]      ]   : W  Q[   V  ]    C)7 )06&:         #*e&gw  g      web.Dialog   web.Widget   web.core   web_editor.rte3   web_editor.snippet.editorO   web_editor.rte.summernote_custom_colors   _t   extend)   web_editor.editorbar   templateK   /web_editor/static/src/xml/editor.xml   xmlDependencies   _onSaveClick=   click button[data-action=save]   _onCancelClickA   click button[data-action=cancel]   events%   _onRequestEditable!   request_editable7   _onHistoryUndoRecordRequest7   request_history_undo_record   _onSaveRequest   request_save   custom_events	   init   start   destroy   cancel	   save#   _getDefaultConfig   _reload#   _onDiscardRequest   Class!!	      require   Dialog   Widget	   core   rte   snippetsEditor-   summernoteCustomColors   _t   EditorMenuBar      +H!!       !!=   click button[data-action=save]!!!!A   click button[data-action=cancel]!!    !!       !!!   request_editable!!!!7   request_history_undo_record!!!!   request_save!!    !!        	   initC ;        N                                      0  0                 	W  QW  QV     QV  5       
V  V  O W   Q   5   D   Q  5   W  QV  V  AV  [       ]      5   ]   ,  R 0   QV  5      
=   V      QV  5   	   
:  W  Q
   V  0   Q   5   R   V    5   AV        
[   V  ]   =   ]      : ,  R 0   QV    &!  Q2I
+?    _super   apply   Editor   Class   getConfig   saveElement   rte   on   rte:start   editable   window3   __EditorMenuBar_$editable   snippets   Object   assign   $el   .o_editable)   selectorEditableArea   snippetsMenu!!      parent   options	   self   res   Editor   $editable   arguments   .this      +H!!           getConfigB R  J    t          5 !!       !!   getConfig!!!!   saveElement!!    !!          init/<b  $ B  B   W          5 !!       !!   $el!!!!)   selectorEditableArea!!    ;5 !!          startC       #   Y                         =             ?  7                  	W  QW  QV     QZ   V  5       
V  V  O `    W   Q  5      
=   V  V  5    Q  5      
=   V  V  5    Q      =	   : 
   
  Q         :    
=        Q         :    
=   =       Q         :    
=   =       Q         :    
=   =       QV  5      
  QB   Q      0   Q   5   1   V      
V  5      
V  5   :  QV  5      
:     
=   :    
=    Q    !   
V   : "   
   : "#27  @K    

0    _super   apply   bus   on'   editor_save_request	   save-   editor_discard_request   cancel   $!   .dropdown-toggle   dropdown   document   keyup   click   .note-editable   submit1   .note-editable form .btn!   hide.bs.dropdown   .dropdown   rte   start   window   onbeforeunload   snippetsMenu	   push   insertAfter   $el   editable	   find   *   off/   mousedown mouseup click   Promise   all	   then!!   	   self	   defs	   flag   arguments   .this        +H!!          start/<b &        0       5!!          start/<b  3  3            5!!          start/<b p  h    L         5!!          start/<b  X  X             5 !!       7   start/window.onbeforeunloadb  )  )   t             B                 5 5!!          start/<b        c          5;5!!          destroyC  w                                             "                    	W   QW  QV  5       
V  V   O Q   5      
=   V  V  5    Q   5      
=   V  V  5    Q  "=C    _super   apply   bus   off'   editor_save_request   _onSaveRequest-   editor_discard_request#   _onDiscardRequest!!      arguments   .this         +H;      5!!          cancelC 3                                               o  o                 W   QV      Q    A    ,  R    
   :  [
 5X    Promise	   then!!      reload	   self   .this      +H!!          cancel/<b         2       5 !!          cancel/<b  # l  l             5;5!!       	   saveE 9        J                        %             u                    Q      QZ       Q       
=   [       ]    Q      
   :          Q   5   .      5      
:           Q      
:     
   5	   
   
:  :          Q   5	      
:           Q   BI         
:          !-$(    trigger_up   ready_to_save	   defs   Promise   all   snippetsMenu   cleanForSave   getParent%   saveModifiedImages   rte   editable	   save   _reload!!      reload	   defs   .generator   .this       +H!!       !!	   defs!!    ;   g         	  5!!       #   _getDefaultConfigC                                                }  }                  [   C]    B]   Z   Z   =   `    Z   =   `    `   `    Z   =   `    Z   =   `    =   `   =   `   =   `   `   `   Z   =   `    Z   =   `    `   `   Z   =	   `    Z   =	   `    `   `   Z   =
   `    Z   =   `    =   `   =   `   `   `   Z   =   `    Z   =   `    `   `   Z   =   `    Z   =   `    =   `   `   `   Z   =   `    Z   =   `    =   `   `   `   ]   B]   Z   =   `    ]   =   ]       ]      ]     
	


	
K"    airMode   focus   style	   font	   bold   italic   underline   clear   fontsize   color	   para   ul   ol   paragraph   table   insert	   link   picture   history	   undo	   redo   airPopover   styleWithSpan   p   inlinemedia	   odoo	   lang   onChange   colors!!      $editable        +H!!          onChangeB " Y  Y            5 !!       !!   airMode!!!!   focus!!!!   airPopover!!!!   styleWithSpan!!!!   inlinemedia!!!!	   lang!!!!   onChange!!!!   colors!!    ;5!!          _reloadC                                                                           5   =       5   5   5   0   Q    5   5      
=	   : >>       5       5   5
      
    =   : 0
   Q       5      
C Q   A   ,  R  uA4C    window   location   scrollTop=   document	   body   scrollTop	   hash   search   indexOf   enable_editor	   href   replace      reload   Promise!!              +H!!1   &?enable_editor(=[^&]*)?   !!          _reload/<b                  5;5!!          _onCancelClickC                                                       :             W   QV       
  Q=    cancel!!      .this         +H;       5 !!       7   _onHistoryUndoRecordRequestC 5                                               1  1   q             W   QV   5       
T  5   5   T  5   5    Qv:    rte#   historyRecordUndo	   data   $target   event!!      ev   .this       +H;       5!!          _onSaveClickC           	                                      G W ? W                W   QV       
  Q   	   save!!      .this         +H;       5!!       #   _onDiscardRequestC G                                   
           r  j                 W   QV       
T  5   5   :    
T  5   5   T  5   5    Q  *    cancel	   data   reload	   then   onSuccess   onFailure!!      ev   .this       +H;       5 !!          _onSaveRequestC U                                               5  5   V            W   QT      
  QV      
T  5   5   :    
T  5   5   T  5   5    Q [*    stopPropagation	   save	   data   reload	   then   onSuccess   onFailure!!      ev   .this       +H;       5!!       %   _onRequestEditableC -                                              Q } I }               W   QT  5       
V   5      
:   Q & 	   data   callback   rte   editable!!      ev   .this       +H;       5!!       !!   template!!!!   xmlDependencies!!!!   events!!!!   custom_events!!!!	   init!!!!   start!!!!   destroy!!!!   cancel!!!!	   save!!!!#   _getDefaultConfig!!!!   _reload!!!!   _onCancelClick!!!!7   _onHistoryUndoRecordRequest!!!!   _onSaveClick!!!!#   _onDiscardRequest!!!!   _onSaveRequest!!!!%   _onRequestEditable!!    !!       !!   Class!!    ;5 !!       C        $                                        %             
       T  =    :    QT  =   :    QT  =   : W   QT  =   : W  QT  =   :    QT  =   : W  QT  =   :    QV   5      QV  5   5	      QV  5   5
      Q    W  QV  A,  R   	  Q      
   5   5   [      ]    Q   5      
[      ]      ]      ]    QV     
[      ]      ]   	   ]   
   ]      ]      ]      ]      ]      ]      ]      ]      ]      ]       ]!   : W  Q[   V  ]"    	  ]#   @
"%7  <   E  L       }  * '        wysiwyg.fonts   web.concurrency   web.core   web.Widget%   web_editor.context+   web_editor.summernoteO   web_editor.rte.summernote_custom_colors   _t	   core   dom   range   $   extend	   expr   :   o_editable   fn   focusIn   focusInEnd   selectContent	   init   start   destroy   cancel   editable#   historyRecordUndo	   save'   _enableEditableArea#   _getDefaultConfig%   _getEscapedElement   _saveElement   _onClick   _onMousedown   _onMouseup   Class   history!!      require   fonts   concurrency	   core   Widget   weContext   summernote-   summernoteCustomColors   _t   dom   range   History   history   RTEWidget      +H!!          HistoryC        
   J       
                                                  W   QZ       Q>   QV       0    QV      0   QV      0   QV      0   QV      0   QV      0   QV      0   QV      0   QV      0   QV   	   0	   Q 
          n4 E:6    makeSnap   applySnap	   undo   hasUndo%   getEditableHasUndo	   redo   hasRedo   recordUndo   splitNext   saveSnap!!      History          !!          $editable   aUndo   pos   toSnap   .this      +H!!       +   History/this.makeSnapb  *  *             5 !!      -   History/this.applySnapb B 5 : 5      p          $editable    r    B _  W               5   B        ?   "       5   B   2   2              55!!      #   History/this.undob  H " @ "             5 !!      )   History/this.hasUndob  8  0                 B       f         5 5!!      ?   History/this.getEditableHasUndob  1 h ) h     0          editable   B  M  M   $           55!!      #   History/this.redob  {  s       2       5!!      )   History/this.hasRedob   :  :             5 !!      /   History/this.recordUndob S J K J                $editable    B        g          5 5!!      -   History/this.splitNextb  b  Z    \           5!!      +   History/this.saveSnapb           0       5;5!!          o_editableB < % 4 %   {   P       5 !!       !!   o_editable!!    !!          focusInB  F  >    /   "       5 !!          focusInEndB          !   "       5!!          selectContentB  7  /    $   "       5 !!       !!   focusIn!!!!   focusInEnd!!!!   selectContent!!    !!       	   initC                                             "                     	W   QW  QV     QV  5       
V  V   O QV     5   5   0   QV      0   QV  T E   QT 5   D   QV  5   0	   QV  T E   QT 5
   D   QV  5   0   Q     
  QO
"+  A@    _super   apply   $   fn   carousel/   init_bootstrap_carousel/   edit_bootstrap_carousel   getConfig#   _getDefaultConfig   _getConfig   saveElement   _saveElement   computeFonts!!      parent   params	   self   arguments   .this      +H!!        C   init/this.edit_bootstrap_carouselb    }              5;5!!          startC       2                            O                                 	W  QW  QV     QV    5    A,  R  0   Q   5   V  5   0   Q         :    
=        Q         :    
=	   V  V  5
      
V  :  Q         :    
=   V  V  5      
V  :  Q      =   :    
=   B QV     
:  W   QV      
=       QV      
=       QV      
=   :    
=   V  :    
    Q         :    
=       Q      =   :    
=   =   V  V  5      
V  :  Q      =   :    
=    Q         5   :     
[   =!   ]"   =   ]#   =$   ]%   [   X]&   d]'   ](   =)   ]*     =+   : ],   :    
=-       Q         : %   
=.    QV  %   
=/    QV  50   1   
V  V  O  
+ |1C"2"
  }!    42
  1"    Mutex   saving_mutex   $   fn/   edit_bootstrap_carousel   carousel   document   on'   click.rte keyup.rte5   mousedown.rte activate.rte   _onMousedown	   bind   mouseup.rte   _onMouseup   .o_not_editable	   attr   contentEditable   editable3   content_will_be_destroyed+   content_was_recreated   addClass   o_editable	   data   rte	   each   content_changed-   #wrapwrap, .o_editable   click.rte   *   _onClick	   body   editor_enable   tooltip%   [data-oe-readonly]   selector   container   hover   trigger	   show	   hide   delay   bottom   placement   Readonly field   title   click   mousedown   rte:start   _super   apply!!   	   self   $editable   arguments   .this        +H!!           start/<b  ,  $    r  @       5 !!          start/<b   R  R            5!!          start/<b   y             5!!          start/<b          "       5 !!          start/<b                 5 !!       !!	   show!!!!	   hide!!    !!       !!   selector!!!!   container!!!!   trigger!!!!   delay!!!!   placement!!!!   title!!    !!           start/<b   $   $            5;5!!          destroyC  8                                             "       '            	W   QW  QV      
  QV  5      
V  V   O Q *"    cancel   _super   apply!!      arguments   .this         +H;      5!!          cancelC  o        >                          -                  k            W   QV   5    %   V   5       
  QV   @0    Q   5   V   5   0   Q         :    
=    Q      =	   :    
=    Q      =
   :    
=    Q         :    
=    Q         :    
=   :    
=   :    
=    Q         :    
=    Q      =   :    
=    QV      
=    Q n+B$
    $last   destroy   $   fn/   init_bootstrap_carousel   carousel   document   off	   .rte-   #wrapwrap, .o_editable   .o_not_editable   removeAttr   contentEditableu   click.rte keyup.rte mousedown.rte activate.rte mouseup.rte   content_changed   removeClass)   o_is_inline_editable   removeData   rte   tooltip   dispose	   body   editor_enable   trigger   rte:stop!!      .this         +H;"       5 !!          editableC  }                                                  
  
                          =   :    
=   :    
    :    
=   :    
=   :    
=   :    
=   : 	   
=
   :  FX    $3   #wrapwrap [data-oe-model]   not   .o_not_editable   filter   link, script%   [data-oe-readonly]   img[data-oe-field="arch"], br[data-oe-field="arch"], input[data-oe-field="arch"]%   .oe_snippet_editor   add   .o_editable!!              +H!!           editable/<b   T  T            5 ;5!!       #   historyRecordUndoC .         z                        *            %                        Q    5     QV  E   QV  5     QV  E   QV  5     Q      T  : U  Q      
:  W   Q      V   E   QV   5   :    
=   : W  QV    D   QV  	    K   T     
=   : W  Q      
T     
=
   : >7>: W   Q*   V     
=   : D   QV   W   QV      
  Q/     Qv  Q      
=   V   Q  	     
V  T T  QV  E   QV      5   I   V     
  QV     
=   : 
   V  V  0   QV  V  0   Q/     Qv  Q      
=   V   Q  ,2VL

.5H3  m:?    document   activeElement   selectionStart   selectionEnd   $   create   sc   closest   .o_editable   length   *	   data   range   select   console   log   error   recordUndo   focus   matches#   input[type=range]!!      $target   event!   internal_history   rng   $editable       !!       )   initialActiveElement+   initialSelectionStart'   initialSelectionEnd          !!         e         !!         e         +H;     8            !          -     O  &                         &              5!!       	   saveC          0                                                         W  QV     Q        =   :    
:     
=    Q        =   : W   QV      
=   :    
=    Q	   
   
V       : W  Q      
V  :    
   :    
   :   

u%A 4.<    $   .o_editable   destroy   removeClass   o_editable o_is_inline_editable o_editable_date_field_linked o_editable_date_field_format_changed   .o_dirty   removeAttr   contentEditable[   o_dirty oe_carlos_danger o_is_inline_editable   _   map   Promise   all	   then   guardedCatch!!      context	   self   $dirty	   defs   .this      +H!!          save/defs<b  %   %                $el    B  >  6      "       5   B   "  "               B                 5    B 2  *             5 55!!          save/<b  M l E l   (         5 !!          save/<b   {    ^         5 ;5!!       '   _enableEditableAreaC 1     !   r                          2                             W  QT      
=   : =   HD   QT      
=   : =   H  =   T      
=   : =   W   QV   =   T      
=   : =   W   QV   =	   T      
=
   : =   W   QV     
:     
V   :    
V   : W  QV     
T  :    
=    QT     
=   :  ;   V     
T      
=   :  QV     
=    QT      
=   : =   H=   T     
=   B QT     
=   :    
=   C QT     
=   : E4   QT     
=   :  E   QT     
=   :  <   T      
=   :    
:     
=   :     
  Q (( $!)<B((%!.'
&
 	   data   oe-type   datetime	   date   [data-oe-id="   oe-id   "]!   [data-oe-field="   oe-field!   [data-oe-model="   oe-model   editable	   find   addBack   not   addClass9   o_editable_date_field_linked   hasClassI   o_editable_date_field_format_changed	   html/   oe-original-with-format   monetary	   attr   contenteditable%   .oe_currency_value   is   [data-oe-model]9   [data-oe-model="ir.ui.view"]+   [data-oe-type="html"]   layoutInfo   popover;   .btn-group:not(.note-history)   remove!!      $editable   selector#   $linkedFieldNodes   .this       +H;R       5 !!       #   _getDefaultConfigC                                                {  {                  [   C]    B]   Z   Z   =   `    Z   =   `    `   `    Z   =   `    Z   =   `    =   `   =   `   =   `   `   `   Z   =   `    Z   =   `    `   `   Z   =	   `    Z   =	   `    `   `   Z   =
   `    Z   =   `    =   `   =   `   `   `   Z   =   `    Z   =   `    `   `   Z   =   `    Z   =   `    =   `   `   `   Z   =   `    Z   =   `    =   `   `   `   ]   B]   Z   =   `    ]   =   ]       ]      ]     
	


	
K"    airMode   focus   style	   font	   bold   italic   underline   clear   fontsize   color	   para   ul   ol   paragraph   table   insert	   link   picture   history	   undo	   redo   airPopover   styleWithSpan   p   inlinemedia	   odoo	   lang   onChange   colors!!      $editable        +H!!          onChangeB   W  W   Y         5 !!       !!   airMode!!!!   focus!!!!   airPopover!!!!   styleWithSpan!!!!   inlinemedia!!!!	   lang!!!!   onChange!!!!   colors!!    ;5!!       %   _getEscapedElementC        	   -                                                         T      
:  W   QV      
=   :    
:  W  QV     
V     
=   :    
=   :    
:  : W  QV     
:     
     QV    

\
b    clone	   find   *   addBack   not   filter   object,iframe,script,style,[data-oe-model][data-oe-model!="ir.ui.view"]   contents	   each!!      $el   escaped_el   to_escape       +H!!       )   _getEscapedElement/<b          "       5;5!!          _saveElementC          F                                     4  4   G     	       W  QT      
=   : W   QV             
:  V     
[    =   ]   =   ]   Z   V   `    V  	   
T  : 
   
=   : `   T      
=   : D   Q@`   ]   T ]   T          [   =   ]   :  b	  6&U   	   data   oe-id   Promise   resolve	   _rpc   ir.ui.view   model	   save   method%   _getEscapedElement	   prop   outerHTML   oe-xpath	   args   context   undefined	   lang   noContextKeys!!      $el   context   withLang   viewID   .this       +H!!       !!   model!!!!   method!!!!	   args!!!!   context!!    !!       !!   noContextKeys!!    ;"       5 !!          _onClickC           	                                      F ^ > ^                 T      
  Q      preventDefault!!      e        +H;       5 !!          _onMousedownC 	     -                          y            t  l           	       W  Q        T  5   :    Q      
=   :    Q      
=   : W   QV  E?   QV  5   E/   QV  5      E   QV  5   >7   >7I(           =   : 	   
=
    Q       D6   QV    E*   Q    5   5   5      
   :          
     QV   x           
=   :    Q     
=   C Q      
    Q           :    
=       QV  E<   QV  5   E,   Q       D   QV  5   >7   >7Ix   V  5      Q	     
  Q      
   X : W  QV  @0   Q      
=   :          V   Q      E+   QV  5    D   QV  5   >7   >7Iy        
V     
   :  Q      
=   	   QV     0   Q      
=   BB Q      
=    BB Q      
=!   BB Q     Qv  Q    5"   #   
=$       Q   5"   #   
=%       Q   5"   #   
=&       Q  '   
:         (   
  Q  )   
   >7:       *   
=+    QV  ,   
    Q 
#D#	8 % P
 %[6  !,1&F9=9`^^%    $   target   closest   .o_editable   is   a   $last   length;   .o_editable_date_field_linked   removeClass9   o_editable_date_field_linked   summernote	   core   dom-   isContentEditableFalse   _   defer	   attr   contenteditable   document   onI   mousedown.reactivate_contenteditable   splitNext   delay   hasClass   modal-body   clearTimeout   _getConfig	   data   NoteHistory   execCommand)   enableObjectResizing1   enableInlineTableEditing   2D-position	   body!   addEventListener   resizestart   movestart   dragstart   create   focusIn   isImg   trigger   mousedown'   _enableEditableArea!!      ev   $target   $editable   isLink   $destroy   lastTimerId   .this      !!       %   hasContentEditable         !!          e         +H!!          _onMousedown/<b                  5 !!         _onMousedown/<b                  5 !!         _onMousedown/<b        P          5!!       3   _onMousedown/lastTimerId<b  { 0 s 0             5!!          _onMousedown/<b   I  I   5          5 !!          _onMousedown/<b ~  v              5 !!          _onMousedown/<b                 5 ;       J      0  m      .     5 !!          _onMouseupC          /                                                         W  Q        T  5   :    Q      
=   : W   QV          V     Q      
     QT  5   E   QT  5   5   HC     	   
T  5   >T  5   T  5   5
      :    
  QC
  4
F2@
    $   target   closest   .o_editable   length   _   defer   originalEvent   detail   create   childNodes   select!!      ev   $target   $editable	   self   .this      +H!!          _onMouseup/<b  , ` $ `             5 ;5!!       !!	   init!!!!   start!!!!   destroy!!!!   cancel!!!!   editable!!!!#   historyRecordUndo!!!!	   save!!!!'   _enableEditableArea!!!!#   _getDefaultConfig!!!!%   _getEscapedElement!!!!   _saveElement!!!!   _onClick!!!!   _onMousedown!!!!   _onMouseup!!    !!       !!   Class!!!!   history!!    ;5 !!       C  W                                                  M  E    ?             Z   f    `    f   `   f   `   f   `   f   `   f   `   f   `   f   `    VRRRRRRRS !!      require        +H!!      !!   #000000!!   #424242!!   #636363!!   #9C9C94!!   #CEC6CE!!   #EFEFEF!!   #F7F7F7!!   #FFFFFF   !!      !!   #FF0000!!   #FF9C00!!   #FFFF00!!   #00FF00!!   #00FFFF!!   #0000FF!!   #9C00FF!!   #FF00FF   !!      !!   #F7C6CE!!   #FFE7CE!!   #FFEFC6!!   #D6EFD6!!   #CEDEE7!!   #CEE7F7!!   #D6D6E7!!   #E7D6DE   !!      !!   #E79C9C!!   #FFC69C!!   #FFE79C!!   #B5D6A5!!   #A5C6CE!!   #9CC6EF!!   #B5A5D6!!   #D6A5BD   !!      !!   #E76363!!   #F7AD6B!!   #FFD663!!   #94BD7B!!   #73A5AD!!   #6BADDE!!   #8C7BC6!!   #C67BA5   !!      !!   #CE0000!!   #E79439!!   #EFC631!!   #6BA54A!!   #4A7B8C!!   #3984C6!!   #634AA5!!   #A54A7B   !!      !!   #9C0000!!   #B56308!!   #BD9400!!   #397B21!!   #104A5A!!   #085294!!   #311873!!   #731842   !!      !!   #630000!!   #7B3900!!   #846300!!   #295218!!   #083139!!   #003163!!   #21104A!!   #4A1031   ;      5!!       C           C      ;                             ]  ]                          Q   !  Q     Q   "  Q     Q     Q   
  QT  =    : W  QT  =   :    QT  =   : W   Q   5   5   5   5   5   5      QT  =	   : 5
      QQT  =   : 5     QT  =   :   QT  =   :   QT  =   :   QT  =   : W  QT  =   :   QV   5     Q   5   5   5   %  Q   5   5   5     Q   5   5   	  Q   5   5   W  QV     
:  5     QV     
:  5     QV     
:  5     Q      QV     0   QV  5     QV  	   0   Q	  5    5!   5   5"   &  Q	  5    5!   5   
   0"   Q	  5    5#   5   5"     Q	  5    5#   5      0"   Q	  5    5!   5"     Q	  5    5!      0"   Q	  5    5$   5"   #  Q	  5    5$      0"   Q	  5    5%      0&   Q	  5    5%      0'   Q	  5    5%      0(   Q	  5    5%      0)   Q	  5    5%      0*   Q	  5    5+      0,   Q	  5    5-      0.   Q   5   5/      00   Q   5   5/      01   Q%  52   D   Q     Q%     02   Q%  53   D   Q     Q%     03   Q%  54   D   Q     Q%     04   Q%  55   D   Q     Q%     05   Q%  56     Q%     06   Q   5   5/   57     Q   5   5/       07   Q   5   5/   !   08   Q["     Q	  59     Q	  #   09   Q	  5:   $  Q	  $   0:   Q   5   5;   [2   [%     =<   : ]=     =>   : ]?     =@   : ]A     =B   : ]C     =D   : ]E     =F   : ]G     =H   : ]I     =J   : ]K     =L   : ]M     =N   : ]O   ]P   [&     =Q   : ]R     =S   : ]T     =U   : ]V     =W   : ]X     =Y   : ]Z     =[   : ]\     =]   : ]^     =_   : ]`     =a   : ]b     =c   : ]d     =e   : ]f     =g   : ]h   ]R   ['     =i   : ]j     =k   : ]T     =l   : ]m     =n   : ]o     =p   : ]q     =r   : ]f     =s   : ]t   ]j   [(     =u   : ]v     =w   : ]x     =y   : ]T     =z   : ]f     ={   : ]|   ]v   [)     =}   : ]~   ]~   [*     =   : ]T   ]   [+     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]   ]   [,     =   : ]     =   : ]   ]   [-     =   : ]     =   : ]     =   : ]8   ]   [.     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]   ]   [/     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]   ]   [0     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]     =   : ]   ]   [1     =   : ]     =   : ]   ]   0   QV     
  5   V  [:   3   ]   4   ]   5   ]   6   ]   7   ]   8   ]   9   ]   : W  QV  9?:!
"+#
"&&  ~$ q= E 6 94=M     K   $  "  7K+M-  P      |



'

?
		


	J Q > b  
B     web.Class   web.concurrency   web.core   window   top	   odoo   __DEBUG__   services   bus   web.Colorpicker#   ColorpickerWidget/   web_editor.ColorPalette%   ColorPaletteWidget   web.mixins   wysiwyg.fonts   web_editor.rte#   web.ServicesMixin   wysiwyg.widgets   _t   $   summernote	   core   dom   range   eventHandler   renderer   getTemplate   button   iconButton   dropdown   createPalette   tplPopovers   modules   popover   update   toolbar   handle   editor   padding   resize   resizefa   floatMe   imageShape   linkDialog   showLinkDialog   imageDialog   showImageDialog   pluginEvents   alt   cropImage   isVoid   isImg   isForbiddenNode   isImgFont   isFont   visible   codeview   attach   detach	   lang	   Bold	   bold   Italic   italic   Underline   underline   Strikethrough   strikethrough   Subscript   subscript   Superscript   superscript#   Remove Font Style   clear   Line Height   height   Font Family	   name   Font Size	   size	   font   File / Image   image   Insert Image   insert   Resize Full   resizeFull   Resize Half   resizeHalf   Resize Quarter   resizeQuarter   Float Left   floatLeft   Float Right   floatRight   Float None   floatNone%   Drag an image here   dragImageHere#   Select from files   selectFromFiles   Image URL   url   Remove Image   remove	   Link	   link   Insert Link   Unlink   unlink	   Edit	   edit   Text to display   textToDisplayA   To what URL should this link go?%   Open in new window   openInNewWindow   Video   video   Video Link   videoLink   Insert Video   Video URL?o   (YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)   providers   Table   table-   Insert Horizontal Rule   hr   Style   style   Normal   normal   Quote   blockquote	   Code   pre   Small   small   Header 1   h1   Header 2   h2   Header 3   h3   Header 4   h4   Header 5   h5   Header 6   h6   Unordered list   unordered   Ordered list   ordered   lists	   Help	   help   Full Screen   fullscreen   Code View   options   Paragraph   paragraph   Outdent   outdent   Indent   indent   Align left	   left   Align center   center   Align right   right   Justify full   justify   Custom Color   custom!   Background Color   background   Font Color   foreground   Transparent   transparent	   None   setTransparent   color%   Keyboard shortcuts   shortcuts   Close   close   Text formatting   textFormatting   Action   action)   Paragraph formatting'   paragraphFormatting   Document Style   documentStyle   shortcut	   Undo	   undo	   Redo	   redo   history   extend)   EventDispatcherMixin	   init   destroy%   saveModifiedImages%   _onAltDialogDemand%   _onCropImageDemand'   _onLinkDialogDemand)   _onMediaDialogDemand!!+      require   weWidgets   fn_tplPopovers   fn_attach	   core   fn_is_img)   summernote_mousedown%   remember_selection3   fn_toolbar_boutton_update   eventHandler#   summernote_ie_fix   getImgTarget!   reRangeSelectKey   _t#   SummernoteManager)   fn_is_forbidden_node   last_editable   tplButton   ServicesMixin   range   fonts   fn_is_void   tplIconButton#   fn_popover_update   fn_is_font   last_div_change   rte   fn_visible   initial_data   Class   mixins   tplDropdown   fn_is_img_font%   summernote_mouseup%   ColorPaletteWidget   renderer   last_div   prettify_html   reRangeSelect!   fn_handle_update   fn_detach   dom#   fn_boutton_update      !!       )   processAndApplyColor#   ColorpickerWidget   topBus   concurrency          +H!!         getImgTarget J  5    @         5 !!         prettify_html " % ! %   #            B T" " L" "   c          5    B # # # #   $         5 5!!      !   reRangeSelectKey J* 0+ 1* 0+     @       5!!         reRangeSelect G+ , 1+ ,      0       	   data   B  , H, + H,             5 5!!      %   summernote_mouseup , . , .      `         B  . . . .   <          5 5!!      )   summernote_mousedown / 4 . 4   4   0         B / 0 / 0             5    B w0 0 o0 0            5    B 0 1 0 1            5 5!!      #   summernote_ie_fix 4 z9 4 z9             5!!      )   processAndApplyColorB         0       5 !!      -   renderer.createPaletteb 9 c 1 c                 parent   D"  `  `   I  p       	   elem    eventName    colorpicker    mutex    $dropdown    manualOpening   D"  $  $   /         5    D"  F ] F ]               D"  v M v M                 oldColorpicker   D" `  `             5    D"       h         5    D"  O  O             5    D"   J  J   L          55555!!      )   renderer.tplPopoversb          R          $imagePopover    $linkPopover    $airPopover    B  /  '    w            B                 5 5   B                     B    z    :         5 55!!      U   eventHandler.modules.popover.button.updateb )  !             5!!      U   eventHandler.modules.toolbar.button.updateb  =  =            5 !!      G   eventHandler.modules.popover.updateb  >  >   -         5!!      E   eventHandler.modules.handle.updateb  4  4      "       5!!      G   eventHandler.modules.editor.paddingb  @  @   ,           5 !!      E   eventHandler.modules.editor.resizeb l  d    h           5!!      I   eventHandler.modules.editor.resizefab       z           5!!      G   eventHandler.modules.editor.floatMeb  U  U             5 !!      M   eventHandler.modules.editor.imageShapeb   }    K         5 !!      ]   eventHandler.modules.linkDialog.showLinkDialogb ?  7      @          $editable    def   B  q  q   s          5 5!!      a   eventHandler.modules.imageDialog.showImageDialogb         0          r   B ~  v    5          5    B       S          55!!      ;   $.summernote.pluginEvents.altb 2  *             5!!      G   $.summernote.pluginEvents.cropImageb C ' ; '            5!!         fn_is_void<b  K O C O            5!!         dom.isVoidb c  [             5 !!         fn_is_img<b                 5 !!         dom.isImgb "               5!!      +   fn_is_forbidden_node<b                 5!!      '   dom.isForbiddenNodeb $                5 !!         fn_is_img_font<b        q          5!!         dom.isImgFontb  N  N      @       5 !!         dom.isFontb |  t    <          5 !!      C   $.summernote.pluginEvents.visibleb   !   !      #       5 !!      E   $.summernote.pluginEvents.codeviewb "& ) & )   +          5!!            !!      '   eventHandler.attachb 9 H 9 H   >             oLayoutInfo    clone_data    $node    $toolbar    B *: B: ": B:             5    B : : : :   P         5    B  :; q; 2; q;            5    B  ; ; ; ;   5         5    B < }< < }<             5   B  = D = D   ~   R          nodes   B  I> d> A> d>             5    B  A A A A            5    B  B C B C            5 5   B  gE IF _E IF   ^         5    /   create_dblclick_feature kF H KF H   b  0          callback    show_tooltip   B F NG F NG             5   B G H yG H   o   0          $target   B  G H G H   %             B  H H H H   y          5 5555!!      '   eventHandler.detachb I xJ I xJ             5!!    
   !!	   bold!!!!   italic!!!!   underline!!!!   strikethrough!!!!   subscript!!!!   superscript!!!!   clear!!!!   height!!!!	   name!!!!	   size!!    !!       !!   image!!!!   insert!!!!   resizeFull!!!!   resizeHalf!!!!   resizeQuarter!!!!   floatLeft!!!!   floatRight!!!!   floatNone!!!!   dragImageHere!!!!   selectFromFiles!!!!   url!!!!   remove!!    !!       !!	   link!!!!   insert!!!!   unlink!!!!	   edit!!!!   textToDisplay!!!!   url!!!!   openInNewWindow!!    !!       !!   video!!!!   videoLink!!!!   insert!!!!   url!!!!   providers!!    !!       !!   table!!    !!       !!   insert!!    !!       !!   style!!!!   normal!!!!   blockquote!!!!   pre!!!!   small!!!!   h1!!!!   h2!!!!   h3!!!!   h4!!!!   h5!!!!   h6!!    !!       !!   unordered!!!!   ordered!!    !!       !!	   help!!!!   fullscreen!!!!   codeview!!    !!       !!   paragraph!!!!   outdent!!!!   indent!!!!	   left!!!!   center!!!!   right!!!!   justify!!    !!       !!   custom!!!!   background!!!!   foreground!!!!   transparent!!!!   setTransparent!!    !!       !!   shortcuts!!!!   close!!!!   textFormatting!!!!   action!!!!'   paragraphFormatting!!!!   documentStyle!!    !!       !!	   undo!!!!	   redo!!    !!       !!	   font!!!!   image!!!!	   link!!!!   video!!!!   table!!!!   hr!!!!   style!!!!   lists!!!!   options!!!!   paragraph!!!!   color!!!!   shortcut!!!!   history!!    !!       	   initC                                               R S R S   
            W   Q  5    5      
V   l QV      
T   Q         
=   V   V   5    Q      
=   V   V   5    Q      
=	   V   V   5
    Q      
=   V   V   5    Q 
,<<>@ )   EventDispatcherMixin	   init	   call   setParent   on#   alt_dialog_demand%   _onAltDialogDemand#   crop_image_demand%   _onCropImageDemand%   link_dialog_demand'   _onLinkDialogDemand'   media_dialog_demand)   _onMediaDialogDemand!!      parent   .this       +H;       5 !!         destroyC                                                 T 8U T 8U               W   Q  5    5      
V   l Q         
=   V   V   5    Q      
=   V   V   5    Q      
=   V   V   5	    Q      
=
   V   V   5    Q /==?A )   EventDispatcherMixin   destroy	   call   off#   alt_dialog_demand%   _onAltDialogDemand#   crop_image_demand%   _onCropImageDemand%   link_dialog_demand'   _onLinkDialogDemand'   media_dialog_demand)   _onMediaDialogDemand!!      .this         +H;       5 !!      %   saveModifiedImagesC C                                             TU #X LU #X                    Q   Q       
T      :    Q      
V   :  /     _   map   Promise   all!!      $editable   .this       !!       	   defs           +H!!      1   saveModifiedImages/defs<d" U X {U X   Q  4          resModel    resId   D" V W V W     4       5 5;      ;       @          5!!      %   _onAltDialogDemandC       
   ,                                    ?X NY 7X NY               W  QT  5       T  C0    Q  5   AV  T  5   D   Q[    T  5   ,  R W   QT  5   &   V      
=   V  T  5    QT  5   &   V      
=   V  T  5    QV   	   
  Q  
:    __alreadyDone   AltDialog   options   media   onSave   on	   save   onCancel   cancel	   open!!   	   data   altDialog   .this       +H!!            ;B       5!!      %   _onCropImageDemandC S                                              jY Y bY Y   .             W   QT  5       T  C0    Q  5   AV   T  5   ,  R    
T  5    Q5`/    __alreadyDone   ImageCropWidget   media   appendTo   $editable!!   	   data   .this       +H;"       5 !!      '   _onLinkDialogDemandC          ,                                    Z 5[ Z 5[   ~      	       W  QT  5       T  C0    Q  5   AV  T  5   D   Q[    T  5   T  5   ,  R W   QT  5   &   V      
=   V  T  5    QT  5   &   V      
=	   V  T  5    QV   
   
  Q   M    __alreadyDone   LinkDialog   options   $editable   linkInfo   onSave   on	   save   onCancel   cancel	   open!!   	   data   linkDialog   .this       +H!!            ;B       5 !!      )   _onMediaDialogDemandC "        G                                    S[ \ K[ \   1             W  QT  5       T  C0    Q  5   AV        
[    T  5      
=   : ]   T  5      
=   : ]	   T  5      
=
   : ]   T  5   : T  5   ,  R W   QT  5   &   V      
=   V  T  5    QT  5   &   V      
=   V  T  5    QV      
  Q8  5
       __alreadyDone   MediaDialog   _   extend   $editable	   data   oe-model   res_model   oe-id   res_id   oe-media-domain   domain   options   media   onSave   on	   save   onCancel   cancel	   open!!   	   data   mediaDialog   .this       +H!!       !!   res_model!!!!   res_id!!!!   domain!!    ;B       5!!       !!	   init!!!!   destroy!!!!%   saveModifiedImages!!!!%   _onAltDialogDemand!!!!%   _onCropImageDemand!!!!'   _onLinkDialogDemand!!!!)   _onMediaDialogDemand!!    ;                     5!!       C                                              ] @v ] @v          
            Q    W   Q     Q     Q   W  Qf      Qf     Q      Q   QY       ]    X   ,   ^	   ]   
   ]      ]      ]      ]      ]      ]      ]      ]	      ]
      Q   A,  R     Q[   V   ]      ]     ]   V  ]     ]   Z   >   -
  5   
   m5   _,  ,  :   5    V  -
  5   
   m5   _,  ,  :   5    =   _Q]   ;Nx .)       tp      n
@!@! 	   blur	   aden   brannan   earlybird   inkwell   maven   toaster   walden   valencia	   xpro   custom   Map%   applyModifications#   cropperDataFields   activateCropper   loadImageInfo   loadImage	   next   value	   done   aspectRatio1   removeOnImageChangeAttrs!!      require%   applyModifications   loadImage   activateCropper   loadImageInfo      !!          applyAll#   cropperDataFields   modifierFields   _applyAll   glFilters   imageCache         +H!!      %   applyModifications  A      (                                    k q k q                          Q       
[    =   ]   =   ]   =   ]     5   :    Q   5	      Q5
      Q5      Q5      Q5      Q5      Q5      Q5    	  Q5    
  QQZ      `       `      `      
   : -
  5   
BQ,  ,  :   5      Q   5      Q   C0   ,  ,  :   5      Q   5      Q   C0   ,  ,  :   5      Q   5      Q   QQ1   
Q   IE
   Q@I   
:     QQQ         :    Q      
=   :    Q     :            Q      
    Q     >   :         Q         :    
=   [      ]	      ]
   :    Q         :    
=    Q      
=   :    Q      D   Q   5	   0	   Q      5
      5	      5	   0
   Q      
=   :    Q       
   >>   5	      5
   >>   5	      5
   	 Q 	       !   5"   A,  R     Q      
=   :    Q     5	   0	   Q     5
   0
   Q    #   
@  :     Q    	  
      
   Q   $   
  O    Q      
   >>   5	      5
   >>  5	     5
   	 Q      D   Q=   0%   Q   &   
>>   5	      5
    Q   '   
      d:            I\L
$ '(+!+D`$!		-'    Object   assign      glFilter   #0000   filter   75   quality   dataset   width   height   resizeWidth   mimetype   originalSrc   filterOptions   map	   next	   done   value   return   parseInt   document   createElement   div   appendChild   $   cropper!   getCroppedCanvas   destroy   canvas   getContext   2d   drawImage   window!   WebGLImageFilter	   bind   apply   fillStyle   fillRect   toDataURL!!      img   .generator       !!          width   height   resizeWidth   quality   filter   mimetype   originalSrc   glFilter   filterOptions	   data   container   original   croppedImg   result   ctx	           !!         glf   cv   filtered            +H!!       !!   glFilter!!!!   filter!!!!   quality!!    !!      D" l l l l            5 !!       !!   width!!!!   height!!    ;   :        ~                   3                 1            T    5!!         loadImage q q q q      @          src    img    D" Cq q Cq q   ;              resolve    D"  rq q rq q   j          5 55!!         activateCropper           n                      3           r s q s 	                         Q      
=   :    Q       
   :  }              :            Q     
        
      
:          :  Q       
   : 0   Q	   	     : 
   
[   ]   =   ]   ?]     ]         
      
Z     `    ?    -
  5   
   m5   _,  ,  :   5    Q)    : ]   ?]   ?]    Q   A   ,  R       T 	[
-
@!KO  J    getAttribute   src   has   fetch   set   URL   createObjectURL	   blob   get   $   cropper   viewMode	   move   dragMode   autoCropArea   aspectRatio   _   mapObject	   pick	   next   value	   done	   data#   minContainerWidth%   minContainerHeight   Promise!!      image   aspectRatio   dataset   .generator       !!          src            !!         res            +H!!      /   activateCropper/<.data<d" es }s es }s 
            5!!       !!   viewMode!!!!   dragMode!!!!   autoCropArea!!!!   aspectRatio!!!!	   data!!!!#   minContainerWidth!!!!%   minContainerHeight!!    !!      #   activateCropper/<d" s s s s 
           5;   m  !              P   r                       s      5 !!         loadImageInfo  D         D                       '            t u s u                         Q  5    5           [   =   ]   [        
=   :    
    : >7]   ]   :         5      QQ   EB   Q	   A   5
      5   5   ,  R 5      5   5   HT     5       5   0   Q  5       5
   0   Q  5       5   0   Q   % & N#aT#+(    dataset   originalSrc5   /web_editor/get_image_info   route   getAttribute   src   split   params   original   URL   image_src   window   location   origin   id   originalId   mimetype!!      img   rpc   .generator       !!          original            +H!!	   [?#]    !!       !!   src!!    !!       !!   route!!!!   params!!    ;      6      )                5!!      !!   x!!   y!!   width!!   height!!   rotate!!   scaleX!!   scaleY   !!      !!   filter!!   quality!!   mimetype!!   glFilter!!   originalId!!   originalSrc!!   resizeWidth!!   aspectRatio   !!          _applyAllD# ^ _ ^ _     0          result    filter   D" ^ _ ^ _   I  0       5 5!!      	   blurD# _ ` _ `   b         5 !!      D" 
` ` 
` `            5 !!      	   adenD# ` a ` a   i         5 !!         brannanD# a b a b   S         5!!         earlybirdD# b d b d            5!!         inkwellD# d d d d            5!!         mavenD# d d d d            5!!         toasterD# d wf d wf            5!!         waldenD# f Sg f Sg   	         5 !!         valenciaD# ]g )h ]g )h   	         5 !!      	   xproD# /h i /h i   
         5 !!         customD# i k i k   "            D" k k k k   \          5 5!!       !!%   applyModifications!!!!#   cropperDataFields!!!!   activateCropper!!!!   loadImageInfo!!!!   loadImage!!!!1   removeOnImageChangeAttrs!!    ;   a  !        !                        5!!       C        b         \                 7            Aw o 9w o       	             T  =    :   QT  =   : W   QT  =   :   QT  =   :   QT  =   :   QT  =   :   QT  =   : W  QT  =   :   QT  =   : 5	      QQT  =
   : 5      Q5      QQV   5     QV   5   	  QV     
[   Z   =   `    ]       ]      ]      ]      ]   : W  QV     
[         
[   V  5   5   D   Q[   [   =   ]   : ]      ]   	   ]   
   ]      ]   : W  QV     
[+         
[   V  5   5   D   Q[   [   =   ]   =   ]    =!   ]"   =#   ]$   =%   ]&   ='   ](   =)   ]*   : ]   +   ],   f   ]-   ].   ]/      ]      ]0      ]      ]      ]1      ]2      ]      ]3      ]4      ]5      ]6      ]7      ]      ]8      ]9       ]:   !   ]%   "   ]   #   ];   $   ]'   %   ]#   &   ]   '   ]!   (   ]<   )   ])   *   ]   : W  QV     
[<   ==   ]>   =?   ],   @   A   
[,   V  5   5   [-   =B   ]C   =D   ]E   : ]   X ]F   .   ]   /   ]0   0   ]G   1   ]1   2   ]2   3   ]:   4   ]   5   ]7   6   ]H   7   ]4   8   ]I   9   ]B   :   ]D   ;   ]   : W  QV     
[@   =J   ]>   =K   ],   =   ]   >   ]:   ?   ]3   : W  QV     
[L   =L   ]>         
[A   V  5   5   D   Q[B   [C   =M   ]N   : ]   D   ]   E   ]0   F   ]   G   ]   H   ]   I   ]O   J   ]P   K   ]M   : W  QV     
[Z   =Q   ]>         
[M   V  5   5   D   Q[N   [O   =R   ]S   =T   ]U   =V   ]W   : ]   P   ]   Q   ]0   R   ]   S   ]   T   ]X   U   ]Y   V   ]R   W   ]V   X   ]T   Y   ]Z   : W  Q[[   V  ][   V  ]\   V  ]]   V  ]^   V  ]_   V  ]`   V  ]a   5,& *n  =*5Wl )?6,=,97 &k$ As H. Q   E      P &  F  R} (:3 v5   + !I5<   {  # ' }      Ow +  4 "$L   % )&?c  yt       4  9  !5>2b    +%    =643 9  E),    web.concurrency   web.core   web.Dialog   web.dom   wysiwyg.fonts   web.utils   web.Widget   web.session7   web_editor.image_processing1   removeOnImageChangeAttrs!   web_editor.utils'   getCSSVariableValue   DEFAULT_PALETTE	   qweb   _t   extendM   /web_editor/static/src/xml/wysiwyg.xml   xmlDependencies	   init   clear	   save   _clear   _   prototype   events   _onSearchInput%   input .o_we_search   search#   _renderThumbnails)   _onUploadButtonClick9   click .o_upload_media_button%   _onFileInputChange)   change .o_file_input/   _onUploadURLButtonClickA   click .o_upload_media_url_button#   _onURLInputChange+   input .o_we_url_input%   _onAttachmentClickC   click .o_existing_attachment_cell   _onRemoveClickG   click .o_existing_attachment_remove!   _onLoadMoreClick%   click .o_load_more   undefined7   existingAttachmentsTemplate   IMAGE_MIMETYPESA   NUMBER_OF_ATTACHMENTS_TO_DISPLAY%   MAX_DB_ATTACHMENTS   start!   fetchAttachments   hasContent+   _getAttachmentsDomain%   _highlightSelected)   _handleNewAttachment   _loadMoreImages   _renderExisting   _save%   _selectAttachement   _updateAddUrlUi   _addData   _addUrl+   wysiwyg.widgets.image   templateU   wysiwyg.widgets.image.existing.attachments   Object   assign-   _onShowOptimizedChangeA   change input.o_we_show_optimized   _onSearchSelect5   change .o_we_search_select   MIN_ROW_HEIGHT   destroy!   _toggleOptimized-   _onAttachmentImageLoad1   wysiwyg.widgets.document[   wysiwyg.widgets.document.existing.attachments5   wysiwyg.widgets.font-icons   _onIconClick-   click .font-icons-icon   _getFont-   _highlightSelectedIcon+   wysiwyg.widgets.video)   _onUpdateVideoOptionI   change .o_video_dialog_options input#   _onVideoCodeInput7   input textarea#o_video_text%   _onVideoCodeChange9   change textarea#o_video_text!   _createVideoNode   _updateVideo!   _getVideoURLData   MediaWidget+   SearchableMediaWidget   FileWidget   ImageWidget   DocumentWidget   IconWidget   VideoWidget!!      require   concurrency	   core   Dialog   dom   fonts   utils   Widget   session	   QWeb   _t   MediaWidget+   SearchableMediaWidget   FileWidget   ImageWidget   DocumentWidget   IconWidget   VideoWidget   	   !!       1   removeOnImageChangeAttrs'   getCSSVariableValue   DEFAULT_PALETTE    	   	   +H!!       	   initC P                                            " yy y qy y   d            	W   QW  QV  5       
V  V   O QV  T 0   QV        T : 0   Q {"	    _super   apply   media   $   $media!!      parent   media   options   arguments   .this       +H;      5!!         clearC  )                                               y z y z               W   QV   5        V      
  Q     media   _clear!!      .this         +H;"       5!!      	   saveC                                                     !z %z z %z                    !!              +H;       5 !!         _clearC                                                     5z 9z -z 9z   1               4 !!              +H;       5 !!       !!   xmlDependencies!!!!	   init!!!!   clear!!!!	   save!!!!   _clear!!    !!            !!            !!       !!%   input .o_we_search!!    !!      	   initC  N                                             " z 4{ z 4{                	W   QW  QV  5       
V  V   O QV        
V  5   X: 0   Q  "$    _super   apply   _   debounce   _onSearchInput!!      arguments   .this         +H;      5 !!         searchC                                                   D{ N{ <{ N{   @               I !!      needle        +H;       5 !!      #   _renderThumbnailsC                                                     i{ m{ a{ m{   e               h !!              +H;       5 !!         _onSearchInputC p                                              { | }{ |                     Q   Z    0    Q      
      T  5   :    
:  D   Q=   :    
     Q   C0   Q +#    attachments   search   $   currentTarget   val   	   then   hasSearched!!      ev   .this       +H!!        !   _onSearchInput/<d"  { { { {            5 ;5!!       !!   events!!!!	   init!!!!   search!!!!#   _renderThumbnails!!!!   _onSearchInput!!    !!            !!            !!       !!9   click .o_upload_media_button!!!!)   change .o_file_input!!!!A   click .o_upload_media_url_button!!!!+   input .o_we_url_input!!!!C   click .o_existing_attachment_cell!!!!G   click .o_existing_attachment_remove!!!!%   click .o_load_more!!    !!      !!   image/gif!!   image/jpe!!   image/jpeg!!   image/jpg!!   image/gif!!   image/png!!   image/svg+xml   !!      	   initC "        7                                  " ~ m ~ m        	       	W   QW  QV  5       
V  V   O QV    5   A,  R  0   QV  V  5   0   QV        
[    T E5   QT 5   E&   Q	   	   T 5   : 
   
:  ]   T D   Q[   : 0   QV  Z    0   QV  Z    0   QV  Z    0   QV  Z    0   QV       
V  5   : 0   Q "H'_3    _super   apply   Mutex   _mutexA   NUMBER_OF_ATTACHMENTS_TO_DISPLAY9   numberOfAttachmentsToDisplay   _   extend   parentElement   $   width   mediaWidth   options   attachments'   selectedAttachments   libraryMedia   selectedMedia!   makeAsyncHandler/   _onUploadURLButtonClick!!      parent   media   options   arguments   .this       +H!!       !!   mediaWidth!!    !!            ;      5!!         startC  ]     $   x                         I             |  t                  	W   Q   Q   5       
   V   O    Q      Q         
=   : 0   Q         
=   : 0   Q         
=   : 0   Q         
=	   : 0
   Q         
=   : 0   Q         
=   : 0   Q         
=   : 0   Q         
=   : 0   Q         
=   : 0   Q[    @]   @]      Q   5      
=   : /         5      
=   : 0   Q      5      
=   : j         5      
=   :    
   =   : 0   Q      5       
   =   : ?7#0!   Q   "   
=   : #   
   :  &
!%	    _super   apply   $   .o_we_url_input   $urlInput	   form   $form   .o_file_input   $fileInput-   .o_upload_media_button   $uploadButton5   .o_upload_media_url_button   $addUrlButton#   .o_we_url_success   $urlSuccess#   .o_we_url_warning   $urlWarning   .o_we_url_error   $urlError!   .o_we_error_text   $errorText   url   alt   $media   is   img	   attr   src   a.o_image	   href   replace      match   id   search	   then!!      def	   self   o   arguments   .this        +H!!       !!   url!!!!   alt!!    !!   [?].*    !!+   \/web\/content\/(\d+)    !!          start/<d"  <  7    !   $          B                 5 5;5!!      	   saveC  2                                                ,  ,                W   QV   5       
V   5      
V   : :  (    _mutex	   exec   _save	   bind!!      .this         +H;       5 !!         searchC -                                              <  4    `             W   QV   T  0    QV      
V   5   >: i?    needle!   fetchAttachmentsA   NUMBER_OF_ATTACHMENTS_TO_DISPLAY!!      needle   .this       +H;       5!!      !   fetchAttachmentsC          A                                                             Q       
[   =   ]   =   ]   Z    ]   [         
   5   : ]   f    ]	   Z   [   =
   ]   B]   `    ]      5   5   ]   T  ?]      ]   ]   :    
   :   (  
 w   	   _rpc   ir.attachment   model   search_read   method	   args+   _getAttachmentsDomain   needle   domain   fields   id	   name   asc   order   options   context   limit   offset   kwargs	   then!!      number   offset   .this       +H!!      !!	   name!!   mimetype!!   description!!   checksum!!   url!!	   type!!   res_id!!   res_model!!   public!!   access_token!!   image_src!!   image_width!!   image_height!!   original_id   !!       !!	   name!!!!   asc!!    !!       !!   domain!!!!   fields!!!!   order!!!!   context!!!!   limit!!!!   offset!!    !!       !!   model!!!!   method!!!!	   args!!!!   kwargs!!    !!       %   fetchAttachments/<d" L  L    p         5 ;5!!         hasContent@           	                                                        W   QV   5            attachments   length!!      .this         +H;       5 !!         _clearC        	   )                                     %      I            W  QV  5       
=   :        W   Q   W  QV  5   V  5   5   EO   QV  5   5      
=   =   :    
V   =   :    
V  =   : 0   Q L OQ]+5"    $media   is   img   media   className   replace#   o_we_custom_image       !!      allImgClasses)   allImgClassModifiers   .this         +H!!w   (^|\s+)((img(\s|$)|img-(?!circle|rounded|thumbnail))[^\s]*)   !!   (^|\s+)(rounded-circle|shadow|rounded|img-thumbnail|mx-auto)([^\s]*)   ;"       5!!      +   _getAttachmentsDomainC                                   2                 o            W  QV  5    5   E   QV  5    5      K   Z   =   `    Z   =   `    =   `   V  5    5   `   `      Z    W   QZ   =   `    Z   =   `    =   `   V  5    5   `   `   Z   =	   `    =   `   V  5    5	   >`   `   W  QV  5    5	    U   V  
   
=    QV     
Z   =   `    =   `   V  5    5   `    QV  5    5     Z   =   `    Z   =   `    =   `   V  5    5   `   `   Z   =	   `    =   `   V  5    5   >`   `   W  QV  5    5    Q   V  
   
=    QV     
Z   =   `    =   `     5   `    QV      
Z   =   `    V  V  : W   Q   V      
V  : W   QZ   =   `    Z   =   `    =   `   C`   `      
V   : W   QV      
V  5    5   : W   QT  E   QT     6   V      
Z   =   `    =   `   T  `    QV      
=   Z   =   `    =   `   =   `    QV      
=   Z   =   `    =   `   =   `   =   Z   =   `    =   `   =   `    QV    |F$	$$	@	++I    options   attachmentIDs   length   |   id   in   &   res_model   =   res_id   unshift	   push   create_uid   user_id   data_res_model   data_res_id   uid   concat   public   mimetypeDomain	   name   ilike   !   =like   %.crop	   type   binary   url   /%/static/%!!      needle   domain-   attachedDocumentDomain   relatedDomain   .this       +H;b       5!!      %   _highlightSelectedC  R                                                                   W   QV      QV       
=   :    
=    Q      
V   5        Q  
?(      $i   .o_existing_attachment_cell.o_we_attachment_selected   removeClass1   o_we_attachment_selected   _	   each'   selectedAttachments!!   	   self   .this        +H!!        )   _highlightSelected/<b   }    ?         5 ;5!!      )   _handleNewAttachmentC f                                              ,  $                  W   QV   V   5       
    : 0    QV   5       
    QV      
  QV      
    Q 5%$    attachments   filter   unshift#   _renderThumbnails%   _selectAttachement!!      attachment   .this      +H!!        M   _handleNewAttachment/this.attachments<d" b } b }            5 ;5!!         _loadMoreImagesC 4                                                                      Q       

   5   :    
    :  <   !   fetchAttachments9   numberOfAttachmentsToDisplay	   then!!      forceSearch   .this       +H!!       #   _loadMoreImages/<d"  Q  Q      0       5;5!!         _renderExistingC 6                                                               W   Q      
V   5   [    T  ]   V   ]   :  5U    render7   existingAttachmentsTemplate   attachments   widget!!      attachments   .this       +H!!       !!   attachments!!!!   widget!!    ;       5 !!      #   _renderThumbnailsC  /        ;                                             X     	       W  QV  5       
>V  5   : W   QV     
=   :    
V     
V   :  QV     
  QV     
=   : 	   
=
   V     
:    QV  5   V  5       W  QV  5   V  5       W  QV     
=   : 	   
=
   V  D   QV    QV     
=   : 	   
=
   V   Q _<1//-TKB9&    attachments   slice9   numberOfAttachmentsToDisplay   $5   .o_we_existing_attachments   replaceWith   _renderExisting%   _highlightSelected   .o_we_load_more   toggleClass   d-none   hasContentA   NUMBER_OF_ATTACHMENTS_TO_DISPLAY   length!   .o_load_done_msg   .o_load_more!!      attachments!   noLoadMoreButton   noMoreImgToLoad   .this         +H;       5!!         _saveE  6     B                                                             Q        Q       
  5      
    : :    QZ       Q       
   :    >IQ        
[   =   ]   [      ]	   ]
   :            Q  5      
   :    
   :    Q  5   5               >7   Q    D   Q   5         5	         5    E   Q   5    t        
[   =   ]   =   ]   Z   Z      5   `    `    ]   :    
   :         Q   5         5     Q   5    E   Q   5   5        5      
=      5   :   Q  5      
=   :  I             =!   [   ="   ]#   : 0   Q    5   >70	   Q  5   $   
=%      Qt    5      
=&   :  W           ='   : (   
  Q          =)   : 0   Q    5   >70	   Q=*      5   =+     Q   5    E   Q   5   5        5      
=,      5   :   Q  =-      5.   =/     Q  5   $   
=0      Q  5   1   
=2   : $   
=3      54   : $   
=5      56    Q  5   $   
=7      57   D   Q   58   D   Q=9    Q  5:     Q        5   ;   
   Q    <   
    Q  5	   5=   >   
=?    Q  5   @   
=A    Q  5	           &   "'	2 &   	 &   R2"
 . 9
K8%    Object   fromEntries   selectedMedia   map	   keys   length	   _rpc=   /web_editor/save_library_media   route   media   params'   selectedAttachments   concat   options   multiImages   id   public   access_token   ir.attachment   model+   generate_access_token   method	   args	   then   image_src   _   str   sprintf!   ?access_token=%s   $media   is   img   $   <img/>7   img-fluid o_we_custom_image   class	   attr   src   a/   .note-control-selection	   hide	   <a/>   /web/content/   ?!   access_token=%s&   unique=   checksum   &download=true	   href   addClass   o_image   title	   name   data-mimetype   mimetype   alt   description      style   css   forEach   classList   remove1   o_modified_image_to_save   trigger   image_changed!!      src	   href   style   .generator   .this         !!       !   mediaAttachments   toSave   selected   img           +H!!          _save/toSave<d" " p " p            5!!       !!   media!!    !!       !!   route!!!!   params!!    !!         _save/selected<d" X  X    E           5 !!       !!   model!!!!   method!!!!	   args!!    !!          _save/<b                 5!!       !!   class!!    !!          _save/<d"  A  A &  !          5;      !      
             I             &                 5!!      %   _selectAttachementC          L                                        &         
              Q   QT     QT   QT H   Q[    5    H   Q=     QQ    Q[   =   ]   =   ]     QV  V  7  Q   5   5        Q   V  7   
V   :   QV  I1   V          V  7   
V  ? Q      V  7	   
V    QC   
      
V  :    
    Q   V  Z   V   `    9Q      
  QV           
=    Q  # 	! 	   type   attachment'   selectedAttachments   selectedMedia   media   options   multiImages   indexOf   splice	   push   Object   values   forEach%   _highlightSelected   trigger_up   save_request!!      attachment	   save 	   type   .this     !!          possibleProps	   prop          !!         index          +H!!            !!       !!   attachment!!!!   media!!    !!      )   _selectAttachement/<d" 3 I 3 I &  ;         5 ;   U   7        w       5!!         _updateAddUrlUiC       	   "                                         '  ^             W   QV   5       
=   T  :    
=   T   :    
=   T   QV   5      
=   T   QV   5      
=   T  D
   QT  QyU7&.7    $addUrlButton   toggleClass   btn-secondary   btn-primary	   prop   disabled   $urlSuccess   d-none   $urlError!!      emptyValue   isURL   isImage   .this       +H;       5!!      %   _onAttachmentClickC          ?                                        '         	       W   Q     QT  5      QV  5   5      Q5      QQ   R     QV   5      
    :   QV      
V  V   5   5     Qg      \     QV   5	      
   :   QV      
V  V   5   5    [   =
   ]    Q y!-J#D<I    currentTarget   dataset   id   mediaId   attachments	   find%   _selectAttachement   options   multiImages   libraryMedia   media	   type!!      ev   .this       !!          attachment   attachmentID   mediaId          !!         attachment          !!         media          +H!!       =   _onAttachmentClick/attachment<d" k  k  '           5 !!      3   _onAttachmentClick/media<d"  5  5 '           5!!       !!	   type!!    ;            L   G             V       5!!      %   _onFileInputChangeC  2                                                   '  8            W   QV   5       
V   5      
V   : :  ;+    _mutex	   exec   _addData	   bind!!      .this         +H;       5 !!         _addDataC        	   $                                       t  t '                W  QV     Q  5    A,  R     Q      
V  5   >75   =   : W   Q      
V        Q      
:     
   :  *     Mutex   _   sortBy   $fileInput   files	   size	   each   getUnlockedDef	   then!!   	   self   uploadMutex   files   .this        +H!!          _addData/<b g  _  '            	   file   B      '  "            B     '  X            B     '  8         5 555!!          _addData/<b   q  q '            5;5!!         _onRemoveClickC R                                                  (                W   QV      Q       
  Q     
V   	  =   : [       ]    Q7
3{    stopPropagation   confirmW   Are you sure you want to delete this file ?!   confirm_callback!!      ev	   self   .this      +H!!       !   confirm_callbackB      (     @          $a    id    attachment   B     (    @         D"     (  "         5    D"     (  Q         5 55!!       !!!   confirm_callback!!    ;5!!      #   _onURLInputChangeC                                                     *         	       W  QV  5       
:     Q   =   HW   Q       
   : W  Q      
f      : W  QV     
V   V  V   Q  !c/    $urlInput   val   	   test   _   any   _updateAddUrlUi!!      inputValue   emptyValue   isURL   isImage   .this        +H!!   ^.+\..+$    !!      !!	   .gif!!   .jpeg!!	   .jpe!!	   .jpg!!	   .png   !!        5   _onURLInputChange/isImage<b     *  E         5 ;5!!      )   _onUploadButtonClickC           	                                       "  " *              W   QV   5       
  Q     $fileInput   click!!      .this         +H;       5!!      /   _onUploadURLButtonClickC           $                                      C  ;  *              W   QV   5       
=   : ?   V   5       
=    QV   5      
=   =    QV   5   	   
V   5
      
V   : :  07/1*    $urlInput   is3   .o_we_horizontal_collapse   removeClass1   o_we_horizontal_collapse   $addUrlButton	   attr   disabled   _mutex	   exec   _addUrl	   bind!!      .this         +H;"       5!!         _addUrlC           (                                      +  #  +                W   QV      QV       
[   =   ]   [    V   5      
:  ]   V   5   5   ]   V   5   5   ]   ]	   : 
   
   : J
'     	   _rpc=   /web_editor/attachment/add_url   route   $urlInput   val   url   options   res_id   res_model   params	   then!!   	   self   .this        +H!!       !!   url!!!!   res_id!!!!   res_model!!    !!       !!   route!!!!   params!!    !!           _addUrl/<b     +            5 ;5!!      !   _onLoadMoreClickC           	                                          +              W   QV       
  Q     _loadMoreImages!!      .this         +H;       5 !!         _onSearchInputC  K                                             "  _  _ +              	W   QW  QV  Z    0    QV  V  5   0   QV  5      
V  V   O Q H"    attachmentsA   NUMBER_OF_ATTACHMENTS_TO_DISPLAY9   numberOfAttachmentsToDisplay   _super   apply!!      arguments   .this         +H;      5!!       !!   events!!!!7   existingAttachmentsTemplate!!!!   IMAGE_MIMETYPES!!!!A   NUMBER_OF_ATTACHMENTS_TO_DISPLAY!!!!%   MAX_DB_ATTACHMENTS!!!!	   init!!!!   start!!!!	   save!!!!   search!!!!!   fetchAttachments!!!!   hasContent!!!!   _clear!!!!+   _getAttachmentsDomain!!!!%   _highlightSelected!!!!)   _handleNewAttachment!!!!   _loadMoreImages!!!!   _renderExisting!!!!#   _renderThumbnails!!!!   _save!!!!%   _selectAttachement!!!!   _updateAddUrlUi!!!!%   _onAttachmentClick!!!!%   _onFileInputChange!!!!   _addData!!!!   _onRemoveClick!!!!#   _onURLInputChange!!!!)   _onUploadButtonClick!!!!/   _onUploadURLButtonClick!!!!   _addUrl!!!!!   _onLoadMoreClick!!!!   _onSearchInput!!    !!            !!       !!A   change input.o_we_show_optimized!!!!5   change .o_we_search_select!!    !!      	   initC          *                         	               +              W   QV   =    0   Q      
[    =   ]   Z   Z   =   `    =   `   V   5   `   `    ]	   T D   Q[   : U QV   V   5
      
V   : 0
   QV      
T  T T  Q b'"    all   searchService   _   extend   image/*   accept   mimetype   in   IMAGE_MIMETYPES   mimetypeDomain-   _onAttachmentImageLoad	   bind   _super!!      parent   media   options   .this       +H!!       !!   accept!!!!   mimetypeDomain!!    !!            ;       5!!         startE                                              (  .  . +               	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5      
=      5   C Q    @!B    _super	   next   value	   done   el!   addEventListener	   load-   _onAttachmentImageLoad!!      .generator   arguments   .this         +H;   K   !         5!!         destroyC                                                ?  7  +  W     
       	W   QW  QV  5       
=   V  5   C QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) ZE@!    el'   removeEventListener	   load-   _onAttachmentImageLoad   _super	   next   value	   done!!      arguments   .this         +H;   ^   !          5!!      !   fetchAttachments@         l                      3            O  O +                    Q        Q  5    E   Q  5   =   I     5     Q>  Q     
    :            Q    =   :    Q  5      
     Q  5    #          
[   =	   ]
   [     5    ]     5      ]   ]   :            Q   5      Q     5   0   Q  5      
Z    >   -
  5   
   m5   _,  ,  :   5    Q)Q+      v   Q      
=    Q            + 1!!;  )}%@!-    needle   searchService   database%   MAX_DB_ATTACHMENTS   _super   o-color-1   attachments   forEach	   _rpcA   /web_editor/media_library_search   route   query   libraryMedia   length   offset   params   media   results   nbMediaResults	   push	   next   value	   done   console   error9   Couldn't reach API endpoint.!!      number   offset   .generator   .this       !!          result   primaryColor            !!         response   newMedia            !!         e           +H!!       %   fetchAttachments/<d"     ,  {   @       5!!       !!   query!!!!   offset!!    !!       !!   route!!!!   params!!    ;     !                                                                  0  5!!         hasContent@       	   >                                     Z + P + .        
       	W   QW  QV  5    =   H|   V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)D   QV  5      ,   V  5    =   H   V  5        V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)@!! .})!@!    searchService   all   _super	   next   value	   done   libraryMedia   length   media-library!!      arguments   .this         +H;   P   !         !   3       5!!         _updateAddUrlUiC          0                                  " D R < R /  ;             	W   QW  Q  QV  5       
V  V   O QV  5      
T E   QT     	  =   :    	  =   :  QT E   QT    QV  5      
=   V    QV     V  5	   
   
=    QU" 
W	&0%    _super   apply   $addUrlButton	   text   Add as document   Add image   $urlWarning   toggleClass   d-none   $urlSuccess   addClass!!      emptyValue   isURL   isImage   arguments   .this       !!          warning          +H;         #      5 !!      #   _renderThumbnailsC  -        i                      :             m 6 e 6 /                	W   Q   Q    Q       
=   :   Q      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)Q       
=   :    
=    QV  	   
     Q   
   
       
=   : >75    Q<       5     Q       
=   :    
[   V  ]   V  ]    Q   5   E4   QZ   =   `    =   `      
   5   :        Q   5         5   H  QV  E   Q   5        Q       
=   :    
=   V  D   QV    Q       
=   :    
=   V   Q f:@!&  L),=E?B9'    $_   .o_existing_attachment_cell[data-loaded="true"]   _super	   next   value	   done7   .o_existing_attachment_cell   addClass   d-none	   each!   _toggleOptimized3   input.o_we_show_optimized   checked   MIN_ROW_HEIGHT9   .o_we_attachment_placeholder   css   flexGrow   flexBasis   needle   media-library   all   includes   searchService   libraryMedia   length   nbMediaResults!   .o_load_done_msg   toggleClass   .o_load_more!!      ?!!      arguments   .this        !!          alreadyLoaded!   placeholderWidth          !!         noMoreImgToLoad!   noLoadMoreButton          +H!!       '   _renderThumbnails/<d" $  $  /            5 !!       !!   flexGrow!!!!   flexBasis!!    ;   `   !                       5!!         _renderExistingC       
                             
           O E G E /  F            W   QV   5    E   QV   5   =   I!   T     
>V   5   : U  Q     
V   5   [    T  ]   V   5   ]   V   ]	   :  T15t    needle   searchService   database   slice%   MAX_DB_ATTACHMENTS   render7   existingAttachmentsTemplate   attachments   libraryMedia   widget!!      attachments   .this       +H!!       !!   attachments!!!!   libraryMedia!!!!   widget!!    ;"       5!!      !   _toggleOptimizedC +                                              _  W  0                W   QV       
=   :    
     Q  %P    $5   .o_we_attachment_optimized	   each!!      value   .this      +H!!        %   _toggleOptimized/<d"     0            5 ;5!!      %   _highlightSelectedC                                                    0         	       	W   Q   Q       
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)Q   5      
     Q 3@!      _super	   next   value	   done   selectedMedia   forEach!!      arguments   .this        +H!!        )   _highlightSelected/<d" 1  1  0  h         5 ;   =   !   5 !!      -   _onAttachmentImageLoadE &     :                         z            4  4 0          	          Q        Q  5       Q      
=   :    Q             5   5   E!   Q   5      
=   :         5      Q           :            Q   5	   
   
=   : =   HY          
:             Q   A    ?7=   ,  R    Q      
   :            
=   :    
:     Q   AZ        
      =   : : `       [    =   ]   ,  R    Q        
   : 0   Q  5      
   :    Q         C0   Q   +      v   Q      
=    Q    5       5!      Q   5!   >H        X0"   Q  5#   =$   0%   Q  5#   =&   0'   Q  5(      Q)   5*   +   
   Q  5"     5,     Q   +   
   Q  -   
="    Q  5#   .   
=%    Q  5#   .   
='    Q     5/      Q   5#      00   Q   5#      =1   02   Q   53   4   
=5    Q   53   6   
=7    Q   5   =8   09   Q     0 +   1 7
&	Df I
   2/!! %&
     target   closest7   .o_existing_attachment_cell   dataset   mediaId   src   startsWith	   blob   fetch   headers   get   content-type   image/svg+xml	   text   RegExp   gi	   test   split   /   pop	   File   replace   o-color-1	   type   URL   createObjectURL   libraryMedia	   find   isDynamicSVG   console   error   CORS is misconfigured on the API server, image will be treated as non-dynamic.   naturalWidth   naturalHeight   width   style   fixed   position   0   opacity   parentElement   document	   body   appendChild   height   removeAttribute   removeProperty   MIN_ROW_HEIGHT   flexGrow   px   flexBasis   classList   remove   d-none   add   d-flex	   true   loaded!!      ev   .generator   .this       !!          aspectRatio   img	   cell   width           !!         mediaUrl            !!         response            !!         svg   colorRegex            !!         fileName	   file   media            !!         e           !!         originalParent            +H!!       !!	   type!!    !!       ;   _onAttachmentImageLoad/media<d" + [ + [ 1            5;                      Q                                       N        j           @  
         A  	         B           C            D     	      \                            5 !!      -   _onShowOptimizedChangeC #         	                                     T  L  4               W   QV       
T  5   5    Q  ) !   _toggleOptimized   target   checked!!      ev   .this       +H;       5 !!         _onSearchSelectC T                                                 4  )            W   Q  QT  5    5     QQV   V  0   QV      
=   :    
=    Q -    target   value   searchService   $   .o_we_search   trigger   input!!      ev   .this       !!          value          +H;      M          5 !!         _onSearchInputC w                                              G 
 G 4       
       	W   QW  QV  Z    0    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)Q @!    libraryMedia   _super	   next   value	   done!!      ev   arguments   .this       +H;   J   !          5 !!       !!   template!!!!7   existingAttachmentsTemplate!!!!   events!!!!   MIN_ROW_HEIGHT!!!!	   init!!!!   start!!!!   destroy!!!!!   fetchAttachments!!!!   hasContent!!!!   _updateAddUrlUi!!!!#   _renderThumbnails!!!!   _renderExisting!!!!!   _toggleOptimized!!!!%   _highlightSelected!!!!-   _onAttachmentImageLoad!!!!-   _onShowOptimizedChange!!!!   _onSearchSelect!!!!   _onSearchInput!!    !!       	   initC       	   !                                        4  {            W   Q       
[    =   ]   Z   Z   =   `    =   `   V   5   `   `    ]   T D   Q[   : U QV      
T  T T  Q 	b"    _   extend   */*   accept   mimetype   not in   IMAGE_MIMETYPES   mimetypeDomain   _super!!      parent   media   options   .this       +H!!       !!   accept!!!!   mimetypeDomain!!    !!            ;       5 !!         _updateAddUrlUiC          .                                  "     4  8            	W   QW  Q  QV  5       
V  V   O QV  5      
T E
   QT    	  =   :    	  =   :  QT E
   QT   QV  5      
=   V    QV     V  5	   
   
=    Q R")V&0%    _super   apply   $addUrlButton	   text   Add as image   Add document   $urlWarning   toggleClass   d-none   $urlSuccess   addClass!!      emptyValue   isURL   isImage   arguments   .this       !!          warning          +H;         #      5 !!      +   _getAttachmentsDomainC P                                               <  < 4  c            	W  QW  QV  5       
V  V  O W   QV      
=        
:  :  p"(    _super   apply   concat   !   assetsDomain!!      needle   domain   arguments   .this       +H;       5 !!       !!   template!!!!7   existingAttachmentsTemplate!!!!	   init!!!!   _updateAddUrlUi!!!!+   _getAttachmentsDomain!!    !!            !!            !!       !!-   click .font-icons-icon!!    !!       	   initC       	                                      " 
    4         	       	W   QW  QV  5       
V  V   O Q     
  QV    5   0   QV        
      
V  5       : : 0   Q "!F    _super   apply   computeFonts   fontIcons   iconsParser   _   flatten   map   alias!!      parent   media   arguments   .this       +H!!       !   init/this.alias<b     4  2         5 ;5!!         startC  /        B                                     ?  ? 4  _            	W  QW  QV  V      
=   : 0   QV  5   E   QV  5   5   D   Q=      
    : W   Q>W  Q a   mV   V  7W  Q      
V  5	   V  : #   V  V  0
   QV     
  QV  #W  QQV  V      V        
V   =   V  5
   : 0   QV  5      
V  V  O  b/&aSq:"    $!   .font-icons-icon   $icons   media   className      split   _   contains   alias   selectedIcon-   _highlightSelectedIcon   length   without%   media_iframe_video   nonIconClasses   _super   apply!!      classes   i   cls   arguments   .this         +H!!   \s+    ;    u   q   3       5 !!      	   saveC          h                         (            M - E - 5               W  QV  5       
=   : D   Q=   W   QV     
V  5   : D    Q[    =   ]   =   ]   W  Q	   
   
V  5      
Z   V  5   `    V  5   `   : : W  QV  5       
=   :           =   : W  QV     
V  5       
:   QV  V  0    QV  V  5    >70   QV      
   =   : W   QV  5       
[   	      
V  :    
=   : ]   V   D   Q@]    Q      
V  5   :   "	#
0B
O    $media	   attr   style      _getFont   selectedIcon   fa	   base	   font   _	   uniq   nonIconClasses   concat   is   span, i   $   <span/>	   data   media   replace   compact	   join       class   Promise   resolve!!      style   iconFont   finalClasses   $span   .this         +H!!       !!	   base!!!!	   font!!    !!   \s*width:[^;]+    !!       !!   class!!!!   style!!    ;"       5!!         searchC          *                                     = ! 5 ! 6                W   QV   5       Q   E   Q      /   Z       Q      
V   5         QV      
=   :    
     
=   [      ]    V   ]	   :  Q
      
:    T\    iconsParser   length   _   filter   $)   div.font-icons-icons	   html   renderA   wysiwyg.widgets.font-icons.icons   widget   Promise   resolve!!      needle   iconsParser   .this      +H!!           search/<b     6               B  =  = 6  )            B  : 	 : 6  W         5 55!!       !!   iconsParser!!!!   widget!!    ;5 !!         _clearC  W                                              1  )  7               W  Q    W   QV  5    V  5    5   E(   QV  5    5      
V   =   : 0   Q  ++/    media   className   replace    !!      allFaClasses   .this         +H!!5   (^|\s)(fa(\s|$)|fa-[^\s]*)   ;       5!!         _getFontC &        l                                    ]  ] 7  D     	       W  QT      r )   T  D   Q=      
    : U  Q>W  Q    mV  5   V  7W   Q>W  Q    mV   5   V  7W  Q      
T  V  5   :    8   [   V   5	   ]	   V   5
   ]
   V  5   >7]   V  #W  QQV  V   5      qV  #W  QQV  V  5      )@ Q 	&      #!&q  #1 8      Array      split   iconsParser   cssData   _   intersection   names   length	   base   parser	   font!!      classNames   fontIcon   cssData   k   s   .this       +H!!   \s+    !!       !!	   base!!!!   parser!!!!	   font!!    ;    f          F      R       5!!      -   _highlightSelectedIconC  R                                               } Q u Q 9                W   QV      QV   5       
=    QV   5       
    :    
=    Q4
4i%    $icons   removeClass1   o_we_attachment_selected   filter   addClass!!   	   self   .this        +H!!       1   _highlightSelectedIcon/<b  )  ) 9            5 ;5!!         _onIconClickC t      
                                        g  _  9              W   QT      
  QT     
  QV         T  5   :    
=   : 0   QV      
  QV      
=	    Q      preventDefault   stopPropagation   $   currentTarget	   data   id   selectedIcon-   _highlightSelectedIcon   trigger_up   save_request!!      ev   .this       +H;       5!!    
   !!   template!!!!   events!!!!	   init!!!!   start!!!!	   save!!!!   search!!!!   _clear!!!!   _getFont!!!!-   _highlightSelectedIcon!!!!   _onIconClick!!    !!            !!            !!       !!I   change .o_video_dialog_options input!!!!7   input textarea#o_video_text!!!!9   change textarea#o_video_text!!    !!      	   initC b                                            " 7  /  9              	W   QW  QV  5       
V  V   O QV  T 5     0   QV        
V  5   X: 0   Q "(    _super   apply   isForBgVideo   _   debounce#   _onVideoCodeInput!!      parent   media   options   arguments   .this       +H;      5!!         startC       !   y                          A             M  M 9       
       	W  QW  QV  V      
=   : 0   QV  5   X          V  5   : W   QV      
=   : De   QV      
=   : DK   QV      
=   :    V   	   
=   :    =
   D   Q=
   W  QV      
=   :    
V   QV      
=   :    
=   V     
=   : > QV      
=   :    
=   V     
=   : > QV      
=   :    
=   V     
=   : > QV      
=   :    
=   V     
=   : > QV      
=   :    
=   V     
=   : > QV      
=   :    
=   V     
=   : > QV      
=   :    
=   V     
=   : > QV     
  QV  5       
V  V  O  ! 	0-5-,)7'434,53"    $-   .o_video_dialog_iframe   $content   media	   data   oe-expression   src   is   iframe	   attr   +   textarea#o_video_text   val-   input#o_video_autoplay	   prop   checked   indexOf   autoplay=17   input#o_video_hide_controls   controls=0%   input#o_video_loop   loop=1;   input#o_video_hide_fullscreen	   fs=05   input#o_video_hide_yt_logo!   modestbranding=15   input#o_video_hide_dm_logo   ui-logo=07   input#o_video_hide_dm_share!   sharing-enable=0   _updateVideo   _super   apply!!      $media   src   arguments   .this         +H;#       5!!      	   saveC  	        D                                     [  S  :  8             W   QV       
  QV   5   8         
[    V   5      
=   : ]   : V      
=	   : 
   
=   : u   V         =   V   5      
=   : =   V   5      
=   : =   : 0   QV   V   5   >70   Q      
V   5   : ;# ;!E   f    _updateVideo   isForBgVideo   Promise   resolve   $content	   attr   src   bgVideoSrc   $-   .o_video_dialog_iframe   is   iframei   <div class="media_iframe_video" data-oe-expression="  "><div class="css_editable_mode_display">&nbsp;</div><div class="media_iframe_video_size" contenteditable="false">&nbsp;</div><iframe src="   " frameborder="0" contenteditable="false" allowfullscreen="allowfullscreen"></iframe></div>   $media   media!!      .this         +H!!       !!   bgVideoSrc!!    ;2       5 !!         _clearC        
   (                                       <  4      	       W  QV  5    5   5   J   V  5    5   .   Q/     Qv  QV  5    5      0   Q     W   QV  5    5   E#   QV  5    5      
V   : W  QV  J   V  5    V  5    5      
V   =   : 0   QV  5    =   0	   Q7'6,2    media   dataset   src   undefined   className   match   replace          innerHTML!!      allVideoClasses   isVideo   .this         !!          e         +H!!=   (^|\s)media_iframe_video(\s|$)   ;               <   &   b       5 !!      !   _createVideoNodeC         T                                   6  .  =              W   Q    QT D   Q[    U QV       
T  T :   QV  5      [   >]   V  5       [   ?]         =   :    
X :    
X:    
=	   >:    
=
   V  5   :    
=   :   Q[   V  ]   V  5   ]    
#   >  R" !   _getVideoURLData   error   errorCode	   type   $   <iframe>   width   height	   attr   frameborder   src   embedURL   addClass+   o_video_dialog_iframe   $video!!      url   options   .this       !!          videoData   $video          +H!!            !!       !!   errorCode!!    !!       !!   errorCode!!    !!       !!   $video!!!!	   type!!    ;             Y              x                        2       5!!         _updateVideoC       A   H                                       ?               W  QV  5       
  QV     
=   :    
=   :    
=   :    
=    QV     
=	   : 
   
=    QV     
=   : W   QV      
:     
:  W  QV      V     
    : W  QV  E2   QV  7   >E   QV  7   
=   :    V  ?V  79QV     V  ?7
   V  W  QV     
V  [   V  5   D)   QV     
=   :    
=   : ]   V  5   D)   QV     
=   :    
=   : ]   V  5   D)   QV     
=   :    
=   : ]   V  5   D)   QV     
=   :    
=   : ]   V  5   D)   QV     
=   :    
=   : ]    V  5   D)   QV     
=!   :    
=   : ]"   V  5   D)   QV     
=#   :    
=   : ]$   : W  QV     
=%   : W  QV  5&      
='   : (   
V  : )   
=   V  5*     QV  5&      
=   : )   
=+   V  5*    :    
=   : )   
=,   V  5*    : -   
:  )   
=.   V  5*     :    
=   : )   
=/   V  5*      QV     
=0   V  51   =2   :    
=    QV  )   
=   V  5   D!   QV     
=3   :    >H QV  51   =4   HZ   V     
=5   : 6   
=7   : )   
=   V     
=   :    
=   :  QV  5*   W  QV      V  58   F                   =9   [   =:   ];   	  =<   : ]=   : W  QD         =9   [   =>   ];   	  =?   : ]=   : W  Q   V  5    @   
V   QV  V  0    Q  )&#&
$; @(5&!!#&%("%"%#& n"H"$?)?(",=',0]D$&h  ;s`<  `$    $content   empty   $'   #o_video_form_group   removeClass3   o_has_error o_has_success	   find;   .form-control, .custom-select'   is-invalid is-valid7   .o_video_dialog_options div   addClass   d-none+   textarea#o_video_text   val	   trim   match   length   indexOf   instagram!   _createVideoNode   isForBgVideo-   input#o_video_autoplay   is   :checked   autoplay7   input#o_video_hide_controls   hide_controls%   input#o_video_loop	   loop;   input#o_video_hide_fullscreen   hide_fullscreen5   input#o_video_hide_yt_logo   hide_yt_logo5   input#o_video_hide_dm_logo   hide_dm_logo7   input#o_video_hide_dm_share   hide_dm_share/   .o_video_dialog_options   $elm   .o_video_dialog_preview_text, .media_iframe_video_size   add   toggleClass   $video   o_has_error   is-invalid   end   o_has_success   is-valid   div.o_	   type   _option!   div:not(.d-none)   youtubes   input#o_video_hide_fullscreen, input#o_video_hide_yt_logo   closest   div   errorCode   <div/>e   alert alert-danger o_video_dialog_iframe mb-2 mt-2   class;   The provided url is not valid	   textg   alert alert-warning o_video_dialog_iframe mb-2 mt-2o   The provided url does not reference any supported video   replaceWith!!      $textarea	   code   embedMatch   url   query   $optBox   $content   .this         +H!!3   (src|href)=["']?([^"']+)?    !!       !!   autoplay!!!!   hide_controls!!!!	   loop!!!!   hide_fullscreen!!!!   hide_yt_logo!!!!   hide_dm_logo!!!!   hide_dm_share!!    !!       !!   class!!!!	   text!!    !!       !!   class!!!!	   text!!    ;  5  b       5!!      )   _onUpdateVideoOptionC                                                  %  % C  Z             W   QV       
  Q]    _updateVideo!!      .this         +H;       5 !!      %   _onVideoCodeChangeC           	                                      A Y 9 Y C               W   QV       
  Q      _updateVideo!!      .this         +H;       5!!      #   _onVideoCodeInputC           	                                      t  l  C               W   QV       
  Q      _updateVideo!!      .this         +H;       5 !!      !   _getVideoURLDataC "      0                           E                C      
                         Q       
    :     [   C]   =   ]   [      ]      ]      ]      ]      ]      ]	     Q
      
V  	   :   QT 5      =      =     QT 5      =      =     QT 5      =      =     Q   Q  QV  5   E   QV  5   7   H       	  QT 5      =      =     QV  #   V  =   V  5   7   =     QT 5      =      =   	  Q=   V  5   ?7D   Q=   =   V  5   7V  =   V  V  V  V	  W   Q=   W  Q  V  5   E   QV  5   7   3   =   V  5   7=   W   Q=   W  Qf  V  5   E   QV  5   >7   ,   V  5   >7=   W   Q=   W  Q  V  5   E   QV  5   7   ]     QV      
=!   ="   :   Q=#   V  5   7V  V  W   Q=   W  Q  V  5   E   QV  5   7          	  QV  5   7    
=$   =   :   QT 5%      =&      =     QT 5'      =(      =   	  Q=)   V  V  V  V  V	  W   Q=   W  Q   V  5	   E   QV  5	   7        QV  5	   7*   
=+   : >=   V  5	   7,   
>V  5	   7*   
=+   : :    V  5	   7  Q=-   V  W   Q=	   W  Q[
   V  ].   V   ]/     j$ D	  2'@T;3C6#341&	3")*!%603.
*CA%

    match   error7   The provided url is invalid   message   youtube   instagram	   vine   vimeo   dailymotion   youku   _   mapObject   autoplay%   ?autoplay=1&mute=1   ?autoplay=0   hide_controls   &controls=0   	   loop   &loop=1   length   hide_fullscreen   &fs=0   &playlist=   hide_yt_logo#   &modestbranding=1   //www.youtube   .com/embed/   &rel=0-   //www.instagram.com/p/   /embed/   /embed/simple   replace	   mute   muted3   //player.vimeo.com/video/   video/   hide_dm_logo   &ui-logo=0   hide_dm_share#   &sharing-enable=0E   //www.dailymotion.com/embed/video/   indexOf   .html?   substring3   //player.youku.com/embed/	   type   embedURL!!      url   options       !!          embedURL	   type   regexes   matches   autoplay   controls	   loop          !!         fullscreen   ytLoop	   logo       
   !!         vimeoAutoplay          !!         videoId	   logo   share       
   !!         videoId          +H!!   ^(http:\/\/|https:\/\/|\/\/)[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$   !!       !!   error!!!!   message!!    !!  ^(?:(?:https?:)?\/\/)?(?:www\.)?(?:youtu\.be\/|youtube(-nocookie)?\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((?:\w|-){11})(?:\S+)?$    !!K   (.*)instagram.com\/p\/(.[a-zA-Z0-9]*)    !!?   \/\/vine.co\/v\/(.[a-zA-Z0-9]*)    !!o   \/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*    !!   .+dailymotion.com\/(video|hub|embed)\/([^_?]+)[^#]*(#video=([^_&]+))?    !!U   (.*).youku\.com\/(v_show\/id_|embed\/)(.+)    !!       !!   youtube!!!!   instagram!!!!	   vine!!!!   vimeo!!!!   dailymotion!!!!   youku!!    !!       3   _getVideoURLData/matches<d" C Z C Z D           5!!       !!	   type!!!!   embedURL!!    ;       !      P             Y              R                      w                      5!!       !!   template!!!!   events!!!!	   init!!!!   start!!!!	   save!!!!   _clear!!!!!   _createVideoNode!!!!   _updateVideo!!!!)   _onUpdateVideoOption!!!!%   _onVideoCodeChange!!!!#   _onVideoCodeInput!!!!!   _getVideoURLData!!    !!       !!   MediaWidget!!!!+   SearchableMediaWidget!!!!   FileWidget!!!!   ImageWidget!!!!   DocumentWidget!!!!   IconWidget!!!!   VideoWidget!!    ;                     5!!       C         	   ?                                     	    H                T  =    :    QT  =   : W   QT  =   : W  QV   5      QV     
[       ]      ]      ]      ]   : W  QV  H    9 H       web.config   web.core   web.Dialog   _t   extend	   init#   _toggleFullScreen	   save	   open!!      require   config	   core   Dialog   _t!   SummernoteDialog      +H!!       	   initC 7        I                                      *  * H                W   QV   T D   Q[    0    Q  5   5      T C0   QV      
T        
[   [   Z   [   V   5    5   D   Q  =   : ]	   =
   ]   V   5   ]   `    [     =   : ]	   C]   `   ]   V   5    :  QV   =   0   QV      QV      
    QV      
=   V       Q   	   
  t    options   device   isMobile   fullscreen   _super   _   extend   save_text	   Save	   text   btn-primary   classes	   save   click   Discard   close   buttons   cancel   destroyAction   opened   on   closed!!      parent   options	   self   .this      +H!!            !!            !!       !!	   text!!!!   classes!!!!   click!!    !!       !!	   text!!!!   close!!    !!       !!   buttons!!    !!          init/<b       I            5 !!          init/<b   '  ' I           5 ;5!!       #   _toggleFullScreenC  L                                               E  =  I  '            W   Q   5    5   E   QV   5    #         =   :    
  Q *H	    device   isMobile   hasFullScreen   $   #iframe_target[isMobile="true"] #web_editor-top-edit .o_fullscreen   click!!      .this         +H;"       5!!       	   saveC  %                                                   I              W   QV   =    0   QV      
  Q  	   save   destroyAction   close!!      .this         +H;       5!!       	   openC  r                                                 	  I              	W   QW  QV             5   5   5   :    
=   : 0   QV     
  QV  5	   
   
V  V   O  ."    $   window   top   document	   body   hasClassC   o_field_widgetTextHtml_fullscreen   hasFullScreen#   _toggleFullScreen   _super   apply!!      arguments   .this         +H;       5 !!       !!	   init!!!!#   _toggleFullScreen!!!!	   save!!!!	   open!!    ;5 !!       C            8                         	            r  j  L         
       T  =    : W   QT  =   : W  QV   5      QV     
[   =   ]   V  5   5      
Z   =	   `    : ]       ]
      ]   : W  QV  K&9T u     web.core-   wysiwyg.widgets.Dialog   _t   extend'   wysiwyg.widgets.alt   template   prototype   xmlDependencies   concatM   /web_editor/static/src/xml/wysiwyg.xml	   init	   save!!      require	   core   Dialog   _t   AltDialog      +H!!        	   initC y        Q                                      z  z L                W  Q   D   Q[       QV      
T        
[   [     =   : ]      :  QV     
=   [      ]      ]    QV  T 0	   Q   W   QV  
   
   V  5	   :    
=   : D   Q=      
V   =   : 0   Q
   
   V  5	   :    
=   : D8   Q
   
   V  5	   :    
=   : D   Q=   W  QV  V     
V   =   : 0   Q d \!v
     _super   _   extendI   Change media description and tooltip   title   trigger_up   getRecordInfo   recordInfo   callback   media   $	   attr   alt      replace   "	   data   original-title   tag_title!!      parent   options   media   allEscQuots   title   .this      +H!!            !!            !!       !!   title!!    !!           callbackB [  S  L           5 !!       !!   recordInfo!!!!   callback!!    !!   &quot;   ;5!!       	   saveC  7        A                                         L  F            	W  QW  QV      
=   :    
:  W   QV      
=   :    
:  W  Q    W  Q        V  5   :    
=   V   "   V      
V  =   :    @:    
=	   V  "   V     
V  =   :    @ Q        V  5   : 
   
=    QV  V  5   0   QV  5      
V  V  O  M

M@"    $	   #alt   val   #title   media	   attr   alt   replace   &quot;   title   trigger   content_changed   final_data   _super   apply!!      alt   title   allNonEscQuots   arguments   .this         +H!!   "   ;       5!!       !!   template!!!!   xmlDependencies!!!!	   init!!!!	   save!!    ;5 !!       C        '                                           O                        QT  =    :    QT  =   :    QT  =   :    QT  =   : 5      QQT  =   :   QT  =   :    QT  =   :    QV   5      QV  	   
[   =
   ]   [    =   ]   =   ]   =   ]   =   ]   ]   [   =   ]   =   ]   ]      ]      ]      ]      ]      ]      ]      ]    	   ]!   
   ]"      ]#      ]$      ]      ]      ]      ]      ]      ]   :  	  Q   Q 	     0%   Q[    	  ]&   7!9""1.33G,0 m V  2 &           I  }  y   O  Y 	(    web.ajax   web.core   web.session   web.Colorpicker#   ColorpickerWidget   web.WidgetO   web_editor.rte.summernote_custom_colors!   web_editor.utils	   qweb   extendK   web_editor.snippet.option.colorpicker   template'   _onColorButtonClick+   click .o_we_color_btn'   _onColorButtonEnter5   mouseenter .o_we_color_btn'   _onColorButtonLeave5   mouseleave .o_we_color_btn1   _onSwitchPaneButtonClickO   click .o_we_colorpicker_switch_pane_btn   events)   _onColorPickerSelect%   colorpicker_select+   _onColorPickerPreview'   colorpicker_preview   custom_events	   init   willStart   start   getColorNames%   _buildCustomColors   _addCustomColor+   _addCustomColorButton%   _createColorButton   _getButtonInfo   _selectColor%   _markSelectedColor!   loadDependencies%   ColorPaletteWidget!!      require        !!    
   /   colorpickerTemplateProm	   ajax	   core   session#   ColorpickerWidget   Widget-   summernoteCustomColors   weUtils	   qweb%   ColorPaletteWidget          +H!!       !!+   click .o_we_color_btn!!!!5   mouseenter .o_we_color_btn!!!!5   mouseleave .o_we_color_btn!!!!O   click .o_we_colorpicker_switch_pane_btn!!    !!       !!%   colorpicker_select!!!!'   colorpicker_preview!!    !!       	   initC         P                        '          "     O         
       	W   Q   Q   5       
   V   O Q   Z       
Z    >    -
  5   
   m5   _,  ,  :   5    Q)0   Q         
	   5
   : 0   Q         
[    B]   C]   Z    ]   @]         :  ]   B]   T D   Q[   : 0   Q   =   0   Q      5   5   0   Q      5   5   0   Q      
=   [      ]    Q S"+@!"2
  *4$O    _super   apply   concat	   next   value	   done7   summernoteCustomColorsArray   window!   getComputedStyle   document   documentElement   style   _   extend   selectedColor   resetButton   excluded!   excludeSectionOf   $   $editable!   withCombinations   options      trigger_up!   request_editable   callback!!      parent   options   arguments   .this      +H!!       !!   selectedColor!!!!   resetButton!!!!   excluded!!!!!   excludeSectionOf!!!!   $editable!!!!!   withCombinations!!    !!            !!           callbackD#     O  +         5 !!       !!   callback!!    ;   f   !   5 !!         willStartE                                              (     O  g             	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q	  	     
   :          Q    j@!*    _super	   next   value	   done!   loadDependencies!!      .generator   arguments   .this         +H;   K   !            5!!         startE  k     -                                    ( 1  #  O                 	   Q   Q        Q  5       
    O    Q     
=   :    Q       
=   : ,              
=   : :          =   :    Q      
=	   : 
   
=    Q      
    Q      
  5   5        Q  5   5   @        
=     5   5   =   : 
   
=    Q  5      
=   :    
    Q  5   5      
=   :  A           
=   :    Q       
    Qf      Q  Z    >   -
  5   
   m5   _,  ,  :   5    Q0   Q  [   0    Q  5      
=!   :    
    Q  5   5"           5   5"      Q     
   : <       #   
     5$   : D   Q      Q    %   
   :    Q   =&   I.       5       7D   Q   0"   Q  '   
  Q  (   
  Q  5"      Q   E!   Q    )   
   :  /       #   
     5$   :    Q      A  [      ]*   ,  R 0+   Q  5+   ,   
   :         Q           V O (G
.)]"Y"L3O)}@!/  )13' ,-9*    _super   apply   $m   .o_colorpicker_sections[data-color-tab="theme-colors"]   has_template-   web_editor.colorpicker   render   <colorpicker><div class="o_colorpicker_section" data-name="common"></div></colorpicker>	   find   button   addClass   o_we_color_btn   appendTo   _	   each   options   excluded!   excludeSectionOf;   [data-name]:has([data-color="   "])   d-none   el!   querySelectorAll-   .o_colorpicker_section   forEach   includes   common)   [data-name="common"]	   next   value	   done   colorNames#   colorToColorNames%   button[data-color]   selectedColor'   getCSSVariableValue   style#   normalizeCSSColor!   rgba(0, 0, 0, 0)%   _buildCustomColors%   _markSelectedColor   isCSSColor   defaultColor   colorPicker   prependTo!!      .generator   arguments   .this         !!          defaultColor   res   $colorSection   $clpicker/   compatibilityColorNames           !!      '   $commonColorSection            !!         selectedColor           +H!!         start/<d"  $  $ O           5!!         start/<d"  )   )  P  ;          5!!         start/<d"   w   w P    0       	   $div   D" , t , t Q  Y          5 5!!      !!   primary!!   secondary!!   alpha!!	   beta!!   gamma!!   delta!!   epsilon!!   success!!	   info!!   warning!!   danger   !!            !!         start/<d" | 0 | 0 R    @       5 !!       !!   defaultColor!!    ;   *  !         O       6                       [            Q  5 !!         getColorNamesC           	                                      1 L ) L V               W   QV   5          colorNames!!      .this         +H;       5!!      %   _buildCustomColorsC  m        \                        2             h 
 ` 
 V                    Q     5    5      
=   : 
     5      
=   :    
     Q   A  5	   
   
      
  5   : : ,  R    Q     
=   [      ]    Q       
=     5   :    
=   :    
    Q      
  5    5      
=   :     Q  5   %        
     5    Q  * $,?V%  8    9    options   excluded   includes   custom   el!   querySelectorAll   .o_custom_color   forEach   Set7   summernoteCustomColorsArray   concat   Object	   keys#   colorToColorNames   trigger_up#   get_custom_colors   onSuccess'   getCSSVariableValue   custom-colors   style   split       _	   each   $editable	   find!   [style*="color"]   selectedColor   _addCustomColor!!      .this         !!          existingColors            +H!!       )   _buildCustomColors/<d"     W  4          5 !!         onSuccessD#     W              D"     W            5 5!!       !!   onSuccess!!    !!       )   _buildCustomColors/<d"  	 	  	 	 W            5!!      )   _buildCustomColors/<d"  
 s
  
 s
 W  _  0       5 ;      `      3          5!!         _addCustomColorC          <                                    
  
  W  >            W   Q  QT  
             
T :  *            
T V   5   : U Q      
T :   QT     
V  :  +   V      
V   QT     
V   Q T   X%
+&    isCSSColor'   getCSSVariableValue   style#   normalizeCSSColor   has+   _addCustomColorButton   add!!      existingColors   color   .this       !!          normColor          +H;                       B       5 !!      +   _addCustomColorButtonC                                                ,  $  Y        	            QW  QT     QT H   QZ      Q    QV      
=    QV     
=   :   QV     
V   V  :   QV     
V  :   %:'  	   push   o_custom_color   $S   .o_colorpicker_section[data-name="theme"]%   _createColorButton   appendTo!!      color   classes   .this      !!          $themeSection   $button          +H;   0   g                 "       5 !!      %   _createColorButtonC J       	                                            Y                       =   [    =   T    
=   : ]   =   T  =   ]   :  `    $   <button/>   o_we_color_btn 	   join       class#   background-color:   ;   style!!      color   classes        +H!!       !!   class!!!!   style!!    ;       5!!         _getButtonInfoC q                                               W  W Y  F               QT  5    5      Q[    V   #            
V   :    T  5   5   D   Q=   ]   T  ]    P'H    style   backgroundColor#   normalizeCSSColor   dataset   color      target!!      buttonEl        !!          bgColor           +H!!       !!   color!!!!   target!!    ;       p       n                 5!!         _selectColorC n                                   
           m 9 e 9 Y              W   QV   T  V   5    T  5   7D   QT  5   0   0   QV      
T T   QV      
  QV      
  Q \% #   colorToColorNames   color   selectedColor   trigger_up%   _buildCustomColors%   _markSelectedColor!!      colorInfo   eventName   .this       +H;       5!!      %   _markSelectedColorC           "                                     U  M  Y                W   Q  QV   5       
=   :    
     QV   5       
=   V   5   =   V   5   =   :   QV     V  5	   
   
=    Q ,3;9~*    el!   querySelectorAll   button.selected   forEach   querySelector'   button[data-color="   selectedColorI   "], button[style*="background-color:   ;"]   classList   add   selected!!      .this         !!          selectedButton          +H!!       )   _markSelectedColor/<d"     Y  #         5 ;         5!!      '   _onColorButtonClickC N                                                 Y  6            W   Q    QT  5      QV      
V  :   QV      
V  =    Q : 
,    currentTarget   _getButtonInfo   _selectColor   color_picked!!      ev   .this       !!          buttonEl   colorInfo          +H;      G          5!!      '   _onColorButtonEnterC ?                                              <  4  Y              W   QT      
  QV      
=   V      
T  5   :  Q E    stopPropagation   trigger_up   color_hover   _getButtonInfo   currentTarget!!      ev   .this       +H;       5!!      '   _onColorButtonLeaveC I                                                   Y  P            W   QT      
  QV      
=   [    V   5   ]   T  5   ]    Q UL    stopPropagation   trigger_up   color_leave   selectedColor   color   target!!      ev   .this       +H!!       !!   color!!!!   target!!    ;       5!!      +   _onColorPickerPreviewC E                                             ?  7  Y              W   QV       
=   [    T  5   5   ]   V   5   5   ]    Q T    trigger_up   color_hover	   data   cssColor   color   colorPicker   el   target!!      ev   .this       +H!!       !!   color!!!!   target!!    ;       5!!      )   _onColorPickerSelectC E                                                 Y  N            W   QV       
[    T  5   5   ]   V   5   5   ]   =    Q S^    _selectColor	   data   cssColor   color   colorPicker   el   target'   custom_color_picked!!      ev   .this       +H!!       !!   color!!!!   target!!    ;       5 !!      1   _onSwitchPaneButtonClick@       
                                        4 |  | Y                W   Q       
  QV   5      
=   :    
     Q   5   5      
=    QV   5      
=	   :    
    Q >.)4d    stopPropagation   el!   querySelectorAllC   .o_we_colorpicker_switch_pane_btn   forEach   currentTarget   classList   add   active/   .o_colorpicker_sections!!      ev   .this      +H!!       5   _onSwitchPaneButtonClick/<d"     Y  +         5 !!       5   _onSwitchPaneButtonClick/<d"  y  y Y           5 ;5!!       !!   template!!!!   events!!!!   custom_events!!!!	   init!!!!   willStart!!!!   start!!!!   getColorNames!!!!%   _buildCustomColors!!!!   _addCustomColor!!!!+   _addCustomColorButton!!!!%   _createColorButton!!!!   _getButtonInfo!!!!   _selectColor!!!!%   _markSelectedColor!!!!'   _onColorButtonClick!!!!'   _onColorButtonEnter!!!!'   _onColorButtonLeave!!!!+   _onColorPickerPreview!!!!)   _onColorPickerSelect!!!!1   _onSwitchPaneButtonClick!!    !!      G   ColorPaletteWidget.loadDependenciese  !         F                                      Y                         QZ           
=       : `       Q    5            E   Q     
=   :  ]        
[    =   ]   =   ]	   Z   =   `    ]
   :    
   :     Q      
     Q      
   :        	t Y 	{>-,a    loadXMLO   /web_editor/static/src/xml/snippets.xml   is_website_user   has_template-   web_editor.colorpicker	   _rpc   ir.ui.view   model   read_template   method	   args	   then	   push   Promise   all!!      rpcCapableObj   .generator       !!          proms            +H!!       !!   model!!!!   method!!!!	   args!!    !!       y   ColorPaletteWidget.loadDependencies/colorpickerTemplateProm<d"  [  [ Y  
         5 ;                        5!!       !!%   ColorPaletteWidget!!    ;                     5!!       C  [         q                                     ' w ' ^                        QT  =    :    QT  =   :    QT  =   : 5      Q5      Q5      Q5      Q5      QQ   5      QV   	   
[   Z   =
   `    ]   Z   =   `    ]   [    =   ]   =   ]   ]      ]      ]      ]      ]      ]      ]      ]      ]   	   ]   
   ]   :   QV  ?O-
*8  aX yYG| ^ 1 c     web.core   web.Widget7   web_editor.image_processing%   applyModifications#   cropperDataFields   activateCropper   loadImage   loadImageInfo   _t   extend)   wysiwyg.widgets.crop   templateM   /web_editor/static/src/xml/wysiwyg.xml   xmlDependencies%   _onCropOptionClickA   click.crop_options [data-action]   _onCropZoom	   zoom   events	   init   willStart   start   destroy   _save%   _getAttributeValue   _resetCropBox)   _onDocumentMousedown!!      require        !!    	   	   core   Widget%   applyModifications#   cropperDataFields   activateCropper   loadImage   loadImageInfo   _t   ImageCropWidget           +H!!       !!A   click.crop_options [data-action]!!!!	   zoom!!    !!      	   init@      !   k                                 A > = > ^              	W   QW  Q    QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  T 0   QV        T : 0   QV  T 5   0   QV  [   [          =	   : ]
   >]   ]   [   =   ]
   <    ]   ]   [   =   ]
   <   ]   ]   [   =   ]
   ?]   ]   [   =   ]
   <   ]   ]   0   QV  5      
=   :   Q      
[   T 5   :   QV  V  0   QV  V  5   D   Q=   0   QV  V  5   D   QV     
=   :    =      =    0   Q @!	"		% ).    _super	   next   value	   done   media   $   $media   ownerDocument   document	   Free   label   0/0	   16:9	   16/9   4:3   4/3   1:1   1/1   2:3   2/3   aspectRatios   getAttribute   src   Object   assign   dataset   initialSrc   aspectRatio   mimetype   endsWith	   .png   image/png   image/jpeg!!qq?!!UUUUUU?!!UUUUUU?!!      parent   media   arguments   .this       !!          src	   data          +H!!       !!   label!!!!   value!!    !!       !!   label!!!!   value!!    !!       !!   label!!!!   value!!    !!       !!   label!!!!   value!!    !!       !!   label!!!!   value!!    !!       !!   0/0!!!!	   16/9!!!!   4/3!!!!   1/1!!!!   2/3!!    !!            ;   E   !                  5 !!         willStart@       	   7                         "           ( N O ? O ^               	   Q   Q      Q   5       
      O          Q       5      5      
   : :          Q   5   5   5   L         5   5   5   0   Q      5   5   5   0   Q      C0   Q    ^ "/#0.    _super   apply   media	   _rpc	   bind   dataset   originalSrc   originalId   uncroppable!!      .generator   arguments   .this         +H;   I      5 !!         start@  G     ,                                    ( [   P   _  #              	   Q   Q        Q  5    g        
[    =   ]       =   : ]     =   : ]    Q     
:       5	   
   
  :    Q     
=   :    Q      5     5   :         Q       
=   : 0   Q  5   >7   QZ     5      
:  =   `      5      
:  =   `   -
  5   
B   5   Q,  ,  :   5      Q   5   0   Q   5      C0   ,  ,  :   5      Q   5   0   Q   QQ1   
Q   IE
   Q@I   
:     QQQ  5      
:     Q   5           5      
=   : : 0   Q   5           5      
=    : : 0   Q      
    Q    5      :         Q         5!     5"   75     5   5#   :         Q    5$   %   
=&    Q    5'   
   
  : 0'   Q  5(   )   
=*     5'   [   C]+    Q   Z    >  -
  5   
   m5   _,  ,  :   5    Q)      % _&&   _ '"#6p*+)['%FU@!    uncroppable'   displayNotification   warning	   type?   This image is an external image   title-  This type of image is not supported for cropping.<br/>If you want to crop it, please first download it from the original source and upload it in Odoo.   message   destroy   _super	   bind   $+   .o_we_cropper_wrapper   originalSrc   media#   .o_we_cropper_img   $cropperImage   $media   width   px   height	   next   style	   done   value   return   offset	   left   parseInt   css   padding-left   top   padding-right   aspectRatios   aspectRatio   dataset   bus   trigger%   deactivate_snippet)   _onDocumentMousedown   document!   addEventListener   mousedown   capture!!      .generator   arguments   .this         !!          _super   $cropperWrapper   cropperImage   offset            +H!!       !!	   type!!!!   title!!!!   message!!    !!       !!   capture!!    ;     
                
              
  !         +                    7                 j  5!!         destroy@           (                                      !   ! `  h     
       	W   QW  QV  5    L   V  5       
=    QV  5      
=   V  5   [    C]    QV  5   	   
=
   V  5    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) k&I/@!    $cropperImage   cropper   destroy   document'   removeEventListener   mousedown)   _onDocumentMousedown   capture   media   setAttribute   src   initialSrc   _super	   next   value	   done!!      arguments   .this         +H!!       !!   capture!!    ;      !   #       5!!         _save@          '                                   ! Z# ! Z# a                    Q      Q   5    5      
=    QZ   >    -
  5   
   m5   _,  ,  :   5    =   _Q   
     Q   5    5	   .
   Q          5    :          0   Q   5      
=    Q      
  Q   `5@!  &%    media   classList   add1   o_modified_image_to_save	   next   value	   done   aspectRatio   forEach   dataset   resizeWidth   initialSrc   $media   trigger   image_cropped   destroy!!      .generator   .this         +H!!           _save/<d" L" " L" " a             5 ;   \   !         5 !!      %   _getAttributeValue@ K                                              m# # [# # a              W   Q          
T  : #   V   5      
=   : T  7V   T  7 "    includes   $cropperImage   cropper   getData!!   	   attr   .this       +H;"       5 !!         _resetCropBox@  9         	                                      # :$ # :$ b  !             W   QV   5       
=    QV   5       
=    Q$$#    $cropperImage   cropper   clear	   crop!!      .this         +H;       5 !!      %   _onCropOptionClick@         g                         "           M$ & ;$ & b        
       W   Q      QT  5    5   5     Q5     Q5     QQV  x=   HyY   =   Hy   =   Hy   =   Hy   =	   Hy   =
   Hy  =   Hy  z&  V   5      
=    QV   V  0   QV   5      
=   V   5   V   5   75    Q   V   5      
V  V   Q   V   5      
V  V   QV      
  Qu     QV   5      
=   : V  7  QV   5      
V  V  : V      
:  V      
:    7t xxxxxxx $W`)`)`9E2    currentTarget   dataset   action   value   scaleDirection   ratio	   zoom   reset   rotate	   flip   apply   discard   $cropperImage   cropper   aspectRatio   setAspectRatio   aspectRatios   _resetCropBox   getData   _save   destroy!!      ev   .this       !!          action   value   scaleDirection          !!         amount          +H;           [  K                                                        2       5 !!      )   _onDocumentMousedown@ ^                                              & !' & !' c  [             W   Q    5      
T  5   : E$   QV      
T  5   :    >H   V      
:  `#    document	   body   contains   target   $   length   destroy!!      ev   .this       +H;"       5 !!         _onCropZoom@  S                                             3' v' "' v' c                    Q      Q    A    ,  R          Q      
  Q     $    Promise   _resetCropBox!!      .generator   .this         +H!!          _onCropZoom/<d" H' ^' H' ^' c            5;   7   5!!       !!   template!!!!   xmlDependencies!!!!   events!!!!	   init!!!!   willStart!!!!   start!!!!   destroy!!!!   _save!!!!%   _getAttributeValue!!!!   _resetCropBox!!!!%   _onCropOptionClick!!!!)   _onDocumentMousedown!!!!   _onCropZoom!!    ;      U      X         5 !!       C                                                5( SE -( SE f                T  =    : W   QT  =   : W  Q   5   5   5      Q   5   5   5      QV   5      QV     
[   =	   ]
   V  5   5   D   QZ       
Z   =   `    : ]         
[    V  5   5   D   Q[   [   =   ]   =   ]   =   ]   =   ]   : ]      ]      ]      ]      ]      ]      ]   	   ]   
   ]      ]   : W  QV  L&" ?303u   q ~l   |    /* f   |     web.core-   wysiwyg.widgets.Dialog   $   summernote	   core   dom   range   _t   extend)   wysiwyg.widgets.link   template   prototype   xmlDependencies   concatM   /web_editor/static/src/xml/wysiwyg.xml   _   events   _onAnyChange   input   _onTypeChangeA   change [name="link_style_color"]   change   _onURLInput/   input input[name="url"]	   init   start	   save   _adaptPreview   _getData!   _updateOptionsUI!!      require	   core   Dialog   dom   range   _t   LinkDialog      +H!!            !!            !!       !!   input!!!!A   change [name="link_style_color"]!!!!   change!!!!/   input input[name="url"]!!    !!       	   initC 	     E                                     W* 4 O* 4 f                   Q   T D   Q[    0    Q      
T        
[     =   : ]      5    :  Q      
=   [      5    ]      ]	    Q   Z   [   =
   ]     =   : ]   =   ]   `    [   =   ]     =   : ]   =   ]   `   [   =   ]     =   : ]   =   ]   `   0   Q   T 0   Q   T D   Q[   0   Q   5   =
   0   Q   5   =
   0   Q   5   5   W   Q   V    D4   QV   5   V   5   HE   QV   5   V   5   H0   Q   5   5   1      Q         5   5   5   :     
=!   :   Q   5   V  "   
=#   : D   Q=
   0   Q   B0$   QV    Q   m    QV  "   
=#   : D   Q=
     QV  %   
   :   QV        V  >70$   QF   V  &   
:  W  QV  '   E   QV  (   
=)   :  [   5      5   5   *   
	   =+   : 0   Q   5   5   ,   
:  W  QV   5   W  QV   5   W  QV   5   W  QV   5   W  QV     V  5-   H     .   
V     V  5/   V  7
   V  : W  Q>W  Q{   V  V  50   '   Ib   V  V  H4   V  1   
V  : W  W  QV  V  W  Q   V  1   
V  : W  Q>W  QV  5-   W     2   
V     V  5/   V  ?7
   V  : W  QV  50   '   W  Q2   V  V  50   '   I   V  1   
V   Q  3   
V  V  : W  Q  4   
V  : D   Q  5   
V  : 3     6   
V  : '   ?W  QV  57   W  Q  8   
V  : 8     6   
V  : '   ?W  QV  57   W  Qe     4   
V  : D   Q  5   
V  : 1     6   
V  : '   W  QV  57   W  Q   5     9   
V  V  V  V  : 0   Q      T :    
=      5   5    Q   5   5   :   
  Q-     ;   
V    5<   : 5/   W  Q  5   
V  : E   QV  =   
V  : H   V  >   
V   QV  '   ?D&   Q  ;   
V  >7  55   :   =
   W  Q   5   Z    0?   Q>W  Q h  m  ;   
V  V  7  55   : V      5   5?   >   
  ;   
V  V  7  55   :  QV  =@   W  Q   V   E   QV  V  75A   ?H      V   E   QV  >H6   V  V  V  750   B   
V  C   : W  Qn   V   E   QV  V  '   ?H2   V  V  V  750   B   
>V  : W  Q   V  V  V  750   W  QV  #W  QQV  V  '      5   V  0D   Q   5      5   5D   *   

   =+   : 0D   Q   W	  Q   W
  Q   5      5   5   *   
V	  =+   : *   
V
  =+   : 0   Q vB!x%(  3
" Q f NF!
()&& h Z x"8'.6-8    options   _super   _   extend   Link to   title   trigger_up   getRecordInfo   recordInfo   callback   	   type	   Link   label	   link   btnPreview   primary   Primary   secondary   Secondary   colorsData   editable	   data   className   iniClassName   range   sc   ec   so   eo   needLabel   $   filter   a	   attr   class+   colorCombinationClass   match   parent   length   is	   body   replace       isOnAnchor   tagName   firstChild   childNodes   textContent   splitText   lastChild   listBetween   isVoid   isImg   listPrev   parentNode	   isBR   create   select   ancestor   isAnchor   indexOf	   push   images   [IMG]   nodeType   slice   Infinity	   text!!      parent   options   editable   linkInfo   r   is_link   sc   so   ec   eo   nodes	   text   i'   allBtnClassSuffixes   allBtnShapes   .this      !!          $node   $link         !!         className   m          +H!!            !!       !!   title!!    !!          callbackD# + I+ + I+ f           5 !!       !!   recordInfo!!!!   callback!!    !!       !!	   type!!!!   label!!!!   btnPreview!!    !!       !!	   type!!!!   label!!!!   btnPreview!!    !!       !!	   type!!!!   label!!!!   btnPreview!!    !!            !!   \b(o_cc\d+)\b   !!3   (^|\s+)btn(-[a-z0-9_-]*)?   !!   [ \t\r\n]+   !!3   (^|\s+)btn(-[a-z0-9_-]*)?   !!7   \s*(rounded-circle|flat)\s*   ;               x       +       }                  5 !!          startC          L                         >             4 8 4 8 q                	W  Q   Q      5       
=   : 0   Q         
=   : 0   Q   5      
=   B: 	   
=
   :    
=   C Q   5   5   0         
      
=   :      Q   5   5   ~         
   5   5   : W   Q      
=   :    
V      V   ?7      5   5    Q      
  Q      
  Q      
  Q      
=   :    
  Q   5      
   V  O  =(""    el   querySelectorG   #o_link_dialog_button_opts_collapse)   buttonOptsCollapseEl   $!   input.link-style   $styleInputs	   prop   checked   filter   [value=""]	   data   iniClassName   _	   each   input[name="link_style_color"], select[name="link_style_size"] > option, select[name="link_style_shape"] > option   url	   exec#   input[name="url"]   val   _onURLInput!   _updateOptionsUI   _adaptPreview'   input:visible:first   focus   _super   apply!!      match   arguments   .this        +H!!           start/<d" X6 7 X6 7 q    @       5 !!   mailto:(.+)    ;5 !!       	   saveC          a                         %            8 ; 8 ; s               	W  QW  QV      
:  W   QV   @H~   V     
=   : W  QV     
=   :    
=   :    
=   :    
=	    QV  
   
  Q      
:  V  5   V   5   0   QV  5   V   5   0   Q    W  Q   W  Q   W  QV  5   V   5      
V  =   :    
V  =   : 0   QV   5      
V  =   : .   V  5   [   =   ]   =   ]   0   QV  5   V   5   0   QV  V  5   0   QV  5      
V  V  O   &j t&f( ''"    _getData   $#   input[name="url"]   closest   .form-group   addClass   o_has_error	   find;   .form-control, .custom-select   is-invalid   focus   Promise   reject	   data   label	   text   url   classes   replace          className!   background-color   color   style   isNewWindow   final_data   _super   apply!!   	   data	   $url   allWhitespace'   allStartAndEndSpace   allBtnTypes   arguments   .this         +H!!   \s+   !!   ^\s+|\s+$   !!   (^|[ ])(btn-secondary|btn-success|btn-primary|btn-info|btn-warning|btn-danger)([ ]|$)   !!       !!!   background-color!!!!   color!!    ;3       5 !!          _adaptPreviewC  3        7                                    ; = ; = u               W  Q  QV      
:  W   QV   @H
   [   V   5      =      =   ]   V   5   E   QV   5         V   5      =   ]   V   5	   
   
    =   : =   ]     QV     
=   :    
V  :    
V   5   E   QV   5         V   5      V   5    Q    
$,	8:    _getData   isNewWindow   _blank      target   url   length   #	   href   classes   replace    o_btn_preview   class   $   #link-preview	   attr	   html   label!!   	   data   .this         !!          attrs          +H!!   float-\w+    !!       !!   target!!!!	   href!!!!   class!!    ;      ,      .          "       5 !!          _getDataC       -                          O            *= ~B "= ~B v              W  Q  	  
          QV      
=   : W   QV      
:  W  QV      
=   :    
:  D   QV  W  QV  E   QV  5   5      >W  Q l   mV     
=   =   :    
=	   =
   :    
    V  5   5   V  75   : W  QV  #W  QQV  V  5   5      V      
=   : E$   QV   D   QV   >7   
:   
   @V      
=   :    
:  D   Q=     QV      
=   :    
:  D   Q=   	  QV      
=   :    
:  D   Q=   
  QV
     V
     
=   :    Z      QZ   =   `    =   `      
V  >7:    V  >7=      =     QV     
V     ?   >:    
=   :   QV  5   5   D   Q=   V     =   V  V     =   V     =   V     =   V	     =   V	     =     QV      
=    :    
=!   : W  QV  "   
=#   : >E7   QV  "   
=$   : >E   QV  %   
   :     =$   V  W  Qr   V  "   
&   5'   : >HE)   QV      
=(   :    
=!   : (   V     
&   5'      : W  Q   W  Q   W  Q[   V  ])   V  ]*   V     
V  =   :    
V  =   : ]+   V  ],      &l^  #	 |   x1)*
&"*"#     $#   input[name="url"]   val'   input[name="label"]	   data   images   replace   <	   &lt;   >	   &gt;   outerHTML   length	   prop   required   checkValidityM   input[name="link_style_color"]:checked   =   select[name="link_style_size"]?   select[name="link_style_shape"]   split   ,   outline	   fill   includes   -   slice	   join       className    btn btn-    btn-7   input[name="is_new_window"]   checked   indexOf   @   mailto:   match   location   origin?   #o_link_dialog_url_strip_domain   label   url   classes   isNewWindow!!   	   $url   url   label   i   isNewWindow   allWhitespace'   allStartAndEndSpace   .this         !!       	   type	   size   shape   shapes   style   shapeClasses   classes          +H!!   \[IMG\]    !!   ^http[s]?   !!   \s+   !!   ^\s+|\s+$   !!       !!   label!!!!   url!!!!   classes!!!!   isNewWindow!!    ;                      q                      b       5!!       !   _updateOptionsUIC  x      	                            	            B "C B "C |               W   Q  QV   5       
=   :   Q      V   5   :    
V  E   QV  5      =      =    Q  ;%    el   querySelectorC   [name="link_style_color"]:checked   $)   buttonOptsCollapseEl   collapse   value	   show	   hide!!      .this         !!          el          +H;      q          5 !!          _onAnyChangeC           	                                      8C QC 0C QC |  {            W   QV       
  Q ~    _adaptPreview!!      .this         +H;       5 !!          _onTypeChange@           	                                      _C {C RC {C |              W   QV       
  Q  !   _updateOptionsUI!!      .this         +H;       5 !!          _onURLInputC          =                                     C <E C <E |       
       W  Q    QV      
=   : W   QV      
=   :    
=   :    
=   :    
=    QV   	   
:    QV  
   
=   : >  QV      
=   :    
=   :    
=   V    QV      
=   :    
=   V  
   
   5   5   : >I Q #%&&,/@    $1   #o_link_dialog_url_input   closest   .form-group   removeClass   o_has_error	   find;   .form-control, .custom-select   is-invalid   val   indexOf   @7   input[name="is_new_window"]   toggleClass   d-none   .o_strip_domain   window   location   origin!!      $linkUrlInput   .this         !!          value   isLink         +H;      
         5 !!       !!   template!!!!   xmlDependencies!!!!   events!!!!	   init!!!!   start!!!!	   save!!!!   _adaptPreview!!!!   _getData!!!!!   _updateOptionsUI!!!!   _onAnyChange!!!!   _onTypeChange!!!!   _onURLInput!!    ;5 !!       C        #                                        E U E U                 T  =    : W   QT  =   :    QT  =   : W  QV   5      QV     
[   =   ]   V  5   5      
Z   =	   `    : ]   
      
[    V  5   5   [   =   ]   =   ]   =   ]   =   ]   : ]   
      
[   V  5   5   D   Q[   [   =   ]   =   ]   =   ]   : ]      ]      ]      ]      ]   	   ]   
   ]       ]!      ]"      ]      ]      ]      ]      ]      ]      ]   : W  QV  M%&!9T,391>  >,   bMEGG    G?AA=?         web.core+   wysiwyg.widgets.media-   wysiwyg.widgets.Dialog   _t   extend   template   prototype   xmlDependencies   concatM   /web_editor/static/src/xml/wysiwyg.xml   _   events!   _onClickImageTab;   click #editor-media-image-tab'   _onClickDocumentTabA   click #editor-media-document-tab   _onClickIconTab9   click #editor-media-icon-tab!   _onClickVideoTab;   click #editor-media-video-tab   custom_events   _onSaveRequest   save_request   _onShowRequest5   show_parent_dialog_request   _onHideRequest5   hide_parent_dialog_request	   init   start!   isDocumentActive   isIconActive   isImageActive   isVideoActive	   save   _clearWidgets!!      require	   core   MediaModules   Dialog   _t   MediaDialog      +H!!            !!       !!;   click #editor-media-image-tab!!!!A   click #editor-media-document-tab!!!!9   click #editor-media-icon-tab!!!!;   click #editor-media-video-tab!!    !!            !!            !!       !!   save_request!!!!5   show_parent_dialog_request!!!!5   hide_parent_dialog_request!!    !!        	   initC      (                            V            I N H N                 W  Q        T : W   QV   >7U Q      
[       :    Q   5   Dn   QV  5   D^   QT ET   QV      
:     
=   : =   HD*   QV      
:     
=	   : =   HW  Q   V  D   Q   5
   0
   Q   V  D   Q   5   0   Q   V  D   Q   5   0   QV     
T        
[   [     =   : ]     =   : ]      :  QV     
=   [      ]   =   ]      ]    Q   5    .   V    5   AV  T    ,  R 0   Q   5
    .   V    5   AV  T    ,  R 0   Q   5    .   V    5   AV  T    ,  R 0   Q   5    .   V    5   AV  T    ,  R 0    QV  5   E   QV   !   
="   :    V  V  5   0#   Q&  V  5   E   QV   !   
=$   :    V  V  5   0#   Q   V  5    E   QV   !   
=%   :    V  V  5    0#   Q   V  5   E   QV   !   
=&   :    V  V  5   0#   Q]   V  Z   V  5   `    V  5   `   V  5    `   V  5   `   '   
   : 0#   Q V	:4,. 
[!  ),6)(    $   _   extend   onlyImages   multiImages   parent	   data   oeField   image   oeType   noDocuments   noIcons   noVideos   _super   Select a Media   title   Add   save_text   trigger_up   getRecordInfo   recordInfo   media	   type   callback   noImages   ImageWidget   imageWidget   DocumentWidget   documentWidget   IconWidget   iconWidget   VideoWidget   videoWidget   is   img   activeWidget   a.o_imageO   .media_iframe_video, .o_bg_video_iframe   span, i	   find!!      parent   options   media   $media   onlyImages   .this      +H!!            !!            !!       !!   title!!!!   save_text!!    !!          callbackB (K UK  K UK   b         5 !!       !!   recordInfo!!!!	   type!!!!   callback!!    !!       /   init/this.activeWidget<d" N N N N            5;5!!          startC          a                         =             N Q N Q          	       	W  Q   QZ      5       
   V  O `    W   Q   5      
=   :    
=    Q   5   =   V      
   5   	   
   
   
=   : :  Q   5   =   V      
   5   	   
   
   
=   : :  Q   5   =   V      
   5   	   
   
   
=   : :  Q   5   =   V      
   5   	   
   
   
=   : :  Q      
     Q      
V   :  
#""(+'(C    _super   apply   $modal	   find   .modal-dialog   addClass+   o_select_media_dialog   imageWidget	   push   appendTo   $'   #editor-media-image   documentWidget-   #editor-media-document   iconWidget%   #editor-media-icon   videoWidget'   #editor-media-video   opened   Promise   all!!      promises   arguments   .this        +H!!          start/<d"  P P P P             5;5!!       !   isDocumentActiveC                                                 &Q YQ Q YQ   {             W   QV   5    V   5   H~/    activeWidget   documentWidget!!      .this         +H;       5!!          isIconActiveC           	                                      oQ Q gQ Q                W   QV   5    V   5   H  +    activeWidget   iconWidget!!      .this         +H;       5 !!          isImageActiveC           	                                      Q Q Q Q   
            W   QV   5    V   5   H ,    activeWidget   imageWidget!!      .this         +H;       5 !!          isVideoActiveC           	                                      Q ,R Q ,R   Q            W   QV   5    V   5   H T,    activeWidget   videoWidget!!      .this         +H;       5 !!       	   saveC  S                                               :R S 2R S                 	W   QW  QV     QV  5       QV      QV  5      
:     
    :  |    _super   activeWidget	   save	   then!!   	   self   _super	   args   arguments   .this        +H!!          save/<b R S R S            5 ;5!!          _clearWidgetsC  Z                                  
             )S S !S S                     QZ      5    `       5   `      5   `      5   `      
     Q M    imageWidget   documentWidget   iconWidget   videoWidget   forEach!!      .this         +H!!          _clearWidgets/<d" |S S |S S             5 ;5!!       '   _onClickDocumentTabC           	                                      S 	T S 	T   4            W   QV   V   5    0   Q 7&    documentWidget   activeWidget!!      .this         +H;       5 !!          _onClickIconTabC           	                                      "T HT T HT   w            W   QV   V   5    0   Q z"    iconWidget   activeWidget!!      .this         +H;       5 !!       !   _onClickImageTabC           	                                      bT T ZT T               W   QV   V   5    0   Q #    imageWidget   activeWidget!!      .this         +H;       5 !!       !   _onClickVideoTabC           	                                      T T T T               W   QV   V   5    0   Q #    videoWidget   activeWidget!!      .this         +H;       5 !!          _onHideRequestC           	                                     T U T U   7            W   QV   5       
=    Q <    $modal   addClass   d-none!!      ev   .this       +H;       5 !!          _onSaveRequestC $                                              U FU U FU   t            W   QT      
  QV      
  Q y    stopPropagation	   save!!      ev   .this       +H;       5 !!          _onShowRequestC           	                                     ^U U VU U               W   QV   5       
=    Q "    $modal   removeClass   d-none!!      ev   .this       +H;       5!!       !!   template!!!!   xmlDependencies!!!!   events!!!!   custom_events!!!!	   init!!!!   start!!!!!   isDocumentActive!!!!   isIconActive!!!!   isImageActive!!!!   isVideoActive!!!!	   save!!!!   _clearWidgets!!!!'   _onClickDocumentTab!!!!   _onClickIconTab!!!!!   _onClickImageTab!!!!!   _onClickVideoTab!!!!   _onHideRequest!!!!   _onSaveRequest!!!!   _onShowRequest!!    ;5!!       C  '         X                                    2V 9Y *V 9Y   &      
         QT  =    : W   QT  =   : W  QT  =   : W  QT  =   : W  QT  =   : W  QT  =   : 5     QQT  =   : W  Q[    V   ]   V  ]	   V  ]
   V  ]   V  ]   V  ]   V  5   ]   V  5   ]   V  5   ]   V  5   ]   V  5   ]   V  5   ]   V  5   ]   /&
)+*0! $2$  -   wysiwyg.widgets.Dialog3   wysiwyg.widgets.AltDialog7   wysiwyg.widgets.MediaDialog5   wysiwyg.widgets.LinkDialog?   wysiwyg.widgets.ImageCropWidget   web.Colorpicker#   ColorpickerDialog+   wysiwyg.widgets.media   Dialog   AltDialog   MediaDialog   LinkDialog   ImageCropWidget   MediaWidget+   SearchableMediaWidget   FileWidget   ImageWidget   DocumentWidget   IconWidget   VideoWidget!!      require   Dialog   AltDialog   MediaDialog   LinkDialog   ImageCropWidget   media       !!       #   ColorpickerDialog          +H!!       !!   Dialog!!!!   AltDialog!!!!   MediaDialog!!!!   LinkDialog!!!!   ImageCropWidget!!!!#   ColorpickerDialog!!!!   MediaWidget!!!!+   SearchableMediaWidget!!!!   FileWidget!!!!   ImageWidget!!!!   DocumentWidget!!!!   IconWidget!!!!   VideoWidget!!    ;       &      $               5 !!       C                 j                             Y   Y                      T  =    :   QT  =   :   QT  =   :   QT  =   :   QT  =   : W   QT  =   :   QT  =   :   QT  =   : 5      QQT  =	   :    QT  =
   : 5      QQ  5     Q[       ]      ]      ]   	  QV      
[&   =   ]   Z   =   `    ]   [   =   ]   =   ]   ]   [   =   ]   =   ]   =   ]   =    ]!   ]"      ]#      ]$      ]%   	   ]&   
   ]'      ](      ])      ]*      ]+      ],      ]-      ].      ]/      ]0      ]1      ]2      ]3      ]4      ]5      ]6      ]7      ]8      ]9      ]:      ];      ]<       ]   !   ]   "   ]   #   ]    $   ]   %   ]   : 
  QV      
[h   ==   ]>   ['   ]?   [(   =@   ]A   =B   ]C   =D   ]E   =F   ]G   =H   ]I   =J   ]K   =L   ]M   =N   ]O   ]   [)   =P   ]Q   =R   ]S   =T   ]U   =V   ]W   =X   ]Y   =Z   ][   =9   ]\   =]   ]^   =_   ]`   =a   ]b   =c   ]d   =e   ]f   =g   ]h   =i   ]j   =    ]!   =k   ]l   =m   ]n   =o   ]p   =q   ]r   =s   ]t   =u   ]v   =w   ]x   =y   ]z   ={   ]|   =}   ]~   ]"   [*   =   ]   =   ]   ]   +   ]#   ,   ]   -   ]$   .   ]%   /   ](   0   ]   1   ]   2   ]   3   ]   4   ]   5   ]   6   ]   7   ]   8   ]   9   ]   :   ]   ;   ]   <   ]   =   ]   >   ]m   ?   ]   @   ]   A   ]   B   ]   C   ]   D   ]   E   ]   F   ]   G   ]   H   ]P   I   ]R   J   ]T   K   ]X   L   ]V   M   ]Z   N   ]9   O   ]_   P   ]s   Q   ]@   R   ]D   S   ]B   T   ]F   U   ]H   V   ]]   W   ]}   X   ]u   Y   ]w   Z   ]a   [   ]o   \   ]c   ]   ]e   ^   ]i   _   ]g   `   ]    a   ]k   b   ]N   c   ]q   d   ]y   e   ]{   f   ]J   g   ]L   : W  Q[i   V  ]   
  ]   	  ]   9+#)@ &+,"81H      *  L _PM  6    ~  B  APru   >h    q  ,27:?DW7(;"(,*/$57&$F@9 9 37887 h  $| O     1   M S     6V   ^ P9 0     E {xk[  ?scb     @ 3  yGJ  /W  ;]#      cQ:         web.concurrency   web.core   web.Dialog   web.dom   web.Widget7   web_editor.snippets.options%   web_editor.wysiwyg/   web_editor.ColorPalette%   ColorPaletteWidget_   web/static/src/js/core/smooth_scroll_on_drag.js!   web_editor.utils'   getCSSVariableValue   _t   closest   all   is   extend5   web_editor.snippet_overlay   templateO   /web_editor/static/src/xml/snippets.xml   xmlDependencies   _onRemoveClick1   click .oe_snippet_remove   _onMouseWheel   wheel   events   _onOptionUpdate   option_update3   _onUserValueWidgetRequest3   user_value_widget_request-   _onSnippetOptionUpdate+   snippet_option_updateA   _onSnippetOptionVisibilityUpdateA   snippet_option_visibility_update   custom_events	   init   start   destroy   areOptionsShown   buildSnippet   cleanForSave   closeWidgets   cover   getName   isShown   isSticky   isTargetVisible   removeSnippet   toggleOverlay   toggleOptions-   toggleTargetVisibility/   toggleOverlayVisibility   clone%   _initializeOptions/   _toggleVisibilityStatus   _onCloneClick'   _onDragAndDropStart%   _onDragAndDropStop7   _onOptionsSectionMouseEnter7   _onOptionsSectionMouseLeave-   _onOptionsSectionClick   oe_snippets   id)   cacheSnippetTemplate%   _onInstallBtnClick)   click .o_install_btn#   _onBlocksTabClick7   click .o_we_add_snippet_btn-   _onInvisibleEntryClick7   click .o_we_invisible_entry#   _onDeleteBtnClickG   click #snippet_custom .o_delete_btn   _onMouseDown   mousedown+   _onSnippetSearchInputI   input .o_snippet_search_filter_input5   _onSnippetSearchResetClickI   click .o_snippet_search_filter_reset1   _onSummernoteToolsUpdateo   summernote_popover_update_call .o_we_snippet_text_tools3   _onActivateInsertionZones1   activate_insertion_zones%   _onActivateSnippet!   activate_snippet5   _onCallForEachChildSnippet7   call_for_each_child_snippet   _onCloneSnippet   clone_snippet-   _onOverlaysCoverUpdate   cover_update)   _onDeactivateSnippet%   deactivate_snippet%   drag_and_drop_stop+   _onGetSnippetVersions)   get_snippet_versions   _onGoToParent   go_to_parent!   _onRemoveSnippet   remove_snippet1   _onSnippetEditionRequest/   snippet_edition_request3   _onSnippetEditorDestroyed1   snippet_editor_destroyed#   _onSnippetRemoved   snippet_removed!   _onSnippetCloned   snippet_cloned;   _onSnippetThumbnailURLRequest;   snippet_thumbnail_url_request7   _disableUndroppableSnippets1   reload_snippet_dropzones   _onSaveRequest   request_save5   _onUpdateCustomizeElements3   update_customize_elements   _onHideOverlay   hide_overlay/   _onBlockPreviewOverlays-   block_preview_overlays3   _onUnblockPreviewOverlays1   unblock_preview_overlays3   _onUserValueWidgetOpening3   user_value_widget_opening3   _onUserValueWidgetClosing3   user_value_widget_closing1   _onReloadSnippetTemplate/   reload_snippet_template   blocks   BLOCKS   options   OPTIONS	   tabs   willStart   loadSnippets/   setSelectorEditableArea   getEditableAreaC   updateCurrentSnippetEditorOverlay/   _activateInsertionZones'   _updateInvisibleDOM!   _activateSnippet-   _loadSnippetsTemplates   _destroyEditors1   _callForEachChildSnippet   _closeWidgets3   _computeSelectorFunctions1   _computeSnippetTemplates)   _createSnippetEditor   _filterSnippets#   _getScrollOptions   _insertDropzone+   _makeSnippetDraggable+   _registerDefaultTexts/   _updateLeftPanelContent!   _scrollToSnippet+   _createLoadingElement-   _execWithLoadingEffect   Class   Editor   globalSelector!!      require   concurrency	   core   Dialog   dom   Widget   options   Wysiwyg   _t   globalSelector   SnippetEditor   SnippetsMenu      !!       %   ColorPaletteWidget%   SmoothScrollOnDrag'   getCSSVariableValue          +H!!          closestD#  [ [ [ [   <         5!!         allD#  [ [ [ [   H         5!!         isD#  [ \ [ \   S         5 !!       !!   closest!!!!   all!!!!   is!!    !!       !!1   click .oe_snippet_remove!!!!   wheel!!    !!       !!   option_update!!!!3   user_value_widget_request!!!!+   snippet_option_update!!!!A   snippet_option_visibility_update!!    !!      	   initC 	        1                                    " ] _ ] _                 	W   Q   Q   5       
   V   O Q   T 0   Q   T 0   Q      5   >75   0   Q            5   5   : 0   Q         T : 0   Q   5   	   
=
       Q   T 0   Q   B0   Q   B0   Q      A    ,  R 0   Q Q"3
)%"=    _super   apply   options   $editable   ownerDocument   $	   body   $body   $target	   data   snippet-editor   templateOptions-   isTargetParentEditable   isTargetMovable   Promise   __isStarted!!      parent   target   templateOptions   $editable   options   arguments   .this      +H!!        -   init/this.__isStarted<d" __ _ __ _            5 ;5!!         startC       /                           _             _ e _ e                 	W  Q   QZ      5       
   V  O `    W   QV      
      
:   Q   5      5      ?7W  Q      5      
:     
=	   : 0
   Q      5
   E   Q   5   0   Q      5
   E+   Q   5      
:     
=   :  0   Q   5        Q   B0   Q   5      
[   [   [    
]   
]   ]   =   ]      ]      5      
   : ]      ]   ]   :   Q       A      5         :     
:  V  ,  R 0   QM         
=    : !   
="    QV  #   
=$   : !   
="    Q   5    =      5   %   
V  : #   
=&   : !   
="    Q>   Q'   (   
   d:    Q   5   )   
=*       Q   5   )   
=+       Q,   -   
V   : .   
   :  #
)GG43
  $ v=Z"%!  `/    _super   apply	   push%   _initializeOptions'   _customize$Elements   length   $target   parent   is   :o_editable-   isTargetParentEditable   isTargetMovable-   [data-oe-type="image"]#   isTargetRemovable   dropped   options!   getScrollOptions	   left   top   cursorAt   .o_move_handle   handle   helper'   _onDragAndDropStart	   bind   start	   stop-   jQueryDraggableOptions   $el   $'   getScrollingElement%   draggableComponent/   .o_overlay_move_options   addClass   d-none	   find#   .oe_snippet_clone   add%   .oe_snippet_remove   _   throttle   on{   transitionstart.snippet_editor, animationstart.snippet_editors   transitionend.snippet_editor, animationend.snippet_editor   Promise   all	   then!!   	   defs   $customize!   _animationsCount%   postAnimationCover   arguments   .this        !!       '   smoothScrollOptions          +H!!       !!	   left!!!!   top!!    !!         helperD#  a vb a vb   C         5 !!      	   stopD# b b b b    	        @ 	   args   D"  b b b b   	         5 5!!       !!   cursorAt!!!!   handle!!!!   helper!!!!   start!!!!	   stop!!    !!       !!-   jQueryDraggableOptions!!    !!        3   start/postAnimationCover<d"  nd ~d nd ~d   9          5!!          start/<d"  d 2e d 2e               D"  d +e d +e              55!!          start/<d"  e e e e   }         5;        5!!         destroyC                                                e f e f        
       	W   QW  QV      
=    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  5      
=    QV  5   	   
=
    Q ,@!*$    trigger_up1   snippet_editor_destroyed   _super	   next   value	   done   $target   removeData   snippet-editor   off   .snippet_editor!!      arguments   .this         +H;   O   !          5 !!         areOptionsShownC  E                                              f g f g   j            W   Q  QV   5       ?  QV   5    V  7   
:        l,% '   _customize$Elements   length   parent!!      .this         !!          lastIndex          +H;      >       B                 5 !!         buildSnippetE           "                                    -g g g g                   Q      Q   5    K'   m      5       7   
  QQLMQN      
C:          Q    8, "    styles   onBuilt-   toggleTargetVisibility!!      i   .generator   .this         +H;   $   .      t   5 !!         cleanForSaveE        
   :                                   g h g h                     Q        Q      
:             
  5      
=   :  :         Q      
  5       :    Q   	   
   :         Q   G H  O"Q;    isDestroyed-   toggleTargetVisibility   $target   hasClass'   o_snippet_invisible   _   map   styles   Promise   all!!      .generator   .this         !!          proms            +H!!       '   cleanForSave/proms<d" <h ch <h ch   o          5;             0             q      5!!         closeWidgetsC  ^                                               h i h i                     Q   5     D   Q      
:            
   5    :    
     Q  J1    styles   areOptionsShown   Object	   keys   forEach!!      .this         +H!!          closeWidgets/<d" h i h i   !          5 ;5!!         coverC  P     #                          J            %i ]m i ]m   Z             W  Q              	  
    QV      
:   D   QV  5       
   V  5      
=   :   QV        V     V  5     QV  >7  QV     
:    Q   5   D   Q   5	   5
     Q   5   D   Q   5	   5     QV  5   <    EL   QV  5   <   E6   QV  V  5   <   E   QV  V  5   <     Q      
V  5   V  5   : <   E/   Q      
V  5   V  5   : <   	  QV   D,   QV	   D    QV  5      
=   :     V     
B QV     
:  
  QV  5      
:     
:  W   QV
  5   V   5   0   QV
  5   V   5   0   QV  5      
[    V     
:  ]   V
  5   ]   V
  5   ]    QV     
=   :    
=   V     
:   QV  5       
:  5   V   5     QV  5   !   
="   V
  5   V   Q\  "0'FIk	%%
$ ^	"$L"*2D    isShown   $target   length	   find   .modal+   getBoundingClientRect   window   innerWidth   document   documentElement   clientWidth   innerHeight   clientHeight   bottom   right   top	   left	   Math   abs   is   :visible/   toggleOverlayVisibility   offset   $el   parent   css   outerWidth   width   $   .o_handles   height   outerHeight   $editable   toggleClass   o_top_cover!!!!!!!!!!{Gz?!!{Gz?!!   #   manipulatorOffset   .this         !!    
      $modal   $target   targetEl	   rect   vpWidth   vpHeight   isInViewport   hasSize   offset#   editableOffsetTop          +H!!       !!   width!!!!	   left!!!!   top!!    ;      I      _                       2       5 !!         getNameC           C                                      nm ?n fm ?n               W   QV   5       
=   :    I   V   5       
=   : V   5       
=   :      =   : V   5       
=   : 	        =
   :   =   :  '  $    $target	   data	   name   undefined   is   img   Image   parent	   .row   length   Column   Block!!      .this         +H;B       5!!         isShownC  P                                               Pn n Hn n   %             W   QV   5    E>   QV   5       
:     E   QV   5       
=   : (    $el   parent   length   hasClass   oe_active!!      .this         +H;       5 !!         isStickyC  1                                               n n n n                W   QV   5    E   QV   5       
=   :   )    $el   hasClass'   o_we_overlay_sticky!!      .this         +H;       5 !!         isTargetVisibleC  #         	                                      o ;o n ;o                W   QV   5    >75   5   =   I  0    $target   dataset   invisible   1!!      .this         +H;       5!!         removeSnippetE       "                          c            Xo t Jo t                     Q       Q      Q       
B Q      
B Q   A   ,  R          Q      
=   [      5   ]    Q   5      
:     Q   5      
=	   : 
   
:     
=    Q   5      
  Q   5      
  Q   >7   Q   E   Q   5   S      5   5    E   Q   5   5   =   H          
   5    Q      
=   :             
=   :    Qe   m      
:     Q      :          
  Q      Q      
=   :    Q             :              Q   5      
=   :    
  Q   5      
=   :    
  Q      
=    Q      
  Q       
=!    Q      0 <
=7(m. f%+$	#      toggleOverlay   toggleOptions   Promise   trigger_up   go_to_parent   $target   $snippet   parent	   find   *   addBack   tooltip   dispose   remove   $el   firstChild   tagName   textContent       removeChild   closest/   :data("snippet-editor")   length	   data   snippet-editor   setTimeout   $body/   .note-control-selection	   hide!   .o_table_handler   snippet_removed   destroy   trigger   content_changed!!      $parent	   node   editor   $nextParent'   isEmptyAndRemovable   .generator   .this         +H!!       '   isEmptyAndRemovable s t s t             5!!          removeSnippet/<d" o ]p o ]p   v             resolve   B p Xp o Xp             55!!       !!   $snippet!!    !!          removeSnippet/<d"  r r r r   3          5;      m      d   5 !!         toggleOverlayC          &                                     t u t u               W   QV   5        T '   V   5       
=   T   Q;   V   5       
=    QV   5       
=   T   QV   5       
=   T   QV      
  Q 4 8-'    $el   toggleClass)   o_we_overlay_preview   removeClass'   o_we_overlay_sticky   oe_active   cover!!   	   show   previewMode   .this       +H;B       5!!         toggleOptionsC          9                                     u w u w                 W   QV   5        V      
:     H   V      
=   [          V   5      Z    ]    QV   5      
    QS ~  ~-d     $el   areOptionsShown   trigger_up3   update_customize_elements'   _customize$Elements%   customize$Elements   forEach!!   	   show   .this      +H!!       !!%   customize$Elements!!    !!           toggleOptions/<d" v w v w      0         D" w 'w w 'w            5    D" 8w Ow 8w Ow   5         5    D" fw {w fw {w   c         5 5;5!!      -   toggleTargetVisibilityE       	   '                                  w x w x                     Q        Q      
  :   Q      
  5   :   Q      
  =   :    
    :    Q      
   :         Q         'E /   _toggleVisibilityStatus   _   values   styles   sortBy   __order   map   Promise   all!!   	   show   styles   .generator   .this       !!          proms            +H!!       ;   toggleTargetVisibility/proms<d" #x bx #x bx             5;                             5!!      /   toggleOverlayVisibilityC \                                              x y x y               W   QV   5    E   QV   5    9   V   5       
=   T   E   QV      
:   Q (@    $el!   scrollingTimeout   toggleClass!   o_overlay_hidden   isShown!!   	   show   .this       +H;"       5 !!         cloneE         H                        !           -y h{ y h{                     Q      Q       
=   [       5   ]    Q   5      
B:    Q   /          
=   [      5   ]    Q   5      
    Q   A   ,  R          Q       
=   [      ]      5   ]    Q   	   
=
    Q     7*E/"H"    trigger_up-   snippet_will_be_cloned   $target   clone7   request_history_undo_record   after   Promise   snippet_cloned   $origin   trigger   content_changed!!      recordUndo   $clone   .generator   .this       +H!!       !!   $target!!    !!       !!   $target!!    !!          clone/<d" $z z $z z   -              resolve   B ~z z vz z              55!!       !!   $target!!!!   $origin!!    ;      5!!      %   _initializeOptionsC  M     .                          p             {  |{                     Q     Z    0    Q  [    0   Q  Z    0   Q  Z    0   Q  5      
:  W   Qi   mV      
=   : W  QV  3       5       
V  5    : 0    Q)   V      
:  W   QV   	   
   
     5      
=   [        
:  ]   : :    
=     :   Q     
=   :    Q      
:     
    Q     
=     5      
  :  Q     
=     5      
  :  Q     
=   =     5      
  :  Q     
=   =     5      
  :  Q     
=   =      5!      
  :  Q  5    "   
   Q  5#      
=$      Q>  Q%   &   
  5'      : W  Q    5   	   >D   Q  5   	   >0(   Q  5#      
=)   : *   
  Q+   ,   
V  : -   
   :   	(t- BP	  "QY,#Y M M-U/N0P/5 =V*   '   _customize$Elements   styles!   selectorSiblings!   selectorChildren   $target   parent	   data   snippet-editor   concat   length   $	   qweb   renderU   web_editor.customize_block_options_section   getName	   name   editor	   find'   we-top-button-group   contents	   each   on   mouseenter7   _onOptionsSectionMouseEnter	   bind   mouseleave7   _onOptionsSectionMouseLeave   click   we-title > span-   _onOptionsSectionClick#   .oe_snippet_clone   _onCloneClick%   .oe_snippet_remove   _onRemoveClick	   push   $el   $optionsSection   _   map   templateOptions   isTargetMovable1   [data-toggle="dropdown"]   dropdown   Promise   all	   then!!      $element   parentEditor   $optionsSection   i	   defs   .this        !!       /   $optionsSectionBtnGroup          +H!!            !!       !!	   name!!    !!       )   _initializeOptions/<d" } %~ } %~              5!!      1   _initializeOptions/defs<d" @ / @ /   `  `       5!!      )   _initializeOptions/<d"                     D"       )  0       5 5;    k   t         @      J         5 !!      /   _toggleVisibilityStatusC o                                   	                              W   QT      H   V      
:   U  QT  !   V   5   >75   .   Q!   V   5   >75   =   0   QT   	/    undefined   isTargetVisible   $target   dataset   invisible   1!!   	   show   .this       +H;B       5!!         _onCloneClickC %         	                                           $             W   QT      
  QV      
C Q)    preventDefault   clone!!      ev   .this       +H;       5!!      '   _onDragAndDropStartC  r                                @                          	       W  QV     QV  B0    Q   [       5      
:  ]      5      
:  ]   0   Q   5      
=    Q   5      
  Q   5   	   
=
    Q>W  Q o   mV    )      5   V  7   
:  W   Q2   V      
   5   V  7   
:  : W   QV  #W  QQV     5      >W  Q o   mV   )      5   V  7   
:  W  Q2   V     
   5   V  7   
:  : W  QV  #W  QQV     5      V     
=   [   V  5   ]    QV     
=   [   V   ]   V  ]    QV  5   	   
=    QV  5      
=   :    
[      ]      ]    Qs
J &oa  (+A&oa  (+A 8,$w&0  ^      dropped   $target   width   height	   size   afterg   <div class="oe_drop_clone" style="display: none;"/>   detach   $el   addClass   d-none!   selectorSiblings   all   add   length!   selectorChildren   trigger_up   go_to_parent   $snippet1   activate_insertion_zones#   $selectorSiblings#   $selectorChildren   $body   move-important   $editable	   find   .oe_drop_zone   droppable	   over   out!!   	   self#   $selectorSiblings   i#   $selectorChildren   .this        +H!!       !!   width!!!!   height!!    !!       !!   $snippet!!    !!       !!#   $selectorSiblings!!!!#   $selectorChildren!!    !!        	   overB   4  4            5 !!          outB  A  9             5!!       !!	   over!!!!   out!!    ;              D     5 !!      %   _onDragAndDropStopC 4     *                           T                             W  QV  5              
[    T 5   5   ]   T 5   5   ]   =   [   	   5
   ]   :    
:  W   QV      )   V      
V  5    QV  C0    QV  5      
=   :    
=   :    
  QV  5      
:  >75   W  QV  5      
:  >75   W  QV  5      
:  W  QV  5      
=   : W  QV  V  >7H   V  >75   W  Q'   V  V  >7H   V  >75   W  QV     
V  5    QV     
:  W  QV  5      
=    QV  5      
=    QV     
  QV  5       V     
=    [   V  5   ]    QV  #   V  5   !   
V   QF   V  #   V  5   "   
V   Q   V  #   
V  5    QV  5$   K$   mW  V  5$   V  7%   
  QQLMQNV  5   &   
='    QV  &   
='    QV     
=(   [   V  5   ])    Q $\%,'&%)/F	%	&8)(&?    dropped   $   nearest   position	   left   x   top   y   .oe_drop_zone   document	   body   container   first   length   after   $target   $editable	   find   droppable   destroy   remove   previousSibling	   last   nextSibling   parent   .oe_drop_clone   $el   removeClass   d-none   $body   move-important   trigger_up7   request_history_undo_record   insertAfter   insertBefore   prepend   styles   onMove   trigger   content_changed%   drag_and_drop_stop   $snippet!!
      ev   ui   $el	   prev	   next   $parent   $clone   $from   i   .this       +H!!       !!   x!!!!   y!!    !!       !!   container!!    !!       !!   $target!!    !!       !!   $snippet!!    ;     +          5 !!      7   _onOptionsSectionMouseEnterC V                                                	    e             W   QV   5       
=   :     V      
=   [    V   5    ]   C]    QjN$N    $target   is   :visible   trigger_up!   activate_snippet   $snippet   previewMode!!      ev   .this       +H!!       !!   $snippet!!!!   previewMode!!    ;"       5 !!      7   _onOptionsSectionMouseLeaveC ,                                                   t             W   QV       
=   [    B]   C]    Qy$G    trigger_up!   activate_snippet   $snippet   previewMode!!      ev   .this       +H!!       !!   $snippet!!!!   previewMode!!    ;       5!!      -   _onOptionsSectionClickC 4                                             ! v  v                W   QV       
=   [    V   5   ]   B]    Q  $O    trigger_up!   activate_snippet   $target   $snippet   previewMode!!      ev   .this       +H!!       !!   $snippet!!!!   previewMode!!    ;       5!!         _onOptionUpdateC          "                                      z  z                 W   Q       QV      Q   5    5   :         
  Q      
   5    5       Q   5    5   4         5    5   :          
  Q X
0 	   data   optionNames   stopPropagation   _	   each   optionName!!      ev	   self5   notifyForEachMatchedOption   .this      +H!!        5   notifyForEachMatchedOption  y  y   #   0       5 !!       #   _onOptionUpdate/<b                5;5!!         _onRemoveClickC Y                                  	                 +             W   QT      
  QT     
  QV      
=   [    V   5   ]    QV      
  Q0/F    preventDefault   stopPropagation   trigger_up7   request_history_undo_record   $target   removeSnippet!!      ev   .this       +H!!       !!   $target!!    ;       5 !!      -   _onSnippetOptionUpdateE          ,                                  B Z 4 Z                     Q        Q       
  5   :    
    :    Q      
   :         Q       
  5   :    
   :    Q      
   :         Q  5      
  Q     D:    Object	   keys   styles   map   Promise   all	   data   onSuccess!!      ev   .generator   .this       !!          proms1   proms2            +H!!       =   _onSnippetOptionUpdate/proms1<d" q  q    
         5 !!      =   _onSnippetOptionUpdate/proms2<d"  )  )            5 ;            l      5!!      A   _onSnippetOptionVisibilityUpdateC 0                                                |                W   QT  5    V      
T  5    5   : 0   Q "+ 	   data/   _toggleVisibilityStatus	   show!!      ev   .this       +H;       5 !!      3   _onUserValueWidgetRequestC j        E                                         ~            W   QT      
  Q  Q      
V   5   : -
  5   
  m  QQ:   5      Q   5     Q  QV   5   V  7   
T  5   5	   :   QV  Q   T  5   
   
V   QQ
Q
   IE
   Q@I   
:     QQQ]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B  &@ P  &	    stopPropagation   Object	   keys   styles	   next	   done   value   findWidget	   data	   name   onSuccess   return!!      ev   .this       !!          key          !!         widget          +H;       )       4           C       q         I           U     w                1                   B       5!!         _onMouseWheelC n                                               S  S                     QT      
  Q   5      
=   =    Q         5    Q             X : 0   Q E& 9    stopPropagation   $el   css   pointer-events	   none   clearTimeout   wheelTimeout   setTimeout!!      ev   .this       +H!!       A   _onMouseWheel/this.wheelTimeout<d"  $ L $ L            5 ;5!!    $   !!   template!!!!   xmlDependencies!!!!   events!!!!   custom_events!!!!	   init!!!!   start!!!!   destroy!!!!   areOptionsShown!!!!   buildSnippet!!!!   cleanForSave!!!!   closeWidgets!!!!   cover!!!!   getName!!!!   isShown!!!!   isSticky!!!!   isTargetVisible!!!!   removeSnippet!!!!   toggleOverlay!!!!   toggleOptions!!!!-   toggleTargetVisibility!!!!/   toggleOverlayVisibility!!!!   clone!!!!%   _initializeOptions!!!!/   _toggleVisibilityStatus!!!!   _onCloneClick!!!!'   _onDragAndDropStart!!!!%   _onDragAndDropStop!!!!7   _onOptionsSectionMouseEnter!!!!7   _onOptionsSectionMouseLeave!!!!-   _onOptionsSectionClick!!!!   _onOptionUpdate!!!!   _onRemoveClick!!!!-   _onSnippetOptionUpdate!!!!A   _onSnippetOptionVisibilityUpdate!!!!3   _onUserValueWidgetRequest!!!!   _onMouseWheel!!    !!            !!       !!)   click .o_install_btn!!!!7   click .o_we_add_snippet_btn!!!!7   click .o_we_invisible_entry!!!!G   click #snippet_custom .o_delete_btn!!!!   mousedown!!!!I   input .o_snippet_search_filter_input!!!!I   click .o_snippet_search_filter_reset!!!!o   summernote_popover_update_call .o_we_snippet_text_tools!!    !!       !!1   activate_insertion_zones!!!!!   activate_snippet!!!!7   call_for_each_child_snippet!!!!   clone_snippet!!!!   cover_update!!!!%   deactivate_snippet!!!!%   drag_and_drop_stop!!!!)   get_snippet_versions!!!!   go_to_parent!!!!   remove_snippet!!!!/   snippet_edition_request!!!!1   snippet_editor_destroyed!!!!   snippet_removed!!!!   snippet_cloned!!!!A   snippet_option_visibility_update!!!!;   snippet_thumbnail_url_request!!!!1   reload_snippet_dropzones!!!!   request_save!!!!3   update_customize_elements!!!!   hide_overlay!!!!-   block_preview_overlays!!!!1   unblock_preview_overlays!!!!3   user_value_widget_opening!!!!3   user_value_widget_closing!!!!/   reload_snippet_template!!    !!       !!   BLOCKS!!!!   OPTIONS!!    !!       	   initC @        D                                   " ] X U X                 	W   QW  QV  5       
V  V   O Q   D   Q[       QV     
=   [      ]      ]    QV     0   QV  5   5       V  5   =   0   QV  Z    0	   QV  Z    0
   QV    5   A,  R  0   QV     
   5      5    QV  f      
=   : 0   QV  [   0   QV  [   0   Q "!v G     _super   apply   trigger_up   getRecordInfo   recordInfo   callback   options   snippets'   web_editor.snippets   snippetEditors/   _enabledEditorHierarchy   Mutex   _mutex/   setSelectorEditableArea   $el)   selectorEditableArea	   join   , ;   _notActivableElementsSelector   loadingTimers   loadingElements!!      parent   options   arguments   .this      +H!!            !!          callbackB                5 !!       !!   recordInfo!!!!   callback!!    !!      !!)   #web_editor-top-edit!!3   .o_we_website_top_actions!!   #oe_snippets!!!   #oe_manipulators!!%   .o_technical_modal!!   .oe_drop_zone!!/   .o_notification_manager!!!   .o_we_no_overlay!!!   .ui-autocomplete!!   .modal .close!!#   .o_we_crop_widget   !!            !!            ;5 !!         willStartC                                                k  c         
       	W   QW  Q          
V   QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) *@! !   loadDependencies   _super	   next   value	   done!!      arguments   .this         +H;   T   !          5 !!         start@       C                                    (  :  :           	       	   Q   Q        QZ     5       
    O `      Q    5   >75   0   Q          5   : 0   Q    5   5   0   Q          5   : 0   Q  	   
   
=   : 0   Q  5   5      
=   =    Q  	   
   
=   : 0   Q  5   5      
=   =    Q  	   
   
=   : 0   Q  5   5      
=    Q  5      
      =   [      =   : ]   =   ]   : >7 Q  5     5      
  : 0   Q     
   :   Q        =   [   =    ]!   : "   
  5   : 0#   Q  5   $   
=%   =&       Q  5'   $   
=(       5)    Q*   +   
   2:   Q  5   $   
=,      Q  5   $   
=-      Q  5   $   
=.       Q  5   $   
=/   *   +   
   X :  Q        :  0   
:  01   Q  51   $   
=2   *   +   
   2:  Q  5   $   
=%   =3       Q  5   $   
=4   	    Q      =5   :    Q  6   
   7         8   
:     B Q  5   9   
[   =:   ];   =<   ]=   d]>   
   ]?    Q@   A   
  : B   
   :        P   U#-+CIB1m"`$$"E?=F    !           +H
      _super   apply   $el   ownerDocument   $   $document   defaultView   window   $window   document   createElement   div   customizePanel   classList   add)   o_we_customize_panel   d-none#   textEditorPanelEl/   o_we_snippet_text_tools'   invisibleDOMPanelEl/   o_we_invisible_el_panel   appendChild   <div/>%   Invisible Elements	   text   o_panel_header   class   options#   _getScrollOptions	   bind!   getScrollOptions	   push   oe_manipulators   id   insertAfter%   $snippetEditorArea   on'   click.snippets_menu   *   bus%   deactivate_snippet)   _onDeactivateSnippet   _   throttle)   resize.snippets_menu;   content_changed.snippets_menu+   keydown.snippets_menua   mousemove.snippets_menu, mousedown.snippets_menu'   getScrollingElement#   $scrollingElement)   scroll.snippets_menu/   .o_default_snippet_text'   keyup.snippets_menu/   .o_we_snippet_autofocus!   _activateSnippet   length   first   tooltip   we-title   selector   bottom   placement   delay   title   Promise   all	   then!!   	   defs   lastElement)   debouncedCoverUpdate   .generator   arguments   .this         !!          $autoFocusEls            +H!!       !!	   text!!!!   class!!    !!         start/<d"        @         5!!       !!   id!!    !!         start/<d"         P         B  m  e    '          5 5!!      7   start/debouncedCoverUpdate<d"    /   /             5!!         start/<d"   S  S   h           D"   P   P            5 5!!         start/<d"   M  M   ,             D"  J  J   ;          5 5!!         start/<d"           0         D"  \  \    E   0       5 5!!         start/<b 3  +             5!!         start/<b    	             5!!         titleB  ^  V    G         5!!       !!   selector!!!!   placement!!!!   delay!!!!   title!!    !!          start/<d"  = 7 = 7   &           B  z  r    c         5    D"   /  /               D"   ,  ,            5 55;                        5!!         destroyC                                               " K  C    4            	W   QW  QV  5       
V  V   O QV  5   e   V  5      
  QV  5      
=    QV  5      
=    QV  5      
=    Q  5	      
=
   V  V  5    QV  5   V  5   5   /Q 7"!#%B8    _super   apply   $window%   $snippetEditorArea   remove   off   .snippets_menu   $document#   $scrollingElement   bus%   deactivate_snippet)   _onDeactivateSnippet)   cacheSnippetTemplate   options   snippets!!      arguments   .this         +H;#      5 !!         cleanForSaveE           ,                                                            Q      Q       
B:          Q      
=    Q      
:           Q      
:     
=   :    
=   : 	   
=    Q      
:     
=
   :    
=    Q     +# !   _activateSnippet   trigger_up/   ready_to_clean_for_save   _destroyEditors   getEditableArea	   find#   [contentEditable]   removeAttr   contentEditable   removeProp)   .o_we_selected_image   removeClass'   o_we_selected_image!!      .generator   .this         +H;   4   l   5 !!         loadSnippetsC          @                                                      W   QT   E   QV   5    V   5   5   72   V   V   5    V   5   5   70   QV   5   V   V      
[   =   ]   =   ]   Z   V   5   5   `    [    `   ]	   [   V   5   5
   ]
   ]   : 0   QV   5    V   5   5   V   5   9QV   5    DG  !  G )   cacheSnippetTemplate   options   snippets!   _defLoadSnippets	   _rpc   ir.ui.view   model'   render_public_asset   method	   args   context   kwargs!!      invalidateCache   .this       +H!!            !!       !!   context!!    !!       !!   model!!!!   method!!!!	   args!!!!   kwargs!!    ;"       5 !!      /   setSelectorEditableAreaC =                                               `  `   !            W   QV   T 0    QV   T  0   QV   T     
=   : 0   Q @/ )   selectorEditableArea   $editor   closest	   body   $body!!      $editor)   selectorEditableArea   .this       +H;       5 !!         getEditableAreaC  J                                   
            y  q                W   QV   5       
V   5   :    
V   5       
V   5   : :  14    $editor	   find)   selectorEditableArea   add   filter!!      .this         +H;       5 !!      C   updateCurrentSnippetEditorOverlayC          9                                                 
       W   Q   V   5    -
  5   
   mQ:   5      Q   5      Q   5      
=   :             
  Q~   V   5	   
   
     Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B! @   [P\,.H  v/    snippetEditors	   next	   done   value   $target   closest	   body   length   cover   _mutex	   exec   return!!      .this         !!          snippetEditor          +H!!       G   updateCurrentSnippetEditorOverlay/<d"                  5;                 C       N   `      +            	  5!!      /   _activateInsertionZonesC Y        b                        "                                W  Q       QV     QT r   T     
    Q            
T  D   Q      :     
T    
:  :    
:  : : U  QT  (   T     
=   :     
    Q m>W   QV  	   
:  
   
=   :    
:  W  QV   V     W   QV     
  QV   >V  	   
:  
   
=   : W  QV      
    Q{I/	"D
1W^&	 (  	   each   $   _	   uniq   add   children   get   filterO   :not(.oe_drop_zone):not(.oe_drop_clone)   getEditableArea	   find;   .oe_drop_zone > .oe_drop_zone   remove   length?   .oe_drop_zone:not(.oe_vertical)!!   #   $selectorSiblings#   $selectorChildren	   self   isFullWidth   count   $zones   .this      +H!!          isFullWidth . n  n             5!!       3   _activateInsertionZones/<b   ^  ^   5   r       5!!       3   _activateInsertionZones/<b  '      g   r       5!!       3   _activateInsertionZones/<b           B       5 ;       c   5 !!      '   _updateInvisibleDOMC                                                 
 :  :                     Q       
    B:   % -   _execWithLoadingEffect!!      .this         +H!!       +   _updateInvisibleDOM/<d"  0 1 0 1             )   $invisibleDOMPanelEl    D"       7         5 5;5!!      !   _activateSnippetE          M                                  Z : L :                     Q        Q  5    E   Q          E   Q     
=   :                          Q      :           , Q  Q d Q +   _blockPreviewOverlays   is   :visible!!      $snippet   previewMode#   ifInactiveOptions   .generator   .this       !!       	   exec            +H!!       -   _activateSnippet/exec<d"                 5 !!      -   _activateSnippet/exec<d"   Q   Q   8          5 !!      %   _activateSnippet/<d"  ^ 7 ^ 7   v             D" v ' v '      0       5    D" . 4 . 4               D" R k R k   <          5 55;             8              j                           5!!      -   _loadSnippetsTemplatesE :                                            ` $ R $                     Q      Q       
    B:            -   _execWithLoadingEffect!!      invalidateCache   .generator   .this       +H!!       1   _loadSnippetsTemplates/<d"                  5 ;   5!!         _destroyEditorsE                                              C   5                       Q        Q       
  5       :    Q      
   :         Q  5      
> Q    ]v    _   map   snippetEditors   Promise   all   splice!!      .generator   .this         !!          proms            +H!!      -   _destroyEditors/proms<d z  l             5 ;      p      b   5!!      1   _callForEachChildSnippetC ]         "                                     " 6  6          	       W  QV     Q       
T     
	     
T  : :     : W   Q      
V   :  R      _   map   add   all   Promise!!      $snippet   callback	   self	   defs   .this      +H!!       =   _callForEachChildSnippet/defs<b   ~                 $snippet   B                 55;5!!         _closeWidgetsC  !         	                                      M  E                  W   QV   5       
     Q h;    snippetEditors   forEach!!      .this         +H!!          _closeWidgets/<d" l  l             5;5!!      3   _computeSelectorFunctionsC          7       	                              W  W                 W  Q   V    Q    E   Q=    =     Q       Q  "           Q     Q[      ]   W   QT )   V      0   QV      0   Q9   V      0   QV   T             0   QV    
/3
Vlo%    , 3   .o_snippet_not_selectable   is   closest   all!!      selector   exclude   target   noCheck   isChildren	   self   functions   .this      !!          filterFunc         !!         oldFilter          +H!!          filterFuncB  8 W 0 W   P         5 !!         filterFuncB                 5 !!         isB  8  8             5 !!       !!   is!!    !!      W   _computeSelectorFunctions/functions.closestb a  Y              5!!      O   _computeSelectorFunctions/functions.allb                 5!!      W   _computeSelectorFunctions/functions.closestb < A 4 A   f             parents   B   +  +     2       5 5!!      Q   _computeSelectorFunctions/functions.all<b c  [    F          5 !!      Q   _computeSelectorFunctions/functions.all<b  B  B             5 ;            U                        5!!      1   _computeSnippetTemplatesC      )                           F            y O q O          	       W  Q  QV     Q        T  : W   QV      
=   : W  QV      
=   :   QV        V  >75   =   0   QV  Z    0	   QZ       QV      
=
   : W  QV     
     QV     
=    Q	     0   Q	     0   Q	     0   QV  V     
=   :    
:     
=   :    
   :    
=   : 0   QV  5          V  5      
  QV     
  QV      
=   :    
=   B QV  5      
V    QV  5      
V  5    QV  5      
V  5     QV  5      
V  5!    QV  "   
V  5    QV  #   
  QV  5      
=$    Q        =%   :    
=&    QV  '   
=(      5    Q:"Q   %(*+# ,    $   siblings   #o_scroll	   find   [data-js="HeaderNavbar"][data-selector="#wrapwrap > header > nav"]   length   dataset;   #wrapwrap > header nav.navbar   selector   templateOptions   [data-selector]	   each   addClass   d-none   closest   all   is   .o_panel_body   children   oe_snippet   not!   [data-module-id]   $snippets   $el   detach+   _registerDefaultTexts   .o_not_editable	   attr   contentEditable	   html   append   customizePanel#   textEditorPanelEl'   invisibleDOMPanelEl+   _makeSnippetDraggable7   _disableUndroppableSnippets   o_loaded%   body.editor_enable'   editor_has_snippets   trigger_up   snippets_loaded!!   	   html	   self   $html   $scroll   selectors   $styles   .this      !!          $headerNavFix          +H!!       5   _computeSnippetTemplates/<b        h          5 !!      _   _computeSnippetTemplates/globalSelector.closestb -  %      0       5!!      W   _computeSnippetTemplates/globalSelector.allb        1           5 !!      U   _computeSnippetTemplates/globalSelector.isb  
  
   +   0       5 !!      Q   _computeSnippetTemplates/this.$snippets<d" _ P _ P   c   @       5;        5!!      )   _createSnippetEditorC       
   G                                     m _ e _                 W  QV     Q       
=   :    Q         5   	     
      
:  : W  QV        V     
V  : W   Q      
V   : 	   
    : 	   
   :    \ * 4( 	   data   snippet-editor   __isStarted   closest   parent   length)   _createSnippetEditor   Promise   resolve	   then!!      $snippet	   self   snippetEditor   def   $parent   .this      +H!!        -   _createSnippetEditor/<b  4  4   )           5!!       -   _createSnippetEditor/<b  C \ ; \   A         5 ;5!!      7   _disableUndroppableSnippetsC  5                                                 |                  W   QV      Q[       QV   5       
    Q 	 N    $snippets	   each!!   	   self   cache   .this        +H!!            !!        ;   _disableUndroppableSnippets/<b          R          $snippetBody    check    B = u 5 u   ;          55;5!!         _filterSnippets@ I                               6                      
          W   Q      QV   5       
=   :   QV   5       
=   :   Q      I   V     0   Q   V  5      Q      
:     QV  5      
=	        Q      Q  QV   5    
   
=   : -
  5   
G  m  QQ:   5      Q.  5     Q      QB  QV     
=   : 5     QV  V  :   Q  QV  
   
=   : -
  5   
  m  QQ:   5      Q  5     Q	  QV  DL   QV  V     
=   : : D*   QV  V  5   5   D   Q=   : 	  QV	     CW  QV  5      
=	   V	    Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B V  5      
=	   V    Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B  g>8!+:Q@ JP 6;.@  P  ;',.$  u"   7    el   querySelector=   .o_snippet_search_filter_input=   .o_snippet_search_filter_reset   undefined   value   toLowerCase   classList   toggle   d-none!   querySelectorAll   .o_panel	   next	   done   .o_panel_header   textContent   .oe_snippet   getAttribute	   name   dataset   oeKeywords      return!!      search   .this      !!          searchInputEl!   searchInputReset   strMatches          !!         panelEl          !!      #   hasVisibleSnippet   panelTitle#   isPanelTitleMatch         !!         snippetEl       	   !!         matches    	   
   +H!!          strMatchesD# e  e    a          5 ; 
            i  C                                   C                  J        B                 &          h  U                5!!      #   _getScrollOptions@           1                                           J                QW  QT  H   Q[       Q       
[   V   [          
[   B]   V   5   : ]          
[   V  5   ]   =   ]   C]   B]	   V   5
   : ]
   : W! 7&      Object   assign   right!   scrollBoundaries   $body   appendTo	   move   cursor   greedy   scroll-   jQueryDraggableOptions!!      options   .this      +H!!            !!            !!       !!   right!!    !!       !!   appendTo!!!!   cursor!!!!   greedy!!!!   scroll!!    !!       !!!   scrollBoundaries!!!!-   jQueryDraggableOptions!!    ;"       5!!         _insertDropzoneC u                                                     `                    =   [    =   T    =      =   ]   : W   QT    V      
T  QT     
V    QV    {M
    $   <div/>-   oe_drop_zone oe_insert    oe_vertical      class   css   replaceWith!!      $hook   vertical   style   $dropzone       +H!!       !!   class!!    ;        5!!      +   _makeSnippetDraggableC          O                                                 
       W   Q     QV     Q   QV       
[   [   >]   =   ]       ]      ]      ]   ]   :   QV       AV   T        :  	   
:  V  ,  R 0
   QY
,;   '     <>U #   _getScrollOptions   distancec   .oe_snippet_thumbnail:not(.o_we_already_dragging)   handle   helper   start	   stop-   jQueryDraggableOptions   $'   getScrollingElement%   draggableComponent!!      $snippets	   self   $toInsert   dropped   $snippet   .this      !!       %   dragAndDropResolve'   smoothScrollOptions         +H!!          helperB        =            D"                5 5!!         startB  . m & m     r       	   prom   D"       Z          5    B   g  g      "       5   B  t  l    -  "       5   D" & O & O                resolve    D"  B O B O            5 5   D"  b j b j            5 5!!      	   stopD  4 s 4   :            $target   D  O  A    Q             B  #  #             5 55!!       !!   distance!!!!   handle!!!!   helper!!!!   start!!!!	   stop!!    !!       !!-   jQueryDraggableOptions!!    ;         5 !!      +   _registerDefaultTextsC                                                                    W   QT      H"   V   5      
=   : U  QT     
=   :    
:     
:     
    :    
:  	   
=
    Q 
L	#    undefined   $snippets	   find!   .oe_snippet_body   *   addBack   contents   filter   parent   addClass-   o_default_snippet_text!!      $in   .this       +H!!        /   _registerDefaultTexts/<b  A | 9 |   2          5;5!!      /   _updateLeftPanelContentC 1        @                         =                                W  QT  5    W   Q5   W  QQ      V  5    QV     
  QV  D   QV  5   5   W  QV   i   (   mV  5      
V  5   5	    QV  5   5	   
   
   V  5   :    
V    QV  
   
=   :    
=   V  V  5   5   I QV  
   
=   :    
=   V  V  5   5   I QV  5   5      
=   V  V  5   5   H QV  5   5      
=   V  V  5   5   I QV  
   
=   :    
=   V  V  5   5   H QV  
   
=   :    
=   V  V  5   5   H:    
=   V  V  5   5   I Q  .(8&#--FJ -&.)    content   tab   clearTimeout5   _textToolsSwitchingTimeout   _closeWidgets	   tabs   BLOCKS   customizePanel   removeChild   firstChild   $   append1   .o_snippet_search_filter   toggleClass   d-none   #o_scroll   classList   toggle#   textEditorPanelEl   OPTIONS+   .o_we_add_snippet_btn   active7   .o_we_customize_snippet_btn	   prop   disabled!!       content   tab   .this       +H;    u   8   2       5 !!      !   _scrollToSnippet@ >                                                                         Q      
   >7[    2]   :        	&    scrollTo   extraOffset!!      $el   .generator       +H!!       !!   extraOffset!!    ;
   5!!      +   _createLoadingElement@           R                                     #      M                     Q       
=   :    Q       
=   :   QZ   =   `    =   `   =   `   =   `     QZ   =   `    =	   `   =
   `   =   `     QV   5      
Z    >V  -
  5   
   m5   _,  ,  :   5    Q)QV  5      
Z    >V  -
  5   
   m5   _,  ,  :   5    Q)QV      
V   QV    O$"	

@!;@!)$    document   createElement   div   i   o_we_ui_loading   d-flex-   justify-content-center%   align-items-center   fa#   fa-circle-o-notch   fa-spin   fa-4x   classList   add	   next   value	   done   appendChild!!              !!          loaderContainer   loader1   loaderContainerClassList   loaderClassList           +H;      !      <  !                                5 !!      -   _execWithLoadingEffect@           1                                                          QT     QT H   QC   QT H
   QX   Q           Q  5       
  :    Q  5     7 T     5                 : 9Q  5       
:     
    Q        ?  F%#      _mutex	   exec   loadingTimers   setTimeout   getUnlockedDef	   then!!      action   contentLoading   delay   .generator   .this      !!                !!         mutexExecResult            +H!!      u   _execWithLoadingEffect/this.loadingTimers[contentLoading]<d"   |  |     0       5 !!      1   _execWithLoadingEffect/<d"                  5;   A      F                      P   5!!      3   _onActivateInsertionZonesC 0                                               #  #   ;             W   QV       
T  5   5   T  5   5    Q@R /   _activateInsertionZones	   data#   $selectorSiblings#   $selectorChildren!!      ev   .this       +H;       5!!      %   _onActivateSnippetC =         	                                     ?  7                 W   QV       
T  5   5   T  5   5   T  5   5    Q  V !   _activateSnippet	   data   $snippet   previewMode#   ifInactiveOptions!!      ev   .this       +H;       5!!      5   _onCallForEachChildSnippetC 0         	                                           /            W   QV       
T  5   5   T  5   5    Q 4A 1   _callForEachChildSnippet	   data   $snippet   callback!!      ev   .this       +H;       5 !!      -   _onOverlaysCoverUpdateC  !         	                                      & a  a                 W   QV   5       
     Q 7    snippetEditors   forEach!!      .this         +H!!        1   _onOverlaysCoverUpdate/<d" E ^ E ^            5 ;5!!         _onCloneSnippetE          !                                     r                    Q        Q      
  Q     
  5   5   :            Q      
:          Q  5   5        5      
  Q    ,    stopPropagation)   _createSnippetEditor	   data   $snippet   clone   onSuccess!!      ev   .generator   .this       !!          editor            +H;            W      5 !!      )   _onDeactivateSnippetC           	                                      8 Y 0 Y               W   QV       
B Q  !   _activateSnippet!!      .this         +H;       5 !!      %   _onDragAndDropStopE q                                             {  m                    Q      Q       
:           Q      
   5   5   :          Q    (    _destroyEditors!   _activateSnippet	   data   $snippet!!      ev   .generator   .this       +H;   3   e   5 !!         _onGoToParentC ;                                               /	  /	   S            W   QT      
  QV      
T  5   5      
:   Q X1    stopPropagation!   _activateSnippet	   data   $snippet   parent!!      ev   .this       +H;       5!!         _onHideOverlayC           (                                    G	 	 ?	 	               W   Q  QV   5    -
  5   
   m  QQ:   5      Q   5     QV     
B Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp Ba @   P%2    snippetEditors	   next	   done   value   toggleOverlay   return!!      .this         !!          editor          +H;                 C       T         ,               2       5!!      %   _onInstallBtnClickC      )                            *            	 0 	 0                 W  QV     Q        T  5   :    
=   : W   QV      
=   :    QV      
=   :    Q  AV  [      5	   
   
  =   :    : ]   =   ]           =   [       5	   
   
  =   :    : ]   :    
        =   [   =   ]   =      =   ]     =   : ]   =   ]   : : ]   Z   [     =   : ]   =   ]      ]    `    [     =!   : ]   ="   ]#   =$   ]   `   [     =%   : ]   C]&   `   ]'   ,  R (   
  Q &	 	%a_ b  	 '*,     $   currentTarget   closest!   [data-module-id]	   data   moduleId	   attr	   name   _   str   sprintf   Install %s   title   medium	   size   <div/>E   Do you want to install the %s App?	   text   append	   <a/>   _blank   target   /web#id=   &view_type=form&model=ir.module.module&action=base.open_module_tree	   href3   More info about this app.   ml4   class   $content!   Save and Install   btn-primary   classes   click'   Install in progress?   fa-spin fa-spinner fa-pulse mr8	   icon;   btn-primary disabled o_hidden   Cancel   close   buttons	   open!!      ev	   self   $snippet   moduleID	   name   .this      +H!!       !!	   text!!    !!       !!   target!!!!	   href!!!!	   text!!!!   class!!    !!          clickB        U  "          .this   D"  z  z             5    D"       B         5 5!!       !!	   text!!!!   classes!!!!   click!!    !!       !!	   text!!!!	   icon!!!!   classes!!    !!       !!	   text!!!!   close!!    !!       !!   title!!!!	   size!!!!   $content!!!!   buttons!!    ;5!!      -   _onInvisibleEntryClickE         8                       "           V  H                      Q        Q      
  Q        5      
  5   : :    Q     
    C:            Q        5   :    
=   :    
=	      :    
=
        Q     
            B:        4  ;'0    preventDefault   $   invisibleDOMMap   get   currentTarget-   _execWithLoadingEffect	   find   .fa   toggleClass   fa-eye   fa-eye-slash!   _activateSnippet!!      ev   .generator   .this       !!          $snippet   isVisible            +H!!       C   _onInvisibleEntryClick/isVisible<d"   G  G   S	         5;                            5!!      #   _onBlocksTabClickC )                                               y   y                     Q       
B:    
     Q 
}N !   _activateSnippet	   then!!      ev   .this       +H!!       '   _onBlocksTabClick/<d"  / v / v   
         5;5!!      #   _onDeleteBtnClickC &        Z                                                           Q   Q           5   :    
=   :    Q  A   [   =   ]     =   : ]           =     =	   V   
   
=   : =   : =   : ]   Z   [     =   : ]   C]   =   ]       ]   `    [     =   : ]   C]   `   ]   ,  R    
  Q 	Ii	
  	,     $   target   closest   .oe_snippet   medium	   size   Confirmation   title   <div><p>[   Are you sure you want to delete the snippet: 	   attr	   name    ?   </p></div>   $content   Yes	   text   close   btn-primary   classes   click   No   buttons	   open!!      ev   .this       !!          $snippet           +H!!         clickD#        +         5!!       !!	   text!!!!   close!!!!   classes!!!!   click!!    !!       !!	   text!!!!   close!!    !!       !!	   size!!!!   title!!!!   $content!!!!   buttons!!    ;        5!!         _onMouseDownC                                                                                 =   :    Q      
=    Q       Q         X:    Q           :    
=       Q A6F ?    $   #wrapwrap   addClass-   o_we_no_pointer_events   setTimeout   document   one   mouseup!!              !!          $blockedArea   reenable   enableTimeoutID            +H!!          reenableD#  3 i 3 i            5 !!      ;   _onMouseDown/enableTimeoutID<d"                 5!!         _onMouseDown/<d"        *         5 ;      ~   5!!      +   _onGetSnippetVersionsC          %                                         {            W   Q  QV   5       
=   T  5   5   =   :   QT  5      
V  EE   Q[    V  5   5   ]   V  5   5	   ]	   V  5   5
   ]
    Q >Ok    el   querySelector;   .oe_snippet > [data-snippet="	   data   snippetName   "]   onSuccess   dataset	   vcss   vjs	   vxml!!      ev   .this       !!          snippet          +H!!       !!	   vcss!!!!   vjs!!!!	   vxml!!    ;                5!!      1   _onReloadSnippetTemplateE d                                  	            R  R   q                Q      Q       
B:          Q      
C:          Q    v" !   _activateSnippet-   _loadSnippetsTemplates!!      ev   .generator   .this       +H;   4   X   5 !!      /   _onBlockPreviewOverlaysC          	                                      s  k                W   QV   C0    Q   +   _blockPreviewOverlays!!      ev   .this       +H;       5 !!      3   _onUnblockPreviewOverlaysC          	                                            ,            W   QV   B0    Q 1! +   _blockPreviewOverlays!!      ev   .this       +H;       5 !!      !   _onRemoveSnippetE          !                                         s                Q        Q      
  Q     
  5   5   :            Q      
:          Q  5   5        5      
  Q    w,    stopPropagation)   _createSnippetEditor	   data   $snippet   removeSnippet   onSuccess!!      ev   .generator   .this       !!          editor            +H;            W      5!!         _onSaveRequestC x         0                                                            Q   T  5       QT  5     HE   Q   5    
      .   QT     
  Q     
    C Q 1-  *- 	   data   target   _toMutex   stopPropagation-   _execWithLoadingEffect!!      ev   .this       !!       	   data            +H!!       !   _onSaveRequest/<d"  I x I x   F   0          oldOnSuccess    D   O  O      '       55;      k       D          5!!      1   _onSnippetEditionRequestC $                                                    P             W   QV       
T  5   5   C QU/ -   _execWithLoadingEffect	   data	   exec!!      ev   .this       +H;       5!!      3   _onSnippetEditorDestroyed@ U                                  	            c  c                W   Q  QT      
  QV   5      
T  5   :   QV   5      
V  ? Q  '$    stopPropagation   snippetEditors   indexOf   target   splice!!      ev   .this       !!          index          +H;      N          5!!      !   _onSnippetClonedC          	                                     }  u    +            W   QV       
  Q 0 '   _updateInvisibleDOM!!      ev   .this       +H;       5!!      #   _onSnippetRemovedC  %                                                     g            W   QV       
  QV      
  Q j# 7   _disableUndroppableSnippets'   _updateInvisibleDOM!!      .this         +H;       5 !!      A   _onSnippetOptionVisibilityUpdateE z                                              +                      Q      Q   5    5    *         
B:          Q      
:           Q      	   data	   show!   _activateSnippet'   _updateInvisibleDOM!!      ev   .generator   .this       +H;   J   n   5 !!      ;   _onSnippetThumbnailURLRequest@ ~                                              8  8   @             W   Q  QV   5       
=   T  5   5   =   :   QT  5      
V        V  >75   5	      =
    QD.6F    $snippets   has   [data-snippet="	   data   key   "]   onSuccess   length   dataset   oeThumbnail   !!      ev   .this       !!          $snippet          +H;      w          5 !!      1   _onSummernoteToolsUpdate@         w                        -            Q  9                     Q     Q   5     
      5   5   5      
:     QV    
   V   5   V   5   HE`   QV   5   5   	   5
   HE@   QV   5   5      
=   : E   QV   5   5      >H
      5   5      
=    Q         5   :    
=   :        Q   5   5      
=    QV   
            5    Q             X : 0   Q  "   !   ?K   63  e. M 5   _textToolsSwitchingEnabled   $   summernote	   core   range   create   sc   ec   nodeType	   Node   ELEMENT_NODE   classList   contains   oe_structure   children   length#   textEditorPanelEl   add   d-block	   find   .btn:visible   remove   clearTimeout5   _textToolsSwitchingTimeout   setTimeout!!      ev   .this       !!          range#   hasVisibleButtons           +H!!      s   _onSummernoteToolsUpdate/this._textToolsSwitchingTimeout<d"        Y          5;            %              X                            W         5!!      5   _onUpdateCustomizeElementsC m      	                                        ~  ~                W   QV       
[    T  5   5   ]   T  5   5         V   5   5      V   5   5   ]    Q  #   /   _updateLeftPanelContent	   data%   customize$Elements   content   length	   tabs   OPTIONS   BLOCKS   tab!!      ev   .this       +H!!       !!   content!!!!   tab!!    ;       5!!      3   _onUserValueWidgetOpeningC  4                                                     v            W   QV       
  QV   5   5      
=    Q y'    _closeWidgets   el   classList   add   o_we_backdrop!!      .this         +H;       5!!      3   _onUserValueWidgetClosingC  %         	                                       2  2               W   QV   5    5      
=    Q *    el   classList   remove   o_we_backdrop!!      .this         +H;       5!!      +   _onSnippetSearchInputC           	                                      Q l I l   &            W   QV       
  Q )    _filterSnippets!!      .this         +H;       5!!      5   _onSnippetSearchResetClickC           	                                            e            W   QV       
=    Q h    _filterSnippets   !!      .this         +H;       5!!    B   !!   id!!!!)   cacheSnippetTemplate!!!!   events!!!!   custom_events!!!!	   tabs!!!!	   init!!!!   willStart!!!!   start!!!!   destroy!!!!   cleanForSave!!!!   loadSnippets!!!!/   setSelectorEditableArea!!!!   getEditableArea!!!!C   updateCurrentSnippetEditorOverlay!!!!/   _activateInsertionZones!!!!'   _updateInvisibleDOM!!!!!   _activateSnippet!!!!-   _loadSnippetsTemplates!!!!   _destroyEditors!!!!1   _callForEachChildSnippet!!!!   _closeWidgets!!!!3   _computeSelectorFunctions!!!!1   _computeSnippetTemplates!!!!)   _createSnippetEditor!!!!7   _disableUndroppableSnippets!!!!   _filterSnippets!!!!#   _getScrollOptions!!!!   _insertDropzone!!!!+   _makeSnippetDraggable!!!!+   _registerDefaultTexts!!!!/   _updateLeftPanelContent!!!!!   _scrollToSnippet!!!!+   _createLoadingElement!!!!-   _execWithLoadingEffect!!!!3   _onActivateInsertionZones!!!!%   _onActivateSnippet!!!!5   _onCallForEachChildSnippet!!!!-   _onOverlaysCoverUpdate!!!!   _onCloneSnippet!!!!)   _onDeactivateSnippet!!!!%   _onDragAndDropStop!!!!   _onGoToParent!!!!   _onHideOverlay!!!!%   _onInstallBtnClick!!!!-   _onInvisibleEntryClick!!!!#   _onBlocksTabClick!!!!#   _onDeleteBtnClick!!!!   _onMouseDown!!!!+   _onGetSnippetVersions!!!!1   _onReloadSnippetTemplate!!!!/   _onBlockPreviewOverlays!!!!3   _onUnblockPreviewOverlays!!!!!   _onRemoveSnippet!!!!   _onSaveRequest!!!!1   _onSnippetEditionRequest!!!!3   _onSnippetEditorDestroyed!!!!!   _onSnippetCloned!!!!#   _onSnippetRemoved!!!!A   _onSnippetOptionVisibilityUpdate!!!!;   _onSnippetThumbnailURLRequest!!!!1   _onSummernoteToolsUpdate!!!!5   _onUpdateCustomizeElements!!!!3   _onUserValueWidgetOpening!!!!3   _onUserValueWidgetClosing!!!!+   _onSnippetSearchInput!!!!5   _onSnippetSearchResetClick!!    !!       !!   Class!!!!   Editor!!!!   globalSelector!!    ;      	               5 !!       C  E               $                k              *S   *S                                  	  
                      Q      Q     Q   
  Q     Q     Q   	  Q     QT  =    : W   QT  =   : 5      QQT  =   :    QT  =   :  
  QT  =   : W  QT  =   : 5     QT  =   :    Q   5	      Q5
    	  QQT  =   :   QT  =   : 5      Q5      Q5      Q5      QQV   5     QV   5     Q=      QV     
[$   =   ]   [   =   ]   ]      ]   	   ]   
   ]      ]      ]      ]      ]       ]!      ]"      ]#      ]$      ]%      ]&      ]'      ](      ])      ]*      ]+      ],      ]-      ].      ]/      ]0      ]1       ]2   !   ]   "   ]3   #   ]4   :   QV     
[-   =5   ]6   [%   =7   ]8   =9   ]:   =3   ];   =4   ]<   ]=   &   ]   '   ]!   (   ](   )   ]+   *   ]/   +   ]7   ,   ]9   :   QV     
[0   V  5>   5   D   Q=?   =@   ]   .   ]   /   ]7   :   QV     
[7   1   ]   2   ]%   3   ]'   4   ])   5   ]/   6   ]A   :   QV     
[?   =B   ]6   [8   =C   ]8   ]=   9   ]   :   ]   ;   ]*   <   ]-   =   ]/   >   ]C   :   QV     
[@   =D   ]6   :   QV     
[G   A   ]   B   ]!   C   ]"   D   ](   E   ]/   F   ]E   :   QV     
[N   =F   ]6   [H   =G   ]H   =I   ]J   =K   ]L   ]=   I   ]   J   ]/   K   ]G   L   ]I   M   ]K   :   QV     
[S   =M   ]6   O   ]   P   ]'   Q   ])   R   ]/   :   QV     
[d   V  5>   5   D   Q=?   =N   ]   O      
[T   V  5>   5   [U   =P   ]Q   =R   ]S   =T   ]U   =V   ]W   =X   ]Y   : ]   V   ]   W   ]   X   ]%   Y   ]'   Z   ])   [   ](   \   ]/   ]   ]Z   ^   ]P   _   ]R   `   ]T   a   ]V   b   ]X   c   ]C   :   QV     
[j   =5   ]6   [e   =[   ]8   ]=   f   ]   g   ]\   h   ]/   i   ][   :   QV     
[l   k   ][   :   QV     
[n   m   ][   :   QV     
[v   [o   =I   ]J   =]   ]^   =_   ]`   ]=   p   ]   q   ]   r   ]*   s   ]/   t   ]]   u   ]_   :   QV     
[{   =a   ]6   [w   =b   ]c   ]=   x   ]   y   ]/   z   ]b   :   QV     
[   V  5>   5   D   Q=?   =d   ]   e   f   
[|   V  5>   5=   [}   =g   ]h   : ]=   ~   ]      ]i      ]g      ]C   :   Q[   V  ]5   V  ]j   V  ]B   V  ]D   V  ]F   V  ]M   V  ]k   V  ]l   V  ]m   V  ]n   V  ]a   V  ]o      QV     
[   =p   ]6   [   =q   ]r   ]=   [   =s   ]   =t   ]u   ]   B]v   B]w      ]      ]      ]x      ]y      ]z      ]{      ]|      ]}      ]~      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]       ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]q      ]s      ]t   : 
  Q[   	  QV	  V
     
[      ]      ]y      ]{      ]      ]      ]      ]   : 0   QV	  V	  5      
[      ]   : 0   QV
     
[      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]   :   QV	  V     
[      ]      ]      ]      ]      ]      ]   : 0   QV	  V     
[      ]      ]      ]      ]      ]      ]      ]      ]   : 0   QV	  V
     
[      ]      ]      ]      ]      ]      ]      ]      ]      ]   : 0   QV	  V
     
[      ]      ]      ]      ]      ]      ]      ]   : 0   QV	  V
     
[      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]      ]   : 0   QV	  V
     
[  Z   =   `    ]      ]      ]     ]     ]     ]     ]     ]     ]     ]     ]   	  ]   
  ]     ]     ]   : 0   QV	  V	  5      
[    ]     ]z     ]   : 0   QV	  V
     
[  Z   =   `    ]     ]     ]y     ]     ]     ]   : 0   QV	  V
     
[  Z   =   `    ]     ]   : 0   QV	  V
     
[  Z   =   `    ]   C]v     ]   : 0   QV	  V
     
["    ]     ]     ]     ]      ]   !  ]   : 0   Q[#  V
  ]   V	  ]      ]   V  ]      ]   V  ]     ]     ]   
  ]     ]   	  ]   V
  ]   V	  ]   ;!<!,
 G+ #1    4   9  779*@&4 ,bOXKcCc / ! ..###  X ,W ! )  6S  ,;,K#" %I +I;  [kT   +_ 2  @H,# b/N' 2 + 9v1$ pLY! 9   >  -#  + >  o9SI-  ;   M  y&] 6GI  ]P& A   H 3& g` H; > >  ;22e qWE I a  1(  Z L   L9O@}  $  H,"&"-  ,2,, 5##;)< w  o   V     ]FQG3   il"82 t5  ~EAh Go6     K N <   ,   &7B       b-  5  yt  :) u  fX       82  T)    O 7  [ .    7  M F   }#.G   h5i   7##    5+   MII# #         k  ( I8)  q   c# 7    H  e  CK,f  .+ bP     4+ 1) r0wS  #a    ( 2(;%!+    web.core   web.Colorpicker#   ColorpickerWidget   web.Dialog   web.time   web.Widget/   web_editor.ColorPalette%   ColorPaletteWidget!   web_editor.utils   normalizeColor   getBgImageURL   wysiwyg.widgets7   web_editor.image_processing   loadImage   loadImageInfo%   applyModifications1   removeOnImageChangeAttrs	   qweb   _t   __NULL__   extend-   o_we_user_value_widget   className1   _onUserValueNotification#   user_value_update   custom_events	   init   willStart!   _makeDescriptive   start   destroy   close   findWidget   getActiveValue   getDefaultValue   getDependencies   getMethodsNames!   getMethodsParams   getName   getValue   isActive   isContainer   isPreviewed   loadMethodsData#   notifyValueChange	   open#   registerSubWidget   setValue!   toggleVisibility)   _handleNotifierEvent%   _onUserValueChange'   _onUserValuePreview#   _onUserValueReset   we-button   tagName   _onButtonClick   click'   _onInnerButtonClick+   click [role="button"]   mouseenter   mouseleave   events   prototype   -    o_we_checkbox_wrapper'   _getActiveSubWidget   we-select   _onClick   we-button-group   _floatToStr   we-input   _onInputInput   input input   _onInputBlur   blur input   _onInputKeydown   keydown input   we-multi-    o_we_so_color_palette   _)   _onCustomColorPicked'   custom_color_picked   _onColorPicked   color_picked   _onColorHovered   color_hover   _onColorLeft   color_leave   _onEnterKey7   enter_key_color_colorpicker'   _renderColorPalette   _onEditMedia   _openDialog/   _onDateTimePickerChange+   change.datetimepicker-   _onDateTimePickerError)   error.datetimepicker   we-range   _onInputChange   change input%    o_we_select_pager   Object   assign   _onPageChangeQ   click .o_we_pager_next, .o_we_pager_prev   _updatePage   we-checkbox   we-colorpicker#   we-datetimepicker   we-imagepicker   we-videopicker   we-select-pager1   we-customizeblock-option/   _onCollapseTogglerClick9   click .o_we_collapse_toggler%   _onUserValueUpdate5   _onUserValueWidgetCritical5   user_value_widget_critical   isTopOption'   forceNoDeleteButton   renderElement   onFocus   onBuilt   onBlur   onClone   onMove   onRemove   onTargetShow   onTargetHide   cleanForSave   selectClass'   selectDataAttribute   selectAttribute   selectStyle   $   closeWidgets   notify   setTarget   updateUI%   updateUIVisibilityA   _checkIfWidgetsUpdateNeedWarning?   _checkIfWidgetsUpdateNeedReload%   _computeVisibility'   _computeWidgetState1   _computeWidgetVisibilityA   _extraInfoFromDescriptionElement+   _normalizeWidgetValue1   _registerUserValueWidget)   _renderCustomWidgets!   _renderCustomXML%   _renderOriginalXML#   _renderXMLWidgets1   _requestUserValueWidgets   _rerenderXML   _select-   _selectAttributeHelper#   _toggleCollapseEl   _getSize   _onResize   sizing   sizing_y   selectWidth   setQuality   glFilter   customFilter/   _computeAvailableWidths   _applyOptions   _loadImageInfo%   _autoOptimizeImage   _getImg/   _computeMaxDisplayWidth   _onImageChanged   _onImageCropped   ImageOptimize)   _onBackgroundChanged%   BackgroundOptimize   toggleBgImage   toggleBgShape   toggleBgFilter;   _getLastPreFilterLayerElement   _hasBgFilter#   _onExternalUpdate#   BackgroundToggler   background   dynamicColor   _setBackground   BackgroundImage   shape   color   flipX   flipY   _flipShape'   _handlePreviewState   _markShape9   _getLastPreShapeLayerElement   _getShapeSrc   _getShapeData#   _getDefaultColors   _toggleShape   BackgroundShapeK   /web_editor/static/src/xml/editor.xml   xmlDependencies   backgroundType3   backgroundPositionOverlay   _initOverlay#   _dimensionOverlay!   _toggleBgOverlay'   _getBackgroundDelta-   _onDragBackgroundStart+   _onDragBackgroundMove%   _onDocumentClicked%   BackgroundPosition   _markColorLevel-   ColoredLevelBackgroundO   /web_editor/static/src/xml/snippets.xml   _clear   _findExisting   _selectRecord   many2one   VersionControl   saveSnippet   SnippetSave   DynamicSvg'   SnippetOptionWidget+   snippetOptionRegistry   NULL_ID   UserValueWidget1   userValueWidgetsRegistry'   UnitUserValueWidget9   addTitleAndAllowedAttributes   buildElement#   buildTitleElement   buildRowElement)   buildCollapseElement   Class   registry!!      require'   createPropertyProxy   weWidgets	   core   _t   Widget   _buildElement!   _buildRowElement!   _buildImgElement%   ColorPaletteWidget+   _buildCollapseElement%   _buildTitleElement	   qweb;   _addTitleAndAllowedAttributes      !!          Dialog1   userValueWidgetsRegistry%   ImageHandlerOption   loadImage)   InputUserValueWidget5   ButtonGroupUserValueWidget   normalizeColor   UserValueWidget;   DatetimePickerUserValueWidget   weUtils5   SelectPagerUserValueWidget'   UnitUserValueWidget1   removeOnImageChangeAttrs   loadImageInfo   registry'   SnippetOptionWidget   getBgImageURL	   time5   ColorpickerUserValueWidget)   MultiUserValueWidget+   ButtonUserValueWidget#   ColorpickerWidget5   VideopickerUserValueWidget   NULL_ID5   MediapickerUserValueWidget/   CheckboxUserValueWidget+   SelectUserValueWidget)   RangeUserValueWidget%   applyModifications5   ImagepickerUserValueWidget9   BaseSelectionUserValueWidget          +H!!       ;   _addTitleAndAllowedAttributes " $ " $            5 !!         _buildElement $ f% $ f%             5!!      %   _buildTitleElement % % g% %             5 !!      !   _buildImgElement  .         I                        "            & B' % B'                         Q      
=   :    
:  =   H            
  :            Q      
:             Q   5   A,  R     Q      
   =	   :    Q   
   
=   : >7         
=   :    Q     0   Q         $ %(E    split   .   pop   svg   window   fetch	   text   DOMParser   parseFromString   text/xml)   getElementsByTagName   document   createElement   img   src!!      src   .generator       !!          imgEl            !!         response	   text   parser   xmlDoc            +H;            @                                                   e      5!!      !   _buildRowElement \' Q( C' Q(      0          rowEl   D"  ( =(  ( =(             5 5!!      +   _buildCollapseElement p( * R( * 	     P          containerEl    D" * * * *             5 5!!      '   createPropertyProxy + , * ,      0          propertyName    value    B N+ + F+ +   W           5   B + + + +      !       55!!       !!#   user_value_update!!    !!       	   initC       
   $                                    , N- , N-         
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  T 0   QV  T 0   QV  Z    0   QV  =   0   QV  T 0	   Q  @!    _super	   next   value	   done   title   options#   _userValueWidgets      _value   $target!!      parent   title   options   $target   arguments   .this       +H;   ;   !          5 !!         willStart@           "                                   ( ^- - O- -   \             	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5   5   5   A           5   5   5   :          0   Q    _@!$3    _super	   next   value	   done   options   dataAttributes   img   imgEl!!      .generator   arguments   .this         +H;   K   !            5!!      !   _makeDescriptiveC          /                                    . / - /               	W   QW  Q    QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  QV  >7  Q  V  V  5   V  5    QV        
=   : 0	   QV  5
   #   V  5	      
V  5
    QV     
V  5	    QV   @! 
:!    _super	   next   value	   done   title   options   document   createElement   div   containerEl   imgEl   appendChild!!      arguments   .this         !!          $el   el          +H;   E   !                	         #       5 !!         start@  $        7                                 ( / 0 / 0                  	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5   5      
=   : r             Q  5   	   
=
      =   =   :  Q  5   	   
=      =   =   :  Q   <@!/  %M%N    _super	   next   value	   done   el   classList   contains!   o_we_img_animate   $el   on-   mouseenter.img_animate   png   gif-   mouseleave.img_animate!!      .generator   arguments   .this         !!       3   buildImgExtensionSwitcher            +H!!      3   buildImgExtensionSwitcherD# / +0 / +0      0          to    regex    D" / )0 / )0             5 5;   K   !         g         5 !!         destroy@                                                0 1 0 1        
       	W   QW  QV  5       V  5       
=    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)Q @!    $el   off   .img_animate   _super	   next   value	   done!!      arguments   .this         +H;   d   !   #       5 !!         closeC  S                                  	             )1 1 !1 1                 W   QV       
=    QV   5   5      
=    QV   5      
     Q--/7    trigger_up3   user_value_widget_closing   el   classList   remove%   o_we_widget_opened#   _userValueWidgets   forEach!!      .this         +H!!          close/<d" 1 1 1 1             5;5!!         findWidgetC w        V                                   1 2 1 2                W   Q  QV   5    -
  5   
@  m  QQ:   5      Q'  5     Q  QV     
:  T  H=   V  Q
Q
   IE
   Q@I   
:     QQQV     
T  :   QV  =   V  Q
Q
   IE
   Q@I   
:     QQQ]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B @@ C  P  ' 
    #   _userValueWidgets	   next	   done   value   getName   return   findWidget!!   	   name   .this       !!          widget          !!         depWidget          +H;       )          )       ?            C       T         ,   C        n     Z             ~   1                         1                  R       5 !!         getActiveValueC                                               2 2 2 2   %             W   QV   5    2    _value!!      methodName   .this       +H;       5 !!         getDefaultValueC G                                             2 b3 2 b3   _             W   Q  QV   5    5   T  7  QV  E   QV  >7D   Q=   kE-    _methodsParams+   optionsPossibleValues   !!      methodName   .this       !!          possibleValues          +H;      @       D                 5 !!         getDependenciesC           	                                      {3 3 s3 3                W   QV   5         _dependencies!!      .this         +H;       5 !!         getMethodsNamesC           	                                      3 3 3 3   5            W   QV   5     8    _methodsNames!!      .this         +H;       5 !!      !   getMethodsParamsC       	   !                        
           3 4 3 4   m            W   Q  Q       
[    V   5   :   QT  `   V  V  5   T  7D   QZ    0   QV  V      
T  : 0   QV  V      
T  : 0   QV   y!C     _   extend   _methodsParams+   optionsPossibleValues   possibleValues   getActiveValue   activeValue   getDefaultValue   defaultValue!!      methodName   .this       !!          params          +H!!            ;                       "       5!!         getNameC  #                                               5 )5 4 )5                 W   QV   5    5   D   Q=   #$    _methodsParams	   name   !!      .this         +H;       5 !!         getValueC          4                         	           ;5 6 35 6   Z             W   Q  QV       
:    QT   D   QV   5      
T  :  $   V     =      =   V     V      
T  : V      
T  : f	)( (!    isActive   _methodsNames   includes	   true      getActiveValue   getDefaultValue!!      methodName   .this       !!          isActive          +H;             e                                      2       5 !!         isActiveC  -                                               .6 \6 &6 \6   ;             W   QV   5    E   QV   5          I>*    _value!!      .this         +H;       5!!         isContainerC                                                     q6 6 i6 6   ~              B   !!              +H;       5 !!         isPreviewedC                                                6 W7 6 W7                W   Q  Q    5     QV  EI   QV  5   =   HE3   QV   5   V  HD   QV   5      
V  : 
   CV   5   5      
=   :   ;2+    document   activeElement   tagName   INPUT   el   contains   classList   o_we_preview!!      .this         !!          focusEl          +H;             r                        "       5!!         loadMethodsDataC                                \            p7 = h7 =                    Q   Z    0    Q         
[    T : 0   Q   5   [   0   Q   Z    0   Q   Z    0   Q   Z    0   Q   Q   5   5	   KB  m   Q     Q   5   5	   V   7
   
:    QV   =   H{      5      
Z    >V     
   : -
  5   
   m5   _,  ,  :   5    Q)Q  V   =   H{      5      
Z    >V     
   : -
  5   
   m5   _,  ,  :   5    Q)Q   V   =   H{      5      
Z    >V     
   : -
  5   
   m5   _,  ,  :   5    Q)Qz         
V   : L      5       
V    Q   5   5   V   V     
   : 9Q      5   V   V  9QQLMQN   5      
    Q   Q   5    -
  5   
   m   QQ:   5      Q   5      Q    Q   5   5   V   7  QV     
   :   Q   5   5   V   V  9Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B k-8 G"@!>@!E @!F /#@    P]'@*t      _methodsNames   _   extend   _methodsParams+   optionsPossibleValues   _dependencies)   _triggerWidgetsNames+   _triggerWidgetsValues   el   dataset	   trim   dependencies	   push   split	   next   value	   done   trigger   triggerValue   includes#   _userValueWidgets   forEach   filter   return!!   !   validMethodNames   extraParams   .this       !!          key           !!         dataValue          !!          methodName           !!         arr   uniqArr          +H!!            !!            !!   \s*,\s*   !!   \s*,\s*   !!   \s*,\s*   !!   \s*\|\s*   !!        #   loadMethodsData/<d" : < : <      `       5 !!      1   loadMethodsData/uniqArr<d" f= = f= =   )         5 ;	   #  !   	     !   	   /  !         I                 C       O  a      '        ~   g        1                 U  V      5!!      #   notifyValueChangeC       
   I                                    = ? = ?                    Q     Q   5        
         
:     QT   E   QV             
C Q[    T  D   QB]   T   ]     QT  CHD   QT  BH   V     0   Q%   T  =   H   V     0   Q      
=	   V   Q * ,=*    _methodsNames   length   isPreviewed#   notifyValueChange   previewMode!   isSimulatedEvent   prepare   reset   trigger_up#   user_value_update!!      previewMode!   isSimulatedEvent   .this       !!          isPreviewed	   data           +H!!       !!   previewMode!!!!!   isSimulatedEvent!!    !!       =   notifyValueChange/data.prepared"  ? =? ? =?             5 !!      =   notifyValueChange/data.prepared"  k? ? k? ?             5 ;             *          5!!      	   open@  9         	                                      ? '@ ? '@   0             W   QV       
=    QV   5   5      
=    Q3-,    trigger_up3   user_value_widget_opening   el   classList   add%   o_we_widget_opened!!      .this         +H;       5!!      #   registerSubWidgetC          	                                     B@ p@ :@ p@                W   QV   5       
T   Q  $ #   _userValueWidgets	   push!!      widget   .this       +H;       5 !!         setValue@ K                                             @ @ q@ @                    Q      Q      0    Q   5   5      
=    Q     )    _value   el   classList   remove   o_we_preview!!      value   methodName   .generator   .this       +H;   5 !!      !   toggleVisibilityC )                                              @ A @ A   N            W   QV   5    5      
=   T    Q U")    el   classList   toggle   d-none!!   	   show   .this       +H;       5!!      )   _handleNotifierEventC H          -                                      7A A /A A                T      CT  5       BT  C0    QT  5      T     
  QC       _seen   preventDefault!!      ev        +H;@       5 !!      %   _onUserValueChangeC /                                              A B A B   )             W   QV       
T  :    V      
B Q. )   _handleNotifierEvent#   notifyValueChange!!      ev   .this       +H;"       5 !!      1   _onUserValueNotificationC ;     
   5                                    :B ZC 2B ZC         	       W   QT  5    V   0   QT  5    5       T  5    Z    0   QT  5    5      
Z    >V   5   -
  5   
   m5   _,  ,  :   5    Q)QT  5    5       T  5    Z    0   QT  5    5      
Z    >V   5	   -
  5   
   m5   _,  ,  :   5    Q)Q  !@!?"@!A 	   data   widget'   triggerWidgetsNames	   push)   _triggerWidgetsNames	   next   value	   done)   triggerWidgetsValues+   _triggerWidgetsValues!!      ev   .this       +H;   }   !        !   2       5 !!      '   _onUserValuePreviewC /                                              wC C oC C !  _             W   QV       
T  :    V      
C Qd )   _handleNotifierEvent#   notifyValueChange!!      ev   .this       +H;"       5!!      #   _onUserValueResetC 3                                              C !D C !D !               W   QV       
T  :    V      
=    Q  ! )   _handleNotifierEvent#   notifyValueChange   reset!!      ev   .this       +H;"       5!!       !!   className!!!!   custom_events!!!!	   init!!!!   willStart!!!!!   _makeDescriptive!!!!   start!!!!   destroy!!!!   close!!!!   findWidget!!!!   getActiveValue!!!!   getDefaultValue!!!!   getDependencies!!!!   getMethodsNames!!!!!   getMethodsParams!!!!   getName!!!!   getValue!!!!   isActive!!!!   isContainer!!!!   isPreviewed!!!!   loadMethodsData!!!!#   notifyValueChange!!!!	   open!!!!#   registerSubWidget!!!!   setValue!!!!!   toggleVisibility!!!!)   _handleNotifierEvent!!!!%   _onUserValueChange!!!!1   _onUserValueNotification!!!!'   _onUserValuePreview!!!!#   _onUserValueReset!!    !!       !!   click!!!!+   click [role="button"]!!!!   mouseenter!!!!   mouseleave!!    !!          startC                                              E E E E !         	       	W   Q   Q   5    E   Q   5    5   &      5    5      
     Q      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) *@!    options   childNodes   forEach   _super	   next   value	   done!!      parent   title   options   arguments   .this      +H!!          start/<d" qE E qE E !  Y         5;      !   5 !!         getActiveValueC Q                                             E sF E sF "  :             W   Q  QV   5    5   T  7  QV  E   QV  V     ?7D   Q=   FEC    _methodsParams+   optionsPossibleValues   length   !!      methodName   .this       !!          possibleValues          +H;      J       N                 5!!         isActiveC  4                                               F F }F F "               W   QV       
:  V   5   5      
=   : I  &    isPreviewed   el   classList   contains   active!!      .this         +H;       5 !!         loadMethodsDataC -        7                                 " F G F G "  G            	W   QW  QV  5       
V  V   O Q  QV  5   -
  5   
   m  QQ:   5      Q   5     Q  QV  5   5   V  7  QV     ?   V  	   
=
    Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B,  Z@  "PL'E      _super   apply   _methodsNames	   next	   done   value   _methodsParams+   optionsPossibleValues   length   unshift      return!!   !   validMethodNames   arguments   .this       !!          methodName          !!         possibleValues          +H;                 C       v   P      N         (        |   E       C      5 !!         setValue@          H                                 ( G H G H "  =             	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q       Q  P     5      
  :             
  :   H   Q  5   5   	   
=
       Q    O " P@!)* #*    _super	   next   value	   done   _methodsNames   includes   getActiveValue   el   classList   toggle   active!!      value   methodName   .generator   arguments   .this       !!          active           +H;   P   !                               5 !!         _onButtonClickC )                                              H I H I $  C             W   QT  5        V      
T   QH '   _innerButtonClicked%   _onUserValueChange!!      ev   .this       +H;"       5 !!      '   _onInnerButtonClickC           	                                       7I YI /I YI $                T  C0    Q   '   _innerButtonClicked!!      ev        +H;       5!!    	   !!   tagName!!!!   events!!!!   start!!!!   getActiveValue!!!!   isActive!!!!   loadMethodsData!!!!   setValue!!!!   _onButtonClick!!!!'   _onInnerButtonClick!!    !!         startC        	                                        I J I J $  b            	W   QW  Q  Q       
=   :   QV  5      
V   QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) d&)@!    document   createElement   we-checkbox   containerEl   appendChild   _super	   next   value	   done!!      arguments   .this         !!          checkboxEl          +H;   r   !                                 5 !!         _onButtonClick@          %                                    J J J J $       
       	W   QW  QT  5       
=   :     V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) ,!@!    target   closest+   we-title, we-checkbox   _super	   next   value	   done!!      ev   arguments   .this       +H;   \   !   #       5 !!       !!   className!!!!   start!!!!   _onButtonClick!!    !!         start@          *                                   ( 8K 0L -K 0L %                 	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q         
=   : 0   Q   5   E   Q   5   5	   &      5   5	   
   
     Q   5      
   5    Q    %o@!-**    _super	   next   value	   done   document   createElement%   we-selection-items   menuEl   options   childNodes   forEach   containerEl   appendChild!!      .generator   arguments   .this         +H!!           start/<d" K L K L %           5;   K   !         5 !!      !   getMethodsParams@         ;                                   AL M 1L M &  <             	W   QW  Q    QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  QV     
:    QV      V        
V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)V  : H@! I3@!B    _super	   next   value	   done'   _getActiveSubWidget   Object   assign!   getMethodsParams!!      methodName   arguments   .this       !!          params   activeWidget          +H;   E   !   	      !                              
         #       5 !!         getValue@          (                                   M M M M '  S             	W   QW  Q  QV      
:    QV     V     
T  : V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)_!@! '   _getActiveSubWidget   getActiveValue   _super	   next   value	   done!!      methodName   arguments   .this       !!          activeWidget          +H;   s   !                B                        #       5!!         isContainer@                                                     M M M M (  .              C1 !!              +H;       5!!         setValue@ *     
                          >          ( M O M O (  M       	       	   Q   Q        Q  5       
  :    Q     5   -
  5   
   mQ:   5      Q   5      Q      
      :         Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp BC    Z    >  5   -
  5   
   m5   _,  ,  :   5    Q   
:  -
  5   
	  mQ:   5      Q   5      Q      
    :         Q   	   
:  ?   Q
Q
   IE
   Q@I   
:     QQQ   ]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B    Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q   _ (f@  P:(@!@ P  6" )@!    _super	   bind#   _userValueWidgets	   next	   done   value   setValue   return   reverse   isActive!!      value   methodName   .generator   arguments   .this       !!          _super            !!         widget            !!         widget            +H;                 C          >      d         Z  !         )                b  C                        !              C             0           C            D                  5 !!      '   _getActiveSubWidget@  Z                                              #O O O O *                W   Q  QV   5       
    :   QV     V  V   5       
   : 2:>7 #   _userValueWidgets	   find!!      .this         !!          previewedWidget          +H!!       I   _getActiveSubWidget/previewedWidget<d" XO tO XO tO *  e          5 !!      +   _getActiveSubWidget/<d" O O O O +  #          5;      S       :              W          5!!       !!   start!!!!!   getMethodsParams!!!!   getValue!!!!   isContainer!!!!   setValue!!!!'   _getActiveSubWidget!!    !!       !!   click!!    !!         start@  @        V                       L           ( cP R XP R +                	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q  5   E   Q  5   5   4     5      
  5   5     5    Q  	   
   
=   : 0   Q    5   5   5   D   QB0   Q  5           5   5      
=    Q	   
   
=   :    Q   5      
=   =     5    Q  5      
    Q  5      
  5     5    Q	   
   
=   :    Q   5      
=    Q  5      
    Q      +  @!'%&0-D5.    _super	   next   value	   done   options   valueEl   containerEl   insertBefore   menuEl   document   createElement   we-toggler   menuTogglerEl   el   dataset	   icon   classList   add!   o_we_icon_select   i   fa   fa-fw   appendChild	   span'   o_we_dropdown_caret!!      .generator   arguments   .this         !!          dropdownCaretEl            !!         iconEl            +H;   P   !         $     A  }             5 !!         closeC                                                R 6S R 6S -        
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  5   5      
=    Q  @!.    _super	   next   value	   done   menuTogglerEl   classList   remove   active!!      arguments   .this         +H;   ;   !          5!!         isPreviewedC                                                KS S CS S -  G     
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)D$   QV  5   5      
=   :  J@!0    _super	   next   value	   done   menuTogglerEl   classList   contains   active!!      arguments   .this         +H;   ;   !          5 !!      	   open@                                                S S S S -       
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  5   5      
=    Q @!+    _super	   next   value	   done   menuTogglerEl   classList   add   active!!      arguments   .this         +H;   ;   !          5!!         setValue@                                K           ( S yW S yW -                 	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q  5           5   '     5      
  Q  @0   Q=      Q  5   	   
    :    Q   @       5
      
=   :    Q  5
   5   5   D-   Q    E    Q  5
   5      
:     Q  5
   5   5      Q           Q      ?           
=   : 0   Q  5      0   QR        5
      
=   :    Q   !           
C: 0   Q   =      Q  5      0   Q  5   %     5      
  5    Q     - @!~ . N+-	+#
'
5"+8    _super	   next   value	   done	   icon#   menuTogglerItemEl   remove   #   _userValueWidgets	   find   el   querySelector   svg   dataset   selectLabel   textContent	   trim   img   document   createElement   src'   .o_we_fake_img_item   cloneNode   /   menuTogglerEl   appendChild!!      .generator   arguments   .this         !!          textContent   activeWidget           !!         svgTag   value   imgSrc            !!         fakeImgEl            +H!!       -   setValue/activeWidget<d" T U T U /  B          5 ;   P   !                              0           G            5 !!         _onClickC          5                                    W X W X 0                W   Q  QT  5       
=   : 
   V   5   5      
=   :     V      
  Q   V      
  QV   5	   
   
    :   QV  5   V   5   V  5   5   V   5   5   0   Q  &   117N    target   closest   [role="button"]   menuTogglerEl   classList   contains   active	   open   close#   _userValueWidgets	   find   menuEl   el   offsetTop   offsetHeight   scrollTop!!      ev   .this       !!          activeButton          +H!!      -   _onClick/activeButton<d" GX `X GX `X 2  /          5 ;             ,          5!!       !!   tagName!!!!   events!!!!   start!!!!   close!!!!   isPreviewed!!!!	   open!!!!   setValue!!!!   _onClick!!    !!       !!   tagName!!    !!          startE  	     
   -                                  ( oY Z aY Z 2  W             	   Q   Q        Q  5    5   5   D   Q=      Q  5    5      0   Q  5    5   5      H      5    5      0   Q     
Z    >  -
  5   
   m5   _,  ,  :   5	    Q)       Y 2 `)@!    el   dataset	   unit      saveUnit   undefined   _super	   next   value	   done!!      .generator   arguments   .this         !!       	   unit            +H;      !                             5 !!         getActiveValueC          =                                   3Z \ +Z \ 3         
       	W   Q   Q     Q      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  Q  5      Q   5       V       
T  B:    QV     
    :    
   : 	   
=
   : F@!  `'  
    _super	   next   value	   done   _methodsParams	   unit   getDefaultValue   split   map	   join    !!      methodName   arguments   .this      !!          activeValue   params   defaultValue          +H!!   \s+   !!       !   getActiveValue/<d" [ \ [ \ 4  _   0       5 ;   H   !                                        5 !!         getDefaultValueC G        K                                   -\ ] %\ ] 4  z            	W   QW  Q        QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  QV  5     QV  5       V  T    V  5      V  5     Q         
V  D   Q=   V  V  5	   V  5
   :   Q      V  :    V  V     
V  : V   @! - 54	S-	    _super	   next   value	   done   _methodsParams	   unit   saveUnit%   convertValueToUnit   0   cssProperty   $target   isNaN   _floatToStr!!      methodName   useInputUnit   arguments   .this       !!          defaultValue   params	   unit   numValue          +H;   M   !         :                    '             D         3       5 !!         isActiveC        
   1                                    ] }^ ] }^ 6  @             	W   QW  Q    QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  QV  5     QV  5       V  V  E1   QV     
      V  5   : : =	   IB@! F'0    _super	   next   value	   done   _methodsParams	   unit   _floatToStr   parseFloat   _value   0!!      arguments   .this         !!          isSuperActive   params          +H;   E   !                                        #       5!!         setValue@          %                                  ^ _ ~^ _ 7                    Q        Q  5       Q   5   ?        
=   :    
    :    
=   :   Q     
    :       h 7o%    _methodsParams	   unit   split       map	   join   _super!!      value   methodName   .generator   .this       !!          params            +H!!         setValue/value<d" ^ _ ^ _ 7             5 ;                          5!!         _floatToStrC                                                 _ ` _ ` 9  ;                      T     
: : C	    parseFloat   toFixed!!      value        +H;       5 !!       !!   start!!!!   getActiveValue!!!!   getDefaultValue!!!!   isActive!!!!   setValue!!!!   _floatToStr!!    !!       !!   input input!!!!   blur input!!!!   keydown input!!    !!          startE  1        `                       G           ( ` !c ` !c 9  4             	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q  5   5   5      Q        
=	   : 0
   Q  5
      
=   =    Q  5
      
=   =    Q  5
      
=     5      
=   : D   Q=    Q  5
   5      
=        Q  5
   5      
=         Q  5      
  5
    Q      
=   :   Q     0   Q  5      
   Q      %     5   5      
=    Q    6@!  )7(Q*1+3/%+    _super	   next   value	   done   el   dataset	   unit   document   createElement   input   inputEl   setAttribute	   type	   text   autocomplete   chrome-off   placeholder   getAttribute      classList   toggle   text-left   text-right   containerEl   appendChild	   span   textContent   length   add!   o_we_large_input!!      unitEl   .generator   arguments   .this         !!       	   unit            +H;   P   !                 5!!         setValue@                                              ( 0c sc "c sc 9               	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5      5   0   Q    @!    _super	   next   value	   done   inputEl   _value!!      .generator   arguments   .this         +H;   K   !         5 !!         _onInputInputC 1                                              c c c c 9              W   QV   V   5    5   0   QV      
T   Q     inputEl   value   _value'   _onUserValuePreview!!      ev   .this       +H;       5 !!         _onInputBlurC          
                                     c Nd c Nd 9                    Q             Q O    setTimeout!!      ev   .this       +H!!           _onInputBlur/<d"  c Kd c Kd 9  Z          5;5!!         _onInputKeydownC         k                         )           gd Pf _d Pf :  9      	       W   QT  5    x   5   5   5   HyC      5   5   5   Hy?      5   5   5   Hy#   zx  V      
T   Q`          QT  5     QV   5	     QV  5
    E   QV  5       
        V  5   D   QV  5   :   Q      V  :    >W  Q      V  5   :   Q      V  :    ?W  QV  T  5       5   5   5   H   V     V  "W  QV  V      
V  : 0   Q      V  :    
=    Q   >p xxx  :h`,a+(	a    which   $   ui   keyCode   ENTER   UP	   DOWN%   _onUserValueChange   currentTarget   _methodsParams	   unit	   step   parseFloat   value   placeholder   isNaN   _floatToStr   trigger   input!!      ev   .this       !!          value	   step   input   params         +H;      Z                             r       5!!       !!   tagName!!!!   events!!!!   start!!!!   setValue!!!!   _onInputInput!!!!   _onInputBlur!!!!   _onInputKeydown!!    !!         startC                                                f Cg f Cg >         	       	W   Q   Q   5    E   Q   5    5   &      5    5      
     Q      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  *@!    options   childNodes   forEach   _super	   next   value	   done!!      arguments   .this        +H!!           start/<d" f g f g >           5;      !   5 !!         getValueC       	                                       Ug g Mg g ?                	W   QW  Q  QV  5       
    :    
=   :    
:    QV  Da   QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)@J
@! #   _userValueWidgets   map	   join    	   trim   _super	   next   value	   done!!      methodName   arguments   .this      !!          value          +H!!          getValue/value<d" g g g g ?  h          5;      !                          5 !!         isContainerC                                                     h h g h ?                C   !!              +H;       5 !!         setValue@ P        R                      &           &h ri h ri ?                  Q        Q      
    :    Q      ?H          
   :    Q   >   Q f   m  5      7   
     
:  D   Q=     :         Q   #   QQ     5      ?  5     5      ?7   
      
=   :   :         Q     ?  fU+)G&    split   length#   _userValueWidgets   setValue   shift   	   join    !!      value   methodName   .generator   .this       !!          values           !!         i           +H!!   \s*\|\s*   !!   \s+   ;    r            ;     d                C  5 !!       !!   tagName!!!!   start!!!!   getValue!!!!   isContainer!!!!   setValue!!    !!            !!       !!'   custom_color_picked!!!!   color_picked!!!!   color_hover!!!!   color_leave!!!!7   enter_key_color_colorpicker!!    !!          startE  U        :                       '           ( k Ul k Ul A               	   Q   Q        Q  5       
  :    Q     Q     
:          Q        
=   : 0   Q  5   5      
=	    Q  5
   Z     5   5   `    0   Q  5
     5   0   Q   Z    >   -
  5   
   m5   _,  ,  :   5    Q)       8)@!    _super	   bind'   _renderColorPalette   document   createElement	   span   colorPreviewEl   classList   add%   o_we_color_preview   options   colorPalette   el   childNodes   valueEl	   next   value	   done!!      .generator   arguments   .this         !!          _super	   args            +H;     !         9      E            i   5 !!         closeC           "                                     dl m \l m A  W     
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  5   E   QV  5   V  5   I3   V  V  5   0   QV  B0   QV     
  Q Z@!A#    _super	   next   value	   done#   _customColorValue   _value%   _onUserValueChange!!      arguments   .this         +H;   ;   !   #       5!!      !   getMethodsParamsC        	                                        8m m 0m m A  +            	W   QW  Q       
V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)[    V  5      
:  ]   :  .@!T    _   extend   _super	   next   value	   done   colorPalette   getColorNames   colorNames!!      arguments   .this         +H!!       !!   colorNames!!    ;	   G   !          5 !!         getValueC         d                                   m o m o A              	W   QW  Q  QV  5    =   H   V  5    V  5   =   H   V  5   V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  QV         QV  5   5   	   
=
   :   QV  5   5   	   
=   :   QV  D   QV  E    Q         
V  :  I   V  (            
V  : W  Q   =   V  =   W  QV   & B* C@!	@<!%)    _previewColor   string#   _customColorValue   _super	   next   value	   done   options   dataAttributes   hasOwnProperty   useCssColor   cssCompatible   isCSSColor'   getCSSVariableValue   var(--   )!!      methodName   arguments   .this       !!          value         !!         useCssColor   cssCompatible          +H;      !               3              V                                    s       5!!         isContainerC                                                     o o o o D  #              B& !!              +H;       5!!         isActiveC  +         
                                      o ?p o ?p D  F             W   Q          
V   5   =   :  I: #   areCssValuesEqual   _value!   rgba(0, 0, 0, 0)!!      .this         +H;       5 !!         setValue@ J        h                       G          ( Np {r @p {r D                	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q     
:          Q       
  5      
:  :    Q  5   5	   
   
Z    >   -
  5   
   m5   _,  ,  :   5    Q)Q  5   5      
=    Q  5             
  5   : *     5   5     5   0   Q        
  5   : ;     5   5	      
=   =     5    Q1     5   5	      
=     5    Q     @!!$?%@!1=+<-0E(9    _super	   next   value	   done'   _renderColorPalette'   computeColorClasses   colorPalette   getColorNames   colorPreviewEl   classList   remove   style   removeProperty!   background-color   _value   isCSSColor   backgroundColor-   isColorCombinationName   add	   o_cc   bg-!!      color   .generator   arguments   .this       !!          classes            +H;   P   !        !         .           5!!      '   _renderColorPaletteC  M        J                        "             r t r t D                W   Q     Q[    V   5    ]     QV   5   5   5   F   V  V   5   5   5      
   =   :    
=   : 0   QV   5   5   5	   %   V  V   5   5   5	     0	   QV   5
      QV     AV   V  ,  R 0
   Q   6   V   5
      
   5   :    
   : V   5
      
      
:  :  	)61"%2E">    _value   selectedColor   options   dataAttributes   excluded   replace      split   ,!   withCombinations   colorPalette   insertAfter   el	   then   appendTo   document-   createDocumentFragment!!      .this         !!          options   oldColorPalette          +H!!       !!   selectedColor!!    !!       !!      +   _renderColorPalette/<d"  ot t ot t F            5;      A      $             J         5!!      )   _onCustomColorPickedC                                               t "u t "u G  d             W   QV   T  5    5   0   Qi% 	   data   color#   _customColorValue!!      ev   .this       +H;       5!!         _onColorPickedC F                                              :u u 2u u G               W   QV   B0    QV   B0   QV   T  5   5   0   QV      
T   Q      _previewColor#   _customColorValue	   data   color   _value%   _onUserValueChange!!      ev   .this       +H;       5 !!         _onColorHoveredC 0                                              u 	v u 	v G  2            W   QV   T  5    5   0   QV      
T   Q 7! 	   data   color   _previewColor'   _onUserValuePreview!!      ev   .this       +H;       5!!         _onColorLeftC $                                              v Yv v Yv G              W   QV   B0    QV      
T   Q     _previewColor#   _onUserValueReset!!      ev   .this       +H;       5!!         _onEnterKeyC           	                                      nv v fv v G              W   QV       
  Q     close!!      .this         +H;       5!!         _onClickC                                              v v v v G       
       	W   QW  QT  5    5    a   V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QT     
  Q (@!    originalEvent)   __isColorpickerClick   _super	   next   value	   done   stopPropagation!!      ev   arguments   .this       +H;   O   !   #       5 !!       !!   className!!!!   custom_events!!!!   start!!!!   close!!!!!   getMethodsParams!!!!   getValue!!!!   isContainer!!!!   isActive!!!!   setValue!!!!'   _renderColorPalette!!!!)   _onCustomColorPicked!!!!   _onColorPicked!!!!   _onColorHovered!!!!   _onColorLeft!!!!   _onEnterKey!!!!   _onClick!!    !!       !!   click!!    !!          start@          A                       +           ( pw x ew x H                	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q      
=   :    Q  5   5   5	   /      5
      
=   =   =    Ql      5
      
=   =   =   =    Q  5   5
      
=    Q  5     =   : 0   Q        5   :    
    Q      H  @! ,57(    _super	   next   value	   done   document   createElement   i   options   dataAttributes   buttonStyle   classList   add   fa   fa-fw   fa-camera   fa-refresh	   mr-1   el   o_we_no_toggle   containerEl   Replace media   textContent   $   prepend!!      .generator   arguments   .this         !!          iconEl            +H;   P   !         i        5!!         _openDialog@          A                                   x 5z x 5z I  1                    QW  QT     QT 5    H   QB  Q5   H   QB  QQ    QV   V  5   0   QV  5      
=   :   Q  5   AV  [    V   ]   V   ]	   C]
   C]   C]   V     
=   : ]   V     
=   : ]   V   ,  R    
:    QV  Q
*,			^      images   videos   _value   src   $target   closest   .o_editable   MediaDialog   noImages   noVideos   noIcons   noDocuments   isForBgVideo	   data   oe-model   res_model   oe-id   res_id	   open!!      el    images   videos   .this      !!          $editable   mediaDialog          +H!!       !!   noImages!!!!   noVideos!!!!   noIcons!!!!   noDocuments!!!!   isForBgVideo!!!!   res_model!!!!   res_id!!    ;   O                   "       5!!         setValue@        	   "                                   ( Dz z 6z z I               	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5   5      
=         
:   Q    @!"3    _super	   next   value	   done   el   classList   toggle   active   isActive!!      .generator   arguments   .this         +H;   K   !         5 !!         _onEditMediaC                                                   z z z z I                  !!      ev        +H;       5 !!       !!   tagName!!!!   events!!!!   start!!!!   _openDialog!!!!   setValue!!!!   _onEditMedia!!    !!          _onEditMedia@ q                                 
            { { z { I                   Q      Q       
=   :    Q     
   [    C]   :    QV      
=         Q `$!(b    document   createElement   img   _openDialog   images   on	   save!!      ev   .this       !!          dummyEl   dialog           +H!!       !!   images!!    !!          _onEditMedia/<d" { { { { I           5 ;      d   5!!       !!   _onEditMedia!!    !!         _onEditMedia@ n                                 	            (| | | | I                   Q     Q       
=   :    Q      
V   [    C]   :   QV     
=          Q }'!(V    document   createElement   iframe   _openDialog   videos   on	   save!!      ev   .this       !!          dummyEl   dialog           +H!!       !!   videos!!    !!          _onEditMedia/<d" | | | | I           5 ;      f   5!!       !!   _onEditMedia!!    !!       !!   blur input!!!!+   change.datetimepicker!!!!)   error.datetimepicker!!    !!       	   initC        	   $                                     } ~ } ~ I       
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV        :     
:     
:  0   QV  >0   Q @!	    _super	   next   value	   done   moment	   unix   toString   _value   __libInput!!      arguments   .this         +H;   ;   !          5 !!         startE       *                         E           ( .~   ~  I                 	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q      
=   :    Q  5   5   	   
=
    Q  5   5   	   
=   =   =    Q  5      
=       Q  5      
=   =       Q[         [    ?]   : ]         :  	   
X =   : ]   C]         :     
:  ]   [   =   ]   ]         
:  ]   
  
     
:  ]   C]   [   C]    C]!   ]"   =#   ]$   C]%      Q  5&   #
0&   QQ'   '     5   :    Q      
    Q  5&   #
0&   QQ   (   
=   :    Q   5)      Q      0)   Q    @! *F1D				*
$      _super	   next   value	   done   _   uniqueId   datetimepicker   el   classList   add!   o_we_large_input   inputEl)   datetimepicker-input	   mx-0   text-left   setAttribute   id   data-target   #   moment   y   minDate   maxDate   calendarWeeks   format   defaultDate'   fa fa-check primary   close   icons   locale+   getLangDatetimeFormat   sideBySide   showClose   showToday   buttons	   body   widgetParent!   allowInputToggle   __libInput   $	   data   _getTemplate!!      .generator   arguments   .this         !!       !   datetimePickerId%   datepickersOptions   $input   libObject   oldFunc            +H!!       !!   y!!    !!       !!   close!!    !!       !!   showClose!!!!   showToday!!    !!       !!   minDate!!!!   maxDate!!!!   calendarWeeks!!!!   defaultDate!!!!   icons!!!!   locale!!!!   format!!!!   sideBySide!!!!   buttons!!!!   widgetParent!!!!!   allowInputToggle!!    !!       9   start/libObject._getTemplateb    }  I           5 ;   P   !                 5 !!         isPreviewedC        	   !                                      q  q I  l	     
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)D3   Q      V  5   :    
=   : 5      	o@!    _super	   next   value	   done   $   inputEl	   data   datetimepicker   widget!!      arguments   .this         +H;   ;   !          5 !!         setValue@  >        A                       !           (  N r N I  	             	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q      
  5   :    Q      
:            :     Q  5   #
0   QQ	   	     5
   :    
=       Q  5   #
0   QQ    	 I 	@!

!    _super	   next   value	   done   moment	   unix   _value   isValid   __libInput   $   inputEl   datetimepicker	   date!!      .generator   arguments   .this         !!          momentObj           +H;   P   !         "        5 !!      /   _onDateTimePickerChangeC          /                                     o  g  J  w             W   QV   5    >   T  5    D   QT  5      
:      V   T  5      
:     
:  0   QV      
T   Q|C K
C    __libInput	   date   isValid	   unix   toString   _value'   _onUserValuePreview!!      ev   .this       +H;2       5!!      -   _onDateTimePickerErrorC                                                 ! <  < L  d              T      
  Qi    stopPropagation!!      ev        +H;       5!!       !!   events!!!!	   init!!!!   start!!!!   isPreviewed!!!!   setValue!!!!/   _onDateTimePickerChange!!!!-   _onDateTimePickerError!!    !!       !!   change input!!    !!          start@  >        h                       Y           (     L               	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q        
=   : 0   Q  5   =   0   Q  5	   5
   5   E(   Q        5	   5
   5   : D   Q>   Q  5	   5
   5   E(   Q        5	   5
   5   : D	   Qd   Q  5	   5
   5   E(   Q        5	   5
   5   : D   Q?   Q        Z      `       `   -
  5   
BQ,  ,  :   5      Q   5      Q   C0   ,  ,  :   5      Q   5      Q   QQ1   
Q   IE
   Q@I   
:     QQQ  5   5      
=    Q  5      
=       Q  5      
=       Q  5      
=       Q  5      
  5    Q     L @! '+$##%)    _super	   next   value	   done   document   createElement   input   range	   type   el   dataset   min   parseFloat   max	   step   return   classList   add'   o_we_inverted_range   setAttribute   containerEl   appendChild!!      .generator   arguments   .this         !!          min   max	   step           +H;   P   !              W           "        5!!         setValue@                                            (  3  3 M                	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5      5   0   Q     @!    _super	   next   value	   done   input   _value!!      value   methodName   .generator   arguments   .this       +H;   K   !         5!!         _onInputChange@ 0                                              B  4  M              W   QV   T  5    5   0   QV      
T   Q 	    target   value   _value%   _onUserValueChange!!      ev   .this       +H;       5 !!       !!   tagName!!!!   events!!!!   start!!!!   setValue!!!!   _onInputChange!!    !!            !!       !!Q   click .o_we_pager_next, .o_we_pager_prev!!    !!         start@       #   v                      d           (  k  k M                 	   Q   Q        Q  5       
  :    Q    5   5      
    : 0   Q    5      0   Q   	   
=
   :    Q   5      
=   =   =    Q     	   
=   : 0   Q  >0   Q   	   
=
   :    Q   5      
=   =   =    Q   	   
=   :    Q   5      
=    Q      
    Q      
  5    Q      
    Q     	   
=   : 0   Q   	   
=   :    Q   5      
=    Q      
  5    Q      
    Q   Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q  5   5      
=    Q          5   : !   
    Q  "   
  Q    _S&=D3 ( "/''@!,    _super	   bind   options   childNodes   filter   pages   length   numPages   document   createElement   i   classList   add   o_we_pager_prev   fa   fa-chevron-left	   span   pageNum   currentPage   o_we_pager_next!   fa-chevron-right   div'   o_we_pager_controls   appendChild   b   pageName#   o_we_pager_header	   next   value	   done   menuEl   o_we_has_pager   $   prepend   _updatePage!!      .generator   arguments   .this         !!          _super	   prev	   next   pagerControls   pagerHeader            +H!!      #   start/this.pages<d"     M           5;   N  !                5 !!         _updatePage@                                                 w  l  M                   Q   Q   5       
     Q   5      5   ?=      5   0   Q   5       
   :    Q   5   V   	   
=
   : 0   Q ;S0"    pages   forEach   pageNum   currentPage   /   numPages   textContent	   find   pageName   getAttribute   string!!      .this         !!          activePage           +H!!          _updatePage/<d"     M  O         5!!      /   _updatePage/activePage<d" 2 P 2 P M           5;         5!!         _onPageChange@                                               \  \ M  _            W   Q  QT      
  QT     
  QT  5      
=   :    ?     QV   V   5   V   5   V  V   5   0   QV      
  Q c+F    preventDefault   stopPropagation   target   matches!   .o_we_pager_next   currentPage   numPages   _updatePage!!      ev   .this       !!          delta          +H;                5 !!         _onClick@          5                                   e c ] c M  '            	W   QW  Q  QV      
:    QV  h     QV  5      
V  5      
=   : :   QV  I#   V  V  0   QV     
  QV     
Z    >V   -
  5	   
   m5
   _,  ,  :   5    Q) +>@! '   _getActiveSubWidget   pages   indexOf   el   closest   we-select-page   currentPage   _updatePage   _super	   next   value	   done!!      ev   arguments   .this       !!          activeButton          !!         currentPage          +H;      !               /   b                     3       5 !!       !!   className!!!!   events!!!!   start!!!!   _updatePage!!!!   _onPageChange!!!!   _onClick!!    !!       !!   we-button!!!!   we-checkbox!!!!   we-select!!!!   we-button-group!!!!   we-input!!!!   we-multi!!!!   we-colorpicker!!!!#   we-datetimepicker!!!!   we-imagepicker!!!!   we-videopicker!!!!   we-range!!!!   we-select-pager!!    !!       !!9   click .o_we_collapse_toggler!!    !!       !!#   user_value_update!!!!5   user_value_widget_critical!!    !!       	   initC          (                          
         "     N  ^            	W   QW  QV  5       
V  V   O QV  T 0   QV  T 0   QV  T 0   QV  T 0   QV  T 0   QV  =   V  5   5   0	   QV  V  5   >75
   0
   QV  Z    0   QV     A,  R  0   Q "%61
    _super   apply'   $originalUIElements   $target   $overlay	   data   options   snippet-option-   optionName   className   ownerDocument#   _userValueWidgets   Map   _actionQueues!!      parent   $uiElements   $target   $overlay	   data   options   arguments   .this       +H;      5!!         willStartE                                             ( !    N                 	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q      
:     
    :        @!0    _super	   next   value	   done%   _renderOriginalXML	   then!!      .generator   arguments   .this         +H!!           willStart/<d" j  j  N  )         5;   K   !         5 !!         renderElementC                                                    N  l     
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  5      
V  5    QV  @0   Q o@!%    _super	   next   value	   done   el   appendChild   uiFragment!!      arguments   .this         +H;   ;   !          5!!         onFocusC                                                         N                  !!              +H;       5 !!         onBuiltC                                                     + / # / N                  !!              +H;       5 !!         onBlurC                                                     ? C 7 C N                  !!              +H;       5!!         onCloneC                                                   T _ L _ N                  !!      options        +H;       5 !!         onMoveC                                                     o s g s N  .               1 !!              +H;       5!!         onRemoveC                                                       }  N  D               G !!              +H;       5!!         onTargetShowE                                                       N  d                   Q    g !!      .generator         +H;
   5 !!         onTargetHideE                                                       N                     Q     !!      .generator         +H;
   5 !!         cleanForSaveE                                                       N                     Q     !!      .generator         +H;
   5 !!         selectClassC         V                       '               N              W   Q  QT 5    -
  5   
  m  QQ:   5      Q  5     QV     V   5   >75      
Z    >V     
:     
    : -
  5   
   m5   _,  ,  :   5    Q)Q]   v,  IM   ,  	   IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B T    V   5   >75   
   
Z    >T    
:     
   : -
  5   
   m5   _,  ,  :   5    Q)Q@  P  +!@!@!*    possibleValues	   next	   done   value   $target   classList   remove	   trim   split   return   add!!      previewMode   widgetValue   params   .this       !!          classNames          +H!!   \s+   !!   \s+   ;
      !                   C       S         +          !         I  R       5!!      '   selectDataAttributeC E                                                 O  r             W   Q  QV       
T T :   QV   5   >75   T 5   V  9Q  04 -   _selectAttributeHelper   $target   dataset   attributeName!!      previewMode   widgetValue   params   .this       !!          value          +H;      >          5!!         selectAttributeC I                                              Y  Y O              W   Q  QV       
T T :   QV   5   >7   
T 5   V   Q =0) -   _selectAttributeHelper   $target   setAttribute   attributeName!!      previewMode   widgetValue   params   .this       !!          value          +H;      B          5 !!         selectStyleC      )   4               
                  n  f  O      
             Q            Q    W   Q   5    >75      
=    Q     QT 5   =   H#      5       
=   T   Q    5   T 5   7D   QZ   T 5   `      Q  QV  -
  5	   
   m  QQ:   5
      Q   5     Q   5    >75      
V  =    Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp BL T 5   #      5       
T 5    QT 5   E   QT 5       Q       
T 5   T 5   :   Q   5    >75      
Z    >V  -
  5	   
   m5   _,  ,  :   5
    Q)Q     
T : G      5    >75      
=   =   T T 5    QV    QT 5      
T :      	  Q      
   5    >7: V  >77  QT 5   T 	  Q   5    >75      
V	   QV        
   5    >7: V  >77I2      5       
T 5    QV    Q   5    >75      
V	   Q       
T :   QV     =   T =   U QT    
   =    : !   
   :   Qv   mV  "   FF            V  #   
V  >7 Q@   V  #   
V  ?7 Q%   V  #   
V  V  "   ?7 QV  "   V  "   z      
   5    >7:   QB  Q  QV  "   ?  Q S   mV   $   
   V  V  7V  %   
:  V  l D   QV  W  QV  #W  QQV  >V   $   
   V  >7V  &   
='   : V  l D   QV  W  QT 5   '      5    (   
T 5   V   QV    Q &U,6@  P,)B!@!-,3 ] S(<)7) ] T) (  3hf%``	 VA- SE[,,    $target   classList   add1   o_we_force_no_transition   cssProperty!   background-color   trigger-   background-color-event   CSS_SHORTHANDS	   next	   done   value   style   setProperty      return   extraClass   removeClass   colorNames   colorPrefix'   computeColorClasses   remove-   isColorCombinationName	   o_cc   includes   window!   getComputedStyle   addClass'   getCSSVariableValue   var(--   )   replace   ,   split   length	   push	   call   pop	   join       toggleClass!!      previewMode   widgetValue   params   applyCSS   .this      !!          hasUserValue'   _restoreTransitions   cssProps   htmlPropValue   values   styles         !!         cssProp          !!         classes          !!      !   originalCSSValue   className       
   !!         i         +H!!          applyCSS     Z  d   "       5!!      '   _restoreTransitionsD#   #  # O  >         5!!   ,\s   !!   \s+   ;    j         K  C       	  0               T  !       A           [                                                                                                            y       [  [  v  5 !!         $C  3         	                                       ?  ? ]  "             	W   QW  QV  5    5      
V  5    V   O %0    $target	   find   apply!!      arguments   .this         +H;       5!!         closeWidgetsC  !                                               U  M  ]                W   QV   5       
     Qv7 #   _userValueWidgets   forEach!!      .this         +H!!           closeWidgets/<d" w  w  ]            5 ;5!!         findWidgetC w        V                                    Z  Z ]               W   Q  QV   5    -
  5   
@  m  QQ:   5      Q'  5     Q  QV     
:  T  H=   V  Q
Q
   IE
   Q@I   
:     QQQV     
T  :   QV  =   V  Q
Q
   IE
   Q@I   
:     QQQ]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B @@ C  P  ' ^
 ]   #   _userValueWidgets	   next	   done   value   getName   return   findWidget!!   	   name   .this       !!          widget          !!         depWidget          +H;       )          )       ?            C       T         ,   C        n     Z             ~   1                         1                  R       5 !!         notifyC )         
                                     j  b  _               W   QT  =    H   V      
T  Q)    target   setTarget!!   	   name	   data   .this       +H;"       5!!         setTargetC                                                    _  g             W   QV   T  0    Qq    $target!!      $target   .this       +H;       5 !!         updateUIE           3                                       _                    QT  H   Q[    5       QQ           Q  5      
   :    Q      
   :         Q   )        
:          Q     _  n    noVisibility#   _userValueWidgets   map   Promise   all%   updateUIVisibility!!       noVisibility   .generator   .this      !!                !!         proms            +H!!            !!         updateUI/proms<d" - A ' A _     d       5 ;   -      2          <         5!!      %   updateUIVisibilityE                                \                b          	          Q        Q  5       
    :    Q     
:             Q  5   5      
=        Q      
   :         Q     5	   
   
=   : -
  5   
   mQ:   5      Q   5      Q   5      
=            : 
   
=   :    
=   :      Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B%      5	   
   
=   : -
  5   
{  mQ:   5      Qg  5      Q           :    Q  5      
=         
:     
:     
=   :  Q      
:     
:     
:     
=   :        Q           
  B Q     
=   : 5      
=       Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B       i b   g ["+#@  PX%(@ ~P  )N!5 hd #   _userValueWidgets   map%   _computeVisibility   el   classList   toggle   d-none   Promise   all   $el	   find   we-row	   next	   done   value   $?   > div > .o_we_user_value_widget   not   .d-none   length   return   we-collapse   children   first   hasClass	   last#   _toggleCollapseEl   querySelector-   .o_we_collapse_toggler!!      .generator   .this         !!          proms   showUI            !!         el            !!         el            !!         $el9   hasNoVisibleElInCollapseMenu            +H!!       3   updateUIVisibility/proms<d"     b    d          params    obj   D"     e  $   4       !   dependenciesData    D" q M q M f  [   0       5    D"     g            5 55;             t  C         \                K         ,  C                  ~        u                            ,           Y      5!!      A   _checkIfWidgetsUpdateNeedWarning@ 9      	   D                                    ~  ~ i         	               QZ       Q     -
  5    
   mQ:   5      Q   5      Q        
:  5      Q           
    Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B4       
=   :          i  @  PI& 	   next	   done   value!   getMethodsParams   warnMessage	   push   return	   join    !!      widgets   .generator       !!          messages            !!         widget            !!         message            +H;                 C       `   M      =            +     !             l   <          )            5 !!      ?   _checkIfWidgetsUpdateNeedReload@                                                     j  A                    QB      K !!      widgets   .generator       +H;
   5 !!      %   _computeVisibilityE                                                       j  {                    QC      ~ !!      .generator         +H;
   5!!      '   _computeWidgetStateE D     %                                       j          	          Q      Q   x=    Hy2   =   Hyf   =   HyY   =   Hy{  z     >   Q=      Q  5      
     Q           5      Q   Q  =   H,     5   >7	   
   :    Q4     =   H#     5   >75
      7   Q   D   Q=      
:     Q  5   E   Q  5    ?         
   :    
   :    
=   :    Q   D   Q  5   D   Q=           5   E   Q  5   a       5   -
  5   
-  mQ:   5      Q  5      Q          
Z     `      5   : >7   Q  5   >75      
   : D     Q
Q
   IE
   Q@I   
:     QQQ   ]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B   5   >75      
=    Q      Q      
  5   >7:    Q    5      5!   7D   QZ     5!   `       Q      
   :    Q   "   HE>   Q    #   
   7   ?7  5!     5   :       $   
  Q   "   HE>   Q    #   
   7   >7  5!     5   :       $   
  Q   "   HE=   Q    #   
   ?7   >7  5!     5   :       $   
  Q     Q      
=   :        t j  u "xxxx %   t3 l0"
#'
 t3 o@ 0*P  '7 t3 oL&[/6
VVV    selectClass   selectAttribute'   selectDataAttribute   selectStyle      possibleValues   forEach   attributeName   $target   getAttribute   dataset	   trim   saveUnit   withUnit   split   map	   join    +   attributeDefaultValue   colorPrefix   colorNames	   next	   done   value'   computeColorClasses   classList   contains   return   add1   o_we_force_no_transition   window!   getComputedStyle   CSS_SHORTHANDS   cssProperty   length#   areCssValuesEqual   pop!!      methodName   params   .generator   .this       !!          maxNbClasses!   activeClassNames           !!          attrValue   attrName           !!       '   _restoreTransitions   styles   cssProps   cssValues            !!         c            !!         className            +H!!       +   _computeWidgetState/<d"     j  1  0         D"  H  H k  V          5 5!!   \s+   !!       =   _computeWidgetState/attrValue<d"   4   4 m  m          5 !!      '   _restoreTransitionsD#      p  T          5!!      =   _computeWidgetState/cssValues<d"     p  8            D" d v d v p           5 5;      )                  C       3          0     X   ;                       )                   r       V        ?             7                                 3           5 !!      1   _computeWidgetVisibilityE          2                                        t  \                 Q      Q   =    HD   Q   =   H'      5      
=   :        =   HD   Q   =   H'      5      
=   :     C       tp= u@    move_up_opt   move_left_opt   $target   is   :first-child   move_down_opt   move_right_opt   :last-child!!      widgetName   params   .generator   .this       +H;   5!!      A   _extraInfoFromDescriptionElementC           $                                        v  7              [   T      
=   : ]   [    T  5   ]   T  5   ]   T  5   ]   T      
=   : ]   Z    >T  5	   -
  5
   
   m5   _,  ,  :   5    Q]	   ]   <	@!    getAttribute   string   title   classList   classes   dataset   dataAttributes   tooltip   placeholder   childNodes	   next   value	   done   options!!      el        +H!!       !!   classes!!!!   dataAttributes!!!!   tooltip!!!!   placeholder!!!!   childNodes!!    !!       !!   title!!!!   options!!    ;      !          5 !!      +   _normalizeWidgetValueC 2                                                 '  ' v               T      
:  U  Q         
T  : U  QT   !	+ 	   trim#   normalizeCSSColor!!      value        +H;       5 !!      1   _registerUserValueWidgetC                                   	           I ; A ; v       	       W   Q  Q      T  7AT T T V   5    ,  R   QT  D   QT V   H#   V   5      
V   Q   T    
V   QV   L*    $target#   _userValueWidgets	   push#   registerSubWidget!!      widgetName   parent   title   options   .this       !!          widget          +H;                       2       5 !!      )   _renderCustomWidgetsC                                                 Y  Q  w  -                     
:  :    Promise   resolve!!      uiFragment        +H;       5 !!      !   _renderCustomXMLC                                                     w  n                     
:  {    Promise   resolve!!      uiFragment        +H;       5 !!      %   _renderOriginalXMLE J                              F               w          	          Q        Q       
:     Q  D   Q  5      
C:    
    Q     
   :         Q   Z   Z   =   `      `   `    Z   =   `    	  `   `   -
  5   
r  mQ:   5	      Q^  5
   -
  5   
BQ,  ,  :   5	      Q   5
      Q   C0   ,  ,  :   5	      Q   5
      Q   QQ1   
Q   IE
   Q@I   
:     QQQ     
   :    
     Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B      
   :         Q     
   :         Q     
:           Z       Q     K"   m        
    QQLMQN  5      
    Q            w  # >	@ uP  W&#&f y8'T    document-   createDocumentFragment'   $originalUIElements   clone   appendTo!   _renderCustomXML   we-row   we-collapse	   next	   done   value   return!   querySelectorAll   forEach#   _renderXMLWidgets)   _renderCustomWidgets   isDestroyed	   push#   _userValueWidgets!!   	   $xml   .generator   .this       !!          uiFragment!   validMethodNames            !!         itemName   build            !!         key            +H!!       )   _renderOriginalXML/<d"     w           5 !!      )   _renderOriginalXML/<d"     z            5 ;   H                 )         
  C                  u       )         5                                7           :                   5 !!      #   _renderXMLWidgetsC                                              7  7 z                   Q   QZ    >   5    -
  5   
   m5   _,  ,  :   5    Q   
    :    Q      
V   :   @! +    children	   next   value	   done   map   Promise   all!!      parentEl   parentWidget   .this       !!          proms           +H!!       1   _renderXMLWidgets/proms<d" X  X  z     @          el    widget   D"      {             55;   7   !                          5 !!      1   _requestUserValueWidgetsC 7     	   C                                   Y E Q E {                W   QU  Q  QZ      Q  QT  -
  5    
   m  QQ:   5      Q   5     Q   @   QV      
=   [   V  ]       ]    Q      V     
    Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B V   x@  Pa -bv 	   next	   done   value   trigger_up3   user_value_widget_request	   name   onSuccess	   push   return!!      widgetNames   .this       !!          widgets          !!         widgetName          !!         widget         +H!!          onSuccessD#     {           5!!       !!	   name!!!!   onSuccess!!    ;                 C       c   e      ;            +                 n   U          4         5 !!         _rerenderXMLE          )                                  a  S  |                    Q        Q  5       
     Q  Z    0    Q  5      
  Q      Q  3        
  l            Q     
   :    
   :       6 |79H #   _userValueWidgets   forEach   $el   empty   undefined	   call%   _renderOriginalXML	   then!!      callback   .generator   .this       !!       	   $xml           +H!!          _rerenderXML/<d"     |  V          5 !!         _rerenderXML/<d" ; | ; | }  *          5 ;                             5!!         _selectE                               2               }          	          Q        Q@   Q         
:  -
  5   
  mQ:   5      Qw  5      Q        
  :    Q     
  :    Q   5            %        
  5   :   Q   	   
      :    Q
      
   :         Q9       
        :         Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp Bw    D   Q  5      
=    Q      }  &@ P -"$	   }      getMethodsNames	   next	   done   value   getValue!   getMethodsParams   applyTo   $   _   map   Promise   all   return   $target   trigger   content_changed!!      previewMode   widget   .generator   .this       !!          $applyTo           !!         methodName            !!         widgetValue   params            !!         proms            +H!!          _select/proms<d"  =  = ~            5 ;               C       m   
     J                $            y               u         3  m  5!!      -   _selectAttributeHelper@          $                                           L             W   QT 5           A=   ,  R pT 5   E   QT 5    .   T     
T 5   :    
=   : U  QT 5   .   V   5	   
   
T 5   T 5   T  I QT  [    attributeName   Error-   Attribute name missing   saveUnit   withUnit   split	   join      extraClass   $target   toggleClass   defaultValue!!      value   params   .this       +H;B       5 !!      #   _toggleCollapseEl@ F                                                                     T  5       
=   T  QT     
=   : 5       
=   T  Q2+=    classList   toggle   active   querySelector-   .o_we_collapse_toggler!!      collapseEl	   show        +H;       5 !!      /   _onCollapseTogglerClick@      	   5                                                      W   Q  QT  5    5     QV      
V   Q  QV     
=   : -
  5   
   m  QQ:   5      Q   5     QV      
V  B Q]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B]   .B@  PG]    currentTarget   parentNode#   _toggleCollapseEl!   querySelectorAll   we-collapse	   next	   done   value   return!!      ev   .this       !!       #   currentCollapseEl          !!         collapseEl          +H;                 C                a            	     1          2       5 !!      %   _onUserValueUpdateE      "   [                                 ;  ;           	          Q        Q      
  Q  5   5      Q  5   5      QB   Q  5   5    E   Q  5   5              
Z    >  5   5   -
  5   
   m5   _,  ,  :   5	    Q)   QZ     5   5   `    
   
   :    Q     
   :            Q   P         A    ,  R            Q               
   :            Q       Q  P         A   ,  R            Q            5      
   :  %     5      
   Z     Q[      ]      Q  5      
   :    
    Q    E   Q  5   5       Q     
=   [      ]    Q  5   5              
Z    >  5   5   -
  5   
   m5   _,  ,  :   5	    Q)   Q        5   5      I$         
=    Q   >   Q  5   5    	  Q     -
  5   
Z  mQ:   5	      QF  5      Q   	    7   Q      I           
  :    Q  CH        0   QA     BH'     B0   Q     0   Q     B0   Q     
  C Q  #  QQ]   v,  IM   ,     IE
   Q@I+    
,  ,  :  
Q	   vQ QQ   QQp B    &        
=    [   C]!    Q       $,@!D	/   I .   I  + wI ,@!>>*I 
@ ]2P  $$
(+!$1 Z 6    stopPropagation	   data   widget   previewMode!   isSimulatedEvent1   _requestUserValueWidgets'   triggerWidgetsNames	   next   value	   done   concatA   _checkIfWidgetsUpdateNeedWarning   Promise?   _checkIfWidgetsUpdateNeedReload   _actionQueues   get   set	   push   trigger_up/   snippet_edition_request	   exec   length   console	   warn3   Missing widget to trigger)   triggerWidgetsValues   undefined+   _normalizeWidgetValue   _previewColor   _value#   notifyValueChange   return   request_save   reloadEditor!!      ev   .generator   .this       !!          requiresReload   i   widget   previewMode   currentAction!   shouldRecordUndo   linkedWidgets)   triggerWidgetsValues           !!         linkedWidgets   widgets   warnMessage   reloadMessage            !!         okWarning            !!      	   save            !!         linkedWidget            !!         widgetValue            !!         normValue            +H!!      ;   _onUserValueUpdate/okWarning<d" Z  Z    m             resolve   D"                 5    D"                 5 5!!      1   _onUserValueUpdate/save<d"                     resolve    D"  l } l }   F          5    D"        h          5 5!!       !!   previewMode!!    !!       	   execD#   $  $      d         D"         0       5    D" x  x    1          5    D"  !  !                 resolve    D"          &             D"        ^          5 555!!       !!	   exec!!    !!       !!   reloadEditor!!    ;      !      ]  !       <           C       2          ]                         c  E                                             E         .           /            0                                       ~         >           e  z         K        5!!      5   _onUserValueWidgetCritical@  .                                              V  <    e             W   QV       
=   [    V   5   ]    Qh";    trigger_up   remove_snippet   $target   $snippet!!      .this         +H!!       !!   $snippet!!    ;       5!!    0   !!   tagName!!!!   events!!!!   custom_events!!!!   isTopOption!!!!'   forceNoDeleteButton!!!!	   init!!!!   willStart!!!!   renderElement!!!!   onFocus!!!!   onBuilt!!!!   onBlur!!!!   onClone!!!!   onMove!!!!   onRemove!!!!   onTargetShow!!!!   onTargetHide!!!!   cleanForSave!!!!   selectClass!!!!'   selectDataAttribute!!!!   selectAttribute!!!!   selectStyle!!!!   $!!!!   closeWidgets!!!!   findWidget!!!!   notify!!!!   setTarget!!!!   updateUI!!!!%   updateUIVisibility!!!!A   _checkIfWidgetsUpdateNeedWarning!!!!?   _checkIfWidgetsUpdateNeedReload!!!!%   _computeVisibility!!!!'   _computeWidgetState!!!!1   _computeWidgetVisibility!!!!A   _extraInfoFromDescriptionElement!!!!+   _normalizeWidgetValue!!!!1   _registerUserValueWidget!!!!)   _renderCustomWidgets!!!!!   _renderCustomXML!!!!%   _renderOriginalXML!!!!#   _renderXMLWidgets!!!!1   _requestUserValueWidgets!!!!   _rerenderXML!!!!   _select!!!!-   _selectAttributeHelper!!!!#   _toggleCollapseEl!!!!/   _onCollapseTogglerClick!!!!%   _onUserValueUpdate!!!!5   _onUserValueWidgetCritical!!    !!            !!         startC        	   )                                                          	W  QW  QV     QV  5       
V  V  O W   QV  V  5      
=   : 0   QV     
:     QV  5      
=        QV     "$       _super   apply   $overlay	   find   .o_handle   $handles   _getSize   on   mousedown!!   	   self   def   resizeValues   arguments   .this        +H!!           start/<b         B         $handle    compass    XY    resize    current !   cssPropertyValue    begin    beginClass    regClass    cursor    $body    xy    bodyMouseMove    bodyMouseUp   B   }    ~   0       5    B #        @       5   B           0          $handlers   B   
  
   {         5    B  <  4              5 55;5!!         onFocusC           	                                                          W   QV       
  Q      _onResize!!      .this         +H;       5!!         onBlurC            	                                      - T % T               W   QV   5       
=    Q #    $handles   addClass   readonly!!      .this         +H;       5!!         setTargetC  w                                  
            g  _    >     
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV     
  Q A@!    _super	   next   value	   done   _onResize!!      arguments   .this         +H;   ;   !          5!!         updateUIE           #                                 (  W  W                  	   Q   Q        Q      
Z    >  -
  5   
   m5   _,  ,  :   5    Q)        Q     
:     Q      
        Q    @! b    _super	   next   value	   done   _getSize   _	   each!!      .generator   arguments   .this         !!          resizeValues            +H!!         updateUI/<d"  T  T            5 ;   P   !                  5 !!         _getSizeC                                                     i m a m   @               C !!              +H;       5!!         _onResizeC ,        J                                       x                  W  QV     QV      
:  W   QV  5      
=   :    Q      
V        QV  5      
=   : W  QV  5      
=	   :    
[   V  ]
   =   V  ]    QV  5      
=   :    
[   >]
    Q      
V  5      
=   :     QV  5      
=    Q x	   '	'  (    _getSize   $overlay	   find   .o_handle   _	   each   $target   css   margin-left   .o_handle.w   width   -	   left   .o_handle.e1   .o_handle.n, .o_handle.s   trigger   content_changed!!      compass   beginClass   current	   self   resizeValues   $handles   ml   .this      +H!!           _onResize/<b         @          values    current !   cssPropertyValue   B         0       5 5!!       !!   width!!!!	   left!!    !!       !!   width!!    !!          _onResize/<b  \  \            5;5!!       !!   start!!!!   onFocus!!!!   onBlur!!!!   setTarget!!!!   updateUI!!!!   _getSize!!!!   _onResize!!    !!         _getSizeC  Z        ]                                      1  1                 W  Q=       Q=   W   Q=      Q=   W  QV  5      
=   : 0   =      Q=   W   Q=	      Q=
   W  QZ    W  Q>W  Q *   mV     
V   QV  #W  QQV   V     
?> QV  [   Z   V     
    : `    V  `   V   `   ]   Z   V     
   : `    V  `   V  `   ]   0   QV  5    &*3	    pt   padding-top   pb   padding-bottom   $target   is   hr   mt   margin-top   mb   margin-bottom	   push   splice   map   n   s	   grid!!      nClass   nProp   sClass   sProp	   grid   i   .this        +H!!       +   _getSize/this.grid.n<d"       *          5!!       +   _getSize/this.grid.s<d"       O          5!!       !!   n!!!!   s!!    ;       3   5 !!       !!   _getSize!!    !!         willStart@          <                                 ( y  j                   	   Q   Q        Q  5       
  :    Q     
:          Q     
:     Q   A    ,  R         Q   Z    >  -
  5   
   m5   _,  ,  :   5    Q)           f@!    _super	   bind   _loadImageInfo   _getImg   Promise	   next   value	   done!!      .generator   arguments   .this         !!          _super   img            +H!!          willStart/<d"       2          5 ;      !                             ^      5 !!         selectWidth@ 2                                                                 W   QV       
:  5   T 0   QV      
:    /    _getImg   dataset   resizeWidth   _applyOptions!!      previewMode   widgetValue   params   .this       +H;       5 !!         setQuality@ 2                                              %                  W   QV       
:  5   T 0   QV      
:   (+    _getImg   dataset   quality   _applyOptions!!      previewMode   widgetValue   params   .this       +H;       5!!         glFilter@ ^                                              G  G   y            W   Q  QV       
:  5     QT    V  T 0   Q   V  .   QV      
:   #    _getImg   dataset   glFilter   _applyOptions!!      previewMode   widgetValue   params   .this       !!          dataset          +H;      W       [          2       5!!         customFilter@          7                                    T  H    *             W   Q        QV       
:    QV  5   5     QQT 5     QQV  =   H         T : U Q      
      
V  D   Q=	   : Y    V  T ^:   QV  5      
   
V  : 0   QV      
:  J!#!N    _getImg   dataset   filterOptions   filterProperty   filterColor   Object   assign	   JSON   parse   {}   stringify   _applyOptions!!      previewMode   widgetValue   params   .this       !!          img   filterOptions   filterProperty   newOptions          +H;                       "       5 !!      %   _computeVisibility@        	   -                                                        W   Q    QV       
:    QZ   =   `    =   `      
V  5   5   :  
   BV     
=   :   QV  E   QV  =   I   8    _getImg   image/jpeg   image/png   includes   dataset   mimetype   getAttribute   src   /!!      .this         !!          img   src          +H;             ^                        "       5 !!      '   _computeWidgetState@                          	                   {  {   M             	W   QW  Q  QV      
:    QT  x=   Hy?   =   Hy?   =   HyD   =   HyV   =   Hye   z   V  5   V  5   5   V  5   5   D   Q=	   V  5   5
   D	   QK      QT 5     QQ      
V  5   5   D   Q=   :   QV  =   H   =      >  QV  V  7D   QV  V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)`s +xxxxx %!   !   !  !!  S21!@!    _getImg   selectWidth   setFilter   glFilter   setQuality   customFilter   naturalWidth   dataset   filter      quality   filterProperty	   JSON   parse   filterOptions   {}   blend   normal   _super	   next   value	   done!!      methodName   params   arguments   .this       !!          img          !!         filterProperty   options   defaultValue          +H;     !               {                                                                    P            Q                     3       5 !!      !   _renderCustomXML@ U        K                      %             |                      Q        Q  5     r   Z    >  5   -
  5   
   m5   _,  ,  :   5    Q   
    :         
:     Q        :    
=	   :    Q  
   
:             
    Q     
=   :    Q   5   5   =   I         
  Q   E F@! m/ r%(    originalSrc   childNodes	   next   value	   done   forEach   _getImg   $	   findK   we-select[data-name=width_select_opt]/   _computeAvailableWidths   querySelector   we-range   dataset   mimetype   image/jpeg   remove!!      uiFragment   .generator   .this       !!          img   $select   qualityRange            +H!!      %   _renderCustomXML/<d"  F  F      0       5 !!      %   _renderCustomXML/<d"  >  >             5 ;   S   !         @                      5 !!      /   _computeAvailableWidths@          f                       ?             O  O                     Q        Q      
:     Q      5   :            Q   5   5         5         5      Q      
        
:  :    Q     0   QY    X =	   ^X =
   ^X =   ^X =   ^X=   ^   Q      5      5      
  =   :    5   : 9Q         5      
  =   :    : 9Q         5      
  =   :    : 9Q      
   :    
    :    
   :        "H!2)'+%5.#    _getImg   originalSrc   dataset   width   naturalWidth	   Math   min/   _computeMaxDisplayWidth   optimizedWidth   128px   256px   512px   1024px   1920px   _   str   sprintf	   %spx!   %dpx (Suggested)   %dpx (Original)   Object   entries   filter	   sort!!      .generator   .this         !!          img   original   maxWidth   optimizedWidth   widths            +H!!      3   _computeAvailableWidths/<d"  3  3            5!!      3   _computeAvailableWidths/<d" : L : L            5;                        V   5!!         _applyOptions@          j                        3            c ; P ;                   Q        Q      
:     QZ   =   `    =   `      
   5   5   :       @0   Q          :            Q      
=   : ?7	      Q  5
      
=   :    Q      
=   :    
  =   :  Q      
=   :    
   X    
?: =    Q      
=    Q   5      
=    Q          :          "  ^'$).    _getImg   image/jpeg   image/png   includes   dataset   mimetype   originalId   split   ,   length   $el	   find%   .o_we_image_weight   > small	   text   New size   b   toFixed    kb   removeClass   d-none   classList   add1   o_modified_image_to_save!!      .generator   .this         !!          img   dataURL   weight   $weight            +H;            u                             5!!         _loadImageInfo@           ?                                    P ; < ;   t                Q        Q      
:     Q         5      
  : :         Q   5   5    '     @0   Q  @0   Q        5   5   0   Q     5   5   0   Q    v  }(P')    _getImg	   _rpc	   bind   dataset   originalId   originalSrc!!      .generator   .this         !!          img            +H;                          j   5!!      %   _autoOptimizeImage@           #                                     T  <    j                 Q      Q       
:           Q      
:           Q      
:  5      5   0   Q      
:           Q      
:           Q   m7    _loadImageInfo   _rerenderXML   _getImg   dataset   optimizedWidth   resizeWidth   _applyOptions   updateUI!!      .generator   .this         +H;   3   V         5!!         _getImg@                                                                           !!              +H;       5 !!      /   _computeMaxDisplayWidth@                                                           0               3 !!              +H;       5 !!       !!   willStart!!!!   selectWidth!!!!   setQuality!!!!   glFilter!!!!   customFilter!!!!%   _computeVisibility!!!!'   _computeWidgetState!!!!!   _renderCustomXML!!!!/   _computeAvailableWidths!!!!   _applyOptions!!!!   _loadImageInfo!!!!%   _autoOptimizeImage!!!!   _getImg!!!!/   _computeMaxDisplayWidth!!    !!          start@           )                                     Y $ T $   o     
       	W   QW  QV  5       
=   V  5      
V  :  QV  5       
=   V  5      
V  :  QV     
Z    >V   -
  5   
   m5	   _,  ,  :   5
    Q) r2S2S@!    $target   on?   image_changed.ImageOptimization   _onImageChanged	   bind?   image_cropped.ImageOptimization   _onImageCropped   _super	   next   value	   done!!      arguments   .this         +H;      !          5!!         destroy@                                                , x % x   B     
       	W   QW  QV  5       
=    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) E'@!    $target   off%   .ImageOptimization   _super	   next   value	   done!!      arguments   .this         +H;   T   !          5 !!      /   _computeMaxDisplayWidth@        
   ?                                       y         	       W   Q  QV       
:  5     QV   5      
=   :       V   5      
=   :    1         
X   	   
V  X: :       
X   	   
V  X: : V   2?     _getImg   clientWidth   $target   closest#   [class*="col-lg"]   length=   .container, .o_container_small	   Math   min   max!!      .this         !!          displayWidth          +H;                                                   2       5!!         _getImg@                                                                    W   QV   5    >7     $target!!      .this         +H;       5!!         _onImageChanged@ B                                             p  p                     Q      Q       
=   [       ]    Q   S+~    trigger_up/   snippet_edition_request	   exec!!      ev   .generator   .this       +H!!       	   execD#  & l ! l             5 !!       !!	   exec!!    ;   5!!         _onImageCropped@ ?                                               q                     Q      Q       
:           Q         _rerenderXML!!      ev   .generator   .this       +H;   3   5!!       !!   start!!!!   destroy!!!!/   _computeMaxDisplayWidth!!!!   _getImg!!!!   _onImageChanged!!!!   _onImageCropped!!    !!         start@        	                                         i  i   H     
       	W   QW  QV  5       
=   V  5      
V  :  QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) K8^@!    $target   onK   background_changed.BackgroundOptimize)   _onBackgroundChanged	   bind   _super	   next   value	   done!!      arguments   .this         +H;   k   !          5 !!         destroy@                                                q  j         
       	W   QW  QV  5       
=    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) (@!    $target   off'   .BackgroundOptimize   _super	   next   value	   done!!      arguments   .this         +H;   T   !          5!!         cleanForSave@           #                                                           Q        Q      
:     Q      
=   : u     5      
=    Q      
   5   : 	   
     Q  5   >75      
   
=   : 0   Q    5*2>    _getImg   matches3   .o_modified_image_to_save   $target   addClass1   o_modified_image_to_save   Object   entries   dataset   forEach   getAttribute   src   bgSrc!!      .generator   .this         !!          img            +H!!         cleanForSave/<d" p  p             5 ;            5!!         _getImg@           	                                            H            W   QV   5     K    img!!      .this         +H;       5 !!      /   _computeMaxDisplayWidth@                                                      "  "   t             X w !!              +H;       5 !!         _applyOptions@           &                                   ( 6  #                 	   Q   Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5      
=   =         
:  	   
=
   : =    Q    @!,T    _super	   next   value	   done   $target   css!   background-image   url('   _getImg   getAttribute   src   ')!!      .generator   arguments   .this         +H;   K   !         5 !!         _loadImageInfo@  D        2                      $           (                      	   Q   Q        Q      A,  R  0   Q      
  5   >75   :    
     Q	  	    5   >7:    Q  5         
=   :          =	   0
   Q     
Z    >  -
  5   
   m5   _,  ,  :   5    Q)               '	(=@!    Image   img   Object   entries   $target   dataset   forEach   startsWith   /      src   _super	   next   value	   done!!      .generator   arguments   .this         !!          src            +H!!      !   _loadImageInfo/<d"  8  8   m         5 ;      !         (      4            0  5 !!      )   _onBackgroundChanged@ O                                             P  P                     Q      Q    ,          
=   [       ]    Q    A+_    trigger_up/   snippet_edition_request	   exec!!      ev   previewMode   .generator   .this       +H!!       	   execD#  % K   K            5 !!       !!	   exec!!    ;   5!!       !!   start!!!!   destroy!!!!   cleanForSave!!!!   _getImg!!!!/   _computeMaxDisplayWidth!!!!   _applyOptions!!!!   _loadImageInfo!!!!)   _onBackgroundChanged!!    !!          start@        	                                                   
       	W   QW  QV  5       
=   V  5      
V  :  QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) 4W@!    $target   onC   content_changed.BackgroundToggler#   _onExternalUpdate	   bind   _super	   next   value	   done!!      arguments   .this         +H;   k   !          5!!         destroy@                                                 Y  Y   v     
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV  5      
=    Q y@!'    _super	   next   value	   done   $target   off%   .BackgroundToggler!!      arguments   .this         +H;   ;   !          5 !!         toggleBgImage@         >                                   g  Z         
       W   QT         QV       
=   : -
  5   
BQ,  ,  :   5      Q   5     Q   QQ1   
Q   IE
   Q@I   
:     QQQV     
:    QV     
B=   V  	   
=   : : +   V       
=   : >75
      
  Q D&  4	 1   _requestUserValueWidgets   bg_image_opt	   next	   done   value   return   getParent   background   !   getMethodsParams   el   click!!      previewMode   widgetValue   params   .this       !!          bgImageWidget   bgImageOpt          +H;   n                             2       5 !!         toggleBgShape@          &                                    \  \        	       W   Q    QV       
=   : -
  5   
BQ,  ,  :   5      Q   5     Q   QQ1   
Q   IE
   Q@I   
:     QQQV     
:    QV     
:   /B 1   _requestUserValueWidgets   bg_shape_opt	   next	   done   value   return   getParent   _toggleShape!!      previewMode   widgetValue   params   .this       !!          shapeWidget   shapeOption          +H;   d                                    5!!         toggleBgFilter@          ,                                    k   ]                 W   QT        Q       
=   :   QV  5      
=   =    QV      
:    QV  +         V  : 	   
V   Q   V   5
      
V   Q)   V   5
      
=   :    
  Q ?%(%
    document   createElement   div   classList   add   o_we_bg_filter   bg-black-50;   _getLastPreFilterLayerElement   $   after   $target   prepend	   find   .o_we_bg_filter   remove!!      previewMode   widgetValue   params   .this       !!          bgFilterEl!   lastBackgroundEl          +H;         R       5 !!      '   _computeWidgetState@ e                                *             *   *   O
            	W   QW  QT  x=    Hy%   =   Hy   =   Hy   z      QV     
=   : -
  5   
BQ,  ,  :   5      Q   5     Q   QQ1   
Q   IE
   Q@I   
:     QQQV  	   
:    QV  
   
=   V     
=   : :   V     
:      QV     
=   : -
  5   
BQ,  ,  :   5      Q   5     Q   QQ1   
Q   IE
   Q@I   
:     QQQV  	   
:    QV  
   
=   V     
=   : :   V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) 
cs xxx 'D-! ! B)!@!    toggleBgImage   toggleBgFilter   toggleBgShape1   _requestUserValueWidgets   bg_image_opt	   next	   done   value   return   getParent'   _computeWidgetState   background!   getMethodsParams   _hasBgFilter   bg_shape_opt   shape   _super!!      methodName   params   arguments   .this       !!          bgImageWidget   bgImageOpt          !!          shapeWidget   shapeOption          +H;                    8  !      =                      +                 S       5!!      ;   _getLastPreFilterLayerElement@                                                     H X + X   @              @C !!              +H;       5!!         _hasBgFilter@  '                                               e  Y    ]             W   QV   5       
=   :      `.    $target	   find#   > .o_we_bg_filter   length!!      .this         +H;       5 !!      #   _onExternalUpdate@           #                                      l  l                W   QV       
:  E5   QV      
:   E   Q 	   	  V   5   :  ;     QV      
=   : >7  QV  5      
  Q  &9    _hasBgFilter;   _getLastPreFilterLayerElement   $target1   _requestUserValueWidgets)   bg_filter_toggle_opt   $el   click!!      .this         !!          widget          +H;   P   5   "       5!!    	   !!   start!!!!   destroy!!!!   toggleBgImage!!!!   toggleBgShape!!!!   toggleBgFilter!!!!'   _computeWidgetState!!!!;   _getLastPreFilterLayerElement!!!!   _hasBgFilter!!!!#   _onExternalUpdate!!    !!          startC                                                           
       	W   QW  QV   	   	  V  5    >7: 0   QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) @!    $target!   __customImageSrc   _super	   next   value	   done!!      arguments   .this         +H;   ^   !          5 !!         backgroundE          5                                   '                        Q      Q   CH0      	  	     5    >7: 0   Q=      =   H      5      Q         0   Q      
    Q   =   IJ          
     Q   5       
=   Z      `     Q     @%(!M+:    $target!   __customImageSrc   reset   _setBackground   forEach   trigger%   background_changed!!      previewMode   widgetValue   params   .generator   .this       +H!!          background/<d" \  \    \          5 ;   5!!         dynamicColor@         m                        -                                  Q        Q	  	    5    >7:    Q  xCHy   =   Hy!   zV        0   Q@     5       
=   =     5   =    Q      A      5	   5
   ,  R    Q   5      
=         :  Q   5      5      Q       :         Q  5       
=   =      =    Q           0   Q        um|x `,B +@",5    $target   reset   previousSrc   css!   background-image   url('   ')   URL   window   location   origin   searchParams   set   c1   pathname   search!!      previewMode   widgetValue   params   .generator   .this       !!          currentSrc   newURL   src            +H;                         >  5!!         setTargetC           +                                     	  	               	W   QW  Q  Q 	   	  V  5    :   QV     
=    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV     V     
V   QV   	  V  5    >7: 0   Q !	@!    $target   _setBackground      _super	   next   value	   done!   __customImageSrc!!      arguments   .this         !!          oldBgURL          +H;   q   !            #       5 !!      '   _computeWidgetStateC          E                                    	 
 	 
   S      
       	W   QW  QT  x=    Hy   =   Hy&   zk    	   	  V  5   >7:    A 	   	  V  5   >7:    5   5   ,  R 5      
=	   : V  
   
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)`s  xx $!   L!@!    background   dynamicColor   $target   URL   window   location   origin   searchParams   get   c1   _super	   next   value	   done!!      methodName   arguments   .this       +H;      !   #       5!!      1   _computeWidgetVisibility@          /                                   
  
    ;             	W   QW  QT  =    H     Q   A 	   	  V  5   >7:    5   5   ,  R   QV  5      5   5   HE   QV  5      
=   : V  	   
Z    >V   -
  5
   
   m5   _,  ,  :   5    Q)O$?,!@! #   dynamic_color_opt   URL   $target   window   location   origin   pathname   startsWith%   /web_editor/shape/   _super	   next   value	   done!!      widgetName   params   arguments   .this       !!          src          +H;      !         }                 #       5 !!         _setBackground@       	                                              1             W   QT  M   V   5       
=   =   T  =    QV   5       
=    Q=   V   5       
=   =    QV   5       
=    QA,?)('    $target   css!   background-image   url('   ')   addClass   oe_img_bg      removeClass!!      backgroundURL   .this       +H;2       5!!       !!   start!!!!   background!!!!   dynamicColor!!!!   setTarget!!!!'   _computeWidgetState!!!!1   _computeWidgetVisibility!!!!   _setBackground!!    !!          updateUI@  S                                                [  [   L            	W   QW  QV  5        V  B0    QV     
:  V  5      
V  V   O  O)"    rerender   _rerenderXML   _super   apply!!      arguments   .this         +H;#       5!!         shape@ !                                              a  \                      Q       
T       QQo '   _handlePreviewState!!      previewMode   widgetValue   params   .this       +H!!          shape/<d"        v          5;5!!         color@ !                                               ?  ?                     Q       
T       Q   % '   _handlePreviewState!!      previewMode   widgetValue   params   .this       +H!!          color/<d"  > < > <            5;5!!         flipX@          	                                     E  @                W   QV       
T  =    Q 5!    _flipShape   x!!      previewMode   widgetValue   params   .this       +H;       5 !!         flipY@          	                                           ]            W   QV       
T  =    Q ~!    _flipShape   y!!      previewMode   widgetValue   params   .this       +H;       5 !!      '   _computeWidgetState@         z                                                     	W   QW  QT  x=    Hy2   =   Hy:   =   Hy   =   Hy   z   V     
:  5            QV     
:  5      Q5     QQ      
V     
:  V  :   QV  E   QV  T 5	   7  QV  D   Q=
   V  5      
=   :    >IV  5      
=   :    >IV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) s #xxxx  ! ;&! ! !@!    shape   color   flipX   flipY   _getShapeData   colors   Object   assign#   _getDefaultColors   colorName      $target	   find3   > .o_we_shape.o_we_flip_x   length3   > .o_we_shape.o_we_flip_y   _super	   next   value	   done!!      methodName   params   arguments   .this       !!          shape   customColors   colors   color          +H;   b  !      _                    c       5!!      !   _renderCustomXML@ `                                                                  W   Q       
V      
:  :    
     Q      
=   :    
    Q   @&  E     Object	   keys#   _getDefaultColors   map!   querySelectorAllK   we-select-pager we-button[data-shape]   forEach!!      uiFragment   .this      +H!!       %   _renderCustomXML/<d"       j          5 !!       %   _renderCustomXML/<d"       J         5 ;5!!      1   _computeWidgetVisibility@          )                                  (  A  A   8             	   Q   Q      Q   =    H   B         
Z    >   -
  5   
   m5   _,  ,  :   5    Q)        L"!@!    shape_none_opt   _super	   next   value	   done!!      widgetName   params   .generator   arguments   .this       +H;   e   !      5!!         _flipShape@ !                                              L  B                      Q       
T       Q@ '   _handlePreviewState!!      previewMode	   axis   .this       +H!!          _flipShape/<d"        e   0       5 ;5!!      '   _handlePreviewState@      %                           B            "                    W   Q             QT  =    HV   V   5   *   V   5   >75   V   5   0   Q   V   5   >75   .   Q     QT  CH%   V   V   5   >75   5   0   QT :    QV      
V   QT  BHI   V   V   5   >75   5   0   QV     
=   :    V   C0   QV   5   >75   5     QV     	   
   
V  :    [    5     Q5     Q5   H   QZ      QQV   5   >7  QV     
=   :    QV   &               
  Q         Q      
=   :    QV      
:    QV  ,         V  :    
    Q   V     
    QV  5   =   0   Q   =   V     
   =   : 0   QV     
    Q         :    
=    V  &   =!   V   "   
:  =#      =$    QM913&.-   $$)G8B    reset   prevShape   $target   dataset   oeShapeData   _markShape   hasOwnProperty   shape   rerender	   JSON   parse   colors	   flip   querySelector)   :scope > .o_we_shape   remove   document   createElement   div9   _getLastPreShapeLayerElement   $   after   prepend   style   relative   position   o_we_shape o_   replace   _   className   forEach   css!   background-image   url("   _getShapeSrc   ")   !!      previewMode!   computeShapeData   .this       !!          shapeContainer	   json   shape   colors	   flip   target         !!         newShapeData          !!      )   preShapeLayerElement          +H!!            !!   \/   !!       +   _handlePreviewState/<d" Y  Y    R          5;                                              5!!         _markShape@          7                                                        W   Q       QV       
:     Q      
V      
:  T  :   Q      
V  5   :    
    :   QV     V  .   QV  5    !   V   5   >75	   .
   Q/   V   5   >75	         
V  : 0
   Q  2!m1$ #   _getDefaultColors   Object   assign   _getShapeData   entries   colors   every   shape   $target   dataset   oeShapeData	   JSON   stringify!!      newData   .this       !!          defaultColors   shapeData!   areColorsDefault          +H!!       9   _markShape/areColorsDefault<d"  	  	            5 ;         5!!      9   _getLastPreShapeLayerElement@  H                                               O  O                W   Q  QV   5       
=   :   QV        V  >7@  
'    $target	   find#   > .o_we_bg_filter   length!!      .this         !!          $filterEl          +H;      A       @              E          "       5!!         _getShapeSrc@           /                                     \ } P }                 W   Q      QV       
:  5     Q5     QQV      =         
V  :    
    :    
=   :   Q=	   V  =
   V    (u
    _getShapeData   shape   colors      Object   entries   map	   join   &%   /web_editor/shape/   .svg?!!      .this         !!          shape   colors   queryString          +H!!       3   _getShapeSrc/queryString<d"  :  :   -          5;             L                        5!!         _getShapeData@           )                                     U ~ U         
          QW  QT  H   QV  5    >7   Q    Q[    =   ]   V     
:  ]   Z    ]     QV   5   5     QV  1      	   
V  
      
V  : : 
   V   	 &8    $target      shape#   _getDefaultColors   colors	   flip   dataset   oeShapeData   Object   assign	   JSON   parse!!      target   .this      !!          defaultData	   json          +H!!       !!   shape!!!!   colors!!!!	   flip!!    ;   *                    "       5 !!      #   _getDefaultColors@          D                                    g ! V !        
       W   Q        QV   5       
=   :    
:     
=   :    
   5   :   QV  >7  QV  	   
=
   =    QV  E   Q 	   	  V  :   QV     
  QV      [       AV     5   5   ,  R   Q      
V  5      
:  :  #"1i)/    $target	   find   > .o_we_shape   clone   addClass   d-none   appendTo   document	   body   css!   background-image      remove   URL   window   location   origin   Object   fromEntries   searchParams   entries!!      .this         !!          $shapeContainer   shapeContainer   shapeSrc   url          +H!!            ;                                   "       5!!         _toggleShape@          U                                    ! x# ! x#          
       W   QV       
:  5   !   V      
B    : e           QV   5   >7  QV  5     QV      
=   : -
  5   
BQ,  ,  :   5      Q   5	     Q   QQ1   
Q
   IE
   Q@I   
:     QQQV     
=   : 5      Q   QV  I      V       
V  : 5      Q     
   :   Q      ?7   QV      
B   : zD   3B9*T=    _getShapeData   shape'   _handlePreviewState   $target-   previousElementSibling1   _requestUserValueWidgets   bg_shape_opt	   next	   done   value   return!   getMethodsParams   possibleValues	   find!!      .this         !!          shapeToSelect   target   previousSibling   shapeWidget   possibleShapes         !!         previousShape          +H!!          _toggleShape/<d"  W! g! W! g!             5 !!      7   _toggleShape/shapeToSelect<d" " 	# " 	#   9         5!!         _toggleShape/<d"  Y# t# Y# t#   &          5 ;            @   Z     4  9                    5 !!       !!   updateUI!!!!   shape!!!!   color!!!!   flipX!!!!   flipY!!!!'   _computeWidgetState!!!!!   _renderCustomXML!!!!1   _computeWidgetVisibility!!!!   _flipShape!!!!'   _handlePreviewState!!!!   _markShape!!!!9   _getLastPreShapeLayerElement!!!!   _getShapeSrc!!!!   _getShapeData!!!!#   _getDefaultColors!!!!   _toggleShape!!    !!         startC  d                                             " # u$ # u$                 	W   Q   Q   5       
   V   O Q      
  Q         :    
=        Q  "
5    _super   apply   _initOverlay   $   window   on#   resize.bgposition!!      arguments   .this        +H!!          start/<d"  V$ r$ V$ r$   #         5;5!!         destroyC  [                                   
          " $ $ ~$ $   S            	W   QW  QV      
B Q         :    
=    QV  5      
V  V   O Q V
" !   _toggleBgOverlay   $   window   off   .bgposition   _super   apply!!      arguments   .this         +H;      5 !!         backgroundTypeC e                                   	           $ % $ %               W   QV   5       
=   T =   H QV   5       
=   =    QV   5       
=   =    Q O+'    $target   toggleClass'   o_bg_img_opt_repeat   repeat-pattern   css'   background-position      background-size!!      previewMode   widgetValue   params   .this       +H;       5!!      3   backgroundPositionOverlayE +        :                                   % ' % '                     Q        Q    A    ,  R         Q  5      
=   :    
=   :    
   :    Q     
:     Q  [      >7]      ?7]	   0
   Q  [      >7d   5   D   Q>]      ?7d   5   D   Q>]	   0   Q     
C Q      	( !    Promise   $target   css'   background-position   split       map'   _getBackgroundDelta	   left   top!   originalPosition   x   y   currentPosition!   _toggleBgOverlay!!      previewMode   widgetValue   params   .generator   .this       !!          position   delta            +H!!       7   backgroundPositionOverlay/<d" & & & &                resolve   D"  o& |& o& |&   <         5 5!!      G   backgroundPositionOverlay/position<d" & ' & '            5!!       !!	   left!!!!   top!!    !!       !!	   left!!!!   top!!    ;           <   5!!         selectStyleC       	   &                                    ' ( ' (        
       	W   QW  QT 5    =   HE    QV  5      
=   :     V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)Q +.@!    cssProperty   background-size   $target   hasClass'   o_bg_img_opt_repeat   _super	   next   value	   done!!      previewMode   widgetValue   params   arguments   .this       +H;   s   !   #       5!!      %   _computeVisibilityC                                                ( ( ( (   7      
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)E"   Q 	   	  V  5   >7:   :@!    _super	   next   value	   done   $target!!      arguments   .this         +H;   ;   !          5 !!      '   _computeWidgetStateC          '                                    ) ) ) )         
       	W   QW  QT  =    H<   V  5      
=   : =   H   =      =   V     
Z    >V   -
  5   
   m5	   _,  ,  :   5
    Q)  "!@!    backgroundType   $target   css#   background-repeat   repeat   repeat-pattern   cover   _super	   next   value	   done!!      methodName   params   arguments   .this       +H;      !   #       5!!         _initOverlayC           &                                      ) + ) +                     Q                
=   : : 0   Q      5      
=   : 0   Q      5      
=   : 0   Q   5   	   
=
   =        Q   5   	   
=
   =       Q   5      
   5    Q;963  Y3    $   renderM   web_editor.background_position_overlay%   $backgroundOverlay	   find+   .o_we_overlay_content   $overlayContent+   .o_overlay_background%   $overlayBackground   on   click   .o_btn_apply   .o_btn_discard   insertAfter   $overlay!!      .this         +H!!           _initOverlay/<d"  * _+ * _+   T         5 !!          _initOverlay/<d"  + + + +             5 ;5!!      #   _dimensionOverlayC          o                        *            	, ". , ".   t     
       W   Q      QV   5       
=   :  
         =   :   QV   5      
:    QV   5       
[    V     
:  ]	   V  
   
:  ]    QV   5      
V   QV   5      
[   V   5      
:  =   ]	   V   5   
   
:  =   ]    Q      V   5      
=   : :       V   5      
=   : :   QV   5      
=   :    
=   V  =    Q v* (
\*	
n,+@ %   $backgroundOverlay   is   .oe_active   $   #wrapwrap   $target   offset   css   innerWidth   width   innerHeight   height   $overlayContent   $bgDragger   px   parseInt   $overlay   top	   find+   .o_we_overlay_buttons!!      .this         !!          $wrapwrap   targetOffset   topPos          +H!!       !!   width!!!!   height!!    !!       !!   width!!!!   height!!    ;            6          "       5 !!      !   _toggleBgOverlayC q     '                            V            <. d2 4. d2                     Q   5     D$   Q   5       
=   : T  H   T         5       
=    Q      
=    Q      
=   [       5   ]	    Q
   
      :    
=    Q      
=    Q      
=   [      5   ]	   C]    Q      
=    Q      5      
:     
:  0   Q   5      
=      5      
=   :  Q   5      
=      5      
   :  Q   5      
[   =   ]   =   ]      5    ]    Q   5       
:  !   
   5    Q   5    "   
=    Q   #   
  Q   5      
=$    Q%   &   
   > Q 5  1,$<  $N*,WG>   . _ %   $backgroundOverlay   is   .oe_active   removeClass   oe_active   trigger_up1   unblock_preview_overlays!   activate_snippet   $target   $snippet   $   document   off!   click.bgposition   hide_overlay   previewMode-   block_preview_overlays   clone   empty   $bgDragger   css+   background-attachment   on   mousedown-   _onDragBackgroundStart	   bind   tooltipk   Click and drag the background to adjust its position!   title   manual   trigger   container%   $overlayBackground   append   addClass#   _dimensionOverlay	   show   window   setTimeout!!      activate   .this       +H!!       !!   $snippet!!    !!       !!   $snippet!!!!   previewMode!!    !!       !!   title!!!!   trigger!!!!   container!!    !!        %   _toggleBgOverlay/<d"  2 _2 2 _2            5 ;5!!      '   _getBackgroundDeltaC  
                               T            2 5 y2 5               W   Q    QV   5       
=   :   QV  =   I      QV     
=   : -
  5   
BQ,  ,  :   5      Q   5     Q   C0   ,  ,  :   5      Q   5     Q   QQ1   
Q	   IE
   Q@I   
:     QQQV  =
   HE   QV  =
   HD   QV   ]   [    V   5       
:  V   5   5   ]   V   5       
:  V   5   5   ]   Z         V  : `          V  : `   -
  5   
BQ,  ,  :   5      Q   5   W  Q   C0   ,  ,  :   5      Q   5   W  Q   QQ1   
Q	   IE
   Q@I   
:     QQQ[   V   5       
:  V  D)   QV  V   5   5   V   5   5   ]   V   5       
:  V  D)   QV  V   5   5   V   5   5   ]         
V   5       
:  V   5   5   V   5       
:  V   5   5   :   Q[   V   5       
:        
V  V   5   5   : ]   V   5       
:        
V  V   5   5   : ]    $!%
0  2Y 0l.1    $target   css   background-size   cover   split    	   next	   done   value   return	   auto   outerWidth   img   naturalWidth   x   outerHeight   naturalHeight   y   parseInt	   Math   max   round!!      .this         !!          bgSize   renderRatio          !!         width   height         +H!!       !!   x!!!!   y!!    !!       !!   x!!!!   y!!    !!       !!   x!!!!   y!!    ;                             Y                =                                   .            /                     2       5!!      -   _onDragBackgroundStartC          !                                    5 6 5 6                     Q   T      
  Q  5      
=    Q        5   :    Q      
=     5   	   
  :  Q   
   
=        Q B0
$Ks    preventDefault   $bgDragger   addClass   o_we_grabbing   $   ownerDocument   on)   mousemove.bgposition+   _onDragBackgroundMove	   bind   one   mouseup!!      ev   .this       !!          $document            +H!!      1   _onDragBackgroundStart/<d"  6 6 6 6   
         5 ;         5!!      +   _onDragBackgroundMoveC         U                        )            7 9 6 9          
       W  Q    Q    W   QT      
  QV     
:    QV  5   V   V  5   5   T  5   5   Z   >`    V  5   `   : 0   QV  5   V   V  5   5   T  5   5   Z   >`    V  5	   `   : 0   Q[   V  5   5   V  5   d]   V  5   5   V  5	   d]     QV  
   
   V  5   :    V  5      V  5   5   0   QV  
   
   V  5   :    V  5      V  5   5   0   QV  5      
=   V  5   =   V  5   =    Q VHTM++OL-      preventDefault'   _getBackgroundDelta   currentPosition	   left   originalEvent   movementX   x   top   movementY   y   isFinite!   originalPosition   $bgDragger   css'   background-position   %    %!!      ev   clamp   .this       !!          delta   percentPosition          +H!!          clamp 9 9 9 9   $         5!!       !!	   left!!!!   top!!    ;        5 !!      %   _onDocumentClickedC 6                                              : y: : y:               W   QT  5       
=   :     V      
B Q 8    target   closestC   .o_we_background_position_overlay!   _toggleBgOverlay!!      ev   .this       +H;"       5!!       !!   xmlDependencies!!!!   start!!!!   destroy!!!!   backgroundType!!!!3   backgroundPositionOverlay!!!!   selectStyle!!!!%   _computeVisibility!!!!'   _computeWidgetState!!!!   _initOverlay!!!!#   _dimensionOverlay!!!!!   _toggleBgOverlay!!!!'   _getBackgroundDelta!!!!-   _onDragBackgroundStart!!!!+   _onDragBackgroundMove!!!!%   _onDocumentClicked!!    !!          startC  w                                  
            : 
; : 
;   L     
       	W   QW  QV      
  QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) O@!    _markColorLevel   _super	   next   value	   done!!      arguments   .this         +H;   J   !          5!!         onBuiltC           	                                      ; 6; ; 6;               W   QV       
  Q     _markColorLevel!!      .this         +H;       5!!         _markColorLevelC            	                                      O; |; G; |;               W   QV   5       
=    Q )    $target   addClass   o_colored_level!!      .this         +H;       5 !!       !!   start!!!!   onBuilt!!!!   _markColorLevel!!    !!          startC       !   Z                         .             ; K? ; K?          
       	W   QW  QV     QV      
=         
V  5   [       ]   :  QV  V  5      
=   : 0	   QV  V  5      
=
   : #0   QV             
=   : :    
V  5   : 0   QV  V  5      
=   : 0   QV  V  5      
=   : 0   QV  5      
=   :    
=       Q         > QV  5      
=   :    
:     
=       QV  5      
=   =       QV  5       
V  V   O  }
7'$-	NWj]"    trigger_up   getRecordInfo   _   extend   options   callback   $target	   data#   oe-many2one-model   Model   oe-many2one-id   ID   $   render5   web_editor.many2one.button   prependTo   $el	   $btn	   find   ul   $ul   li:first   $search   input   onK   mousedown click mouseup keyup keydown   setTimeout   focus   keyup   click!   li:not(:first) a   _super   apply!!   	   self   arguments   .this        +H!!           callbackB Q< < I< <            5 !!       !!   callback!!    !!          start/<b = = = =   C	         5!!          start/<b  = 3> = 3>   q	           B > 0> > 0>   	         5 5!!          start/<b m> > e> >   	         5!!          start/<b > ? > ?   q
         5;5!!         onFocusC  4                                               \? ? T? ?   
            W   QV   5       
=   =    QV      
  Q 
-    $target	   attr   contentEditable   false   _clear!!      .this         +H;       5 !!         _clearC  l                                               ? ?@ ? ?@                 W   QV      QV   5       
:     
  Q   5       
=   :    
=    Q          > Q 0
	>    $search   siblings   remove	   find   input   val      setTimeout!!   	   self   .this        +H!!          _clear/<b  @ :@ @ :@            5 ;5!!         _findExistingC E                                             V@ B N@ B          	       W  QV     QZ    W   QT   D   QT       '      5      
:     
  Q      T  #:    V  5   =   I;   V      
Z   =   `    =	   `   T  `    Q\   V      
=
   Z   =   `    =	   `   T  `   Z   =   `    =	   `   T  `    Q6   V      
Z   =   `    =   `   T  `    QV     
[   V  5   ]   =   ]   Z   V   `    V  5   =   H8   Z   =   `    =   `   =   `   =   `      Z   =   `    =   `   `   ]   [   Z   [    =   ]   B]   `    ]   ]   V  5   5   ]   ]   :    
   :  
	  	)E2        length   $search   siblings   remove   isNaN   Model   res.partner	   push	   name   ilike   |   email   id   =	   _rpc   model   search_read   method   display_name	   city   country_id	   args   asc   order   limit   options   context   kwargs	   then!!   	   name	   self   domain   .this      +H!!       !!	   name!!!!   asc!!    !!       !!   order!!!!   limit!!!!   context!!    !!       !!   model!!!!   method!!!!	   args!!!!   kwargs!!    !!           _findExisting/<b |B B tB B            5;5!!         _selectRecordC .        m                         C            C F 	C F                 W   QV      QV   T      
=   : #0   QV   5      
=   V   5   :     
=   V   5    QV      
=   [    V   5   ]    QV   5   	   
=
    Q   5       
=   : =   H/        =   :    
=      5       
=   : =   :    
=      5       
=   : =   :    
=      5       
=   : =   :    
=      5       
=   : =   :    
   5   :    
=      5   :     
=      5   :    
    Q-      5      
T      
=   :  QV      
  Q 
1/F(*9URcS$  	   data   id   ID   $target	   attr'   data-oe-many2one-id   oe-many2one-id   trigger_up7   request_history_undo_record   trigger   content_changed   oe-type   contact   $3   [data-oe-contact-options]   filter!   [data-oe-model="   oe-model   "]   [data-oe-id="   oe-id!   [data-oe-field="   oe-field7   [data-oe-contact-options!="%   oe-contact-options   add	   each	   html	   name   _clear!!      $li	   self   .this      +H!!       !!   $target!!    !!           _selectRecord/<b  E F E F   8  "          $node   B F F F F            5 5;5!!       !!   xmlDependencies!!!!   start!!!!   onFocus!!!!   _clear!!!!   _findExisting!!!!   _selectRecord!!    !!          startC           &                                     iG H aG H          	       	W   Q   Q       
=   [      5   >75   5   ]       ]    Q      
Z    >V   -
  5   
   m5	   _,  ,  :   5
    Q)  (, A@!    trigger_up)   get_snippet_versions   $target   dataset   snippet   snippetName   onSuccess   _super	   next   value	   done!!      arguments   .this        +H!!           onSuccessD# G H G H      0          snippetVersions    D" H RH H RH   A         5 5!!       !!   snippetName!!!!   onSuccess!!    ;   }   !   5 !!       !!   xmlDependencies!!!!   start!!    !!         saveSnippetC                                               cI VM [I VM                     Q    A    ,  R       Promise!!      previewMode   widgetValue   params   .this       +H!!           saveSnippet/<d" I SM I SM     0          resolve    dialog    D"  J L J L     $          thumbnailURL   D" K K K K            5 5   D"  CM PM CM PM   j         5 5;5!!       !!   xmlDependencies!!!!   isTopOption!!!!   saveSnippet!!    !!          start@        	                                        M  N M  N        
       	W   QW  QV  5       
=   V  5      
V  :  QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) +L@!    $target   on1   image_changed.DynamicSvg   _onImageChanged	   bind   _super	   next   value	   done!!      arguments   .this         +H;   k   !          5 !!         destroy@                                                N MN N MN   /     
       	W   QW  QV  5       
=    QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) 2 @!    $target   off   .DynamicSvg   _super	   next   value	   done!!      arguments   .this         +H;   T   !          5!!         color@ b        ]                        (           YN O NN O                   Q        Q  5    >7   Q  xCHy   =   Hy0   zI           
=   : 0   Q$        5   0   Q      A   5      5   5   ,  R    Q   5	   
   
=         :  Q   5      5      Q       :         Q      0   Q           0   Q      u`|x `  !+@"    $target   reset   getAttribute   src   previousSrc   URL   window   location   origin   searchParams   set   c1   pathname   search!!      previewMode   widgetValue   params   .generator   .this       !!          target   newURL   src            +H;      M                   (  5!!      '   _computeWidgetState@          ,                                    P P O P         
       	W   QW  QT  x=    Hy   zG      AV  5   >75      5   5   ,  R 5      
=	   : V  
   
Z    >V   -
  5   
   m5   _,  ,  :   5    Q) sUx A!@!    color   URL   $target   src   window   location   origin   searchParams   get   c1   _super	   next   value	   done!!      methodName   params   arguments   .this       +H;      !   #       5 !!      %   _computeVisibility@                                                P Q P Q   5             W   QV   5       
=   : I2    $target   is=   img[src^='/web_editor/shape/']!!      methodName   params   .this       +H;       5!!         _onImageChanged@                                               ,Q XQ Q XQ                W   QV       
:        updateUI!!      methodName   params   .this       +H;       5 !!       !!   start!!!!   destroy!!!!   color!!!!'   _computeWidgetState!!!!%   _computeVisibility!!!!   _onImageChanged!!    !!       !!'   SnippetOptionWidget!!!!+   snippetOptionRegistry!!!!   NULL_ID!!!!   UserValueWidget!!!!1   userValueWidgetsRegistry!!!!'   UnitUserValueWidget!!!!9   addTitleAndAllowedAttributes!!!!   buildElement!!!!#   buildTitleElement!!!!   buildRowElement!!!!)   buildCollapseElement!!!!   Class!!!!   registry!!    ;      ?      B         5 !!       C        1                            	            T Je T Je          
       T  =    : W   QT  =   :    QT  =   : W  Q>   QV      
[   Z    ]   [   B]   Z   Z   =   `    Z   =   `    `   `    Z   =   `    Z   =   `    =	   `   =
   `   =   `   `   `   Z   =   `    Z   =   `    `   `   Z   =   `    Z   =   `    `   `   Z   =   `    Z   =   `    =   `   =   `   `   `   Z   =   `    Z   =   `    `   `   Z   =   `    Z   =   `    =   `   `   `   Z   =   `    Z   =   `    =   `   `   `   ]   B]   Z   =   `    ]   =   ]   V  ]   [   [    ]    ]!   ]"      ]#      ]$      ]%      ]&      ]'      ](   	   ]   
   ])      ]*      ]+      ],      ]-   :    Q      0.   Q      0/   Q      00   Q   D)7	
	


	
 dv -T( [6f      O     web.Widget3   web_editor.rte.summernoteO   web_editor.rte.summernote_custom_colors   extend   xmlDependencies   focus   style	   font	   bold   italic   underline   clear   fontsize   color	   para   ul   ol   paragraph   table   insert	   link   picture   history	   undo	   redo   toolbar   styleWithSpan   p   inlinemedia	   odoo	   lang   colors   context   recordInfo   defaultOptions	   init   willStart   start   destroy   getEditable   isDirty   getValue	   save%   saveModifiedImages   setValue   _editorOptions   getRange   setRange!   setRangeFromNode!!      require   Widget#   SummernoteManager-   summernoteCustomColors   id   Wysiwyg      +H!!            !!       !!   context!!    !!       !!   focus!!!!   toolbar!!!!   styleWithSpan!!!!   inlinemedia!!!!	   lang!!!!   colors!!!!   recordInfo!!    !!        	   initC L                                            " W rW W rW               	W   QW  QV  5       
V  V   O QV     #   0   QV  T 0   Q "    _super   apply   id   options!!      parent   options   arguments   .this       +H;      5!!          willStartC  D                                               W W }W W               W   QV      AV   ,  R 0    QV   V   5   0   QV      
:    %   _summernoteManager   $el   $target   _super!!      .this         +H;       5!!          startC  u        ;                          )            W Y W Y               	W  QW  QV  5       
=    QV  V  5       
:  0   QV     
:  W   QV  5       
V    QV  V     
=   : 0	   QV  5	   
   
=   V   QV  5	   
   
=   V   5   5    QV  5	   
   
=   V   5   5    Q         :    
=   V  5    QV  V  5       
:  D   QV  5       
:  0   QV  5      
V  V  O  .	!";5"    $target	   wrap1   <odoo-wysiwyg-container>   parent   $el   _editorOptions   summernote   $)   .note-editable:first   $editor	   data   wysiwyg   oe-model   recordInfo   res_model   oe-id   res_id   document   on   mousedown   _blur	   html   val   _value   _super   apply!!      options   arguments   .this         +H;       5 !!          destroyC                                                 Y Z Y Z   n            W   Q           :    
=   V   5    QV   5   EC   QV   5      
=   : E$   QV   5      
=	   : 
      V   5      
=    QV      
  Q q*    $   document   off   mousedown   _blur   $target   is   textarea	   next   .note-editor   length   summernote   destroy   _super!!      .this         +H;"       5 !!          getEditableC                                                 Z Z Z Z   $             W   QV   5    '    $editor!!      .this         +H;       5!!          isDirtyC  @                                               Z [ Z [   M             W   QV   5    V   5      
:  D   QV   5      
:  IP    _value   $editor	   html   val!!      .this         +H;       5 !!          focusC            	                                       %[ >[ [ >[                        
=    Q      console   log   focus!!              +H;       5!!          getValueC p        <                          (           P[ ] H[ ]                W  QT  E   QT  5    D   QV  5      
:  W   QV      
=   :    
=    QV      
=   :    
=    QV      
=	   :    
=
    QV      
=   :    
=    QV      
=   :    
=    QV      
=   :    
=    QV      
=   :    
=    QV      
=   :    
=   :    
=    QV      
:    $$+"+	%"    $layout   $editor   clone	   find#   [contenteditable]   removeAttr   contenteditable   [class=""]   class   [style=""]   style   [title=""]   title   [alt=""]   alt1   [data-original-title=""]'   data-original-title1   a.o_image, span.fa, i.fa	   html   %   [aria-describedby]!   aria-describedby!!      options   $editable   .this       +H;       5 !!       	   saveC        	   +                                     ] j^ ] j^   !            W  QV      
:  W   QV     
:  W  QV  5      
=   : #   V  5      
V   Q   V  5      
V   Q      
[    V   ]    V  ]   :  (-    isDirty   getValue   $target   is   textarea   val	   html   Promise   resolve!!      isDirty	   html   .this         +H!!       !!   isDirty!!!!	   html!!    ;2       5!!       %   saveModifiedImagesC                                               ^ ^ ~^ ^   Q             W   QV   5       
T  : ]6 %   _summernoteManager%   saveModifiedImages!!      $editable   .this       +H;       5 !!          setValueC q                                              ^ e_ ^ e_                W   QV   5       
=   : "   V   5      
T   Q   V   5      
T   QV   5       
T   Q      $editor   is   textarea   $target   val	   html!!      value   options   .this       +H;2       5 !!          _editorOptionsC           &                                      }_ a u_ a                 W  QV     Q       
[       5   5   V  5   V  5   : W   QV  5   5   "   V  5      
V   : W   QV   V   5   0   QV      0	   QV      0
   QV      0   QV      0   QV   9H!#s[><    Object   assign   $   summernote   options   defaultOptions   generateOptions   toolbar   airPopover   onChange   onUpload   onFocus   onBlur!!   	   self   options   .this        +H!!            !!       ?   _editorOptions/options.onChangeb o` ` g` `   <          5!!       ?   _editorOptions/options.onUploadb ` #a ` #a             5!!       =   _editorOptions/options.onFocusb  <a aa 4a aa   	         5 !!       ;   _editorOptions/options.onBlurb  ya a qa a   F         5;5!!       !!   xmlDependencies!!!!   defaultOptions!!!!	   init!!!!   willStart!!!!   start!!!!   destroy!!!!   getEditable!!!!   isDirty!!!!   focus!!!!   getValue!!!!	   save!!!!%   saveModifiedImages!!!!   setValue!!!!   _editorOptions!!    !!        !   Wysiwyg.getRangeb a ?b a ?b            5 !!       !   Wysiwyg.setRangeb Yb c Qb c   &  0       5 !!       1   Wysiwyg.setRangeFromNodeb c 9e c 9e   p   `       5;5!!       C  :                                               te "f le "f   ?             [    T  =    : ]   T  =   : ]   T  =   : ]    V"'( -   wysiwyg.widgets.Dialog   Dialog7   wysiwyg.widgets.MediaDialog   MediaDialog5   wysiwyg.widgets.LinkDialog   LinkDialog!!      require        +H!!       !!   Dialog!!!!   MediaDialog!!!!   LinkDialog!!    ;      5!!       C  W          *                                     f ;k f ;k                 T  =    :    QT  =   : W   QV      
[       ]      ]      ]    QM!    : #   web_editor.editor%   web_editor.wysiwyg   include	   init   start%   _relocateEditorBar!!      require   editor   Wysiwyg      +H!!        	   initC t                                   
         " Jg g Bg g                	W   QW  QV  5       
V  V   O QV     5   0   QV  5   5    '   V  5         =   : 0   Q  "    _super   apply   Class   Editor   options   toolbarHandler   $)   #web_editor-top-edit!!      parent   options   arguments   .this       +H;#      5!!          startE  J        3                       -            h }i g }i                     Q      Q   5    5            Q    5   A    5    ,  R 0   Q    5   5      
:  0   Q  5   >7!     5   >75   5      	   5      Q  5   
   
   :         Q     
  Q  5      
=        Q         
:         v
$!GU    options   snippets   Editor   editor   rte   editable   $editor   ownerDocument	   body   document   prependTo%   _relocateEditorBar   $el   on   content_changed   _super!!   	   self   .generator   .this         !!          $body            +H!!          start/<b 7i ^i /i ^i            5;   -            5!!       %   _relocateEditorBarC          $                          %            i 6k i 6k               W   QV   5    5       '   V   5          =   : 0   QV   5    5      
V   5   5    QV   5   5   E8   QV   5   5   5   	   
V   5    5   :     c   V   5   5   5   
   
V   5    5    QV   5   5   5   
   
V   5   5   5    Q %4FFW    options   toolbarHandler   length   $1   .o_we_snippet_text_tools   append   editor   $el   snippetsMenu   has   insertAfter%   $snippetEditorArea!!      .this         +H;2       5 !!       !!	   init!!!!   start!!!!%   _relocateEditorBar!!    ;5 !!       C         	   F                                     k u k u                 T  =    : W   QT  =   :    QT  =   : W  QT  =   :    QV  5      QV      
[       ]      ]      ]    QK"!      G %   web_editor.wysiwyg   web.ajax   web.core   web.config	   qweb   include	   init   willStart   _loadIframe!!      require   Wysiwyg	   ajax	   core   config	   qweb   promiseCommon   promiseWysiwyg      +H!!       	   initC f                                            " l bm l bm   "            	W   QW  QV  5       
V  V   O QV  5   5      V  =   V  5   0   QV  Z    0   Q 3"    _super   apply   options   inIframe   onLoad_   id#   _onUpdateIframeId-   __extraAssetsForIframe!!      parent   options   arguments   .this       +H;#      5!!          willStartC  M        ^                         "            um Eo mm Eo   3             W  QV  5    5       V     
:  V  5    5   -         
V  5    5   : W   Q3         
[    Z    ]   Z    ]   : W   Q   D   Q      
=	   :    QV     
   
Z      `    V   `   : 0   QV  V  5   0   QV  5      
V  5      
V  : :    
V  5      
V  : : 6   	!	3:'5    options   inIframe   _super   iframeCssAssets   loadAsset   Promise   resolve   cssLibs   cssContentsO   web_editor.wysiwyg_iframe_editor_assets   all   defAsset   $el   $target	   then   _loadIframe	   bind!!      defAsset   .this         +H!!       !!   cssLibs!!!!   cssContents!!    ;B       5 !!          _loadIframeC           6                                      Zo u Ro u                 W  QV     QV          =   :    
[    =   ]   =   ]   : 0   Q>   Q   A   ,  R W   QV  5   	   
=
   V    QV  5      
=       QV  5      
V  5    QV    
*, ! '    $?   <iframe class="wysiwyg_iframe">   css	   55vh   min-height	   100%   width   $iframe   Promise	   data   loadDef   on	   load   insertAfter   $target!!   	   self   avoidDoubleLoad   def   .this        +H!!       !!   min-height!!!!   width!!    !!        !   _loadIframe/def<b o fs o fs                resolve    B ,p ds $p ds               B  br Ds Zr Ds            5 55!!          onLoadB s {u s {u     0       !   _avoidDoubleLoad    B s xu s xu   L          55;5!!       !!	   init!!!!   willStart!!!!   _loadIframe!!    ;5!!       C         	   A                                     <v { 4v {          
       T  =    : W   QT  =   : W  QT  =   :    QT  =   : W  QV      
   5   V  [       ]      ]      ]   : W  QV  >!E             web.Class   web.rpc   web.mixins#   web.ServicesMixin   extend)   EventDispatcherMixin	   init   getImages   _fetchImages!!      require   Class   rpc   Mixins   ServicesMixin   UnsplashCore      +H!!       	   initC [                                             3w w +w w               	W   QW  Q   5    5      
V  V   l QV     
T   QV  [    0   QV  B0   Q #6 )   EventDispatcherMixin	   init	   call   setParent   _cache   clientId!!      parent   arguments   .this       +H!!            ;       5 !!          getImagesC       
   5                                     w ly w ly          	       W  Q>   QT    QV  5    T  7W   QV   EC   QV   5         D(   QV   5   >IE   QV   5      Q         
[    V   5      
      : ]      V   5   ]   : V     
T  : 	   
   :  h!  qo    _cache   images   length   totalImages   Promise   resolve   slice   isMaxed   _fetchImages	   then!!      query   pageSize	   from   to   cachedData   .this      +H!!       !!   images!!!!   isMaxed!!    !!          getImages/<b 	y iy y iy   -          5;5!!          _fetchImagesC          =                                     y { zy {                 W  QV  5    T  7 5   V  5    T  [    Z    ]   >]   >]   >]   9QV  5    T  7   Q[   T  ]      5   ?]   ]   W   QV     
[   =	   ]
   V   ]   :    
   :   
"	#@      _cache   images   maxPages   totalImages   pageCached   query	   page   per_page	   _rpc5   /web_unsplash/fetch_images   route   params	   then!!      query   cachedData   payload   .this      +H!!       !!   images!!!!   maxPages!!!!   totalImages!!!!   pageCached!!    !!       !!   query!!!!	   page!!!!   per_page!!    !!       !!   route!!!!   params!!    !!          _fetchImages/<b z { z {              5;5!!       !!	   init!!!!   getImages!!!!   _fetchImages!!    ;5 !!       C                                               S| ! K| !                     QT  =    :    QT  =   :    QT  =   : W   Q@   QV   5   5   5     QV  5     QV         A=   ,  R p	   
   
V  [    V  ]    QV  .   QV   5      
[   V   5   5   5      
Z   =   `    : ]   	   
   
[   V   5   5   5   [   =   ]   =   ]   : ]      ]      ]      ]      ]      ]      ]   	   ]   
   ]      ]      ]      ]      ]    Q:%?An;"Kv>F   )]&  # u   /     ^    web.core   unsplash.api+   wysiwyg.widgets.media   ImageWidget   prototype   eventsC   click .o_existing_attachment_cell   Error=  Couldn't find a handler for o_existing_attachment_cell clicks.
The unsplash image widget needs to prevent this handler from executing on unsplash attachments.   _   extend   click .o_existing_attachment_cell:not(.o_unsplash_attachment_cell)   include   xmlDependencies   concatm   /web_unsplash/static/src/xml/unsplash_image_widget.xml'   _onUnsplashImgClick[   click .o_unsplash_attachment_cell[data-imgid]5   _onSaveUnsplashCredentials5   click button.save_unsplash	   init   destroy   _save   search   hasContent%   _highlightSelected   _loadMoreImages#   _renderThumbnails   _renderExisting%   _selectAttachement!!      require	   core   UnsplashAPI   widgetsMedia   unsplashAPI      !!          originalEvents   clickHandler          +H!!       !!   click .o_existing_attachment_cell:not(.o_unsplash_attachment_cell)!!    !!            !!       !![   click .o_unsplash_attachment_cell[data-imgid]!!!!5   click button.save_unsplash!!    !!       	   initC        
   +                                   " a | Y |               	W   QW  QV  5       
V  V   O QV  [   [    ]   B]   B]   B]   Z    ]   0   Q   @H5   V     AV  ,  R 0   QV  5      Q-   V     0   QV  5   	   
V   Q ""#"    _super   apply   selectedImages   isMaxed   query   error   records   _unsplash   unsplashAPI   setParent!!      arguments   .this         +H!!            !!       !!   selectedImages!!!!   isMaxed!!!!   query!!!!   error!!!!   records!!    ;3      5 !!         destroyC  B                                             "       K            	W   QW  QV  5       
    QV  5      
V  V   O Q N&"    unsplashAPI   setParent   undefined   _super   apply!!      arguments   .this         +H;      5 !!         _saveE          `                      7           (                    	   Q   Q        Q  5       Q      
  5   5   :    m       C0   Q     
[   =   ]	   [      5   5   ]
     5   5   ]     5   5   ]     5   5   ]   ]   :            Q  5      
Z    >   -
  5   
   m5   _,  ,  :   5    Q)Q  5      
Z    >   -
  5   
   m5   _,  ,  :   5    Q)Q      
    O          2%+!a  @!!@!    _super   Object	   keys   _unsplash   selectedImages   length   saved	   _rpc9   /web_unsplash/attachment/add   route   unsplashurls   options   res_model   res_id   query   params   attachments	   push	   next   value	   done'   selectedAttachments   apply!!      .generator   arguments   .this         !!          _super            !!         images            +H!!       !!   unsplashurls!!!!   res_model!!!!   res_id!!!!   query!!    !!       !!   route!!!!   params!!    ;   0  !        !              ]   b                         5!!         searchE (        B                                 (                      	   Q   Q      Q      Q       
Z    >   -
  5   
   m5   _,  ,  :   5    Q)         Q   5      0   Q    #      5   Z    0   Q      5      
      5	   : 
   
       :          Q    H
@!	  E      _super	   next   value	   done   _unsplash   query   records   unsplashAPI   getImages9   numberOfAttachmentsToDisplay	   then!!      needle	   self   .generator   arguments   .this       +H!!           search/<b   {    X          5 !!          search/<b                 5 ;   V   !           5 !!         hasContent@  :     	   @                                     ! !  !         
       	W   QW  QV  5    =   H   V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)D%   QV  5   E   QV  5      ;   V  5    =   H&   V  5   E   QV  5      V     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)  @!!  t$!@!    searchService   all   _super	   next   value	   done   unsplashRecords   length   unsplash!!      arguments   .this         +H;   P   !        !   3       5 !!      %   _highlightSelectedC  r                                              = % 5 %                 	W   Q   Q  Q   5       
   V   O Q      
=   :    
    :    
=   :   QV  @(2N%    _super   apply   $O   .o_unsplash_attachment_cell[data-imgid]   filter   addClass1   o_we_attachment_selected!!      arguments   .this        !!          $select          +H!!      7   _highlightSelected/$select<d"                 5;      d       o          5!!         _loadMoreImagesC          0                                     >  6                      Q       
=   :    
:            
T  :    5   
0   Q      
       
=   :    
:  :    
     Q Ms&*#    $   .o_we_search   val   _super9   numberOfAttachmentsToDisplay   search	   then!!      forceSearch   .this       +H!!       #   _loadMoreImages/<d"        U          5;5!!      #   _renderThumbnailsC          k                        ,             	  	         
       	W   QW  QV      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)QV     
=   :    
  QZ   =   `    =   `   	   
V  5
   :     V  5   5   E   QV  5   5   W   V     
=   :    
   5      
=   [    V  5   5   ]   :  QZ   =   `    =   `   	   
V  5
   : E+   QV  5   5   E   QV  5   5    L   V     
=   :    
=    QV     
=   :    
=    Q  @!   /U[  A4    _super	   next   value	   done   $   .unsplash_error   empty   all   unsplash   includes   searchService   _unsplash   query   error	   html	   qweb   renderC   web_unsplash.dialog.error.content   status   isMaxed   .o_load_more   removeClass   d-none!   .o_load_done_msg   addClass!!      arguments   .this         +H!!       !!   status!!    ;   ;   !   C       5!!         _renderExistingC                                              " 8  8          	       	W   Q   Q      5    5      
    : 0   Q      
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)    @!    _unsplash   records   map   unsplashRecords   _super	   next   value	   done!!      attachments   arguments   .this      +H!!       K   _renderExisting/this.unsplashRecords<d" `  `             5;   g   !   5 !!      %   _selectAttachementC                                             T  L         
       	W   QW  QV  5    5       V  5   [    0   QV     
Z    >V   -
  5   
   m5   _,  ,  :   5    Q)Q @!    options   multiImages   _unsplash   selectedImages   _super	   next   value	   done!!      attachment	   save   arguments   .this       +H!!            ;   e   !   #       5!!      5   _onSaveUnsplashCredentialsC  A        X                                                          W  QV     QV      
=   :    
:     
:     QV      
=   :    
:     
:  W   QV      
=   :    
=        QV      
=   :    
=   V     Q   E   QV   t   V  5      
=	   : 
    P   V     
[   =   ]   [       ]   V   ]   ]   :    
    QF3/!%$O      $   #accessKeyInput   val	   trim   #appIdInput   toggleClass   is-invalid   $el	   find   .is-invalid   length	   _rpc7   /web_unsplash/save_unsplash   route   key   appId   params	   then!!   	   self   key   appId   .this        +H!!       !!   key!!!!   appId!!    !!       !!   route!!!!   params!!    !!       9   _onSaveUnsplashCredentials/<b  W  O                D"                 5 5;5!!      '   _onUnsplashImgClickC         P                                         T     
       W   Q        QV   5    
   T  5   5   5     Q5     Q5     Q5     QQV   5   5    )   V   5	   [    0
   QV   Z    0   QV  V   5	   5
   q   V   5	   5
   V  /Qz     Q   AV  ,  R   QV  5      
=   =    QV   5	   5
   V  [   V  5   ]   V  ]   V  ]   9QV      
  QV   5   5       V      
=    Q XY =!+1	&&!    saved   currentTarget   dataset   imgid   url   downloadUrl   description   options   multiImages   _unsplash   selectedImages'   selectedAttachments   URL   searchParams   set   w	   1920	   href   download_url%   _highlightSelected   trigger_up   save_request!!      ev   .this       !!          imgid   url   downloadUrl   description          !!         _1920Url          +H!!            !!       !!   url!!!!   download_url!!!!   description!!    ;      |      *                t       b       5!!       !!   xmlDependencies!!!!   events!!!!	   init!!!!   destroy!!!!   _save!!!!   search!!!!   hasContent!!!!%   _highlightSelected!!!!   _loadMoreImages!!!!#   _renderThumbnails!!!!   _renderExisting!!!!%   _selectAttachement!!!!5   _onSaveUnsplashCredentials!!!!'   _onUnsplashImgClick!!    ;         5 ;y+6MFnol      
`!-`!-B&Ca   L    :http://hr.deerom.com/web/content/458-ec554a4/1/web_editor.assets_wysiwyg.js necko:classified 1 strongly-framed 1 request-method GET response-head HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Date: Wed, 03 Feb 2021 10:36:10 GMT
Content-Type: application/javascript
Content-Length: 364579
X-Content-Type-Options: nosniff
ETag: a67b17d84a97023eb924c9236503025830494ac7
Cache-Control: max-age=31536000
 original-response-headers Server: nginx/1.18.0 (Ubuntu)
Date: Wed, 03 Feb 2021 10:36:10 GMT
Content-Type: application/javascript
Content-Length: 364579
Connection: keep-alive
X-Content-Type-Options: nosniff
ETag: a67b17d84a97023eb924c9236503025830494ac7
Cache-Control: max-age=31536000
Set-Cookie: session_id=e3bcac1b45e33606ae06175f0b91fc65add6d2a6; Expires=Tue, 04-May-2021 10:36:10 GMT; Max-Age=7776000; HttpOnly; Path=/
 uncompressed-len 0 net-response-time-onstart 92 net-response-time-onstop 497 alt-data 1;364579,javascript/moz-bytecode-20190327091201 alt-data-from-child 1  g